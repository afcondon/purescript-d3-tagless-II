/* Generated by Spago v0.93.44 */
(() => {
  // output/Affjax/foreign.js
  function _ajax(platformSpecificDriver, timeoutErrorMessageIdent, requestFailedMessageIdent, mkHeader, options2) {
    return function(errback, callback) {
      var xhr = platformSpecificDriver.newXHR();
      var fixedUrl = platformSpecificDriver.fixupUrl(options2.url, xhr);
      xhr.open(options2.method || "GET", fixedUrl, true, options2.username, options2.password);
      if (options2.headers) {
        try {
          for (var i2 = 0, header2; (header2 = options2.headers[i2]) != null; i2++) {
            xhr.setRequestHeader(header2.field, header2.value);
          }
        } catch (e) {
          errback(e);
        }
      }
      var onerror = function(msgIdent) {
        return function() {
          errback(new Error(msgIdent));
        };
      };
      xhr.onerror = onerror(requestFailedMessageIdent);
      xhr.ontimeout = onerror(timeoutErrorMessageIdent);
      xhr.onload = function() {
        callback({
          status: xhr.status,
          statusText: xhr.statusText,
          headers: xhr.getAllResponseHeaders().split("\r\n").filter(function(header3) {
            return header3.length > 0;
          }).map(function(header3) {
            var i3 = header3.indexOf(":");
            return mkHeader(header3.substring(0, i3))(header3.substring(i3 + 2));
          }),
          body: xhr.response
        });
      };
      xhr.responseType = options2.responseType;
      xhr.withCredentials = options2.withCredentials;
      xhr.timeout = options2.timeout;
      xhr.send(options2.content);
      return function(error4, cancelErrback, cancelCallback) {
        try {
          xhr.abort();
        } catch (e) {
          return cancelErrback(e);
        }
        return cancelCallback();
      };
    };
  }

  // output/Data.Functor/foreign.js
  var arrayMap = function(f) {
    return function(arr) {
      var l = arr.length;
      var result = new Array(l);
      for (var i2 = 0; i2 < l; i2++) {
        result[i2] = f(arr[i2]);
      }
      return result;
    };
  };

  // output/Control.Semigroupoid/index.js
  var semigroupoidFn = {
    compose: function(f) {
      return function(g) {
        return function(x47) {
          return f(g(x47));
        };
      };
    }
  };

  // output/Control.Category/index.js
  var identity = function(dict) {
    return dict.identity;
  };
  var categoryFn = {
    identity: function(x47) {
      return x47;
    },
    Semigroupoid0: function() {
      return semigroupoidFn;
    }
  };

  // output/Data.Boolean/index.js
  var otherwise = true;

  // output/Data.Function/index.js
  var on = function(f) {
    return function(g) {
      return function(x47) {
        return function(y48) {
          return f(g(x47))(g(y48));
        };
      };
    };
  };
  var flip = function(f) {
    return function(b10) {
      return function(a2) {
        return f(a2)(b10);
      };
    };
  };
  var $$const = function(a2) {
    return function(v) {
      return a2;
    };
  };

  // output/Data.Unit/foreign.js
  var unit = void 0;

  // output/Type.Proxy/index.js
  var $$Proxy = /* @__PURE__ */ (function() {
    function $$Proxy2() {
    }
    ;
    $$Proxy2.value = new $$Proxy2();
    return $$Proxy2;
  })();

  // output/Data.Functor/index.js
  var map = function(dict) {
    return dict.map;
  };
  var mapFlipped = function(dictFunctor) {
    var map124 = map(dictFunctor);
    return function(fa) {
      return function(f) {
        return map124(f)(fa);
      };
    };
  };
  var $$void = function(dictFunctor) {
    return map(dictFunctor)($$const(unit));
  };
  var voidLeft = function(dictFunctor) {
    var map124 = map(dictFunctor);
    return function(f) {
      return function(x47) {
        return map124($$const(x47))(f);
      };
    };
  };
  var voidRight = function(dictFunctor) {
    var map124 = map(dictFunctor);
    return function(x47) {
      return map124($$const(x47));
    };
  };
  var functorArray = {
    map: arrayMap
  };

  // output/Data.Semigroup/foreign.js
  var concatString = function(s1) {
    return function(s2) {
      return s1 + s2;
    };
  };
  var concatArray = function(xs) {
    return function(ys) {
      if (xs.length === 0) return ys;
      if (ys.length === 0) return xs;
      return xs.concat(ys);
    };
  };

  // output/Data.Symbol/index.js
  var reflectSymbol = function(dict) {
    return dict.reflectSymbol;
  };

  // output/Record.Unsafe/foreign.js
  var unsafeGet = function(label5) {
    return function(rec) {
      return rec[label5];
    };
  };
  var unsafeSet = function(label5) {
    return function(value18) {
      return function(rec) {
        var copy2 = {};
        for (var key in rec) {
          if ({}.hasOwnProperty.call(rec, key)) {
            copy2[key] = rec[key];
          }
        }
        copy2[label5] = value18;
        return copy2;
      };
    };
  };

  // output/Data.Semigroup/index.js
  var semigroupString = {
    append: concatString
  };
  var semigroupArray = {
    append: concatArray
  };
  var append = function(dict) {
    return dict.append;
  };

  // output/Control.Alt/index.js
  var alt = function(dict) {
    return dict.alt;
  };

  // output/Control.Apply/foreign.js
  var arrayApply = function(fs) {
    return function(xs) {
      var l = fs.length;
      var k = xs.length;
      var result = new Array(l * k);
      var n = 0;
      for (var i2 = 0; i2 < l; i2++) {
        var f = fs[i2];
        for (var j = 0; j < k; j++) {
          result[n++] = f(xs[j]);
        }
      }
      return result;
    };
  };

  // output/Control.Apply/index.js
  var identity2 = /* @__PURE__ */ identity(categoryFn);
  var applyArray = {
    apply: arrayApply,
    Functor0: function() {
      return functorArray;
    }
  };
  var apply = function(dict) {
    return dict.apply;
  };
  var applyFirst = function(dictApply) {
    var apply1 = apply(dictApply);
    var map95 = map(dictApply.Functor0());
    return function(a2) {
      return function(b10) {
        return apply1(map95($$const)(a2))(b10);
      };
    };
  };
  var applySecond = function(dictApply) {
    var apply1 = apply(dictApply);
    var map95 = map(dictApply.Functor0());
    return function(a2) {
      return function(b10) {
        return apply1(map95($$const(identity2))(a2))(b10);
      };
    };
  };
  var lift2 = function(dictApply) {
    var apply1 = apply(dictApply);
    var map95 = map(dictApply.Functor0());
    return function(f) {
      return function(a2) {
        return function(b10) {
          return apply1(map95(f)(a2))(b10);
        };
      };
    };
  };

  // output/Control.Applicative/index.js
  var pure = function(dict) {
    return dict.pure;
  };
  var unless = function(dictApplicative) {
    var pure128 = pure(dictApplicative);
    return function(v) {
      return function(v1) {
        if (!v) {
          return v1;
        }
        ;
        if (v) {
          return pure128(unit);
        }
        ;
        throw new Error("Failed pattern match at Control.Applicative (line 68, column 1 - line 68, column 65): " + [v.constructor.name, v1.constructor.name]);
      };
    };
  };
  var when = function(dictApplicative) {
    var pure128 = pure(dictApplicative);
    return function(v) {
      return function(v1) {
        if (v) {
          return v1;
        }
        ;
        if (!v) {
          return pure128(unit);
        }
        ;
        throw new Error("Failed pattern match at Control.Applicative (line 63, column 1 - line 63, column 63): " + [v.constructor.name, v1.constructor.name]);
      };
    };
  };
  var liftA1 = function(dictApplicative) {
    var apply8 = apply(dictApplicative.Apply0());
    var pure128 = pure(dictApplicative);
    return function(f) {
      return function(a2) {
        return apply8(pure128(f))(a2);
      };
    };
  };
  var applicativeArray = {
    pure: function(x47) {
      return [x47];
    },
    Apply0: function() {
      return applyArray;
    }
  };

  // output/Data.Bounded/foreign.js
  var topInt = 2147483647;
  var bottomInt = -2147483648;
  var topChar = String.fromCharCode(65535);
  var bottomChar = String.fromCharCode(0);
  var topNumber = Number.POSITIVE_INFINITY;
  var bottomNumber = Number.NEGATIVE_INFINITY;

  // output/Data.Ord/foreign.js
  var unsafeCompareImpl = function(lt) {
    return function(eq20) {
      return function(gt) {
        return function(x47) {
          return function(y48) {
            return x47 < y48 ? lt : x47 === y48 ? eq20 : gt;
          };
        };
      };
    };
  };
  var ordBooleanImpl = unsafeCompareImpl;
  var ordIntImpl = unsafeCompareImpl;
  var ordNumberImpl = unsafeCompareImpl;
  var ordStringImpl = unsafeCompareImpl;
  var ordCharImpl = unsafeCompareImpl;
  var ordArrayImpl = function(f) {
    return function(xs) {
      return function(ys) {
        var i2 = 0;
        var xlen = xs.length;
        var ylen = ys.length;
        while (i2 < xlen && i2 < ylen) {
          var x47 = xs[i2];
          var y48 = ys[i2];
          var o = f(x47)(y48);
          if (o !== 0) {
            return o;
          }
          i2++;
        }
        if (xlen === ylen) {
          return 0;
        } else if (xlen > ylen) {
          return -1;
        } else {
          return 1;
        }
      };
    };
  };

  // output/Data.Eq/foreign.js
  var refEq = function(r1) {
    return function(r2) {
      return r1 === r2;
    };
  };
  var eqBooleanImpl = refEq;
  var eqIntImpl = refEq;
  var eqNumberImpl = refEq;
  var eqCharImpl = refEq;
  var eqStringImpl = refEq;
  var eqArrayImpl = function(f) {
    return function(xs) {
      return function(ys) {
        if (xs.length !== ys.length) return false;
        for (var i2 = 0; i2 < xs.length; i2++) {
          if (!f(xs[i2])(ys[i2])) return false;
        }
        return true;
      };
    };
  };

  // output/Data.Eq/index.js
  var eqUnit = {
    eq: function(v) {
      return function(v1) {
        return true;
      };
    }
  };
  var eqString = {
    eq: eqStringImpl
  };
  var eqRowNil = {
    eqRecord: function(v) {
      return function(v1) {
        return function(v2) {
          return true;
        };
      };
    }
  };
  var eqRecord = function(dict) {
    return dict.eqRecord;
  };
  var eqRec = function() {
    return function(dictEqRecord) {
      return {
        eq: eqRecord(dictEqRecord)($$Proxy.value)
      };
    };
  };
  var eqNumber = {
    eq: eqNumberImpl
  };
  var eqInt = {
    eq: eqIntImpl
  };
  var eqChar = {
    eq: eqCharImpl
  };
  var eqBoolean = {
    eq: eqBooleanImpl
  };
  var eq = function(dict) {
    return dict.eq;
  };
  var eq2 = /* @__PURE__ */ eq(eqBoolean);
  var eqArray = function(dictEq) {
    return {
      eq: eqArrayImpl(eq(dictEq))
    };
  };
  var eqRowCons = function(dictEqRecord) {
    var eqRecord1 = eqRecord(dictEqRecord);
    return function() {
      return function(dictIsSymbol) {
        var reflectSymbol2 = reflectSymbol(dictIsSymbol);
        return function(dictEq) {
          var eq34 = eq(dictEq);
          return {
            eqRecord: function(v) {
              return function(ra) {
                return function(rb) {
                  var tail2 = eqRecord1($$Proxy.value)(ra)(rb);
                  var key = reflectSymbol2($$Proxy.value);
                  var get26 = unsafeGet(key);
                  return eq34(get26(ra))(get26(rb)) && tail2;
                };
              };
            }
          };
        };
      };
    };
  };
  var notEq = function(dictEq) {
    var eq34 = eq(dictEq);
    return function(x47) {
      return function(y48) {
        return eq2(eq34(x47)(y48))(false);
      };
    };
  };

  // output/Data.Ordering/index.js
  var LT = /* @__PURE__ */ (function() {
    function LT2() {
    }
    ;
    LT2.value = new LT2();
    return LT2;
  })();
  var GT = /* @__PURE__ */ (function() {
    function GT2() {
    }
    ;
    GT2.value = new GT2();
    return GT2;
  })();
  var EQ = /* @__PURE__ */ (function() {
    function EQ2() {
    }
    ;
    EQ2.value = new EQ2();
    return EQ2;
  })();
  var eqOrdering = {
    eq: function(v) {
      return function(v1) {
        if (v instanceof LT && v1 instanceof LT) {
          return true;
        }
        ;
        if (v instanceof GT && v1 instanceof GT) {
          return true;
        }
        ;
        if (v instanceof EQ && v1 instanceof EQ) {
          return true;
        }
        ;
        return false;
      };
    }
  };

  // output/Data.Ring/foreign.js
  var intSub = function(x47) {
    return function(y48) {
      return x47 - y48 | 0;
    };
  };

  // output/Data.Semiring/foreign.js
  var intAdd = function(x47) {
    return function(y48) {
      return x47 + y48 | 0;
    };
  };
  var intMul = function(x47) {
    return function(y48) {
      return x47 * y48 | 0;
    };
  };
  var numAdd = function(n1) {
    return function(n2) {
      return n1 + n2;
    };
  };
  var numMul = function(n1) {
    return function(n2) {
      return n1 * n2;
    };
  };

  // output/Data.Semiring/index.js
  var zero = function(dict) {
    return dict.zero;
  };
  var semiringNumber = {
    add: numAdd,
    zero: 0,
    mul: numMul,
    one: 1
  };
  var semiringInt = {
    add: intAdd,
    zero: 0,
    mul: intMul,
    one: 1
  };
  var one = function(dict) {
    return dict.one;
  };
  var mul = function(dict) {
    return dict.mul;
  };
  var add = function(dict) {
    return dict.add;
  };

  // output/Data.Ring/index.js
  var ringInt = {
    sub: intSub,
    Semiring0: function() {
      return semiringInt;
    }
  };

  // output/Data.Ord/index.js
  var eqRec2 = /* @__PURE__ */ eqRec();
  var notEq2 = /* @__PURE__ */ notEq(eqOrdering);
  var ordUnit = {
    compare: function(v) {
      return function(v1) {
        return EQ.value;
      };
    },
    Eq0: function() {
      return eqUnit;
    }
  };
  var ordString = /* @__PURE__ */ (function() {
    return {
      compare: ordStringImpl(LT.value)(EQ.value)(GT.value),
      Eq0: function() {
        return eqString;
      }
    };
  })();
  var ordRecordNil = {
    compareRecord: function(v) {
      return function(v1) {
        return function(v2) {
          return EQ.value;
        };
      };
    },
    EqRecord0: function() {
      return eqRowNil;
    }
  };
  var ordNumber = /* @__PURE__ */ (function() {
    return {
      compare: ordNumberImpl(LT.value)(EQ.value)(GT.value),
      Eq0: function() {
        return eqNumber;
      }
    };
  })();
  var ordInt = /* @__PURE__ */ (function() {
    return {
      compare: ordIntImpl(LT.value)(EQ.value)(GT.value),
      Eq0: function() {
        return eqInt;
      }
    };
  })();
  var ordChar = /* @__PURE__ */ (function() {
    return {
      compare: ordCharImpl(LT.value)(EQ.value)(GT.value),
      Eq0: function() {
        return eqChar;
      }
    };
  })();
  var ordBoolean = /* @__PURE__ */ (function() {
    return {
      compare: ordBooleanImpl(LT.value)(EQ.value)(GT.value),
      Eq0: function() {
        return eqBoolean;
      }
    };
  })();
  var compareRecord = function(dict) {
    return dict.compareRecord;
  };
  var ordRecord = function() {
    return function(dictOrdRecord) {
      var eqRec1 = eqRec2(dictOrdRecord.EqRecord0());
      return {
        compare: compareRecord(dictOrdRecord)($$Proxy.value),
        Eq0: function() {
          return eqRec1;
        }
      };
    };
  };
  var compare = function(dict) {
    return dict.compare;
  };
  var compare2 = /* @__PURE__ */ compare(ordInt);
  var comparing = function(dictOrd) {
    var compare32 = compare(dictOrd);
    return function(f) {
      return function(x47) {
        return function(y48) {
          return compare32(f(x47))(f(y48));
        };
      };
    };
  };
  var max = function(dictOrd) {
    var compare32 = compare(dictOrd);
    return function(x47) {
      return function(y48) {
        var v = compare32(x47)(y48);
        if (v instanceof LT) {
          return y48;
        }
        ;
        if (v instanceof EQ) {
          return x47;
        }
        ;
        if (v instanceof GT) {
          return x47;
        }
        ;
        throw new Error("Failed pattern match at Data.Ord (line 181, column 3 - line 184, column 12): " + [v.constructor.name]);
      };
    };
  };
  var min = function(dictOrd) {
    var compare32 = compare(dictOrd);
    return function(x47) {
      return function(y48) {
        var v = compare32(x47)(y48);
        if (v instanceof LT) {
          return x47;
        }
        ;
        if (v instanceof EQ) {
          return x47;
        }
        ;
        if (v instanceof GT) {
          return y48;
        }
        ;
        throw new Error("Failed pattern match at Data.Ord (line 172, column 3 - line 175, column 12): " + [v.constructor.name]);
      };
    };
  };
  var ordArray = function(dictOrd) {
    var compare32 = compare(dictOrd);
    var eqArray2 = eqArray(dictOrd.Eq0());
    return {
      compare: /* @__PURE__ */ (function() {
        var toDelta = function(x47) {
          return function(y48) {
            var v = compare32(x47)(y48);
            if (v instanceof EQ) {
              return 0;
            }
            ;
            if (v instanceof LT) {
              return 1;
            }
            ;
            if (v instanceof GT) {
              return -1 | 0;
            }
            ;
            throw new Error("Failed pattern match at Data.Ord (line 79, column 7 - line 82, column 17): " + [v.constructor.name]);
          };
        };
        return function(xs) {
          return function(ys) {
            return compare2(0)(ordArrayImpl(toDelta)(xs)(ys));
          };
        };
      })(),
      Eq0: function() {
        return eqArray2;
      }
    };
  };
  var ordRecordCons = function(dictOrdRecord) {
    var compareRecord1 = compareRecord(dictOrdRecord);
    var eqRowCons2 = eqRowCons(dictOrdRecord.EqRecord0())();
    return function() {
      return function(dictIsSymbol) {
        var reflectSymbol2 = reflectSymbol(dictIsSymbol);
        var eqRowCons1 = eqRowCons2(dictIsSymbol);
        return function(dictOrd) {
          var compare32 = compare(dictOrd);
          var eqRowCons22 = eqRowCons1(dictOrd.Eq0());
          return {
            compareRecord: function(v) {
              return function(ra) {
                return function(rb) {
                  var key = reflectSymbol2($$Proxy.value);
                  var left3 = compare32(unsafeGet(key)(ra))(unsafeGet(key)(rb));
                  var $95 = notEq2(left3)(EQ.value);
                  if ($95) {
                    return left3;
                  }
                  ;
                  return compareRecord1($$Proxy.value)(ra)(rb);
                };
              };
            },
            EqRecord0: function() {
              return eqRowCons22;
            }
          };
        };
      };
    };
  };
  var clamp = function(dictOrd) {
    var min1 = min(dictOrd);
    var max15 = max(dictOrd);
    return function(low2) {
      return function(hi) {
        return function(x47) {
          return min1(hi)(max15(low2)(x47));
        };
      };
    };
  };

  // output/Data.Bounded/index.js
  var top = function(dict) {
    return dict.top;
  };
  var boundedInt = {
    top: topInt,
    bottom: bottomInt,
    Ord0: function() {
      return ordInt;
    }
  };
  var boundedChar = {
    top: topChar,
    bottom: bottomChar,
    Ord0: function() {
      return ordChar;
    }
  };
  var bottom = function(dict) {
    return dict.bottom;
  };

  // output/Data.Show/foreign.js
  var showIntImpl = function(n) {
    return n.toString();
  };
  var showNumberImpl = function(n) {
    var str2 = n.toString();
    return isNaN(str2 + ".0") ? str2 : str2 + ".0";
  };
  var showStringImpl = function(s) {
    var l = s.length;
    return '"' + s.replace(
      /[\0-\x1F\x7F"\\]/g,
      // eslint-disable-line no-control-regex
      function(c, i2) {
        switch (c) {
          case '"':
          case "\\":
            return "\\" + c;
          case "\x07":
            return "\\a";
          case "\b":
            return "\\b";
          case "\f":
            return "\\f";
          case "\n":
            return "\\n";
          case "\r":
            return "\\r";
          case "	":
            return "\\t";
          case "\v":
            return "\\v";
        }
        var k = i2 + 1;
        var empty9 = k < l && s[k] >= "0" && s[k] <= "9" ? "\\&" : "";
        return "\\" + c.charCodeAt(0).toString(10) + empty9;
      }
    ) + '"';
  };
  var showArrayImpl = function(f) {
    return function(xs) {
      var ss = [];
      for (var i2 = 0, l = xs.length; i2 < l; i2++) {
        ss[i2] = f(xs[i2]);
      }
      return "[" + ss.join(",") + "]";
    };
  };

  // output/Data.Show/index.js
  var showString = {
    show: showStringImpl
  };
  var showRecordFields = function(dict) {
    return dict.showRecordFields;
  };
  var showRecord = function() {
    return function() {
      return function(dictShowRecordFields) {
        var showRecordFields1 = showRecordFields(dictShowRecordFields);
        return {
          show: function(record) {
            return "{" + (showRecordFields1($$Proxy.value)(record) + "}");
          }
        };
      };
    };
  };
  var showNumber = {
    show: showNumberImpl
  };
  var showInt = {
    show: showIntImpl
  };
  var showBoolean = {
    show: function(v) {
      if (v) {
        return "true";
      }
      ;
      if (!v) {
        return "false";
      }
      ;
      throw new Error("Failed pattern match at Data.Show (line 29, column 1 - line 31, column 23): " + [v.constructor.name]);
    }
  };
  var show = function(dict) {
    return dict.show;
  };
  var showArray = function(dictShow) {
    return {
      show: showArrayImpl(show(dictShow))
    };
  };
  var showRecordFieldsCons = function(dictIsSymbol) {
    var reflectSymbol2 = reflectSymbol(dictIsSymbol);
    return function(dictShowRecordFields) {
      var showRecordFields1 = showRecordFields(dictShowRecordFields);
      return function(dictShow) {
        var show144 = show(dictShow);
        return {
          showRecordFields: function(v) {
            return function(record) {
              var tail2 = showRecordFields1($$Proxy.value)(record);
              var key = reflectSymbol2($$Proxy.value);
              var focus3 = unsafeGet(key)(record);
              return " " + (key + (": " + (show144(focus3) + ("," + tail2))));
            };
          }
        };
      };
    };
  };
  var showRecordFieldsConsNil = function(dictIsSymbol) {
    var reflectSymbol2 = reflectSymbol(dictIsSymbol);
    return function(dictShow) {
      var show144 = show(dictShow);
      return {
        showRecordFields: function(v) {
          return function(record) {
            var key = reflectSymbol2($$Proxy.value);
            var focus3 = unsafeGet(key)(record);
            return " " + (key + (": " + (show144(focus3) + " ")));
          };
        }
      };
    };
  };

  // output/Data.Maybe/index.js
  var identity3 = /* @__PURE__ */ identity(categoryFn);
  var Nothing = /* @__PURE__ */ (function() {
    function Nothing2() {
    }
    ;
    Nothing2.value = new Nothing2();
    return Nothing2;
  })();
  var Just = /* @__PURE__ */ (function() {
    function Just2(value0) {
      this.value0 = value0;
    }
    ;
    Just2.create = function(value0) {
      return new Just2(value0);
    };
    return Just2;
  })();
  var maybe = function(v) {
    return function(v1) {
      return function(v2) {
        if (v2 instanceof Nothing) {
          return v;
        }
        ;
        if (v2 instanceof Just) {
          return v1(v2.value0);
        }
        ;
        throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): " + [v.constructor.name, v1.constructor.name, v2.constructor.name]);
      };
    };
  };
  var isNothing = /* @__PURE__ */ maybe(true)(/* @__PURE__ */ $$const(false));
  var isJust = /* @__PURE__ */ maybe(false)(/* @__PURE__ */ $$const(true));
  var functorMaybe = {
    map: function(v) {
      return function(v1) {
        if (v1 instanceof Just) {
          return new Just(v(v1.value0));
        }
        ;
        return Nothing.value;
      };
    }
  };
  var map2 = /* @__PURE__ */ map(functorMaybe);
  var fromMaybe = function(a2) {
    return maybe(a2)(identity3);
  };
  var fromJust = function() {
    return function(v) {
      if (v instanceof Just) {
        return v.value0;
      }
      ;
      throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): " + [v.constructor.name]);
    };
  };
  var eqMaybe = function(dictEq) {
    var eq20 = eq(dictEq);
    return {
      eq: function(x47) {
        return function(y48) {
          if (x47 instanceof Nothing && y48 instanceof Nothing) {
            return true;
          }
          ;
          if (x47 instanceof Just && y48 instanceof Just) {
            return eq20(x47.value0)(y48.value0);
          }
          ;
          return false;
        };
      }
    };
  };
  var ordMaybe = function(dictOrd) {
    var compare26 = compare(dictOrd);
    var eqMaybe1 = eqMaybe(dictOrd.Eq0());
    return {
      compare: function(x47) {
        return function(y48) {
          if (x47 instanceof Nothing && y48 instanceof Nothing) {
            return EQ.value;
          }
          ;
          if (x47 instanceof Nothing) {
            return LT.value;
          }
          ;
          if (y48 instanceof Nothing) {
            return GT.value;
          }
          ;
          if (x47 instanceof Just && y48 instanceof Just) {
            return compare26(x47.value0)(y48.value0);
          }
          ;
          throw new Error("Failed pattern match at Data.Maybe (line 0, column 0 - line 0, column 0): " + [x47.constructor.name, y48.constructor.name]);
        };
      },
      Eq0: function() {
        return eqMaybe1;
      }
    };
  };
  var applyMaybe = {
    apply: function(v) {
      return function(v1) {
        if (v instanceof Just) {
          return map2(v.value0)(v1);
        }
        ;
        if (v instanceof Nothing) {
          return Nothing.value;
        }
        ;
        throw new Error("Failed pattern match at Data.Maybe (line 67, column 1 - line 69, column 30): " + [v.constructor.name, v1.constructor.name]);
      };
    },
    Functor0: function() {
      return functorMaybe;
    }
  };
  var bindMaybe = {
    bind: function(v) {
      return function(v1) {
        if (v instanceof Just) {
          return v1(v.value0);
        }
        ;
        if (v instanceof Nothing) {
          return Nothing.value;
        }
        ;
        throw new Error("Failed pattern match at Data.Maybe (line 125, column 1 - line 127, column 28): " + [v.constructor.name, v1.constructor.name]);
      };
    },
    Apply0: function() {
      return applyMaybe;
    }
  };
  var applicativeMaybe = /* @__PURE__ */ (function() {
    return {
      pure: Just.create,
      Apply0: function() {
        return applyMaybe;
      }
    };
  })();
  var altMaybe = {
    alt: function(v) {
      return function(v1) {
        if (v instanceof Nothing) {
          return v1;
        }
        ;
        return v;
      };
    },
    Functor0: function() {
      return functorMaybe;
    }
  };
  var plusMaybe = /* @__PURE__ */ (function() {
    return {
      empty: Nothing.value,
      Alt0: function() {
        return altMaybe;
      }
    };
  })();
  var alternativeMaybe = {
    Applicative0: function() {
      return applicativeMaybe;
    },
    Plus1: function() {
      return plusMaybe;
    }
  };

  // output/Data.MediaType.Common/index.js
  var applicationJSON = "application/json";
  var applicationFormURLEncoded = "application/x-www-form-urlencoded";

  // output/Affjax.RequestBody/index.js
  var ArrayView = /* @__PURE__ */ (function() {
    function ArrayView2(value0) {
      this.value0 = value0;
    }
    ;
    ArrayView2.create = function(value0) {
      return new ArrayView2(value0);
    };
    return ArrayView2;
  })();
  var Blob = /* @__PURE__ */ (function() {
    function Blob3(value0) {
      this.value0 = value0;
    }
    ;
    Blob3.create = function(value0) {
      return new Blob3(value0);
    };
    return Blob3;
  })();
  var Document = /* @__PURE__ */ (function() {
    function Document3(value0) {
      this.value0 = value0;
    }
    ;
    Document3.create = function(value0) {
      return new Document3(value0);
    };
    return Document3;
  })();
  var $$String = /* @__PURE__ */ (function() {
    function $$String3(value0) {
      this.value0 = value0;
    }
    ;
    $$String3.create = function(value0) {
      return new $$String3(value0);
    };
    return $$String3;
  })();
  var FormData = /* @__PURE__ */ (function() {
    function FormData2(value0) {
      this.value0 = value0;
    }
    ;
    FormData2.create = function(value0) {
      return new FormData2(value0);
    };
    return FormData2;
  })();
  var FormURLEncoded = /* @__PURE__ */ (function() {
    function FormURLEncoded2(value0) {
      this.value0 = value0;
    }
    ;
    FormURLEncoded2.create = function(value0) {
      return new FormURLEncoded2(value0);
    };
    return FormURLEncoded2;
  })();
  var Json = /* @__PURE__ */ (function() {
    function Json3(value0) {
      this.value0 = value0;
    }
    ;
    Json3.create = function(value0) {
      return new Json3(value0);
    };
    return Json3;
  })();
  var toMediaType = function(v) {
    if (v instanceof FormURLEncoded) {
      return new Just(applicationFormURLEncoded);
    }
    ;
    if (v instanceof Json) {
      return new Just(applicationJSON);
    }
    ;
    return Nothing.value;
  };

  // output/Unsafe.Coerce/foreign.js
  var unsafeCoerce2 = function(x47) {
    return x47;
  };

  // output/Safe.Coerce/index.js
  var coerce = function() {
    return unsafeCoerce2;
  };

  // output/Data.Newtype/index.js
  var coerce2 = /* @__PURE__ */ coerce();
  var unwrap = function() {
    return coerce2;
  };
  var alaF = function() {
    return function() {
      return function() {
        return function() {
          return function(v) {
            return coerce2;
          };
        };
      };
    };
  };

  // output/Affjax.RequestHeader/index.js
  var unwrap2 = /* @__PURE__ */ unwrap();
  var Accept = /* @__PURE__ */ (function() {
    function Accept2(value0) {
      this.value0 = value0;
    }
    ;
    Accept2.create = function(value0) {
      return new Accept2(value0);
    };
    return Accept2;
  })();
  var ContentType = /* @__PURE__ */ (function() {
    function ContentType2(value0) {
      this.value0 = value0;
    }
    ;
    ContentType2.create = function(value0) {
      return new ContentType2(value0);
    };
    return ContentType2;
  })();
  var RequestHeader = /* @__PURE__ */ (function() {
    function RequestHeader2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    RequestHeader2.create = function(value0) {
      return function(value1) {
        return new RequestHeader2(value0, value1);
      };
    };
    return RequestHeader2;
  })();
  var value = function(v) {
    if (v instanceof Accept) {
      return unwrap2(v.value0);
    }
    ;
    if (v instanceof ContentType) {
      return unwrap2(v.value0);
    }
    ;
    if (v instanceof RequestHeader) {
      return v.value1;
    }
    ;
    throw new Error("Failed pattern match at Affjax.RequestHeader (line 26, column 1 - line 26, column 33): " + [v.constructor.name]);
  };
  var name = function(v) {
    if (v instanceof Accept) {
      return "Accept";
    }
    ;
    if (v instanceof ContentType) {
      return "Content-Type";
    }
    ;
    if (v instanceof RequestHeader) {
      return v.value0;
    }
    ;
    throw new Error("Failed pattern match at Affjax.RequestHeader (line 21, column 1 - line 21, column 32): " + [v.constructor.name]);
  };

  // output/Affjax.ResponseFormat/index.js
  var identity4 = /* @__PURE__ */ identity(categoryFn);
  var $$ArrayBuffer = /* @__PURE__ */ (function() {
    function $$ArrayBuffer2(value0) {
      this.value0 = value0;
    }
    ;
    $$ArrayBuffer2.create = function(value0) {
      return new $$ArrayBuffer2(value0);
    };
    return $$ArrayBuffer2;
  })();
  var Blob2 = /* @__PURE__ */ (function() {
    function Blob3(value0) {
      this.value0 = value0;
    }
    ;
    Blob3.create = function(value0) {
      return new Blob3(value0);
    };
    return Blob3;
  })();
  var Document2 = /* @__PURE__ */ (function() {
    function Document3(value0) {
      this.value0 = value0;
    }
    ;
    Document3.create = function(value0) {
      return new Document3(value0);
    };
    return Document3;
  })();
  var Json2 = /* @__PURE__ */ (function() {
    function Json3(value0) {
      this.value0 = value0;
    }
    ;
    Json3.create = function(value0) {
      return new Json3(value0);
    };
    return Json3;
  })();
  var $$String2 = /* @__PURE__ */ (function() {
    function $$String3(value0) {
      this.value0 = value0;
    }
    ;
    $$String3.create = function(value0) {
      return new $$String3(value0);
    };
    return $$String3;
  })();
  var Ignore = /* @__PURE__ */ (function() {
    function Ignore2(value0) {
      this.value0 = value0;
    }
    ;
    Ignore2.create = function(value0) {
      return new Ignore2(value0);
    };
    return Ignore2;
  })();
  var toResponseType = function(v) {
    if (v instanceof $$ArrayBuffer) {
      return "arraybuffer";
    }
    ;
    if (v instanceof Blob2) {
      return "blob";
    }
    ;
    if (v instanceof Document2) {
      return "document";
    }
    ;
    if (v instanceof Json2) {
      return "text";
    }
    ;
    if (v instanceof $$String2) {
      return "text";
    }
    ;
    if (v instanceof Ignore) {
      return "";
    }
    ;
    throw new Error("Failed pattern match at Affjax.ResponseFormat (line 44, column 3 - line 50, column 19): " + [v.constructor.name]);
  };
  var toMediaType2 = function(v) {
    if (v instanceof Json2) {
      return new Just(applicationJSON);
    }
    ;
    return Nothing.value;
  };
  var string = /* @__PURE__ */ (function() {
    return new $$String2(identity4);
  })();
  var json = /* @__PURE__ */ (function() {
    return new Json2(identity4);
  })();
  var ignore = /* @__PURE__ */ (function() {
    return new Ignore(identity4);
  })();

  // output/Affjax.ResponseHeader/index.js
  var ResponseHeader = /* @__PURE__ */ (function() {
    function ResponseHeader2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    ResponseHeader2.create = function(value0) {
      return function(value1) {
        return new ResponseHeader2(value0, value1);
      };
    };
    return ResponseHeader2;
  })();

  // output/Control.Bind/foreign.js
  var arrayBind = typeof Array.prototype.flatMap === "function" ? function(arr) {
    return function(f) {
      return arr.flatMap(f);
    };
  } : function(arr) {
    return function(f) {
      var result = [];
      var l = arr.length;
      for (var i2 = 0; i2 < l; i2++) {
        var xs = f(arr[i2]);
        var k = xs.length;
        for (var j = 0; j < k; j++) {
          result.push(xs[j]);
        }
      }
      return result;
    };
  };

  // output/Control.Bind/index.js
  var identity5 = /* @__PURE__ */ identity(categoryFn);
  var discard = function(dict) {
    return dict.discard;
  };
  var bindArray = {
    bind: arrayBind,
    Apply0: function() {
      return applyArray;
    }
  };
  var bind = function(dict) {
    return dict.bind;
  };
  var bindFlipped = function(dictBind) {
    return flip(bind(dictBind));
  };
  var composeKleisliFlipped = function(dictBind) {
    var bindFlipped12 = bindFlipped(dictBind);
    return function(f) {
      return function(g) {
        return function(a2) {
          return bindFlipped12(f)(g(a2));
        };
      };
    };
  };
  var composeKleisli = function(dictBind) {
    var bind139 = bind(dictBind);
    return function(f) {
      return function(g) {
        return function(a2) {
          return bind139(f(a2))(g);
        };
      };
    };
  };
  var discardUnit = {
    discard: function(dictBind) {
      return bind(dictBind);
    }
  };
  var join = function(dictBind) {
    var bind139 = bind(dictBind);
    return function(m) {
      return bind139(m)(identity5);
    };
  };

  // output/Data.Either/index.js
  var Left = /* @__PURE__ */ (function() {
    function Left4(value0) {
      this.value0 = value0;
    }
    ;
    Left4.create = function(value0) {
      return new Left4(value0);
    };
    return Left4;
  })();
  var Right = /* @__PURE__ */ (function() {
    function Right4(value0) {
      this.value0 = value0;
    }
    ;
    Right4.create = function(value0) {
      return new Right4(value0);
    };
    return Right4;
  })();
  var note = function(a2) {
    return maybe(new Left(a2))(Right.create);
  };
  var functorEither = {
    map: function(f) {
      return function(m) {
        if (m instanceof Left) {
          return new Left(m.value0);
        }
        ;
        if (m instanceof Right) {
          return new Right(f(m.value0));
        }
        ;
        throw new Error("Failed pattern match at Data.Either (line 0, column 0 - line 0, column 0): " + [m.constructor.name]);
      };
    }
  };
  var map3 = /* @__PURE__ */ map(functorEither);
  var either = function(v) {
    return function(v1) {
      return function(v2) {
        if (v2 instanceof Left) {
          return v(v2.value0);
        }
        ;
        if (v2 instanceof Right) {
          return v1(v2.value0);
        }
        ;
        throw new Error("Failed pattern match at Data.Either (line 208, column 1 - line 208, column 64): " + [v.constructor.name, v1.constructor.name, v2.constructor.name]);
      };
    };
  };
  var hush = /* @__PURE__ */ (function() {
    return either($$const(Nothing.value))(Just.create);
  })();
  var applyEither = {
    apply: function(v) {
      return function(v1) {
        if (v instanceof Left) {
          return new Left(v.value0);
        }
        ;
        if (v instanceof Right) {
          return map3(v.value0)(v1);
        }
        ;
        throw new Error("Failed pattern match at Data.Either (line 70, column 1 - line 72, column 30): " + [v.constructor.name, v1.constructor.name]);
      };
    },
    Functor0: function() {
      return functorEither;
    }
  };
  var applicativeEither = /* @__PURE__ */ (function() {
    return {
      pure: Right.create,
      Apply0: function() {
        return applyEither;
      }
    };
  })();

  // output/Effect/foreign.js
  var pureE = function(a2) {
    return function() {
      return a2;
    };
  };
  var bindE = function(a2) {
    return function(f) {
      return function() {
        return f(a2())();
      };
    };
  };

  // output/Control.Monad/index.js
  var unlessM = function(dictMonad) {
    var bind87 = bind(dictMonad.Bind1());
    var unless2 = unless(dictMonad.Applicative0());
    return function(mb) {
      return function(m) {
        return bind87(mb)(function(b10) {
          return unless2(b10)(m);
        });
      };
    };
  };
  var ap = function(dictMonad) {
    var bind87 = bind(dictMonad.Bind1());
    var pure91 = pure(dictMonad.Applicative0());
    return function(f) {
      return function(a2) {
        return bind87(f)(function(f$prime) {
          return bind87(a2)(function(a$prime) {
            return pure91(f$prime(a$prime));
          });
        });
      };
    };
  };

  // output/Data.EuclideanRing/foreign.js
  var intDegree = function(x47) {
    return Math.min(Math.abs(x47), 2147483647);
  };
  var intDiv = function(x47) {
    return function(y48) {
      if (y48 === 0) return 0;
      return y48 > 0 ? Math.floor(x47 / y48) : -Math.floor(x47 / -y48);
    };
  };
  var intMod = function(x47) {
    return function(y48) {
      if (y48 === 0) return 0;
      var yy = Math.abs(y48);
      return (x47 % yy + yy) % yy;
    };
  };

  // output/Data.CommutativeRing/index.js
  var commutativeRingInt = {
    Ring0: function() {
      return ringInt;
    }
  };

  // output/Data.EuclideanRing/index.js
  var mod = function(dict) {
    return dict.mod;
  };
  var euclideanRingInt = {
    degree: intDegree,
    div: intDiv,
    mod: intMod,
    CommutativeRing0: function() {
      return commutativeRingInt;
    }
  };
  var div = function(dict) {
    return dict.div;
  };

  // output/Data.Monoid/index.js
  var monoidString = {
    mempty: "",
    Semigroup0: function() {
      return semigroupString;
    }
  };
  var mempty = function(dict) {
    return dict.mempty;
  };

  // output/Effect/index.js
  var $runtime_lazy = function(name16, moduleName, init13) {
    var state3 = 0;
    var val;
    return function(lineNumber) {
      if (state3 === 2) return val;
      if (state3 === 1) throw new ReferenceError(name16 + " was needed before it finished initializing (module " + moduleName + ", line " + lineNumber + ")", moduleName, lineNumber);
      state3 = 1;
      val = init13();
      state3 = 2;
      return val;
    };
  };
  var monadEffect = {
    Applicative0: function() {
      return applicativeEffect;
    },
    Bind1: function() {
      return bindEffect;
    }
  };
  var bindEffect = {
    bind: bindE,
    Apply0: function() {
      return $lazy_applyEffect(0);
    }
  };
  var applicativeEffect = {
    pure: pureE,
    Apply0: function() {
      return $lazy_applyEffect(0);
    }
  };
  var $lazy_functorEffect = /* @__PURE__ */ $runtime_lazy("functorEffect", "Effect", function() {
    return {
      map: liftA1(applicativeEffect)
    };
  });
  var $lazy_applyEffect = /* @__PURE__ */ $runtime_lazy("applyEffect", "Effect", function() {
    return {
      apply: ap(monadEffect),
      Functor0: function() {
        return $lazy_functorEffect(0);
      }
    };
  });
  var functorEffect = /* @__PURE__ */ $lazy_functorEffect(20);
  var applyEffect = /* @__PURE__ */ $lazy_applyEffect(23);

  // output/Effect.Exception/foreign.js
  function error(msg) {
    return new Error(msg);
  }
  function message(e) {
    return e.message;
  }
  function throwException(e) {
    return function() {
      throw e;
    };
  }

  // output/Effect.Exception/index.js
  var $$throw = function($4) {
    return throwException(error($4));
  };

  // output/Control.Monad.Error.Class/index.js
  var throwError = function(dict) {
    return dict.throwError;
  };
  var catchError = function(dict) {
    return dict.catchError;
  };
  var $$try = function(dictMonadError) {
    var catchError1 = catchError(dictMonadError);
    var Monad0 = dictMonadError.MonadThrow0().Monad0();
    var map95 = map(Monad0.Bind1().Apply0().Functor0());
    var pure91 = pure(Monad0.Applicative0());
    return function(a2) {
      return catchError1(map95(Right.create)(a2))(function($52) {
        return pure91(Left.create($52));
      });
    };
  };

  // output/Data.Identity/index.js
  var Identity = function(x47) {
    return x47;
  };
  var functorIdentity = {
    map: function(f) {
      return function(m) {
        return f(m);
      };
    }
  };
  var applyIdentity = {
    apply: function(v) {
      return function(v1) {
        return v(v1);
      };
    },
    Functor0: function() {
      return functorIdentity;
    }
  };
  var bindIdentity = {
    bind: function(v) {
      return function(f) {
        return f(v);
      };
    },
    Apply0: function() {
      return applyIdentity;
    }
  };
  var applicativeIdentity = {
    pure: Identity,
    Apply0: function() {
      return applyIdentity;
    }
  };
  var monadIdentity = {
    Applicative0: function() {
      return applicativeIdentity;
    },
    Bind1: function() {
      return bindIdentity;
    }
  };

  // output/Effect.Ref/foreign.js
  var _new = function(val) {
    return function() {
      return { value: val };
    };
  };
  var read = function(ref2) {
    return function() {
      return ref2.value;
    };
  };
  var modifyImpl = function(f) {
    return function(ref2) {
      return function() {
        var t = f(ref2.value);
        ref2.value = t.state;
        return t.value;
      };
    };
  };
  var write = function(val) {
    return function(ref2) {
      return function() {
        ref2.value = val;
      };
    };
  };

  // output/Effect.Ref/index.js
  var $$void2 = /* @__PURE__ */ $$void(functorEffect);
  var $$new = _new;
  var modify$prime = modifyImpl;
  var modify = function(f) {
    return modify$prime(function(s) {
      var s$prime = f(s);
      return {
        state: s$prime,
        value: s$prime
      };
    });
  };
  var modify_ = function(f) {
    return function(s) {
      return $$void2(modify(f)(s));
    };
  };

  // output/Control.Monad.Rec.Class/index.js
  var bindFlipped2 = /* @__PURE__ */ bindFlipped(bindEffect);
  var map4 = /* @__PURE__ */ map(functorEffect);
  var Loop = /* @__PURE__ */ (function() {
    function Loop2(value0) {
      this.value0 = value0;
    }
    ;
    Loop2.create = function(value0) {
      return new Loop2(value0);
    };
    return Loop2;
  })();
  var Done = /* @__PURE__ */ (function() {
    function Done2(value0) {
      this.value0 = value0;
    }
    ;
    Done2.create = function(value0) {
      return new Done2(value0);
    };
    return Done2;
  })();
  var tailRecM = function(dict) {
    return dict.tailRecM;
  };
  var monadRecEffect = {
    tailRecM: function(f) {
      return function(a2) {
        var fromDone = function(v) {
          if (v instanceof Done) {
            return v.value0;
          }
          ;
          throw new Error("Failed pattern match at Control.Monad.Rec.Class (line 137, column 30 - line 137, column 44): " + [v.constructor.name]);
        };
        return function __do3() {
          var r = bindFlipped2($$new)(f(a2))();
          (function() {
            while (!(function __do4() {
              var v = read(r)();
              if (v instanceof Loop) {
                var e = f(v.value0)();
                write(e)(r)();
                return false;
              }
              ;
              if (v instanceof Done) {
                return true;
              }
              ;
              throw new Error("Failed pattern match at Control.Monad.Rec.Class (line 128, column 22 - line 133, column 28): " + [v.constructor.name]);
            })()) {
            }
            ;
            return {};
          })();
          return map4(fromDone)(read(r))();
        };
      };
    },
    Monad0: function() {
      return monadEffect;
    }
  };
  var forever = function(dictMonadRec) {
    var tailRecM1 = tailRecM(dictMonadRec);
    var voidRight4 = voidRight(dictMonadRec.Monad0().Bind1().Apply0().Functor0());
    return function(ma) {
      return tailRecM1(function(u2) {
        return voidRight4(new Loop(u2))(ma);
      })(unit);
    };
  };

  // output/Control.Monad.ST.Internal/foreign.js
  var map_ = function(f) {
    return function(a2) {
      return function() {
        return f(a2());
      };
    };
  };
  var pure_ = function(a2) {
    return function() {
      return a2;
    };
  };
  var bind_ = function(a2) {
    return function(f) {
      return function() {
        return f(a2())();
      };
    };
  };
  var foreach = function(as) {
    return function(f) {
      return function() {
        for (var i2 = 0, l = as.length; i2 < l; i2++) {
          f(as[i2])();
        }
      };
    };
  };
  function newSTRef(val) {
    return function() {
      return { value: val };
    };
  }
  var read2 = function(ref2) {
    return function() {
      return ref2.value;
    };
  };
  var modifyImpl2 = function(f) {
    return function(ref2) {
      return function() {
        var t = f(ref2.value);
        ref2.value = t.state;
        return t.value;
      };
    };
  };
  var write2 = function(a2) {
    return function(ref2) {
      return function() {
        return ref2.value = a2;
      };
    };
  };

  // output/Control.Monad.ST.Internal/index.js
  var $runtime_lazy2 = function(name16, moduleName, init13) {
    var state3 = 0;
    var val;
    return function(lineNumber) {
      if (state3 === 2) return val;
      if (state3 === 1) throw new ReferenceError(name16 + " was needed before it finished initializing (module " + moduleName + ", line " + lineNumber + ")", moduleName, lineNumber);
      state3 = 1;
      val = init13();
      state3 = 2;
      return val;
    };
  };
  var modify$prime2 = modifyImpl2;
  var modify2 = function(f) {
    return modify$prime2(function(s) {
      var s$prime = f(s);
      return {
        state: s$prime,
        value: s$prime
      };
    });
  };
  var functorST = {
    map: map_
  };
  var monadST = {
    Applicative0: function() {
      return applicativeST;
    },
    Bind1: function() {
      return bindST;
    }
  };
  var bindST = {
    bind: bind_,
    Apply0: function() {
      return $lazy_applyST(0);
    }
  };
  var applicativeST = {
    pure: pure_,
    Apply0: function() {
      return $lazy_applyST(0);
    }
  };
  var $lazy_applyST = /* @__PURE__ */ $runtime_lazy2("applyST", "Control.Monad.ST.Internal", function() {
    return {
      apply: ap(monadST),
      Functor0: function() {
        return functorST;
      }
    };
  });

  // output/Data.HeytingAlgebra/foreign.js
  var boolConj = function(b12) {
    return function(b22) {
      return b12 && b22;
    };
  };
  var boolDisj = function(b12) {
    return function(b22) {
      return b12 || b22;
    };
  };
  var boolNot = function(b10) {
    return !b10;
  };

  // output/Data.HeytingAlgebra/index.js
  var tt = function(dict) {
    return dict.tt;
  };
  var not = function(dict) {
    return dict.not;
  };
  var implies = function(dict) {
    return dict.implies;
  };
  var ff = function(dict) {
    return dict.ff;
  };
  var disj = function(dict) {
    return dict.disj;
  };
  var heytingAlgebraBoolean = {
    ff: false,
    tt: true,
    implies: function(a2) {
      return function(b10) {
        return disj(heytingAlgebraBoolean)(not(heytingAlgebraBoolean)(a2))(b10);
      };
    },
    conj: boolConj,
    disj: boolDisj,
    not: boolNot
  };
  var conj = function(dict) {
    return dict.conj;
  };
  var heytingAlgebraFunction = function(dictHeytingAlgebra) {
    var ff1 = ff(dictHeytingAlgebra);
    var tt1 = tt(dictHeytingAlgebra);
    var implies1 = implies(dictHeytingAlgebra);
    var conj1 = conj(dictHeytingAlgebra);
    var disj1 = disj(dictHeytingAlgebra);
    var not1 = not(dictHeytingAlgebra);
    return {
      ff: function(v) {
        return ff1;
      },
      tt: function(v) {
        return tt1;
      },
      implies: function(f) {
        return function(g) {
          return function(a2) {
            return implies1(f(a2))(g(a2));
          };
        };
      },
      conj: function(f) {
        return function(g) {
          return function(a2) {
            return conj1(f(a2))(g(a2));
          };
        };
      },
      disj: function(f) {
        return function(g) {
          return function(a2) {
            return disj1(f(a2))(g(a2));
          };
        };
      },
      not: function(f) {
        return function(a2) {
          return not1(f(a2));
        };
      }
    };
  };

  // output/Data.Tuple/index.js
  var Tuple = /* @__PURE__ */ (function() {
    function Tuple2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Tuple2.create = function(value0) {
      return function(value1) {
        return new Tuple2(value0, value1);
      };
    };
    return Tuple2;
  })();
  var snd = function(v) {
    return v.value1;
  };
  var functorTuple = {
    map: function(f) {
      return function(m) {
        return new Tuple(m.value0, f(m.value1));
      };
    }
  };
  var fst = function(v) {
    return v.value0;
  };
  var eqTuple = function(dictEq) {
    var eq20 = eq(dictEq);
    return function(dictEq1) {
      var eq110 = eq(dictEq1);
      return {
        eq: function(x47) {
          return function(y48) {
            return eq20(x47.value0)(y48.value0) && eq110(x47.value1)(y48.value1);
          };
        }
      };
    };
  };
  var ordTuple = function(dictOrd) {
    var compare26 = compare(dictOrd);
    var eqTuple1 = eqTuple(dictOrd.Eq0());
    return function(dictOrd1) {
      var compare114 = compare(dictOrd1);
      var eqTuple2 = eqTuple1(dictOrd1.Eq0());
      return {
        compare: function(x47) {
          return function(y48) {
            var v = compare26(x47.value0)(y48.value0);
            if (v instanceof LT) {
              return LT.value;
            }
            ;
            if (v instanceof GT) {
              return GT.value;
            }
            ;
            return compare114(x47.value1)(y48.value1);
          };
        },
        Eq0: function() {
          return eqTuple2;
        }
      };
    };
  };

  // output/Control.Monad.State.Class/index.js
  var state = function(dict) {
    return dict.state;
  };
  var put = function(dictMonadState) {
    var state1 = state(dictMonadState);
    return function(s) {
      return state1(function(v) {
        return new Tuple(unit, s);
      });
    };
  };
  var modify_2 = function(dictMonadState) {
    var state1 = state(dictMonadState);
    return function(f) {
      return state1(function(s) {
        return new Tuple(unit, f(s));
      });
    };
  };
  var modify3 = function(dictMonadState) {
    var state1 = state(dictMonadState);
    return function(f) {
      return state1(function(s) {
        var s$prime = f(s);
        return new Tuple(s$prime, s$prime);
      });
    };
  };
  var gets = function(dictMonadState) {
    var state1 = state(dictMonadState);
    return function(f) {
      return state1(function(s) {
        return new Tuple(f(s), s);
      });
    };
  };
  var get = function(dictMonadState) {
    return state(dictMonadState)(function(s) {
      return new Tuple(s, s);
    });
  };

  // output/Control.Monad.Trans.Class/index.js
  var lift = function(dict) {
    return dict.lift;
  };

  // output/Control.Monad.Writer.Class/index.js
  var tell = function(dict) {
    return dict.tell;
  };

  // output/Effect.Class/index.js
  var monadEffectEffect = {
    liftEffect: /* @__PURE__ */ identity(categoryFn),
    Monad0: function() {
      return monadEffect;
    }
  };
  var liftEffect = function(dict) {
    return dict.liftEffect;
  };

  // output/Control.Monad.Except.Trans/index.js
  var map5 = /* @__PURE__ */ map(functorEither);
  var ExceptT = function(x47) {
    return x47;
  };
  var runExceptT = function(v) {
    return v;
  };
  var mapExceptT = function(f) {
    return function(v) {
      return f(v);
    };
  };
  var functorExceptT = function(dictFunctor) {
    var map124 = map(dictFunctor);
    return {
      map: function(f) {
        return mapExceptT(map124(map5(f)));
      }
    };
  };
  var monadExceptT = function(dictMonad) {
    return {
      Applicative0: function() {
        return applicativeExceptT(dictMonad);
      },
      Bind1: function() {
        return bindExceptT(dictMonad);
      }
    };
  };
  var bindExceptT = function(dictMonad) {
    var bind87 = bind(dictMonad.Bind1());
    var pure91 = pure(dictMonad.Applicative0());
    return {
      bind: function(v) {
        return function(k) {
          return bind87(v)(either(function($193) {
            return pure91(Left.create($193));
          })(function(a2) {
            var v1 = k(a2);
            return v1;
          }));
        };
      },
      Apply0: function() {
        return applyExceptT(dictMonad);
      }
    };
  };
  var applyExceptT = function(dictMonad) {
    var functorExceptT1 = functorExceptT(dictMonad.Bind1().Apply0().Functor0());
    return {
      apply: ap(monadExceptT(dictMonad)),
      Functor0: function() {
        return functorExceptT1;
      }
    };
  };
  var applicativeExceptT = function(dictMonad) {
    return {
      pure: (function() {
        var $194 = pure(dictMonad.Applicative0());
        return function($195) {
          return ExceptT($194(Right.create($195)));
        };
      })(),
      Apply0: function() {
        return applyExceptT(dictMonad);
      }
    };
  };
  var monadThrowExceptT = function(dictMonad) {
    var monadExceptT1 = monadExceptT(dictMonad);
    return {
      throwError: (function() {
        var $204 = pure(dictMonad.Applicative0());
        return function($205) {
          return ExceptT($204(Left.create($205)));
        };
      })(),
      Monad0: function() {
        return monadExceptT1;
      }
    };
  };
  var altExceptT = function(dictSemigroup) {
    var append34 = append(dictSemigroup);
    return function(dictMonad) {
      var Bind1 = dictMonad.Bind1();
      var bind87 = bind(Bind1);
      var pure91 = pure(dictMonad.Applicative0());
      var functorExceptT1 = functorExceptT(Bind1.Apply0().Functor0());
      return {
        alt: function(v) {
          return function(v1) {
            return bind87(v)(function(rm) {
              if (rm instanceof Right) {
                return pure91(new Right(rm.value0));
              }
              ;
              if (rm instanceof Left) {
                return bind87(v1)(function(rn) {
                  if (rn instanceof Right) {
                    return pure91(new Right(rn.value0));
                  }
                  ;
                  if (rn instanceof Left) {
                    return pure91(new Left(append34(rm.value0)(rn.value0)));
                  }
                  ;
                  throw new Error("Failed pattern match at Control.Monad.Except.Trans (line 87, column 9 - line 89, column 49): " + [rn.constructor.name]);
                });
              }
              ;
              throw new Error("Failed pattern match at Control.Monad.Except.Trans (line 83, column 5 - line 89, column 49): " + [rm.constructor.name]);
            });
          };
        },
        Functor0: function() {
          return functorExceptT1;
        }
      };
    };
  };

  // output/Control.Monad.Except/index.js
  var unwrap3 = /* @__PURE__ */ unwrap();
  var runExcept = function($3) {
    return unwrap3(runExceptT($3));
  };

  // output/Data.Argonaut.Core/foreign.js
  function id(x47) {
    return x47;
  }
  function stringify(j) {
    return JSON.stringify(j);
  }

  // output/Foreign.Object/foreign.js
  var empty = {};
  function _lookup(no, yes, k, m) {
    return k in m ? yes(m[k]) : no;
  }
  function toArrayWithKey(f) {
    return function(m) {
      var r = [];
      for (var k in m) {
        if (hasOwnProperty.call(m, k)) {
          r.push(f(k)(m[k]));
        }
      }
      return r;
    };
  }
  var keys = Object.keys || toArrayWithKey(function(k) {
    return function() {
      return k;
    };
  });

  // output/Data.Array/foreign.js
  var rangeImpl = function(start13, end2) {
    var step4 = start13 > end2 ? -1 : 1;
    var result = new Array(step4 * (end2 - start13) + 1);
    var i2 = start13, n = 0;
    while (i2 !== end2) {
      result[n++] = i2;
      i2 += step4;
    }
    result[n] = i2;
    return result;
  };
  var replicateFill = function(count, value18) {
    if (count < 1) {
      return [];
    }
    var result = new Array(count);
    return result.fill(value18);
  };
  var replicatePolyfill = function(count, value18) {
    var result = [];
    var n = 0;
    for (var i2 = 0; i2 < count; i2++) {
      result[n++] = value18;
    }
    return result;
  };
  var replicateImpl = typeof Array.prototype.fill === "function" ? replicateFill : replicatePolyfill;
  var fromFoldableImpl = /* @__PURE__ */ (function() {
    function Cons2(head6, tail2) {
      this.head = head6;
      this.tail = tail2;
    }
    var emptyList = {};
    function curryCons(head6) {
      return function(tail2) {
        return new Cons2(head6, tail2);
      };
    }
    function listToArray(list) {
      var result = [];
      var count = 0;
      var xs = list;
      while (xs !== emptyList) {
        result[count++] = xs.head;
        xs = xs.tail;
      }
      return result;
    }
    return function(foldr7, xs) {
      return listToArray(foldr7(curryCons)(emptyList)(xs));
    };
  })();
  var length = function(xs) {
    return xs.length;
  };
  var unconsImpl = function(empty9, next2, xs) {
    return xs.length === 0 ? empty9({}) : next2(xs[0])(xs.slice(1));
  };
  var indexImpl = function(just, nothing, xs, i2) {
    return i2 < 0 || i2 >= xs.length ? nothing : just(xs[i2]);
  };
  var findMapImpl = function(nothing, isJust2, f, xs) {
    for (var i2 = 0; i2 < xs.length; i2++) {
      var result = f(xs[i2]);
      if (isJust2(result)) return result;
    }
    return nothing;
  };
  var findIndexImpl = function(just, nothing, f, xs) {
    for (var i2 = 0, l = xs.length; i2 < l; i2++) {
      if (f(xs[i2])) return just(i2);
    }
    return nothing;
  };
  var _insertAt = function(just, nothing, i2, a2, l) {
    if (i2 < 0 || i2 > l.length) return nothing;
    var l1 = l.slice();
    l1.splice(i2, 0, a2);
    return just(l1);
  };
  var _deleteAt = function(just, nothing, i2, l) {
    if (i2 < 0 || i2 >= l.length) return nothing;
    var l1 = l.slice();
    l1.splice(i2, 1);
    return just(l1);
  };
  var _updateAt = function(just, nothing, i2, a2, l) {
    if (i2 < 0 || i2 >= l.length) return nothing;
    var l1 = l.slice();
    l1[i2] = a2;
    return just(l1);
  };
  var reverse = function(l) {
    return l.slice().reverse();
  };
  var concat = function(xss) {
    if (xss.length <= 1e4) {
      return Array.prototype.concat.apply([], xss);
    }
    var result = [];
    for (var i2 = 0, l = xss.length; i2 < l; i2++) {
      var xs = xss[i2];
      for (var j = 0, m = xs.length; j < m; j++) {
        result.push(xs[j]);
      }
    }
    return result;
  };
  var filterImpl = function(f, xs) {
    return xs.filter(f);
  };
  var partitionImpl = function(f, xs) {
    var yes = [];
    var no = [];
    for (var i2 = 0; i2 < xs.length; i2++) {
      var x47 = xs[i2];
      if (f(x47))
        yes.push(x47);
      else
        no.push(x47);
    }
    return { yes, no };
  };
  var sortByImpl = /* @__PURE__ */ (function() {
    function mergeFromTo(compare26, fromOrdering, xs1, xs2, from3, to2) {
      var mid;
      var i2;
      var j;
      var k;
      var x47;
      var y48;
      var c;
      mid = from3 + (to2 - from3 >> 1);
      if (mid - from3 > 1) mergeFromTo(compare26, fromOrdering, xs2, xs1, from3, mid);
      if (to2 - mid > 1) mergeFromTo(compare26, fromOrdering, xs2, xs1, mid, to2);
      i2 = from3;
      j = mid;
      k = from3;
      while (i2 < mid && j < to2) {
        x47 = xs2[i2];
        y48 = xs2[j];
        c = fromOrdering(compare26(x47)(y48));
        if (c > 0) {
          xs1[k++] = y48;
          ++j;
        } else {
          xs1[k++] = x47;
          ++i2;
        }
      }
      while (i2 < mid) {
        xs1[k++] = xs2[i2++];
      }
      while (j < to2) {
        xs1[k++] = xs2[j++];
      }
    }
    return function(compare26, fromOrdering, xs) {
      var out;
      if (xs.length < 2) return xs;
      out = xs.slice(0);
      mergeFromTo(compare26, fromOrdering, out, xs.slice(0), 0, xs.length);
      return out;
    };
  })();
  var sliceImpl = function(s, e, l) {
    return l.slice(s, e);
  };
  var zipWithImpl = function(f, xs, ys) {
    var l = xs.length < ys.length ? xs.length : ys.length;
    var result = new Array(l);
    for (var i2 = 0; i2 < l; i2++) {
      result[i2] = f(xs[i2])(ys[i2]);
    }
    return result;
  };
  var anyImpl = function(p2, xs) {
    var len = xs.length;
    for (var i2 = 0; i2 < len; i2++) {
      if (p2(xs[i2])) return true;
    }
    return false;
  };
  var allImpl = function(p2, xs) {
    var len = xs.length;
    for (var i2 = 0; i2 < len; i2++) {
      if (!p2(xs[i2])) return false;
    }
    return true;
  };
  var unsafeIndexImpl = function(xs, n) {
    return xs[n];
  };

  // output/Data.Array.ST/foreign.js
  function newSTArray() {
    return [];
  }
  function unsafeFreezeThawImpl(xs) {
    return xs;
  }
  var unsafeFreezeImpl = unsafeFreezeThawImpl;
  var unsafeThawImpl = unsafeFreezeThawImpl;
  function copyImpl(xs) {
    return xs.slice();
  }
  var thawImpl = copyImpl;
  var pushImpl = function(a2, xs) {
    return xs.push(a2);
  };

  // output/Control.Monad.ST.Uncurried/foreign.js
  var runSTFn1 = function runSTFn12(fn) {
    return function(a2) {
      return function() {
        return fn(a2);
      };
    };
  };
  var runSTFn2 = function runSTFn22(fn) {
    return function(a2) {
      return function(b10) {
        return function() {
          return fn(a2, b10);
        };
      };
    };
  };

  // output/Data.Array.ST/index.js
  var unsafeThaw = /* @__PURE__ */ runSTFn1(unsafeThawImpl);
  var unsafeFreeze = /* @__PURE__ */ runSTFn1(unsafeFreezeImpl);
  var thaw = /* @__PURE__ */ runSTFn1(thawImpl);
  var withArray = function(f) {
    return function(xs) {
      return function __do3() {
        var result = thaw(xs)();
        f(result)();
        return unsafeFreeze(result)();
      };
    };
  };
  var push = /* @__PURE__ */ runSTFn2(pushImpl);

  // output/Data.Array.ST.Iterator/index.js
  var map6 = /* @__PURE__ */ map(functorST);
  var not2 = /* @__PURE__ */ not(heytingAlgebraBoolean);
  var $$void3 = /* @__PURE__ */ $$void(functorST);
  var Iterator = /* @__PURE__ */ (function() {
    function Iterator2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Iterator2.create = function(value0) {
      return function(value1) {
        return new Iterator2(value0, value1);
      };
    };
    return Iterator2;
  })();
  var peek = function(v) {
    return function __do3() {
      var i2 = read2(v.value1)();
      return v.value0(i2);
    };
  };
  var next = function(v) {
    return function __do3() {
      var i2 = read2(v.value1)();
      modify2(function(v1) {
        return v1 + 1 | 0;
      })(v.value1)();
      return v.value0(i2);
    };
  };
  var pushWhile = function(p2) {
    return function(iter) {
      return function(array2) {
        return function __do3() {
          var $$break = newSTRef(false)();
          while (map6(not2)(read2($$break))()) {
            (function __do4() {
              var mx = peek(iter)();
              if (mx instanceof Just && p2(mx.value0)) {
                push(mx.value0)(array2)();
                return $$void3(next(iter))();
              }
              ;
              return $$void3(write2(true)($$break))();
            })();
          }
          ;
          return {};
        };
      };
    };
  };
  var iterator = function(f) {
    return map6(Iterator.create(f))(newSTRef(0));
  };
  var iterate = function(iter) {
    return function(f) {
      return function __do3() {
        var $$break = newSTRef(false)();
        while (map6(not2)(read2($$break))()) {
          (function __do4() {
            var mx = next(iter)();
            if (mx instanceof Just) {
              return f(mx.value0)();
            }
            ;
            if (mx instanceof Nothing) {
              return $$void3(write2(true)($$break))();
            }
            ;
            throw new Error("Failed pattern match at Data.Array.ST.Iterator (line 42, column 5 - line 44, column 47): " + [mx.constructor.name]);
          })();
        }
        ;
        return {};
      };
    };
  };

  // output/Data.Foldable/foreign.js
  var foldrArray = function(f) {
    return function(init13) {
      return function(xs) {
        var acc = init13;
        var len = xs.length;
        for (var i2 = len - 1; i2 >= 0; i2--) {
          acc = f(xs[i2])(acc);
        }
        return acc;
      };
    };
  };
  var foldlArray = function(f) {
    return function(init13) {
      return function(xs) {
        var acc = init13;
        var len = xs.length;
        for (var i2 = 0; i2 < len; i2++) {
          acc = f(acc)(xs[i2]);
        }
        return acc;
      };
    };
  };

  // output/Control.Plus/index.js
  var empty2 = function(dict) {
    return dict.empty;
  };

  // output/Data.Bifunctor/index.js
  var identity6 = /* @__PURE__ */ identity(categoryFn);
  var bimap = function(dict) {
    return dict.bimap;
  };
  var lmap = function(dictBifunctor) {
    var bimap1 = bimap(dictBifunctor);
    return function(f) {
      return bimap1(f)(identity6);
    };
  };
  var rmap = function(dictBifunctor) {
    return bimap(dictBifunctor)(identity6);
  };
  var bifunctorTuple = {
    bimap: function(f) {
      return function(g) {
        return function(v) {
          return new Tuple(f(v.value0), g(v.value1));
        };
      };
    }
  };

  // output/Data.Monoid.Disj/index.js
  var Disj = function(x47) {
    return x47;
  };
  var semigroupDisj = function(dictHeytingAlgebra) {
    var disj2 = disj(dictHeytingAlgebra);
    return {
      append: function(v) {
        return function(v1) {
          return disj2(v)(v1);
        };
      }
    };
  };
  var monoidDisj = function(dictHeytingAlgebra) {
    var semigroupDisj1 = semigroupDisj(dictHeytingAlgebra);
    return {
      mempty: ff(dictHeytingAlgebra),
      Semigroup0: function() {
        return semigroupDisj1;
      }
    };
  };

  // output/Data.Foldable/index.js
  var eq12 = /* @__PURE__ */ eq(eqOrdering);
  var alaF2 = /* @__PURE__ */ alaF()()()();
  var foldr = function(dict) {
    return dict.foldr;
  };
  var traverse_ = function(dictApplicative) {
    var applySecond5 = applySecond(dictApplicative.Apply0());
    var pure91 = pure(dictApplicative);
    return function(dictFoldable) {
      var foldr22 = foldr(dictFoldable);
      return function(f) {
        return foldr22(function($454) {
          return applySecond5(f($454));
        })(pure91(unit));
      };
    };
  };
  var for_ = function(dictApplicative) {
    var traverse_15 = traverse_(dictApplicative);
    return function(dictFoldable) {
      return flip(traverse_15(dictFoldable));
    };
  };
  var foldl = function(dict) {
    return dict.foldl;
  };
  var indexl = function(dictFoldable) {
    var foldl22 = foldl(dictFoldable);
    return function(idx) {
      var go2 = function(cursor) {
        return function(a2) {
          if (cursor.elem instanceof Just) {
            return cursor;
          }
          ;
          var $296 = cursor.pos === idx;
          if ($296) {
            return {
              elem: new Just(a2),
              pos: cursor.pos
            };
          }
          ;
          return {
            pos: cursor.pos + 1 | 0,
            elem: cursor.elem
          };
        };
      };
      var $455 = foldl22(go2)({
        elem: Nothing.value,
        pos: 0
      });
      return function($456) {
        return (function(v) {
          return v.elem;
        })($455($456));
      };
    };
  };
  var intercalate = function(dictFoldable) {
    var foldl22 = foldl(dictFoldable);
    return function(dictMonoid) {
      var append34 = append(dictMonoid.Semigroup0());
      var mempty3 = mempty(dictMonoid);
      return function(sep) {
        return function(xs) {
          var go2 = function(v) {
            return function(v1) {
              if (v.init) {
                return {
                  init: false,
                  acc: v1
                };
              }
              ;
              return {
                init: false,
                acc: append34(v.acc)(append34(sep)(v1))
              };
            };
          };
          return foldl22(go2)({
            init: true,
            acc: mempty3
          })(xs).acc;
        };
      };
    };
  };
  var maximumBy = function(dictFoldable) {
    var foldl22 = foldl(dictFoldable);
    return function(cmp) {
      var max$prime = function(v) {
        return function(v1) {
          if (v instanceof Nothing) {
            return new Just(v1);
          }
          ;
          if (v instanceof Just) {
            return new Just((function() {
              var $303 = eq12(cmp(v.value0)(v1))(GT.value);
              if ($303) {
                return v.value0;
              }
              ;
              return v1;
            })());
          }
          ;
          throw new Error("Failed pattern match at Data.Foldable (line 441, column 3 - line 441, column 27): " + [v.constructor.name, v1.constructor.name]);
        };
      };
      return foldl22(max$prime)(Nothing.value);
    };
  };
  var maximum = function(dictOrd) {
    var compare26 = compare(dictOrd);
    return function(dictFoldable) {
      return maximumBy(dictFoldable)(compare26);
    };
  };
  var minimumBy = function(dictFoldable) {
    var foldl22 = foldl(dictFoldable);
    return function(cmp) {
      var min$prime = function(v) {
        return function(v1) {
          if (v instanceof Nothing) {
            return new Just(v1);
          }
          ;
          if (v instanceof Just) {
            return new Just((function() {
              var $307 = eq12(cmp(v.value0)(v1))(LT.value);
              if ($307) {
                return v.value0;
              }
              ;
              return v1;
            })());
          }
          ;
          throw new Error("Failed pattern match at Data.Foldable (line 454, column 3 - line 454, column 27): " + [v.constructor.name, v1.constructor.name]);
        };
      };
      return foldl22(min$prime)(Nothing.value);
    };
  };
  var minimum = function(dictOrd) {
    var compare26 = compare(dictOrd);
    return function(dictFoldable) {
      return minimumBy(dictFoldable)(compare26);
    };
  };
  var sum = function(dictFoldable) {
    var foldl22 = foldl(dictFoldable);
    return function(dictSemiring) {
      return foldl22(add(dictSemiring))(zero(dictSemiring));
    };
  };
  var foldableMaybe = {
    foldr: function(v) {
      return function(v1) {
        return function(v2) {
          if (v2 instanceof Nothing) {
            return v1;
          }
          ;
          if (v2 instanceof Just) {
            return v(v2.value0)(v1);
          }
          ;
          throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): " + [v.constructor.name, v1.constructor.name, v2.constructor.name]);
        };
      };
    },
    foldl: function(v) {
      return function(v1) {
        return function(v2) {
          if (v2 instanceof Nothing) {
            return v1;
          }
          ;
          if (v2 instanceof Just) {
            return v(v1)(v2.value0);
          }
          ;
          throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): " + [v.constructor.name, v1.constructor.name, v2.constructor.name]);
        };
      };
    },
    foldMap: function(dictMonoid) {
      var mempty3 = mempty(dictMonoid);
      return function(v) {
        return function(v1) {
          if (v1 instanceof Nothing) {
            return mempty3;
          }
          ;
          if (v1 instanceof Just) {
            return v(v1.value0);
          }
          ;
          throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): " + [v.constructor.name, v1.constructor.name]);
        };
      };
    }
  };
  var foldableEither = {
    foldr: function(v) {
      return function(v1) {
        return function(v2) {
          if (v2 instanceof Left) {
            return v1;
          }
          ;
          if (v2 instanceof Right) {
            return v(v2.value0)(v1);
          }
          ;
          throw new Error("Failed pattern match at Data.Foldable (line 181, column 1 - line 187, column 28): " + [v.constructor.name, v1.constructor.name, v2.constructor.name]);
        };
      };
    },
    foldl: function(v) {
      return function(v1) {
        return function(v2) {
          if (v2 instanceof Left) {
            return v1;
          }
          ;
          if (v2 instanceof Right) {
            return v(v1)(v2.value0);
          }
          ;
          throw new Error("Failed pattern match at Data.Foldable (line 181, column 1 - line 187, column 28): " + [v.constructor.name, v1.constructor.name, v2.constructor.name]);
        };
      };
    },
    foldMap: function(dictMonoid) {
      var mempty3 = mempty(dictMonoid);
      return function(v) {
        return function(v1) {
          if (v1 instanceof Left) {
            return mempty3;
          }
          ;
          if (v1 instanceof Right) {
            return v(v1.value0);
          }
          ;
          throw new Error("Failed pattern match at Data.Foldable (line 181, column 1 - line 187, column 28): " + [v.constructor.name, v1.constructor.name]);
        };
      };
    }
  };
  var foldMapDefaultR = function(dictFoldable) {
    var foldr22 = foldr(dictFoldable);
    return function(dictMonoid) {
      var append34 = append(dictMonoid.Semigroup0());
      var mempty3 = mempty(dictMonoid);
      return function(f) {
        return foldr22(function(x47) {
          return function(acc) {
            return append34(f(x47))(acc);
          };
        })(mempty3);
      };
    };
  };
  var foldableArray = {
    foldr: foldrArray,
    foldl: foldlArray,
    foldMap: function(dictMonoid) {
      return foldMapDefaultR(foldableArray)(dictMonoid);
    }
  };
  var foldMap = function(dict) {
    return dict.foldMap;
  };
  var any = function(dictFoldable) {
    var foldMap22 = foldMap(dictFoldable);
    return function(dictHeytingAlgebra) {
      return alaF2(Disj)(foldMap22(monoidDisj(dictHeytingAlgebra)));
    };
  };

  // output/Data.Function.Uncurried/foreign.js
  var mkFn2 = function(fn) {
    return function(a2, b10) {
      return fn(a2)(b10);
    };
  };
  var runFn2 = function(fn) {
    return function(a2) {
      return function(b10) {
        return fn(a2, b10);
      };
    };
  };
  var runFn3 = function(fn) {
    return function(a2) {
      return function(b10) {
        return function(c) {
          return fn(a2, b10, c);
        };
      };
    };
  };
  var runFn4 = function(fn) {
    return function(a2) {
      return function(b10) {
        return function(c) {
          return function(d18) {
            return fn(a2, b10, c, d18);
          };
        };
      };
    };
  };
  var runFn5 = function(fn) {
    return function(a2) {
      return function(b10) {
        return function(c) {
          return function(d18) {
            return function(e) {
              return fn(a2, b10, c, d18, e);
            };
          };
        };
      };
    };
  };

  // output/Data.FunctorWithIndex/foreign.js
  var mapWithIndexArray = function(f) {
    return function(xs) {
      var l = xs.length;
      var result = Array(l);
      for (var i2 = 0; i2 < l; i2++) {
        result[i2] = f(i2)(xs[i2]);
      }
      return result;
    };
  };

  // output/Data.FunctorWithIndex/index.js
  var mapWithIndex = function(dict) {
    return dict.mapWithIndex;
  };
  var functorWithIndexArray = {
    mapWithIndex: mapWithIndexArray,
    Functor0: function() {
      return functorArray;
    }
  };

  // output/Data.Traversable/foreign.js
  var traverseArrayImpl = /* @__PURE__ */ (function() {
    function array1(a2) {
      return [a2];
    }
    function array2(a2) {
      return function(b10) {
        return [a2, b10];
      };
    }
    function array3(a2) {
      return function(b10) {
        return function(c) {
          return [a2, b10, c];
        };
      };
    }
    function concat2(xs) {
      return function(ys) {
        return xs.concat(ys);
      };
    }
    return function(apply8) {
      return function(map95) {
        return function(pure91) {
          return function(f) {
            return function(array4) {
              function go2(bot, top3) {
                switch (top3 - bot) {
                  case 0:
                    return pure91([]);
                  case 1:
                    return map95(array1)(f(array4[bot]));
                  case 2:
                    return apply8(map95(array2)(f(array4[bot])))(f(array4[bot + 1]));
                  case 3:
                    return apply8(apply8(map95(array3)(f(array4[bot])))(f(array4[bot + 1])))(f(array4[bot + 2]));
                  default:
                    var pivot = bot + Math.floor((top3 - bot) / 4) * 2;
                    return apply8(map95(concat2)(go2(bot, pivot)))(go2(pivot, top3));
                }
              }
              return go2(0, array4.length);
            };
          };
        };
      };
    };
  })();

  // output/Data.Traversable.Accum.Internal/index.js
  var stateL = function(v) {
    return v;
  };
  var functorStateL = {
    map: function(f) {
      return function(k) {
        return function(s) {
          var v = stateL(k)(s);
          return {
            accum: v.accum,
            value: f(v.value)
          };
        };
      };
    }
  };
  var applyStateL = {
    apply: function(f) {
      return function(x47) {
        return function(s) {
          var v = stateL(f)(s);
          var v1 = stateL(x47)(v.accum);
          return {
            accum: v1.accum,
            value: v.value(v1.value)
          };
        };
      };
    },
    Functor0: function() {
      return functorStateL;
    }
  };
  var applicativeStateL = {
    pure: function(a2) {
      return function(s) {
        return {
          accum: s,
          value: a2
        };
      };
    },
    Apply0: function() {
      return applyStateL;
    }
  };

  // output/Data.Traversable/index.js
  var identity7 = /* @__PURE__ */ identity(categoryFn);
  var traverse = function(dict) {
    return dict.traverse;
  };
  var sequenceDefault = function(dictTraversable) {
    var traverse22 = traverse(dictTraversable);
    return function(dictApplicative) {
      return traverse22(dictApplicative)(identity7);
    };
  };
  var traversableArray = {
    traverse: function(dictApplicative) {
      var Apply0 = dictApplicative.Apply0();
      return traverseArrayImpl(apply(Apply0))(map(Apply0.Functor0()))(pure(dictApplicative));
    },
    sequence: function(dictApplicative) {
      return sequenceDefault(traversableArray)(dictApplicative);
    },
    Functor0: function() {
      return functorArray;
    },
    Foldable1: function() {
      return foldableArray;
    }
  };
  var sequence = function(dict) {
    return dict.sequence;
  };
  var mapAccumL = function(dictTraversable) {
    var traverse22 = traverse(dictTraversable)(applicativeStateL);
    return function(f) {
      return function(s0) {
        return function(xs) {
          return stateL(traverse22(function(a2) {
            return function(s) {
              return f(s)(a2);
            };
          })(xs))(s0);
        };
      };
    };
  };
  var scanl = function(dictTraversable) {
    var mapAccumL1 = mapAccumL(dictTraversable);
    return function(f) {
      return function(b02) {
        return function(xs) {
          return mapAccumL1(function(b10) {
            return function(a2) {
              var b$prime = f(b10)(a2);
              return {
                accum: b$prime,
                value: b$prime
              };
            };
          })(b02)(xs).value;
        };
      };
    };
  };

  // output/Data.Unfoldable/foreign.js
  var unfoldrArrayImpl = function(isNothing2) {
    return function(fromJust7) {
      return function(fst2) {
        return function(snd2) {
          return function(f) {
            return function(b10) {
              var result = [];
              var value18 = b10;
              while (true) {
                var maybe2 = f(value18);
                if (isNothing2(maybe2)) return result;
                var tuple = fromJust7(maybe2);
                result.push(fst2(tuple));
                value18 = snd2(tuple);
              }
            };
          };
        };
      };
    };
  };

  // output/Data.Unfoldable1/foreign.js
  var unfoldr1ArrayImpl = function(isNothing2) {
    return function(fromJust7) {
      return function(fst2) {
        return function(snd2) {
          return function(f) {
            return function(b10) {
              var result = [];
              var value18 = b10;
              while (true) {
                var tuple = f(value18);
                result.push(fst2(tuple));
                var maybe2 = snd2(tuple);
                if (isNothing2(maybe2)) return result;
                value18 = fromJust7(maybe2);
              }
            };
          };
        };
      };
    };
  };

  // output/Data.Unfoldable1/index.js
  var fromJust2 = /* @__PURE__ */ fromJust();
  var unfoldable1Array = {
    unfoldr1: /* @__PURE__ */ unfoldr1ArrayImpl(isNothing)(fromJust2)(fst)(snd)
  };

  // output/Data.Unfoldable/index.js
  var fromJust3 = /* @__PURE__ */ fromJust();
  var unfoldr = function(dict) {
    return dict.unfoldr;
  };
  var unfoldableArray = {
    unfoldr: /* @__PURE__ */ unfoldrArrayImpl(isNothing)(fromJust3)(fst)(snd),
    Unfoldable10: function() {
      return unfoldable1Array;
    }
  };

  // output/Data.Array/index.js
  var $$void4 = /* @__PURE__ */ $$void(functorST);
  var intercalate1 = /* @__PURE__ */ intercalate(foldableArray);
  var map7 = /* @__PURE__ */ map(functorMaybe);
  var map1 = /* @__PURE__ */ map(functorArray);
  var map22 = /* @__PURE__ */ map(functorST);
  var fromJust4 = /* @__PURE__ */ fromJust();
  var when2 = /* @__PURE__ */ when(applicativeST);
  var notEq3 = /* @__PURE__ */ notEq(eqOrdering);
  var append2 = /* @__PURE__ */ append(semigroupArray);
  var zipWith = /* @__PURE__ */ runFn3(zipWithImpl);
  var zip = /* @__PURE__ */ (function() {
    return zipWith(Tuple.create);
  })();
  var updateAt = /* @__PURE__ */ (function() {
    return runFn5(_updateAt)(Just.create)(Nothing.value);
  })();
  var unsafeIndex = function() {
    return runFn2(unsafeIndexImpl);
  };
  var unsafeIndex1 = /* @__PURE__ */ unsafeIndex();
  var uncons = /* @__PURE__ */ (function() {
    return runFn3(unconsImpl)($$const(Nothing.value))(function(x47) {
      return function(xs) {
        return new Just({
          head: x47,
          tail: xs
        });
      };
    });
  })();
  var sortBy = function(comp) {
    return runFn3(sortByImpl)(comp)(function(v) {
      if (v instanceof GT) {
        return 1;
      }
      ;
      if (v instanceof EQ) {
        return 0;
      }
      ;
      if (v instanceof LT) {
        return -1 | 0;
      }
      ;
      throw new Error("Failed pattern match at Data.Array (line 897, column 38 - line 900, column 11): " + [v.constructor.name]);
    });
  };
  var sortWith = function(dictOrd) {
    var comparing4 = comparing(dictOrd);
    return function(f) {
      return sortBy(comparing4(f));
    };
  };
  var sortWith1 = /* @__PURE__ */ sortWith(ordInt);
  var sort = function(dictOrd) {
    var compare26 = compare(dictOrd);
    return function(xs) {
      return sortBy(compare26)(xs);
    };
  };
  var snoc = function(xs) {
    return function(x47) {
      return withArray(push(x47))(xs)();
    };
  };
  var slice = /* @__PURE__ */ runFn3(sliceImpl);
  var take = function(n) {
    return function(xs) {
      var $152 = n < 1;
      if ($152) {
        return [];
      }
      ;
      return slice(0)(n)(xs);
    };
  };
  var singleton2 = function(a2) {
    return [a2];
  };
  var replicate = /* @__PURE__ */ runFn2(replicateImpl);
  var range2 = /* @__PURE__ */ runFn2(rangeImpl);
  var partition = /* @__PURE__ */ runFn2(partitionImpl);
  var $$null = function(xs) {
    return length(xs) === 0;
  };
  var mapWithIndex2 = /* @__PURE__ */ mapWithIndex(functorWithIndexArray);
  var intercalate2 = function(dictMonoid) {
    return intercalate1(dictMonoid);
  };
  var insertAt = /* @__PURE__ */ (function() {
    return runFn5(_insertAt)(Just.create)(Nothing.value);
  })();
  var index = /* @__PURE__ */ (function() {
    return runFn4(indexImpl)(Just.create)(Nothing.value);
  })();
  var last = function(xs) {
    return index(xs)(length(xs) - 1 | 0);
  };
  var head = function(xs) {
    return index(xs)(0);
  };
  var nubBy = function(comp) {
    return function(xs) {
      var indexedAndSorted = sortBy(function(x47) {
        return function(y48) {
          return comp(snd(x47))(snd(y48));
        };
      })(mapWithIndex2(Tuple.create)(xs));
      var v = head(indexedAndSorted);
      if (v instanceof Nothing) {
        return [];
      }
      ;
      if (v instanceof Just) {
        return map1(snd)(sortWith1(fst)((function __do3() {
          var result = unsafeThaw(singleton2(v.value0))();
          foreach(indexedAndSorted)(function(v1) {
            return function __do4() {
              var lst = map22(/* @__PURE__ */ (function() {
                var $183 = function($185) {
                  return fromJust4(last($185));
                };
                return function($184) {
                  return snd($183($184));
                };
              })())(unsafeFreeze(result))();
              return when2(notEq3(comp(lst)(v1.value1))(EQ.value))($$void4(push(v1)(result)))();
            };
          })();
          return unsafeFreeze(result)();
        })()));
      }
      ;
      throw new Error("Failed pattern match at Data.Array (line 1115, column 17 - line 1123, column 28): " + [v.constructor.name]);
    };
  };
  var nub = function(dictOrd) {
    return nubBy(compare(dictOrd));
  };
  var groupBy = function(op) {
    return function(xs) {
      return (function __do3() {
        var result = newSTArray();
        var iter = iterator(function(v) {
          return index(xs)(v);
        })();
        iterate(iter)(function(x47) {
          return $$void4(function __do4() {
            var sub1 = newSTArray();
            push(x47)(sub1)();
            pushWhile(op(x47))(iter)(sub1)();
            var grp = unsafeFreeze(sub1)();
            return push(grp)(result)();
          });
        })();
        return unsafeFreeze(result)();
      })();
    };
  };
  var fromFoldable = function(dictFoldable) {
    return runFn2(fromFoldableImpl)(foldr(dictFoldable));
  };
  var foldr2 = /* @__PURE__ */ foldr(foldableArray);
  var foldl2 = /* @__PURE__ */ foldl(foldableArray);
  var findMap = /* @__PURE__ */ (function() {
    return runFn4(findMapImpl)(Nothing.value)(isJust);
  })();
  var findIndex = /* @__PURE__ */ (function() {
    return runFn4(findIndexImpl)(Just.create)(Nothing.value);
  })();
  var find2 = function(f) {
    return function(xs) {
      return map7(unsafeIndex1(xs))(findIndex(f)(xs));
    };
  };
  var filter = /* @__PURE__ */ runFn2(filterImpl);
  var elemIndex = function(dictEq) {
    var eq27 = eq(dictEq);
    return function(x47) {
      return findIndex(function(v) {
        return eq27(v)(x47);
      });
    };
  };
  var elem2 = function(dictEq) {
    var elemIndex1 = elemIndex(dictEq);
    return function(a2) {
      return function(arr) {
        return isJust(elemIndex1(a2)(arr));
      };
    };
  };
  var drop = function(n) {
    return function(xs) {
      var $173 = n < 1;
      if ($173) {
        return xs;
      }
      ;
      return slice(n)(length(xs))(xs);
    };
  };
  var deleteAt = /* @__PURE__ */ (function() {
    return runFn4(_deleteAt)(Just.create)(Nothing.value);
  })();
  var deleteBy = function(v) {
    return function(v1) {
      return function(v2) {
        if (v2.length === 0) {
          return [];
        }
        ;
        return maybe(v2)(function(i2) {
          return fromJust4(deleteAt(i2)(v2));
        })(findIndex(v(v1))(v2));
      };
    };
  };
  var $$delete = function(dictEq) {
    return deleteBy(eq(dictEq));
  };
  var difference = function(dictEq) {
    return foldr2($$delete(dictEq));
  };
  var cons = function(x47) {
    return function(xs) {
      return append2([x47])(xs);
    };
  };
  var concatMap = /* @__PURE__ */ flip(/* @__PURE__ */ bind(bindArray));
  var mapMaybe = function(f) {
    return concatMap((function() {
      var $189 = maybe([])(singleton2);
      return function($190) {
        return $189(f($190));
      };
    })());
  };
  var catMaybes = /* @__PURE__ */ mapMaybe(/* @__PURE__ */ identity(categoryFn));
  var any2 = /* @__PURE__ */ runFn2(anyImpl);
  var nubByEq = function(eq27) {
    return function(xs) {
      return (function __do3() {
        var arr = newSTArray();
        foreach(xs)(function(x47) {
          return function __do4() {
            var e = map22((function() {
              var $194 = any2(function(v) {
                return eq27(v)(x47);
              });
              return function($195) {
                return !$194($195);
              };
            })())(unsafeFreeze(arr))();
            return when2(e)($$void4(push(x47)(arr)))();
          };
        })();
        return unsafeFreeze(arr)();
      })();
    };
  };
  var all2 = /* @__PURE__ */ runFn2(allImpl);

  // output/Data.FoldableWithIndex/index.js
  var foldr8 = /* @__PURE__ */ foldr(foldableArray);
  var mapWithIndex3 = /* @__PURE__ */ mapWithIndex(functorWithIndexArray);
  var foldl8 = /* @__PURE__ */ foldl(foldableArray);
  var foldrWithIndex = function(dict) {
    return dict.foldrWithIndex;
  };
  var traverseWithIndex_ = function(dictApplicative) {
    var applySecond5 = applySecond(dictApplicative.Apply0());
    var pure91 = pure(dictApplicative);
    return function(dictFoldableWithIndex) {
      var foldrWithIndex1 = foldrWithIndex(dictFoldableWithIndex);
      return function(f) {
        return foldrWithIndex1(function(i2) {
          var $289 = f(i2);
          return function($290) {
            return applySecond5($289($290));
          };
        })(pure91(unit));
      };
    };
  };
  var foldlWithIndex = function(dict) {
    return dict.foldlWithIndex;
  };
  var foldMapWithIndexDefaultR = function(dictFoldableWithIndex) {
    var foldrWithIndex1 = foldrWithIndex(dictFoldableWithIndex);
    return function(dictMonoid) {
      var append34 = append(dictMonoid.Semigroup0());
      var mempty3 = mempty(dictMonoid);
      return function(f) {
        return foldrWithIndex1(function(i2) {
          return function(x47) {
            return function(acc) {
              return append34(f(i2)(x47))(acc);
            };
          };
        })(mempty3);
      };
    };
  };
  var foldableWithIndexArray = {
    foldrWithIndex: function(f) {
      return function(z) {
        var $291 = foldr8(function(v) {
          return function(y48) {
            return f(v.value0)(v.value1)(y48);
          };
        })(z);
        var $292 = mapWithIndex3(Tuple.create);
        return function($293) {
          return $291($292($293));
        };
      };
    },
    foldlWithIndex: function(f) {
      return function(z) {
        var $294 = foldl8(function(y48) {
          return function(v) {
            return f(v.value0)(y48)(v.value1);
          };
        })(z);
        var $295 = mapWithIndex3(Tuple.create);
        return function($296) {
          return $294($295($296));
        };
      };
    },
    foldMapWithIndex: function(dictMonoid) {
      return foldMapWithIndexDefaultR(foldableWithIndexArray)(dictMonoid);
    },
    Foldable0: function() {
      return foldableArray;
    }
  };

  // output/Data.TraversableWithIndex/index.js
  var traverseWithIndexDefault = function(dictTraversableWithIndex) {
    var sequence2 = sequence(dictTraversableWithIndex.Traversable2());
    var mapWithIndex4 = mapWithIndex(dictTraversableWithIndex.FunctorWithIndex0());
    return function(dictApplicative) {
      var sequence12 = sequence2(dictApplicative);
      return function(f) {
        var $174 = mapWithIndex4(f);
        return function($175) {
          return sequence12($174($175));
        };
      };
    };
  };
  var traverseWithIndex = function(dict) {
    return dict.traverseWithIndex;
  };
  var traversableWithIndexArray = {
    traverseWithIndex: function(dictApplicative) {
      return traverseWithIndexDefault(traversableWithIndexArray)(dictApplicative);
    },
    FunctorWithIndex0: function() {
      return functorWithIndexArray;
    },
    FoldableWithIndex1: function() {
      return foldableWithIndexArray;
    },
    Traversable2: function() {
      return traversableArray;
    }
  };

  // output/Foreign.Object.ST/foreign.js
  var newImpl = function() {
    return {};
  };

  // output/Foreign.Object/index.js
  var lookup = /* @__PURE__ */ (function() {
    return runFn4(_lookup)(Nothing.value)(Just.create);
  })();

  // output/Data.Argonaut.Core/index.js
  var jsonEmptyObject = /* @__PURE__ */ id(empty);

  // output/Data.Argonaut.Parser/foreign.js
  function _jsonParser(fail3, succ, s) {
    try {
      return succ(JSON.parse(s));
    } catch (e) {
      return fail3(e.message);
    }
  }

  // output/Data.Argonaut.Parser/index.js
  var jsonParser = function(j) {
    return _jsonParser(Left.create, Right.create, j);
  };

  // output/Data.String.Common/foreign.js
  var replaceAll = function(s1) {
    return function(s2) {
      return function(s3) {
        return s3.replace(new RegExp(s1.replace(/[-\/\\^$*+?.()|[\]{}]/g, "\\$&"), "g"), s2);
      };
    };
  };
  var split = function(sep) {
    return function(s) {
      return s.split(sep);
    };
  };
  var toLower = function(s) {
    return s.toLowerCase();
  };
  var trim = function(s) {
    return s.trim();
  };
  var joinWith = function(s) {
    return function(xs) {
      return xs.join(s);
    };
  };

  // output/Data.String.Common/index.js
  var $$null2 = function(s) {
    return s === "";
  };

  // output/JSURI/foreign.js
  function encodeURIComponent_to_RFC3986(input3) {
    return input3.replace(/[!'()*]/g, function(c) {
      return "%" + c.charCodeAt(0).toString(16);
    });
  }
  function _encodeFormURLComponent(fail3, succeed, input3) {
    try {
      return succeed(encodeURIComponent_to_RFC3986(encodeURIComponent(input3)).replace(/%20/g, "+"));
    } catch (err) {
      return fail3(err);
    }
  }
  function _decodeURIComponent(fail3, succeed, input3) {
    try {
      return succeed(decodeURIComponent(input3));
    } catch (err) {
      return fail3(err);
    }
  }

  // output/JSURI/index.js
  var encodeFormURLComponent = /* @__PURE__ */ (function() {
    return runFn3(_encodeFormURLComponent)($$const(Nothing.value))(Just.create);
  })();
  var $$decodeURIComponent = /* @__PURE__ */ (function() {
    return runFn3(_decodeURIComponent)($$const(Nothing.value))(Just.create);
  })();

  // output/Data.FormURLEncoded/index.js
  var apply2 = /* @__PURE__ */ apply(applyMaybe);
  var map8 = /* @__PURE__ */ map(functorMaybe);
  var traverse2 = /* @__PURE__ */ traverse(traversableArray)(applicativeMaybe);
  var toArray = function(v) {
    return v;
  };
  var encode = /* @__PURE__ */ (function() {
    var encodePart = function(v) {
      if (v.value1 instanceof Nothing) {
        return encodeFormURLComponent(v.value0);
      }
      ;
      if (v.value1 instanceof Just) {
        return apply2(map8(function(key) {
          return function(val) {
            return key + ("=" + val);
          };
        })(encodeFormURLComponent(v.value0)))(encodeFormURLComponent(v.value1.value0));
      }
      ;
      throw new Error("Failed pattern match at Data.FormURLEncoded (line 37, column 16 - line 39, column 114): " + [v.constructor.name]);
    };
    var $37 = map8(joinWith("&"));
    var $38 = traverse2(encodePart);
    return function($39) {
      return $37($38(toArray($39)));
    };
  })();

  // output/Data.HTTP.Method/index.js
  var OPTIONS = /* @__PURE__ */ (function() {
    function OPTIONS2() {
    }
    ;
    OPTIONS2.value = new OPTIONS2();
    return OPTIONS2;
  })();
  var GET = /* @__PURE__ */ (function() {
    function GET3() {
    }
    ;
    GET3.value = new GET3();
    return GET3;
  })();
  var HEAD = /* @__PURE__ */ (function() {
    function HEAD2() {
    }
    ;
    HEAD2.value = new HEAD2();
    return HEAD2;
  })();
  var POST = /* @__PURE__ */ (function() {
    function POST3() {
    }
    ;
    POST3.value = new POST3();
    return POST3;
  })();
  var PUT = /* @__PURE__ */ (function() {
    function PUT2() {
    }
    ;
    PUT2.value = new PUT2();
    return PUT2;
  })();
  var DELETE = /* @__PURE__ */ (function() {
    function DELETE2() {
    }
    ;
    DELETE2.value = new DELETE2();
    return DELETE2;
  })();
  var TRACE = /* @__PURE__ */ (function() {
    function TRACE2() {
    }
    ;
    TRACE2.value = new TRACE2();
    return TRACE2;
  })();
  var CONNECT = /* @__PURE__ */ (function() {
    function CONNECT2() {
    }
    ;
    CONNECT2.value = new CONNECT2();
    return CONNECT2;
  })();
  var PROPFIND = /* @__PURE__ */ (function() {
    function PROPFIND2() {
    }
    ;
    PROPFIND2.value = new PROPFIND2();
    return PROPFIND2;
  })();
  var PROPPATCH = /* @__PURE__ */ (function() {
    function PROPPATCH2() {
    }
    ;
    PROPPATCH2.value = new PROPPATCH2();
    return PROPPATCH2;
  })();
  var MKCOL = /* @__PURE__ */ (function() {
    function MKCOL2() {
    }
    ;
    MKCOL2.value = new MKCOL2();
    return MKCOL2;
  })();
  var COPY = /* @__PURE__ */ (function() {
    function COPY2() {
    }
    ;
    COPY2.value = new COPY2();
    return COPY2;
  })();
  var MOVE = /* @__PURE__ */ (function() {
    function MOVE2() {
    }
    ;
    MOVE2.value = new MOVE2();
    return MOVE2;
  })();
  var LOCK = /* @__PURE__ */ (function() {
    function LOCK2() {
    }
    ;
    LOCK2.value = new LOCK2();
    return LOCK2;
  })();
  var UNLOCK = /* @__PURE__ */ (function() {
    function UNLOCK2() {
    }
    ;
    UNLOCK2.value = new UNLOCK2();
    return UNLOCK2;
  })();
  var PATCH = /* @__PURE__ */ (function() {
    function PATCH2() {
    }
    ;
    PATCH2.value = new PATCH2();
    return PATCH2;
  })();
  var unCustomMethod = function(v) {
    return v;
  };
  var showMethod = {
    show: function(v) {
      if (v instanceof OPTIONS) {
        return "OPTIONS";
      }
      ;
      if (v instanceof GET) {
        return "GET";
      }
      ;
      if (v instanceof HEAD) {
        return "HEAD";
      }
      ;
      if (v instanceof POST) {
        return "POST";
      }
      ;
      if (v instanceof PUT) {
        return "PUT";
      }
      ;
      if (v instanceof DELETE) {
        return "DELETE";
      }
      ;
      if (v instanceof TRACE) {
        return "TRACE";
      }
      ;
      if (v instanceof CONNECT) {
        return "CONNECT";
      }
      ;
      if (v instanceof PROPFIND) {
        return "PROPFIND";
      }
      ;
      if (v instanceof PROPPATCH) {
        return "PROPPATCH";
      }
      ;
      if (v instanceof MKCOL) {
        return "MKCOL";
      }
      ;
      if (v instanceof COPY) {
        return "COPY";
      }
      ;
      if (v instanceof MOVE) {
        return "MOVE";
      }
      ;
      if (v instanceof LOCK) {
        return "LOCK";
      }
      ;
      if (v instanceof UNLOCK) {
        return "UNLOCK";
      }
      ;
      if (v instanceof PATCH) {
        return "PATCH";
      }
      ;
      throw new Error("Failed pattern match at Data.HTTP.Method (line 43, column 1 - line 59, column 23): " + [v.constructor.name]);
    }
  };
  var print = /* @__PURE__ */ either(/* @__PURE__ */ show(showMethod))(unCustomMethod);

  // output/Data.NonEmpty/index.js
  var NonEmpty = /* @__PURE__ */ (function() {
    function NonEmpty2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    NonEmpty2.create = function(value0) {
      return function(value1) {
        return new NonEmpty2(value0, value1);
      };
    };
    return NonEmpty2;
  })();
  var singleton4 = function(dictPlus) {
    var empty9 = empty2(dictPlus);
    return function(a2) {
      return new NonEmpty(a2, empty9);
    };
  };

  // output/Data.List.Types/index.js
  var identity8 = /* @__PURE__ */ identity(categoryFn);
  var Nil = /* @__PURE__ */ (function() {
    function Nil2() {
    }
    ;
    Nil2.value = new Nil2();
    return Nil2;
  })();
  var Cons = /* @__PURE__ */ (function() {
    function Cons2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Cons2.create = function(value0) {
      return function(value1) {
        return new Cons2(value0, value1);
      };
    };
    return Cons2;
  })();
  var NonEmptyList = function(x47) {
    return x47;
  };
  var toList = function(v) {
    return new Cons(v.value0, v.value1);
  };
  var listMap = function(f) {
    var chunkedRevMap = function($copy_v) {
      return function($copy_v1) {
        var $tco_var_v = $copy_v;
        var $tco_done = false;
        var $tco_result;
        function $tco_loop(v, v1) {
          if (v1 instanceof Cons && (v1.value1 instanceof Cons && v1.value1.value1 instanceof Cons)) {
            $tco_var_v = new Cons(v1, v);
            $copy_v1 = v1.value1.value1.value1;
            return;
          }
          ;
          var unrolledMap = function(v2) {
            if (v2 instanceof Cons && (v2.value1 instanceof Cons && v2.value1.value1 instanceof Nil)) {
              return new Cons(f(v2.value0), new Cons(f(v2.value1.value0), Nil.value));
            }
            ;
            if (v2 instanceof Cons && v2.value1 instanceof Nil) {
              return new Cons(f(v2.value0), Nil.value);
            }
            ;
            return Nil.value;
          };
          var reverseUnrolledMap = function($copy_v2) {
            return function($copy_v3) {
              var $tco_var_v2 = $copy_v2;
              var $tco_done1 = false;
              var $tco_result2;
              function $tco_loop2(v2, v3) {
                if (v2 instanceof Cons && (v2.value0 instanceof Cons && (v2.value0.value1 instanceof Cons && v2.value0.value1.value1 instanceof Cons))) {
                  $tco_var_v2 = v2.value1;
                  $copy_v3 = new Cons(f(v2.value0.value0), new Cons(f(v2.value0.value1.value0), new Cons(f(v2.value0.value1.value1.value0), v3)));
                  return;
                }
                ;
                $tco_done1 = true;
                return v3;
              }
              ;
              while (!$tco_done1) {
                $tco_result2 = $tco_loop2($tco_var_v2, $copy_v3);
              }
              ;
              return $tco_result2;
            };
          };
          $tco_done = true;
          return reverseUnrolledMap(v)(unrolledMap(v1));
        }
        ;
        while (!$tco_done) {
          $tco_result = $tco_loop($tco_var_v, $copy_v1);
        }
        ;
        return $tco_result;
      };
    };
    return chunkedRevMap(Nil.value);
  };
  var functorList = {
    map: listMap
  };
  var map9 = /* @__PURE__ */ map(functorList);
  var foldableList = {
    foldr: function(f) {
      return function(b10) {
        var rev3 = (function() {
          var go2 = function($copy_v) {
            return function($copy_v1) {
              var $tco_var_v = $copy_v;
              var $tco_done = false;
              var $tco_result;
              function $tco_loop(v, v1) {
                if (v1 instanceof Nil) {
                  $tco_done = true;
                  return v;
                }
                ;
                if (v1 instanceof Cons) {
                  $tco_var_v = new Cons(v1.value0, v);
                  $copy_v1 = v1.value1;
                  return;
                }
                ;
                throw new Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): " + [v.constructor.name, v1.constructor.name]);
              }
              ;
              while (!$tco_done) {
                $tco_result = $tco_loop($tco_var_v, $copy_v1);
              }
              ;
              return $tco_result;
            };
          };
          return go2(Nil.value);
        })();
        var $284 = foldl(foldableList)(flip(f))(b10);
        return function($285) {
          return $284(rev3($285));
        };
      };
    },
    foldl: function(f) {
      var go2 = function($copy_b) {
        return function($copy_v) {
          var $tco_var_b = $copy_b;
          var $tco_done1 = false;
          var $tco_result;
          function $tco_loop(b10, v) {
            if (v instanceof Nil) {
              $tco_done1 = true;
              return b10;
            }
            ;
            if (v instanceof Cons) {
              $tco_var_b = f(b10)(v.value0);
              $copy_v = v.value1;
              return;
            }
            ;
            throw new Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): " + [v.constructor.name]);
          }
          ;
          while (!$tco_done1) {
            $tco_result = $tco_loop($tco_var_b, $copy_v);
          }
          ;
          return $tco_result;
        };
      };
      return go2;
    },
    foldMap: function(dictMonoid) {
      var append210 = append(dictMonoid.Semigroup0());
      var mempty3 = mempty(dictMonoid);
      return function(f) {
        return foldl(foldableList)(function(acc) {
          var $286 = append210(acc);
          return function($287) {
            return $286(f($287));
          };
        })(mempty3);
      };
    }
  };
  var foldl3 = /* @__PURE__ */ foldl(foldableList);
  var foldr3 = /* @__PURE__ */ foldr(foldableList);
  var semigroupList = {
    append: function(xs) {
      return function(ys) {
        return foldr3(Cons.create)(ys)(xs);
      };
    }
  };
  var append1 = /* @__PURE__ */ append(semigroupList);
  var monoidList = /* @__PURE__ */ (function() {
    return {
      mempty: Nil.value,
      Semigroup0: function() {
        return semigroupList;
      }
    };
  })();
  var semigroupNonEmptyList = {
    append: function(v) {
      return function(as$prime) {
        return new NonEmpty(v.value0, append1(v.value1)(toList(as$prime)));
      };
    }
  };
  var traversableList = {
    traverse: function(dictApplicative) {
      var Apply0 = dictApplicative.Apply0();
      var map124 = map(Apply0.Functor0());
      var lift22 = lift2(Apply0);
      var pure128 = pure(dictApplicative);
      return function(f) {
        var $301 = map124(foldl3(flip(Cons.create))(Nil.value));
        var $302 = foldl3(function(acc) {
          var $304 = lift22(flip(Cons.create))(acc);
          return function($305) {
            return $304(f($305));
          };
        })(pure128(Nil.value));
        return function($303) {
          return $301($302($303));
        };
      };
    },
    sequence: function(dictApplicative) {
      return traverse(traversableList)(dictApplicative)(identity8);
    },
    Functor0: function() {
      return functorList;
    },
    Foldable1: function() {
      return foldableList;
    }
  };
  var applyList = {
    apply: function(v) {
      return function(v1) {
        if (v instanceof Nil) {
          return Nil.value;
        }
        ;
        if (v instanceof Cons) {
          return append1(map9(v.value0)(v1))(apply(applyList)(v.value1)(v1));
        }
        ;
        throw new Error("Failed pattern match at Data.List.Types (line 157, column 1 - line 159, column 48): " + [v.constructor.name, v1.constructor.name]);
      };
    },
    Functor0: function() {
      return functorList;
    }
  };
  var bindList = {
    bind: function(v) {
      return function(v1) {
        if (v instanceof Nil) {
          return Nil.value;
        }
        ;
        if (v instanceof Cons) {
          return append1(v1(v.value0))(bind(bindList)(v.value1)(v1));
        }
        ;
        throw new Error("Failed pattern match at Data.List.Types (line 164, column 1 - line 166, column 37): " + [v.constructor.name, v1.constructor.name]);
      };
    },
    Apply0: function() {
      return applyList;
    }
  };
  var applicativeList = {
    pure: function(a2) {
      return new Cons(a2, Nil.value);
    },
    Apply0: function() {
      return applyList;
    }
  };
  var altList = {
    alt: append1,
    Functor0: function() {
      return functorList;
    }
  };
  var plusList = /* @__PURE__ */ (function() {
    return {
      empty: Nil.value,
      Alt0: function() {
        return altList;
      }
    };
  })();

  // output/Data.List/index.js
  var map10 = /* @__PURE__ */ map(functorMaybe);
  var foldl4 = /* @__PURE__ */ foldl(foldableList);
  var uncons2 = function(v) {
    if (v instanceof Nil) {
      return Nothing.value;
    }
    ;
    if (v instanceof Cons) {
      return new Just({
        head: v.value0,
        tail: v.value1
      });
    }
    ;
    throw new Error("Failed pattern match at Data.List (line 259, column 1 - line 259, column 66): " + [v.constructor.name]);
  };
  var toUnfoldable2 = function(dictUnfoldable) {
    return unfoldr(dictUnfoldable)(function(xs) {
      return map10(function(rec) {
        return new Tuple(rec.head, rec.tail);
      })(uncons2(xs));
    });
  };
  var singleton5 = function(a2) {
    return new Cons(a2, Nil.value);
  };
  var reverse2 = /* @__PURE__ */ (function() {
    var go2 = function($copy_v) {
      return function($copy_v1) {
        var $tco_var_v = $copy_v;
        var $tco_done = false;
        var $tco_result;
        function $tco_loop(v, v1) {
          if (v1 instanceof Nil) {
            $tco_done = true;
            return v;
          }
          ;
          if (v1 instanceof Cons) {
            $tco_var_v = new Cons(v1.value0, v);
            $copy_v1 = v1.value1;
            return;
          }
          ;
          throw new Error("Failed pattern match at Data.List (line 368, column 3 - line 368, column 19): " + [v.constructor.name, v1.constructor.name]);
        }
        ;
        while (!$tco_done) {
          $tco_result = $tco_loop($tco_var_v, $copy_v1);
        }
        ;
        return $tco_result;
      };
    };
    return go2(Nil.value);
  })();
  var unsnoc = function(lst) {
    var go2 = function($copy_v) {
      return function($copy_v1) {
        var $tco_var_v = $copy_v;
        var $tco_done = false;
        var $tco_result;
        function $tco_loop(v, v1) {
          if (v instanceof Nil) {
            $tco_done = true;
            return Nothing.value;
          }
          ;
          if (v instanceof Cons && v.value1 instanceof Nil) {
            $tco_done = true;
            return new Just({
              revInit: v1,
              last: v.value0
            });
          }
          ;
          if (v instanceof Cons) {
            $tco_var_v = v.value1;
            $copy_v1 = new Cons(v.value0, v1);
            return;
          }
          ;
          throw new Error("Failed pattern match at Data.List (line 270, column 3 - line 270, column 21): " + [v.constructor.name, v1.constructor.name]);
        }
        ;
        while (!$tco_done) {
          $tco_result = $tco_loop($tco_var_v, $copy_v1);
        }
        ;
        return $tco_result;
      };
    };
    return map10(function(h) {
      return {
        init: reverse2(h.revInit),
        last: h.last
      };
    })(go2(lst)(Nil.value));
  };
  var zipWith2 = function(f) {
    return function(xs) {
      return function(ys) {
        var go2 = function($copy_v) {
          return function($copy_v1) {
            return function($copy_v2) {
              var $tco_var_v = $copy_v;
              var $tco_var_v1 = $copy_v1;
              var $tco_done = false;
              var $tco_result;
              function $tco_loop(v, v1, v2) {
                if (v instanceof Nil) {
                  $tco_done = true;
                  return v2;
                }
                ;
                if (v1 instanceof Nil) {
                  $tco_done = true;
                  return v2;
                }
                ;
                if (v instanceof Cons && v1 instanceof Cons) {
                  $tco_var_v = v.value1;
                  $tco_var_v1 = v1.value1;
                  $copy_v2 = new Cons(f(v.value0)(v1.value0), v2);
                  return;
                }
                ;
                throw new Error("Failed pattern match at Data.List (line 779, column 3 - line 779, column 21): " + [v.constructor.name, v1.constructor.name, v2.constructor.name]);
              }
              ;
              while (!$tco_done) {
                $tco_result = $tco_loop($tco_var_v, $tco_var_v1, $copy_v2);
              }
              ;
              return $tco_result;
            };
          };
        };
        return reverse2(go2(xs)(ys)(Nil.value));
      };
    };
  };
  var $$null3 = function(v) {
    if (v instanceof Nil) {
      return true;
    }
    ;
    return false;
  };
  var length2 = /* @__PURE__ */ foldl4(function(acc) {
    return function(v) {
      return acc + 1 | 0;
    };
  })(0);
  var fromFoldable2 = function(dictFoldable) {
    return foldr(dictFoldable)(Cons.create)(Nil.value);
  };

  // output/Partial.Unsafe/foreign.js
  var _unsafePartial = function(f) {
    return f();
  };

  // output/Partial/foreign.js
  var _crashWith = function(msg) {
    throw new Error(msg);
  };

  // output/Partial/index.js
  var crashWith = function() {
    return _crashWith;
  };

  // output/Partial.Unsafe/index.js
  var crashWith2 = /* @__PURE__ */ crashWith();
  var unsafePartial = _unsafePartial;
  var unsafeCrashWith = function(msg) {
    return unsafePartial(function() {
      return crashWith2(msg);
    });
  };

  // output/Data.List.NonEmpty/index.js
  var singleton6 = /* @__PURE__ */ (function() {
    var $200 = singleton4(plusList);
    return function($201) {
      return NonEmptyList($200($201));
    };
  })();
  var head2 = function(v) {
    return v.value0;
  };
  var cons2 = function(y48) {
    return function(v) {
      return new NonEmpty(y48, new Cons(v.value0, v.value1));
    };
  };

  // output/Data.Nullable/foreign.js
  var nullImpl = null;
  function nullable(a2, r, f) {
    return a2 == null ? r : f(a2);
  }
  function notNull(x47) {
    return x47;
  }

  // output/Data.Nullable/index.js
  var toNullable = /* @__PURE__ */ maybe(nullImpl)(notNull);
  var toMaybe = function(n) {
    return nullable(n, Nothing.value, Just.create);
  };
  var eqNullable = function(dictEq) {
    return {
      eq: on(eq(eqMaybe(dictEq)))(toMaybe)
    };
  };
  var ordNullable = function(dictOrd) {
    var eqNullable1 = eqNullable(dictOrd.Eq0());
    return {
      compare: on(compare(ordMaybe(dictOrd)))(toMaybe),
      Eq0: function() {
        return eqNullable1;
      }
    };
  };

  // output/Effect.Aff/foreign.js
  var Aff = (function() {
    var EMPTY = {};
    var PURE = "Pure";
    var THROW = "Throw";
    var CATCH = "Catch";
    var SYNC = "Sync";
    var ASYNC = "Async";
    var BIND = "Bind";
    var BRACKET = "Bracket";
    var FORK = "Fork";
    var SEQ = "Sequential";
    var MAP = "Map";
    var APPLY = "Apply";
    var ALT = "Alt";
    var CONS = "Cons";
    var RESUME = "Resume";
    var RELEASE = "Release";
    var FINALIZER = "Finalizer";
    var FINALIZED = "Finalized";
    var FORKED = "Forked";
    var FIBER = "Fiber";
    var THUNK = "Thunk";
    function Aff2(tag, _1, _2, _3) {
      this.tag = tag;
      this._1 = _1;
      this._2 = _2;
      this._3 = _3;
    }
    function AffCtr(tag) {
      var fn = function(_1, _2, _3) {
        return new Aff2(tag, _1, _2, _3);
      };
      fn.tag = tag;
      return fn;
    }
    function nonCanceler2(error4) {
      return new Aff2(PURE, void 0);
    }
    function runEff(eff) {
      try {
        eff();
      } catch (error4) {
        setTimeout(function() {
          throw error4;
        }, 0);
      }
    }
    function runSync(left3, right3, eff) {
      try {
        return right3(eff());
      } catch (error4) {
        return left3(error4);
      }
    }
    function runAsync(left3, eff, k) {
      try {
        return eff(k)();
      } catch (error4) {
        k(left3(error4))();
        return nonCanceler2;
      }
    }
    var Scheduler = (function() {
      var limit = 1024;
      var size6 = 0;
      var ix = 0;
      var queue = new Array(limit);
      var draining = false;
      function drain() {
        var thunk;
        draining = true;
        while (size6 !== 0) {
          size6--;
          thunk = queue[ix];
          queue[ix] = void 0;
          ix = (ix + 1) % limit;
          thunk();
        }
        draining = false;
      }
      return {
        isDraining: function() {
          return draining;
        },
        enqueue: function(cb) {
          var i2, tmp;
          if (size6 === limit) {
            tmp = draining;
            drain();
            draining = tmp;
          }
          queue[(ix + size6) % limit] = cb;
          size6++;
          if (!draining) {
            drain();
          }
        }
      };
    })();
    function Supervisor(util2) {
      var fibers = {};
      var fiberId = 0;
      var count = 0;
      return {
        register: function(fiber) {
          var fid = fiberId++;
          fiber.onComplete({
            rethrow: true,
            handler: function(result) {
              return function() {
                count--;
                delete fibers[fid];
              };
            }
          })();
          fibers[fid] = fiber;
          count++;
        },
        isEmpty: function() {
          return count === 0;
        },
        killAll: function(killError, cb) {
          return function() {
            if (count === 0) {
              return cb();
            }
            var killCount = 0;
            var kills = {};
            function kill2(fid) {
              kills[fid] = fibers[fid].kill(killError, function(result) {
                return function() {
                  delete kills[fid];
                  killCount--;
                  if (util2.isLeft(result) && util2.fromLeft(result)) {
                    setTimeout(function() {
                      throw util2.fromLeft(result);
                    }, 0);
                  }
                  if (killCount === 0) {
                    cb();
                  }
                };
              })();
            }
            for (var k in fibers) {
              if (fibers.hasOwnProperty(k)) {
                killCount++;
                kill2(k);
              }
            }
            fibers = {};
            fiberId = 0;
            count = 0;
            return function(error4) {
              return new Aff2(SYNC, function() {
                for (var k2 in kills) {
                  if (kills.hasOwnProperty(k2)) {
                    kills[k2]();
                  }
                }
              });
            };
          };
        }
      };
    }
    var SUSPENDED = 0;
    var CONTINUE = 1;
    var STEP_BIND = 2;
    var STEP_RESULT = 3;
    var PENDING = 4;
    var RETURN = 5;
    var COMPLETED = 6;
    function Fiber(util2, supervisor, aff) {
      var runTick = 0;
      var status = SUSPENDED;
      var step4 = aff;
      var fail3 = null;
      var interrupt = null;
      var bhead = null;
      var btail = null;
      var attempts = null;
      var bracketCount = 0;
      var joinId = 0;
      var joins = null;
      var rethrow = true;
      function run3(localRunTick) {
        var tmp, result, attempt;
        while (true) {
          tmp = null;
          result = null;
          attempt = null;
          switch (status) {
            case STEP_BIND:
              status = CONTINUE;
              try {
                step4 = bhead(step4);
                if (btail === null) {
                  bhead = null;
                } else {
                  bhead = btail._1;
                  btail = btail._2;
                }
              } catch (e) {
                status = RETURN;
                fail3 = util2.left(e);
                step4 = null;
              }
              break;
            case STEP_RESULT:
              if (util2.isLeft(step4)) {
                status = RETURN;
                fail3 = step4;
                step4 = null;
              } else if (bhead === null) {
                status = RETURN;
              } else {
                status = STEP_BIND;
                step4 = util2.fromRight(step4);
              }
              break;
            case CONTINUE:
              switch (step4.tag) {
                case BIND:
                  if (bhead) {
                    btail = new Aff2(CONS, bhead, btail);
                  }
                  bhead = step4._2;
                  status = CONTINUE;
                  step4 = step4._1;
                  break;
                case PURE:
                  if (bhead === null) {
                    status = RETURN;
                    step4 = util2.right(step4._1);
                  } else {
                    status = STEP_BIND;
                    step4 = step4._1;
                  }
                  break;
                case SYNC:
                  status = STEP_RESULT;
                  step4 = runSync(util2.left, util2.right, step4._1);
                  break;
                case ASYNC:
                  status = PENDING;
                  step4 = runAsync(util2.left, step4._1, function(result2) {
                    return function() {
                      if (runTick !== localRunTick) {
                        return;
                      }
                      runTick++;
                      Scheduler.enqueue(function() {
                        if (runTick !== localRunTick + 1) {
                          return;
                        }
                        status = STEP_RESULT;
                        step4 = result2;
                        run3(runTick);
                      });
                    };
                  });
                  return;
                case THROW:
                  status = RETURN;
                  fail3 = util2.left(step4._1);
                  step4 = null;
                  break;
                // Enqueue the Catch so that we can call the error handler later on
                // in case of an exception.
                case CATCH:
                  if (bhead === null) {
                    attempts = new Aff2(CONS, step4, attempts, interrupt);
                  } else {
                    attempts = new Aff2(CONS, step4, new Aff2(CONS, new Aff2(RESUME, bhead, btail), attempts, interrupt), interrupt);
                  }
                  bhead = null;
                  btail = null;
                  status = CONTINUE;
                  step4 = step4._1;
                  break;
                // Enqueue the Bracket so that we can call the appropriate handlers
                // after resource acquisition.
                case BRACKET:
                  bracketCount++;
                  if (bhead === null) {
                    attempts = new Aff2(CONS, step4, attempts, interrupt);
                  } else {
                    attempts = new Aff2(CONS, step4, new Aff2(CONS, new Aff2(RESUME, bhead, btail), attempts, interrupt), interrupt);
                  }
                  bhead = null;
                  btail = null;
                  status = CONTINUE;
                  step4 = step4._1;
                  break;
                case FORK:
                  status = STEP_RESULT;
                  tmp = Fiber(util2, supervisor, step4._2);
                  if (supervisor) {
                    supervisor.register(tmp);
                  }
                  if (step4._1) {
                    tmp.run();
                  }
                  step4 = util2.right(tmp);
                  break;
                case SEQ:
                  status = CONTINUE;
                  step4 = sequential3(util2, supervisor, step4._1);
                  break;
              }
              break;
            case RETURN:
              bhead = null;
              btail = null;
              if (attempts === null) {
                status = COMPLETED;
                step4 = interrupt || fail3 || step4;
              } else {
                tmp = attempts._3;
                attempt = attempts._1;
                attempts = attempts._2;
                switch (attempt.tag) {
                  // We cannot recover from an unmasked interrupt. Otherwise we should
                  // continue stepping, or run the exception handler if an exception
                  // was raised.
                  case CATCH:
                    if (interrupt && interrupt !== tmp && bracketCount === 0) {
                      status = RETURN;
                    } else if (fail3) {
                      status = CONTINUE;
                      step4 = attempt._2(util2.fromLeft(fail3));
                      fail3 = null;
                    }
                    break;
                  // We cannot resume from an unmasked interrupt or exception.
                  case RESUME:
                    if (interrupt && interrupt !== tmp && bracketCount === 0 || fail3) {
                      status = RETURN;
                    } else {
                      bhead = attempt._1;
                      btail = attempt._2;
                      status = STEP_BIND;
                      step4 = util2.fromRight(step4);
                    }
                    break;
                  // If we have a bracket, we should enqueue the handlers,
                  // and continue with the success branch only if the fiber has
                  // not been interrupted. If the bracket acquisition failed, we
                  // should not run either.
                  case BRACKET:
                    bracketCount--;
                    if (fail3 === null) {
                      result = util2.fromRight(step4);
                      attempts = new Aff2(CONS, new Aff2(RELEASE, attempt._2, result), attempts, tmp);
                      if (interrupt === tmp || bracketCount > 0) {
                        status = CONTINUE;
                        step4 = attempt._3(result);
                      }
                    }
                    break;
                  // Enqueue the appropriate handler. We increase the bracket count
                  // because it should not be cancelled.
                  case RELEASE:
                    attempts = new Aff2(CONS, new Aff2(FINALIZED, step4, fail3), attempts, interrupt);
                    status = CONTINUE;
                    if (interrupt && interrupt !== tmp && bracketCount === 0) {
                      step4 = attempt._1.killed(util2.fromLeft(interrupt))(attempt._2);
                    } else if (fail3) {
                      step4 = attempt._1.failed(util2.fromLeft(fail3))(attempt._2);
                    } else {
                      step4 = attempt._1.completed(util2.fromRight(step4))(attempt._2);
                    }
                    fail3 = null;
                    bracketCount++;
                    break;
                  case FINALIZER:
                    bracketCount++;
                    attempts = new Aff2(CONS, new Aff2(FINALIZED, step4, fail3), attempts, interrupt);
                    status = CONTINUE;
                    step4 = attempt._1;
                    break;
                  case FINALIZED:
                    bracketCount--;
                    status = RETURN;
                    step4 = attempt._1;
                    fail3 = attempt._2;
                    break;
                }
              }
              break;
            case COMPLETED:
              for (var k in joins) {
                if (joins.hasOwnProperty(k)) {
                  rethrow = rethrow && joins[k].rethrow;
                  runEff(joins[k].handler(step4));
                }
              }
              joins = null;
              if (interrupt && fail3) {
                setTimeout(function() {
                  throw util2.fromLeft(fail3);
                }, 0);
              } else if (util2.isLeft(step4) && rethrow) {
                setTimeout(function() {
                  if (rethrow) {
                    throw util2.fromLeft(step4);
                  }
                }, 0);
              }
              return;
            case SUSPENDED:
              status = CONTINUE;
              break;
            case PENDING:
              return;
          }
        }
      }
      function onComplete(join6) {
        return function() {
          if (status === COMPLETED) {
            rethrow = rethrow && join6.rethrow;
            join6.handler(step4)();
            return function() {
            };
          }
          var jid = joinId++;
          joins = joins || {};
          joins[jid] = join6;
          return function() {
            if (joins !== null) {
              delete joins[jid];
            }
          };
        };
      }
      function kill2(error4, cb) {
        return function() {
          if (status === COMPLETED) {
            cb(util2.right(void 0))();
            return function() {
            };
          }
          var canceler = onComplete({
            rethrow: false,
            handler: function() {
              return cb(util2.right(void 0));
            }
          })();
          switch (status) {
            case SUSPENDED:
              interrupt = util2.left(error4);
              status = COMPLETED;
              step4 = interrupt;
              run3(runTick);
              break;
            case PENDING:
              if (interrupt === null) {
                interrupt = util2.left(error4);
              }
              if (bracketCount === 0) {
                if (status === PENDING) {
                  attempts = new Aff2(CONS, new Aff2(FINALIZER, step4(error4)), attempts, interrupt);
                }
                status = RETURN;
                step4 = null;
                fail3 = null;
                run3(++runTick);
              }
              break;
            default:
              if (interrupt === null) {
                interrupt = util2.left(error4);
              }
              if (bracketCount === 0) {
                status = RETURN;
                step4 = null;
                fail3 = null;
              }
          }
          return canceler;
        };
      }
      function join5(cb) {
        return function() {
          var canceler = onComplete({
            rethrow: false,
            handler: cb
          })();
          if (status === SUSPENDED) {
            run3(runTick);
          }
          return canceler;
        };
      }
      return {
        kill: kill2,
        join: join5,
        onComplete,
        isSuspended: function() {
          return status === SUSPENDED;
        },
        run: function() {
          if (status === SUSPENDED) {
            if (!Scheduler.isDraining()) {
              Scheduler.enqueue(function() {
                run3(runTick);
              });
            } else {
              run3(runTick);
            }
          }
        }
      };
    }
    function runPar(util2, supervisor, par, cb) {
      var fiberId = 0;
      var fibers = {};
      var killId = 0;
      var kills = {};
      var early = new Error("[ParAff] Early exit");
      var interrupt = null;
      var root3 = EMPTY;
      function kill2(error4, par2, cb2) {
        var step4 = par2;
        var head6 = null;
        var tail2 = null;
        var count = 0;
        var kills2 = {};
        var tmp, kid;
        loop: while (true) {
          tmp = null;
          switch (step4.tag) {
            case FORKED:
              if (step4._3 === EMPTY) {
                tmp = fibers[step4._1];
                kills2[count++] = tmp.kill(error4, function(result) {
                  return function() {
                    count--;
                    if (count === 0) {
                      cb2(result)();
                    }
                  };
                });
              }
              if (head6 === null) {
                break loop;
              }
              step4 = head6._2;
              if (tail2 === null) {
                head6 = null;
              } else {
                head6 = tail2._1;
                tail2 = tail2._2;
              }
              break;
            case MAP:
              step4 = step4._2;
              break;
            case APPLY:
            case ALT:
              if (head6) {
                tail2 = new Aff2(CONS, head6, tail2);
              }
              head6 = step4;
              step4 = step4._1;
              break;
          }
        }
        if (count === 0) {
          cb2(util2.right(void 0))();
        } else {
          kid = 0;
          tmp = count;
          for (; kid < tmp; kid++) {
            kills2[kid] = kills2[kid]();
          }
        }
        return kills2;
      }
      function join5(result, head6, tail2) {
        var fail3, step4, lhs, rhs, tmp, kid;
        if (util2.isLeft(result)) {
          fail3 = result;
          step4 = null;
        } else {
          step4 = result;
          fail3 = null;
        }
        loop: while (true) {
          lhs = null;
          rhs = null;
          tmp = null;
          kid = null;
          if (interrupt !== null) {
            return;
          }
          if (head6 === null) {
            cb(fail3 || step4)();
            return;
          }
          if (head6._3 !== EMPTY) {
            return;
          }
          switch (head6.tag) {
            case MAP:
              if (fail3 === null) {
                head6._3 = util2.right(head6._1(util2.fromRight(step4)));
                step4 = head6._3;
              } else {
                head6._3 = fail3;
              }
              break;
            case APPLY:
              lhs = head6._1._3;
              rhs = head6._2._3;
              if (fail3) {
                head6._3 = fail3;
                tmp = true;
                kid = killId++;
                kills[kid] = kill2(early, fail3 === lhs ? head6._2 : head6._1, function() {
                  return function() {
                    delete kills[kid];
                    if (tmp) {
                      tmp = false;
                    } else if (tail2 === null) {
                      join5(fail3, null, null);
                    } else {
                      join5(fail3, tail2._1, tail2._2);
                    }
                  };
                });
                if (tmp) {
                  tmp = false;
                  return;
                }
              } else if (lhs === EMPTY || rhs === EMPTY) {
                return;
              } else {
                step4 = util2.right(util2.fromRight(lhs)(util2.fromRight(rhs)));
                head6._3 = step4;
              }
              break;
            case ALT:
              lhs = head6._1._3;
              rhs = head6._2._3;
              if (lhs === EMPTY && util2.isLeft(rhs) || rhs === EMPTY && util2.isLeft(lhs)) {
                return;
              }
              if (lhs !== EMPTY && util2.isLeft(lhs) && rhs !== EMPTY && util2.isLeft(rhs)) {
                fail3 = step4 === lhs ? rhs : lhs;
                step4 = null;
                head6._3 = fail3;
              } else {
                head6._3 = step4;
                tmp = true;
                kid = killId++;
                kills[kid] = kill2(early, step4 === lhs ? head6._2 : head6._1, function() {
                  return function() {
                    delete kills[kid];
                    if (tmp) {
                      tmp = false;
                    } else if (tail2 === null) {
                      join5(step4, null, null);
                    } else {
                      join5(step4, tail2._1, tail2._2);
                    }
                  };
                });
                if (tmp) {
                  tmp = false;
                  return;
                }
              }
              break;
          }
          if (tail2 === null) {
            head6 = null;
          } else {
            head6 = tail2._1;
            tail2 = tail2._2;
          }
        }
      }
      function resolve(fiber) {
        return function(result) {
          return function() {
            delete fibers[fiber._1];
            fiber._3 = result;
            join5(result, fiber._2._1, fiber._2._2);
          };
        };
      }
      function run3() {
        var status = CONTINUE;
        var step4 = par;
        var head6 = null;
        var tail2 = null;
        var tmp, fid;
        loop: while (true) {
          tmp = null;
          fid = null;
          switch (status) {
            case CONTINUE:
              switch (step4.tag) {
                case MAP:
                  if (head6) {
                    tail2 = new Aff2(CONS, head6, tail2);
                  }
                  head6 = new Aff2(MAP, step4._1, EMPTY, EMPTY);
                  step4 = step4._2;
                  break;
                case APPLY:
                  if (head6) {
                    tail2 = new Aff2(CONS, head6, tail2);
                  }
                  head6 = new Aff2(APPLY, EMPTY, step4._2, EMPTY);
                  step4 = step4._1;
                  break;
                case ALT:
                  if (head6) {
                    tail2 = new Aff2(CONS, head6, tail2);
                  }
                  head6 = new Aff2(ALT, EMPTY, step4._2, EMPTY);
                  step4 = step4._1;
                  break;
                default:
                  fid = fiberId++;
                  status = RETURN;
                  tmp = step4;
                  step4 = new Aff2(FORKED, fid, new Aff2(CONS, head6, tail2), EMPTY);
                  tmp = Fiber(util2, supervisor, tmp);
                  tmp.onComplete({
                    rethrow: false,
                    handler: resolve(step4)
                  })();
                  fibers[fid] = tmp;
                  if (supervisor) {
                    supervisor.register(tmp);
                  }
              }
              break;
            case RETURN:
              if (head6 === null) {
                break loop;
              }
              if (head6._1 === EMPTY) {
                head6._1 = step4;
                status = CONTINUE;
                step4 = head6._2;
                head6._2 = EMPTY;
              } else {
                head6._2 = step4;
                step4 = head6;
                if (tail2 === null) {
                  head6 = null;
                } else {
                  head6 = tail2._1;
                  tail2 = tail2._2;
                }
              }
          }
        }
        root3 = step4;
        for (fid = 0; fid < fiberId; fid++) {
          fibers[fid].run();
        }
      }
      function cancel(error4, cb2) {
        interrupt = util2.left(error4);
        var innerKills;
        for (var kid in kills) {
          if (kills.hasOwnProperty(kid)) {
            innerKills = kills[kid];
            for (kid in innerKills) {
              if (innerKills.hasOwnProperty(kid)) {
                innerKills[kid]();
              }
            }
          }
        }
        kills = null;
        var newKills = kill2(error4, root3, cb2);
        return function(killError) {
          return new Aff2(ASYNC, function(killCb) {
            return function() {
              for (var kid2 in newKills) {
                if (newKills.hasOwnProperty(kid2)) {
                  newKills[kid2]();
                }
              }
              return nonCanceler2;
            };
          });
        };
      }
      run3();
      return function(killError) {
        return new Aff2(ASYNC, function(killCb) {
          return function() {
            return cancel(killError, killCb);
          };
        });
      };
    }
    function sequential3(util2, supervisor, par) {
      return new Aff2(ASYNC, function(cb) {
        return function() {
          return runPar(util2, supervisor, par, cb);
        };
      });
    }
    Aff2.EMPTY = EMPTY;
    Aff2.Pure = AffCtr(PURE);
    Aff2.Throw = AffCtr(THROW);
    Aff2.Catch = AffCtr(CATCH);
    Aff2.Sync = AffCtr(SYNC);
    Aff2.Async = AffCtr(ASYNC);
    Aff2.Bind = AffCtr(BIND);
    Aff2.Bracket = AffCtr(BRACKET);
    Aff2.Fork = AffCtr(FORK);
    Aff2.Seq = AffCtr(SEQ);
    Aff2.ParMap = AffCtr(MAP);
    Aff2.ParApply = AffCtr(APPLY);
    Aff2.ParAlt = AffCtr(ALT);
    Aff2.Fiber = Fiber;
    Aff2.Supervisor = Supervisor;
    Aff2.Scheduler = Scheduler;
    Aff2.nonCanceler = nonCanceler2;
    return Aff2;
  })();
  var _pure = Aff.Pure;
  var _throwError = Aff.Throw;
  function _catchError(aff) {
    return function(k) {
      return Aff.Catch(aff, k);
    };
  }
  function _map(f) {
    return function(aff) {
      if (aff.tag === Aff.Pure.tag) {
        return Aff.Pure(f(aff._1));
      } else {
        return Aff.Bind(aff, function(value18) {
          return Aff.Pure(f(value18));
        });
      }
    };
  }
  function _bind(aff) {
    return function(k) {
      return Aff.Bind(aff, k);
    };
  }
  function _fork(immediate) {
    return function(aff) {
      return Aff.Fork(immediate, aff);
    };
  }
  var _liftEffect = Aff.Sync;
  function _parAffMap(f) {
    return function(aff) {
      return Aff.ParMap(f, aff);
    };
  }
  function _parAffApply(aff1) {
    return function(aff2) {
      return Aff.ParApply(aff1, aff2);
    };
  }
  var makeAff = Aff.Async;
  function generalBracket(acquire) {
    return function(options2) {
      return function(k) {
        return Aff.Bracket(acquire, options2, k);
      };
    };
  }
  function _makeFiber(util2, aff) {
    return function() {
      return Aff.Fiber(util2, null, aff);
    };
  }
  var _delay = /* @__PURE__ */ (function() {
    function setDelay(n, k) {
      if (n === 0 && typeof setImmediate !== "undefined") {
        return setImmediate(k);
      } else {
        return setTimeout(k, n);
      }
    }
    function clearDelay(n, t) {
      if (n === 0 && typeof clearImmediate !== "undefined") {
        return clearImmediate(t);
      } else {
        return clearTimeout(t);
      }
    }
    return function(right3, ms) {
      return Aff.Async(function(cb) {
        return function() {
          var timer2 = setDelay(ms, cb(right3()));
          return function() {
            return Aff.Sync(function() {
              return right3(clearDelay(ms, timer2));
            });
          };
        };
      });
    };
  })();
  var _sequential = Aff.Seq;

  // output/Control.Monad.Writer.Trans/index.js
  var WriterT = function(x47) {
    return x47;
  };
  var runWriterT = function(v) {
    return v;
  };
  var mapWriterT = function(f) {
    return function(v) {
      return f(v);
    };
  };
  var functorWriterT = function(dictFunctor) {
    var map95 = map(dictFunctor);
    return {
      map: function(f) {
        return mapWriterT(map95(function(v) {
          return new Tuple(f(v.value0), v.value1);
        }));
      }
    };
  };
  var applyWriterT = function(dictSemigroup) {
    var append34 = append(dictSemigroup);
    return function(dictApply) {
      var apply8 = apply(dictApply);
      var Functor0 = dictApply.Functor0();
      var map95 = map(Functor0);
      var functorWriterT1 = functorWriterT(Functor0);
      return {
        apply: function(v) {
          return function(v1) {
            var k = function(v3) {
              return function(v4) {
                return new Tuple(v3.value0(v4.value0), append34(v3.value1)(v4.value1));
              };
            };
            return apply8(map95(k)(v))(v1);
          };
        },
        Functor0: function() {
          return functorWriterT1;
        }
      };
    };
  };
  var bindWriterT = function(dictSemigroup) {
    var append34 = append(dictSemigroup);
    var applyWriterT1 = applyWriterT(dictSemigroup);
    return function(dictBind) {
      var bind87 = bind(dictBind);
      var Apply0 = dictBind.Apply0();
      var map95 = map(Apply0.Functor0());
      var applyWriterT2 = applyWriterT1(Apply0);
      return {
        bind: function(v) {
          return function(k) {
            return bind87(v)(function(v1) {
              var v2 = k(v1.value0);
              return map95(function(v3) {
                return new Tuple(v3.value0, append34(v1.value1)(v3.value1));
              })(v2);
            });
          };
        },
        Apply0: function() {
          return applyWriterT2;
        }
      };
    };
  };
  var applicativeWriterT = function(dictMonoid) {
    var mempty3 = mempty(dictMonoid);
    var applyWriterT1 = applyWriterT(dictMonoid.Semigroup0());
    return function(dictApplicative) {
      var pure91 = pure(dictApplicative);
      var applyWriterT2 = applyWriterT1(dictApplicative.Apply0());
      return {
        pure: function(a2) {
          return pure91(new Tuple(a2, mempty3));
        },
        Apply0: function() {
          return applyWriterT2;
        }
      };
    };
  };
  var monadWriterT = function(dictMonoid) {
    var applicativeWriterT1 = applicativeWriterT(dictMonoid);
    var bindWriterT1 = bindWriterT(dictMonoid.Semigroup0());
    return function(dictMonad) {
      var applicativeWriterT22 = applicativeWriterT1(dictMonad.Applicative0());
      var bindWriterT2 = bindWriterT1(dictMonad.Bind1());
      return {
        Applicative0: function() {
          return applicativeWriterT22;
        },
        Bind1: function() {
          return bindWriterT2;
        }
      };
    };
  };
  var monadTellWriterT = function(dictMonoid) {
    var Semigroup0 = dictMonoid.Semigroup0();
    var monadWriterT1 = monadWriterT(dictMonoid);
    return function(dictMonad) {
      var monadWriterT2 = monadWriterT1(dictMonad);
      return {
        tell: (function() {
          var $262 = pure(dictMonad.Applicative0());
          var $263 = Tuple.create(unit);
          return function($264) {
            return WriterT($262($263($264)));
          };
        })(),
        Semigroup0: function() {
          return Semigroup0;
        },
        Monad1: function() {
          return monadWriterT2;
        }
      };
    };
  };

  // output/Data.Profunctor/index.js
  var profunctorFn = {
    dimap: function(a2b) {
      return function(c2d) {
        return function(b2c) {
          return function($18) {
            return c2d(b2c(a2b($18)));
          };
        };
      };
    }
  };
  var dimap = function(dict) {
    return dict.dimap;
  };

  // output/Control.Parallel.Class/index.js
  var sequential = function(dict) {
    return dict.sequential;
  };
  var parallel = function(dict) {
    return dict.parallel;
  };

  // output/Control.Parallel/index.js
  var identity9 = /* @__PURE__ */ identity(categoryFn);
  var parTraverse_ = function(dictParallel) {
    var sequential3 = sequential(dictParallel);
    var parallel4 = parallel(dictParallel);
    return function(dictApplicative) {
      var traverse_10 = traverse_(dictApplicative);
      return function(dictFoldable) {
        var traverse_15 = traverse_10(dictFoldable);
        return function(f) {
          var $51 = traverse_15(function($53) {
            return parallel4(f($53));
          });
          return function($52) {
            return sequential3($51($52));
          };
        };
      };
    };
  };
  var parSequence_ = function(dictParallel) {
    var parTraverse_1 = parTraverse_(dictParallel);
    return function(dictApplicative) {
      var parTraverse_2 = parTraverse_1(dictApplicative);
      return function(dictFoldable) {
        return parTraverse_2(dictFoldable)(identity9);
      };
    };
  };

  // output/Effect.Unsafe/foreign.js
  var unsafePerformEffect = function(f) {
    return f();
  };

  // output/Effect.Aff/index.js
  var $runtime_lazy3 = function(name16, moduleName, init13) {
    var state3 = 0;
    var val;
    return function(lineNumber) {
      if (state3 === 2) return val;
      if (state3 === 1) throw new ReferenceError(name16 + " was needed before it finished initializing (module " + moduleName + ", line " + lineNumber + ")", moduleName, lineNumber);
      state3 = 1;
      val = init13();
      state3 = 2;
      return val;
    };
  };
  var pure2 = /* @__PURE__ */ pure(applicativeEffect);
  var $$void5 = /* @__PURE__ */ $$void(functorEffect);
  var map11 = /* @__PURE__ */ map(functorEffect);
  var Canceler = function(x47) {
    return x47;
  };
  var suspendAff = /* @__PURE__ */ _fork(false);
  var functorParAff = {
    map: _parAffMap
  };
  var functorAff = {
    map: _map
  };
  var map12 = /* @__PURE__ */ map(functorAff);
  var forkAff = /* @__PURE__ */ _fork(true);
  var ffiUtil = /* @__PURE__ */ (function() {
    var unsafeFromRight = function(v) {
      if (v instanceof Right) {
        return v.value0;
      }
      ;
      if (v instanceof Left) {
        return unsafeCrashWith("unsafeFromRight: Left");
      }
      ;
      throw new Error("Failed pattern match at Effect.Aff (line 412, column 21 - line 414, column 54): " + [v.constructor.name]);
    };
    var unsafeFromLeft = function(v) {
      if (v instanceof Left) {
        return v.value0;
      }
      ;
      if (v instanceof Right) {
        return unsafeCrashWith("unsafeFromLeft: Right");
      }
      ;
      throw new Error("Failed pattern match at Effect.Aff (line 407, column 20 - line 409, column 55): " + [v.constructor.name]);
    };
    var isLeft = function(v) {
      if (v instanceof Left) {
        return true;
      }
      ;
      if (v instanceof Right) {
        return false;
      }
      ;
      throw new Error("Failed pattern match at Effect.Aff (line 402, column 12 - line 404, column 21): " + [v.constructor.name]);
    };
    return {
      isLeft,
      fromLeft: unsafeFromLeft,
      fromRight: unsafeFromRight,
      left: Left.create,
      right: Right.create
    };
  })();
  var makeFiber = function(aff) {
    return _makeFiber(ffiUtil, aff);
  };
  var launchAff = function(aff) {
    return function __do3() {
      var fiber = makeFiber(aff)();
      fiber.run();
      return fiber;
    };
  };
  var launchAff_ = function($75) {
    return $$void5(launchAff($75));
  };
  var delay = function(v) {
    return _delay(Right.create, v);
  };
  var bracket = function(acquire) {
    return function(completed) {
      return generalBracket(acquire)({
        killed: $$const(completed),
        failed: $$const(completed),
        completed: $$const(completed)
      });
    };
  };
  var applyParAff = {
    apply: _parAffApply,
    Functor0: function() {
      return functorParAff;
    }
  };
  var monadAff = {
    Applicative0: function() {
      return applicativeAff;
    },
    Bind1: function() {
      return bindAff;
    }
  };
  var bindAff = {
    bind: _bind,
    Apply0: function() {
      return $lazy_applyAff(0);
    }
  };
  var applicativeAff = {
    pure: _pure,
    Apply0: function() {
      return $lazy_applyAff(0);
    }
  };
  var $lazy_applyAff = /* @__PURE__ */ $runtime_lazy3("applyAff", "Effect.Aff", function() {
    return {
      apply: ap(monadAff),
      Functor0: function() {
        return functorAff;
      }
    };
  });
  var applyAff = /* @__PURE__ */ $lazy_applyAff(73);
  var pure22 = /* @__PURE__ */ pure(applicativeAff);
  var bind1 = /* @__PURE__ */ bind(bindAff);
  var bindFlipped3 = /* @__PURE__ */ bindFlipped(bindAff);
  var $$finally = function(fin) {
    return function(a2) {
      return bracket(pure22(unit))($$const(fin))($$const(a2));
    };
  };
  var parallelAff = {
    parallel: unsafeCoerce2,
    sequential: _sequential,
    Apply0: function() {
      return applyAff;
    },
    Apply1: function() {
      return applyParAff;
    }
  };
  var parallel2 = /* @__PURE__ */ parallel(parallelAff);
  var applicativeParAff = {
    pure: function($76) {
      return parallel2(pure22($76));
    },
    Apply0: function() {
      return applyParAff;
    }
  };
  var monadEffectAff = {
    liftEffect: _liftEffect,
    Monad0: function() {
      return monadAff;
    }
  };
  var liftEffect2 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var effectCanceler = function($77) {
    return Canceler($$const(liftEffect2($77)));
  };
  var joinFiber = function(v) {
    return makeAff(function(k) {
      return map11(effectCanceler)(v.join(k));
    });
  };
  var functorFiber = {
    map: function(f) {
      return function(t) {
        return unsafePerformEffect(makeFiber(map12(f)(joinFiber(t))));
      };
    }
  };
  var killFiber = function(e) {
    return function(v) {
      return bind1(liftEffect2(v.isSuspended))(function(suspended) {
        if (suspended) {
          return liftEffect2($$void5(v.kill(e, $$const(pure2(unit)))));
        }
        ;
        return makeAff(function(k) {
          return map11(effectCanceler)(v.kill(e, k));
        });
      });
    };
  };
  var monadThrowAff = {
    throwError: _throwError,
    Monad0: function() {
      return monadAff;
    }
  };
  var monadErrorAff = {
    catchError: _catchError,
    MonadThrow0: function() {
      return monadThrowAff;
    }
  };
  var $$try2 = /* @__PURE__ */ $$try(monadErrorAff);
  var runAff = function(k) {
    return function(aff) {
      return launchAff(bindFlipped3(function($83) {
        return liftEffect2(k($83));
      })($$try2(aff)));
    };
  };
  var runAff_ = function(k) {
    return function(aff) {
      return $$void5(runAff(k)(aff));
    };
  };
  var monadRecAff = {
    tailRecM: function(k) {
      var go2 = function(a2) {
        return bind1(k(a2))(function(res) {
          if (res instanceof Done) {
            return pure22(res.value0);
          }
          ;
          if (res instanceof Loop) {
            return go2(res.value0);
          }
          ;
          throw new Error("Failed pattern match at Effect.Aff (line 104, column 7 - line 106, column 23): " + [res.constructor.name]);
        });
      };
      return go2;
    },
    Monad0: function() {
      return monadAff;
    }
  };
  var nonCanceler = /* @__PURE__ */ $$const(/* @__PURE__ */ pure22(unit));

  // output/Effect.Aff.Compat/index.js
  var fromEffectFnAff = function(v) {
    return makeAff(function(k) {
      return function __do3() {
        var v1 = v(function($9) {
          return k(Left.create($9))();
        }, function($10) {
          return k(Right.create($10))();
        });
        return function(e) {
          return makeAff(function(k2) {
            return function __do4() {
              v1(e, function($11) {
                return k2(Left.create($11))();
              }, function($12) {
                return k2(Right.create($12))();
              });
              return nonCanceler;
            };
          });
        };
      };
    });
  };

  // output/Foreign/foreign.js
  function typeOf(value18) {
    return typeof value18;
  }
  function tagOf(value18) {
    return Object.prototype.toString.call(value18).slice(8, -1);
  }
  var isArray = Array.isArray || function(value18) {
    return Object.prototype.toString.call(value18) === "[object Array]";
  };

  // output/Data.Int/foreign.js
  var fromNumberImpl = function(just) {
    return function(nothing) {
      return function(n) {
        return (n | 0) === n ? just(n) : nothing;
      };
    };
  };
  var toNumber = function(n) {
    return n;
  };
  var fromStringAsImpl = function(just) {
    return function(nothing) {
      return function(radix) {
        var digits;
        if (radix < 11) {
          digits = "[0-" + (radix - 1).toString() + "]";
        } else if (radix === 11) {
          digits = "[0-9a]";
        } else {
          digits = "[0-9a-" + String.fromCharCode(86 + radix) + "]";
        }
        var pattern2 = new RegExp("^[\\+\\-]?" + digits + "+$", "i");
        return function(s) {
          if (pattern2.test(s)) {
            var i2 = parseInt(s, radix);
            return (i2 | 0) === i2 ? just(i2) : nothing;
          } else {
            return nothing;
          }
        };
      };
    };
  };

  // output/Data.Number/foreign.js
  var infinity = Infinity;
  var isFiniteImpl = isFinite;
  function fromStringImpl(str2, isFinite2, just, nothing) {
    var num = parseFloat(str2);
    if (isFinite2(num)) {
      return just(num);
    } else {
      return nothing;
    }
  }
  var abs = Math.abs;
  var atan2 = function(y48) {
    return function(x47) {
      return Math.atan2(y48, x47);
    };
  };
  var ceil = Math.ceil;
  var cos = Math.cos;
  var floor = Math.floor;
  var log = Math.log;
  var pow = function(n) {
    return function(p2) {
      return Math.pow(n, p2);
    };
  };
  var remainder = function(n) {
    return function(m) {
      return n % m;
    };
  };
  var sin = Math.sin;
  var sqrt = Math.sqrt;

  // output/Data.Number/index.js
  var pi = 3.141592653589793;
  var fromString = function(str2) {
    return fromStringImpl(str2, isFiniteImpl, Just.create, Nothing.value);
  };

  // output/Data.Int/index.js
  var top2 = /* @__PURE__ */ top(boundedInt);
  var bottom2 = /* @__PURE__ */ bottom(boundedInt);
  var fromStringAs = /* @__PURE__ */ (function() {
    return fromStringAsImpl(Just.create)(Nothing.value);
  })();
  var fromString2 = /* @__PURE__ */ fromStringAs(10);
  var fromNumber = /* @__PURE__ */ (function() {
    return fromNumberImpl(Just.create)(Nothing.value);
  })();
  var unsafeClamp = function(x47) {
    if (!isFiniteImpl(x47)) {
      return 0;
    }
    ;
    if (x47 >= toNumber(top2)) {
      return top2;
    }
    ;
    if (x47 <= toNumber(bottom2)) {
      return bottom2;
    }
    ;
    if (otherwise) {
      return fromMaybe(0)(fromNumber(x47));
    }
    ;
    throw new Error("Failed pattern match at Data.Int (line 72, column 1 - line 72, column 29): " + [x47.constructor.name]);
  };
  var floor2 = function($39) {
    return unsafeClamp(floor($39));
  };

  // output/Data.String.CodeUnits/foreign.js
  var fromCharArray = function(a2) {
    return a2.join("");
  };
  var toCharArray = function(s) {
    return s.split("");
  };
  var singleton7 = function(c) {
    return c;
  };
  var length3 = function(s) {
    return s.length;
  };
  var _indexOf = function(just) {
    return function(nothing) {
      return function(x47) {
        return function(s) {
          var i2 = s.indexOf(x47);
          return i2 === -1 ? nothing : just(i2);
        };
      };
    };
  };
  var take3 = function(n) {
    return function(s) {
      return s.substr(0, n);
    };
  };
  var drop3 = function(n) {
    return function(s) {
      return s.substring(n);
    };
  };
  var splitAt = function(i2) {
    return function(s) {
      return { before: s.substring(0, i2), after: s.substring(i2) };
    };
  };

  // output/Data.String.Unsafe/foreign.js
  var charAt = function(i2) {
    return function(s) {
      if (i2 >= 0 && i2 < s.length) return s.charAt(i2);
      throw new Error("Data.String.Unsafe.charAt: Invalid index.");
    };
  };

  // output/Data.String.CodeUnits/index.js
  var stripPrefix = function(v) {
    return function(str2) {
      var v1 = splitAt(length3(v))(str2);
      var $20 = v1.before === v;
      if ($20) {
        return new Just(v1.after);
      }
      ;
      return Nothing.value;
    };
  };
  var indexOf = /* @__PURE__ */ (function() {
    return _indexOf(Just.create)(Nothing.value);
  })();
  var contains = function(pat) {
    var $23 = indexOf(pat);
    return function($24) {
      return isJust($23($24));
    };
  };

  // output/Foreign/index.js
  var show2 = /* @__PURE__ */ show(showString);
  var show1 = /* @__PURE__ */ show(showInt);
  var ForeignError = /* @__PURE__ */ (function() {
    function ForeignError2(value0) {
      this.value0 = value0;
    }
    ;
    ForeignError2.create = function(value0) {
      return new ForeignError2(value0);
    };
    return ForeignError2;
  })();
  var TypeMismatch = /* @__PURE__ */ (function() {
    function TypeMismatch2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    TypeMismatch2.create = function(value0) {
      return function(value1) {
        return new TypeMismatch2(value0, value1);
      };
    };
    return TypeMismatch2;
  })();
  var ErrorAtIndex = /* @__PURE__ */ (function() {
    function ErrorAtIndex2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    ErrorAtIndex2.create = function(value0) {
      return function(value1) {
        return new ErrorAtIndex2(value0, value1);
      };
    };
    return ErrorAtIndex2;
  })();
  var ErrorAtProperty = /* @__PURE__ */ (function() {
    function ErrorAtProperty2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    ErrorAtProperty2.create = function(value0) {
      return function(value1) {
        return new ErrorAtProperty2(value0, value1);
      };
    };
    return ErrorAtProperty2;
  })();
  var unsafeToForeign = unsafeCoerce2;
  var unsafeFromForeign = unsafeCoerce2;
  var renderForeignError = function(v) {
    if (v instanceof ForeignError) {
      return v.value0;
    }
    ;
    if (v instanceof ErrorAtIndex) {
      return "Error at array index " + (show1(v.value0) + (": " + renderForeignError(v.value1)));
    }
    ;
    if (v instanceof ErrorAtProperty) {
      return "Error at property " + (show2(v.value0) + (": " + renderForeignError(v.value1)));
    }
    ;
    if (v instanceof TypeMismatch) {
      return "Type mismatch: expected " + (v.value0 + (", found " + v.value1));
    }
    ;
    throw new Error("Failed pattern match at Foreign (line 78, column 1 - line 78, column 45): " + [v.constructor.name]);
  };
  var fail = function(dictMonad) {
    var $153 = throwError(monadThrowExceptT(dictMonad));
    return function($154) {
      return $153(singleton6($154));
    };
  };
  var unsafeReadTagged = function(dictMonad) {
    var pure128 = pure(applicativeExceptT(dictMonad));
    var fail1 = fail(dictMonad);
    return function(tag) {
      return function(value18) {
        if (tagOf(value18) === tag) {
          return pure128(unsafeFromForeign(value18));
        }
        ;
        if (otherwise) {
          return fail1(new TypeMismatch(tag, tagOf(value18)));
        }
        ;
        throw new Error("Failed pattern match at Foreign (line 123, column 1 - line 123, column 104): " + [tag.constructor.name, value18.constructor.name]);
      };
    };
  };
  var readBoolean = function(dictMonad) {
    return unsafeReadTagged(dictMonad)("Boolean");
  };
  var readString = function(dictMonad) {
    return unsafeReadTagged(dictMonad)("String");
  };

  // output/Affjax/index.js
  var pure3 = /* @__PURE__ */ pure(/* @__PURE__ */ applicativeExceptT(monadIdentity));
  var fail2 = /* @__PURE__ */ fail(monadIdentity);
  var unsafeReadTagged2 = /* @__PURE__ */ unsafeReadTagged(monadIdentity);
  var alt2 = /* @__PURE__ */ alt(/* @__PURE__ */ altExceptT(semigroupNonEmptyList)(monadIdentity));
  var composeKleisliFlipped2 = /* @__PURE__ */ composeKleisliFlipped(/* @__PURE__ */ bindExceptT(monadIdentity));
  var map13 = /* @__PURE__ */ map(functorMaybe);
  var any3 = /* @__PURE__ */ any(foldableArray)(heytingAlgebraBoolean);
  var eq3 = /* @__PURE__ */ eq(eqString);
  var bindFlipped4 = /* @__PURE__ */ bindFlipped(bindMaybe);
  var map14 = /* @__PURE__ */ map(functorArray);
  var mapFlipped2 = /* @__PURE__ */ mapFlipped(functorAff);
  var $$try3 = /* @__PURE__ */ $$try(monadErrorAff);
  var pure1 = /* @__PURE__ */ pure(applicativeAff);
  var RequestContentError = /* @__PURE__ */ (function() {
    function RequestContentError2(value0) {
      this.value0 = value0;
    }
    ;
    RequestContentError2.create = function(value0) {
      return new RequestContentError2(value0);
    };
    return RequestContentError2;
  })();
  var ResponseBodyError = /* @__PURE__ */ (function() {
    function ResponseBodyError2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    ResponseBodyError2.create = function(value0) {
      return function(value1) {
        return new ResponseBodyError2(value0, value1);
      };
    };
    return ResponseBodyError2;
  })();
  var TimeoutError = /* @__PURE__ */ (function() {
    function TimeoutError2() {
    }
    ;
    TimeoutError2.value = new TimeoutError2();
    return TimeoutError2;
  })();
  var RequestFailedError = /* @__PURE__ */ (function() {
    function RequestFailedError2() {
    }
    ;
    RequestFailedError2.value = new RequestFailedError2();
    return RequestFailedError2;
  })();
  var XHROtherError = /* @__PURE__ */ (function() {
    function XHROtherError2(value0) {
      this.value0 = value0;
    }
    ;
    XHROtherError2.create = function(value0) {
      return new XHROtherError2(value0);
    };
    return XHROtherError2;
  })();
  var request = function(driver2) {
    return function(req2) {
      var parseJSON = function(v2) {
        if (v2 === "") {
          return pure3(jsonEmptyObject);
        }
        ;
        return either(function($74) {
          return fail2(ForeignError.create($74));
        })(pure3)(jsonParser(v2));
      };
      var fromResponse = (function() {
        if (req2.responseFormat instanceof $$ArrayBuffer) {
          return unsafeReadTagged2("ArrayBuffer");
        }
        ;
        if (req2.responseFormat instanceof Blob2) {
          return unsafeReadTagged2("Blob");
        }
        ;
        if (req2.responseFormat instanceof Document2) {
          return function(x47) {
            return alt2(unsafeReadTagged2("Document")(x47))(alt2(unsafeReadTagged2("XMLDocument")(x47))(unsafeReadTagged2("HTMLDocument")(x47)));
          };
        }
        ;
        if (req2.responseFormat instanceof Json2) {
          return composeKleisliFlipped2(function($75) {
            return req2.responseFormat.value0(parseJSON($75));
          })(unsafeReadTagged2("String"));
        }
        ;
        if (req2.responseFormat instanceof $$String2) {
          return unsafeReadTagged2("String");
        }
        ;
        if (req2.responseFormat instanceof Ignore) {
          return $$const(req2.responseFormat.value0(pure3(unit)));
        }
        ;
        throw new Error("Failed pattern match at Affjax (line 274, column 18 - line 283, column 57): " + [req2.responseFormat.constructor.name]);
      })();
      var extractContent = function(v2) {
        if (v2 instanceof ArrayView) {
          return new Right(v2.value0(unsafeToForeign));
        }
        ;
        if (v2 instanceof Blob) {
          return new Right(unsafeToForeign(v2.value0));
        }
        ;
        if (v2 instanceof Document) {
          return new Right(unsafeToForeign(v2.value0));
        }
        ;
        if (v2 instanceof $$String) {
          return new Right(unsafeToForeign(v2.value0));
        }
        ;
        if (v2 instanceof FormData) {
          return new Right(unsafeToForeign(v2.value0));
        }
        ;
        if (v2 instanceof FormURLEncoded) {
          return note("Body contains values that cannot be encoded as application/x-www-form-urlencoded")(map13(unsafeToForeign)(encode(v2.value0)));
        }
        ;
        if (v2 instanceof Json) {
          return new Right(unsafeToForeign(stringify(v2.value0)));
        }
        ;
        throw new Error("Failed pattern match at Affjax (line 235, column 20 - line 250, column 69): " + [v2.constructor.name]);
      };
      var addHeader = function(mh) {
        return function(hs) {
          if (mh instanceof Just && !any3(on(eq3)(name)(mh.value0))(hs)) {
            return snoc(hs)(mh.value0);
          }
          ;
          return hs;
        };
      };
      var headers = function(reqContent) {
        return addHeader(map13(ContentType.create)(bindFlipped4(toMediaType)(reqContent)))(addHeader(map13(Accept.create)(toMediaType2(req2.responseFormat)))(req2.headers));
      };
      var ajaxRequest = function(v2) {
        return {
          method: print(req2.method),
          url: req2.url,
          headers: map14(function(h) {
            return {
              field: name(h),
              value: value(h)
            };
          })(headers(req2.content)),
          content: v2,
          responseType: toResponseType(req2.responseFormat),
          username: toNullable(req2.username),
          password: toNullable(req2.password),
          withCredentials: req2.withCredentials,
          timeout: fromMaybe(0)(map13(function(v1) {
            return v1;
          })(req2.timeout))
        };
      };
      var send = function(content3) {
        return mapFlipped2($$try3(fromEffectFnAff(_ajax(driver2, "AffjaxTimeoutErrorMessageIdent", "AffjaxRequestFailedMessageIdent", ResponseHeader.create, ajaxRequest(content3)))))(function(v2) {
          if (v2 instanceof Right) {
            var v1 = runExcept(fromResponse(v2.value0.body));
            if (v1 instanceof Left) {
              return new Left(new ResponseBodyError(head2(v1.value0), v2.value0));
            }
            ;
            if (v1 instanceof Right) {
              return new Right({
                headers: v2.value0.headers,
                status: v2.value0.status,
                statusText: v2.value0.statusText,
                body: v1.value0
              });
            }
            ;
            throw new Error("Failed pattern match at Affjax (line 209, column 9 - line 211, column 52): " + [v1.constructor.name]);
          }
          ;
          if (v2 instanceof Left) {
            return new Left((function() {
              var message2 = message(v2.value0);
              var $61 = message2 === "AffjaxTimeoutErrorMessageIdent";
              if ($61) {
                return TimeoutError.value;
              }
              ;
              var $62 = message2 === "AffjaxRequestFailedMessageIdent";
              if ($62) {
                return RequestFailedError.value;
              }
              ;
              return new XHROtherError(v2.value0);
            })());
          }
          ;
          throw new Error("Failed pattern match at Affjax (line 207, column 144 - line 219, column 28): " + [v2.constructor.name]);
        });
      };
      if (req2.content instanceof Nothing) {
        return send(toNullable(Nothing.value));
      }
      ;
      if (req2.content instanceof Just) {
        var v = extractContent(req2.content.value0);
        if (v instanceof Right) {
          return send(toNullable(new Just(v.value0)));
        }
        ;
        if (v instanceof Left) {
          return pure1(new Left(new RequestContentError(v.value0)));
        }
        ;
        throw new Error("Failed pattern match at Affjax (line 199, column 7 - line 203, column 48): " + [v.constructor.name]);
      }
      ;
      throw new Error("Failed pattern match at Affjax (line 195, column 3 - line 203, column 48): " + [req2.content.constructor.name]);
    };
  };
  var printError = function(v) {
    if (v instanceof RequestContentError) {
      return "There was a problem with the request content: " + v.value0;
    }
    ;
    if (v instanceof ResponseBodyError) {
      return "There was a problem with the response body: " + renderForeignError(v.value0);
    }
    ;
    if (v instanceof TimeoutError) {
      return "There was a problem making the request: timeout";
    }
    ;
    if (v instanceof RequestFailedError) {
      return "There was a problem making the request: request failed";
    }
    ;
    if (v instanceof XHROtherError) {
      return "There was a problem making the request: " + message(v.value0);
    }
    ;
    throw new Error("Failed pattern match at Affjax (line 113, column 14 - line 123, column 66): " + [v.constructor.name]);
  };
  var defaultRequest = /* @__PURE__ */ (function() {
    return {
      method: new Left(GET.value),
      url: "/",
      headers: [],
      content: Nothing.value,
      username: Nothing.value,
      password: Nothing.value,
      withCredentials: false,
      responseFormat: ignore,
      timeout: Nothing.value
    };
  })();
  var get2 = function(driver2) {
    return function(rf) {
      return function(u2) {
        return request(driver2)({
          method: defaultRequest.method,
          headers: defaultRequest.headers,
          content: defaultRequest.content,
          username: defaultRequest.username,
          password: defaultRequest.password,
          withCredentials: defaultRequest.withCredentials,
          timeout: defaultRequest.timeout,
          url: u2,
          responseFormat: rf
        });
      };
    };
  };

  // output/Affjax.Web/foreign.js
  var driver = {
    newXHR: function() {
      return new XMLHttpRequest();
    },
    fixupUrl: function(url2) {
      return url2 || "/";
    }
  };

  // output/Affjax.Web/index.js
  var get3 = /* @__PURE__ */ get2(driver);

  // output/Data.Tree/index.js
  var map15 = /* @__PURE__ */ map(functorList);
  var foldr4 = /* @__PURE__ */ foldr(foldableList);
  var foldl5 = /* @__PURE__ */ foldl(foldableList);
  var foldMap2 = /* @__PURE__ */ foldMap(foldableList);
  var Node = /* @__PURE__ */ (function() {
    function Node4(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Node4.create = function(value0) {
      return function(value1) {
        return new Node4(value0, value1);
      };
    };
    return Node4;
  })();
  var functorTree = {
    map: function(f) {
      return function(v) {
        return new Node(f(v.value0), map15(map(functorTree)(f))(v.value1));
      };
    }
  };
  var foldableTree = {
    foldr: function(f) {
      return function(b10) {
        return function(v) {
          return f(v.value0)(foldr4(flip(foldr(foldableTree)(f)))(b10)(v.value1));
        };
      };
    },
    foldl: function(f) {
      return function(b10) {
        return function(v) {
          return f(foldl5(foldl(foldableTree)(f))(b10)(v.value1))(v.value0);
        };
      };
    },
    foldMap: function(dictMonoid) {
      var append127 = append(dictMonoid.Semigroup0());
      var foldMap12 = foldMap2(dictMonoid);
      return function(f) {
        return function(v) {
          return append127(f(v.value0))(foldMap12(foldMap(foldableTree)(dictMonoid)(f))(v.value1));
        };
      };
    }
  };

  // output/PSD3.Capabilities.Selection/index.js
  var updateJoin = function(dict) {
    return dict.updateJoin;
  };
  var setAttributes = function(dict) {
    return dict.setAttributes;
  };
  var openSelection = function(dict) {
    return dict.openSelection;
  };
  var attach = function(dict) {
    return dict.attach;
  };
  var appendTo = function(dict) {
    return dict.appendTo;
  };

  // output/PSD3.Internal.Attributes.Instances/index.js
  var Static = /* @__PURE__ */ (function() {
    function Static2(value0) {
      this.value0 = value0;
    }
    ;
    Static2.create = function(value0) {
      return new Static2(value0);
    };
    return Static2;
  })();
  var Fn = /* @__PURE__ */ (function() {
    function Fn2(value0) {
      this.value0 = value0;
    }
    ;
    Fn2.create = function(value0) {
      return new Fn2(value0);
    };
    return Fn2;
  })();
  var FnI = /* @__PURE__ */ (function() {
    function FnI2(value0) {
      this.value0 = value0;
    }
    ;
    FnI2.create = function(value0) {
      return new FnI2(value0);
    };
    return FnI2;
  })();
  var StringAttr = /* @__PURE__ */ (function() {
    function StringAttr2(value0) {
      this.value0 = value0;
    }
    ;
    StringAttr2.create = function(value0) {
      return new StringAttr2(value0);
    };
    return StringAttr2;
  })();
  var NumberAttr = /* @__PURE__ */ (function() {
    function NumberAttr2(value0) {
      this.value0 = value0;
    }
    ;
    NumberAttr2.create = function(value0) {
      return new NumberAttr2(value0);
    };
    return NumberAttr2;
  })();
  var ArrayAttr = /* @__PURE__ */ (function() {
    function ArrayAttr2(value0) {
      this.value0 = value0;
    }
    ;
    ArrayAttr2.create = function(value0) {
      return new ArrayAttr2(value0);
    };
    return ArrayAttr2;
  })();
  var AttributeSetter = /* @__PURE__ */ (function() {
    function AttributeSetter2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    AttributeSetter2.create = function(value0) {
      return function(value1) {
        return new AttributeSetter2(value0, value1);
      };
    };
    return AttributeSetter2;
  })();
  var unboxAttr = function(v) {
    if (v instanceof StringAttr && v.value0 instanceof Static) {
      return v.value0.value0;
    }
    ;
    if (v instanceof StringAttr && v.value0 instanceof Fn) {
      return v.value0.value0;
    }
    ;
    if (v instanceof StringAttr && v.value0 instanceof FnI) {
      return mkFn2(v.value0.value0);
    }
    ;
    if (v instanceof NumberAttr && v.value0 instanceof Static) {
      return v.value0.value0;
    }
    ;
    if (v instanceof NumberAttr && v.value0 instanceof Fn) {
      return v.value0.value0;
    }
    ;
    if (v instanceof NumberAttr && v.value0 instanceof FnI) {
      return mkFn2(v.value0.value0);
    }
    ;
    if (v instanceof ArrayAttr && v.value0 instanceof Static) {
      return v.value0.value0;
    }
    ;
    if (v instanceof ArrayAttr && v.value0 instanceof Fn) {
      return v.value0.value0;
    }
    ;
    if (v instanceof ArrayAttr && v.value0 instanceof FnI) {
      return mkFn2(v.value0.value0);
    }
    ;
    throw new Error("Failed pattern match at PSD3.Internal.Attributes.Instances (line 68, column 3 - line 79, column 54): " + [v.constructor.name]);
  };
  var toAttrStringFn = {
    toAttr: function($50) {
      return StringAttr.create(Fn.create($50));
    }
  };
  var toAttrString = {
    toAttr: function($51) {
      return StringAttr.create(Static.create($51));
    }
  };
  var toAttrNumberFnI = {
    toAttr: function($52) {
      return NumberAttr.create(FnI.create($52));
    }
  };
  var toAttrNumberFn = {
    toAttr: function($53) {
      return NumberAttr.create(Fn.create($53));
    }
  };
  var toAttrNumber = {
    toAttr: function($54) {
      return NumberAttr.create(Static.create($54));
    }
  };
  var toAttr = function(dict) {
    return dict.toAttr;
  };

  // output/PSD3.Internal.FFI/foreign.js
  function d3Append_(element3) {
    return (selection2) => {
      return selection2.append(element3);
    };
  }
  function d3DataWithKeyFunction_(data) {
    return (keyFn) => (selection2) => {
      return selection2.data(data, keyFn);
    };
  }
  function d3DataWithFunction_(extractFn) {
    return (keyFn) => (selection2) => {
      return selection2.data(extractFn, keyFn);
    };
  }
  function d3EnterAndAppend_(element3) {
    return (selection2) => {
      return selection2.enter().append(element3);
    };
  }
  function d3GetExitSelection_(selection2) {
    return selection2.exit();
  }
  function d3GetEnterSelection_(selection2) {
    return selection2.enter();
  }
  function d3FilterSelection_(selection2) {
    return (selector) => selection2.filter(selector);
  }
  function d3LowerSelection_(selection2) {
    return selection2.lower();
  }
  function d3MergeSelectionWith_(enter) {
    return (update7) => {
      return enter.merge(update7);
    };
  }
  function d3OrderSelection_(selection2) {
    return selection2.order();
  }
  function d3RaiseSelection_(selection2) {
    return selection2.raise();
  }
  function d3RemoveSelection_(selection2) {
    return selection2.remove();
  }
  function d3SelectAllInDOM_(selector) {
    return d3.selectAll(selector);
  }
  function d3SelectionSelectAll_(selector) {
    return (selection2) => {
      return selection2.selectAll(selector);
    };
  }
  function d3SetAttr_(name16) {
    return (value18) => (selection2) => {
      return selection2.attr(name16, value18);
    };
  }
  function d3SetHTML_(value18) {
    return (selection2) => {
      return selection2.html(value18);
    };
  }
  function d3SetProperty_(value18) {
    return (selection2) => {
      return selection2.property(value18);
    };
  }
  function d3SetText_(value18) {
    return (selection2) => {
      return selection2.text(value18);
    };
  }
  function d3SortSelection_(selection2) {
    return (compare26) => selection2.sort(compare26);
  }
  function selectionOn_(selection2) {
    return (event) => (callback) => {
      return selection2.on(event, callback);
    };
  }
  function d3AddTransition_(selection2) {
    return (transition2) => {
      var handle;
      if (transition2.name == "") {
        handle = selection2.transition();
        if (transition2.duration != 0) {
          handle.duration(transition2.duration);
        }
        if (transition2.delay != 0) {
          handle.delay(transition2.delay);
        }
      } else {
        handle = selection2.transition(transition2.name);
      }
      return handle;
    };
  }
  var linksForceName_ = "links";
  function forceCenter_() {
    return d3.forceCenter();
  }
  function forceCollideFn_() {
    return d3.forceCollide();
  }
  function forceLink_() {
    return d3.forceLink().id((d18) => d18.id);
  }
  function forceMany_() {
    return d3.forceManyBody();
  }
  function forceRadial_() {
    return d3.forceRadial();
  }
  function forceX_() {
    return d3.forceX();
  }
  function forceY_() {
    return d3.forceY();
  }
  function getNodes_(simulation) {
    return simulation.nodes();
  }
  function keyIsID_(d18) {
    return d18.id;
  }
  function swizzledLinkKey_(d18) {
    const sourceId = typeof d18.source === "object" ? d18.source.id : d18.source;
    const targetId = typeof d18.target === "object" ? d18.target.id : d18.target;
    const key = `${sourceId}->${targetId}`;
    if (!window._linkKeyDebugCount) window._linkKeyDebugCount = 0;
    if (window._linkKeyDebugCount < 5) {
      console.log(`swizzledLinkKey_: ${key} (source type: ${typeof d18.source}, target type: ${typeof d18.target})`);
      window._linkKeyDebugCount++;
    }
    return key;
  }
  function setAlpha_(simulation) {
    return (alpha) => {
      console.log(`FFI: setting simulation.alpha to ${alpha}`);
      simulation.alpha(alpha);
    };
  }
  function setAlphaDecay_(simulation) {
    return (alphaDecay) => simulation.alphaDecay(alphaDecay);
  }
  function setAlphaMin_(simulation) {
    return (alphaMin) => simulation.alphaMin(alphaMin);
  }
  function setAlphaTarget_(simulation) {
    return (alphaTarget) => simulation.alphaTarget(alphaTarget);
  }
  function setAsNullForceInSimulation_(simulation) {
    return (label5) => simulation.force(label5, null);
  }
  function setForceDistance_(force2) {
    return (attr3) => force2.distance(attr3);
  }
  function setForceDistanceMax_(force2) {
    return (attr3) => force2.distanceMax(attr3);
  }
  function setForceDistanceMin_(force2) {
    return (attr3) => force2.distanceMin(attr3);
  }
  function setForceIterations_(force2) {
    return (attr3) => force2.iterations(attr3);
  }
  function setForceRadius_(force2) {
    return (attr3) => force2.radius(attr3);
  }
  function setForceStrength_(force2) {
    return (attr3) => force2.strength(attr3);
  }
  function setForceTheta_(force2) {
    return (attr3) => force2.theta(attr3);
  }
  function setForceX_(force2) {
    return (attr3) => force2.x(attr3);
  }
  function setForceY_(force2) {
    return (attr3) => force2.y(attr3);
  }
  function setVelocityDecay_(simulation) {
    return (velocityDecay) => simulation.velocityDecay(velocityDecay);
  }
  function startSimulation_(simulation) {
    console.log(`FFI: restarting the simulation, alpha before: ${simulation.alpha()}`);
    simulation.alpha(1).restart();
    console.log(`FFI: restarted simulation, alpha after: ${simulation.alpha()}`);
  }
  function stopSimulation_(simulation) {
    return simulation.stop();
  }
  function initSimulation_(config) {
    return (keyFn) => {
      const simulation = d3.forceSimulation([]).force(linksForceName_, d3.forceLink([]).id(keyFn)).alpha(config.alpha).alphaTarget(config.alphaTarget).alphaMin(config.alphaMin).alphaDecay(config.alphaDecay).velocityDecay(config.velocityDecay);
      if (true) {
        console.log(`FFI: initSimulation${simulation}`);
      }
      return simulation;
    };
  }
  function readSimulationVariables_(simulation) {
    return {
      alpha: simulation.alpha(),
      alphaTarget: simulation.alphaTarget(),
      alphaMin: simulation.alphaMin(),
      alphaDecay: simulation.alphaDecay(),
      velocityDecay: simulation.velocityDecay()
    };
  }
  function getIDsFromNodes_(nodes) {
    return (keyFn) => {
      const keys4 = [];
      for (let i2 = 0; i2 < nodes.length; i2++) {
        keys4[i2] = keyFn(nodes[i2]);
      }
      return keys4;
    };
  }
  function setNodes_(simulation) {
    return (nodes) => {
      console.log(`FFI: setting nodes in simulation, there are ${nodes.length} nodes`);
      const oldNodes = simulation.nodes();
      const oldNodeMap = new Map(oldNodes.map((d18) => [d18.id, d18]));
      const nodesWithPositions = nodes.map((newNode) => {
        const oldNode = oldNodeMap.get(newNode.id);
        if (oldNode) {
          return Object.assign({}, newNode, {
            x: oldNode.x,
            y: oldNode.y,
            vx: oldNode.vx,
            vy: oldNode.vy,
            // Only override fx/fy if new node has them explicitly set
            fx: newNode.fx !== void 0 ? newNode.fx : oldNode.fx,
            fy: newNode.fy !== void 0 ? newNode.fy : oldNode.fy
          });
        }
        return newNode;
      });
      simulation.nodes(nodesWithPositions);
      return simulation.nodes();
    };
  }
  function setLinks_(simulation) {
    return (links) => {
      console.log(`FFI: setting links in simulation, there are ${links.length} links`);
      const linkForce = simulation.force(linksForceName_);
      if (linkForce) {
        linkForce.links(links);
      } else {
        console.log(`FFI: links force not found (may be disabled), skipping setLinks`);
      }
    };
  }
  function swizzleLinks_(links) {
    return (simNodes) => (keyFn) => {
      console.log(`FFI: swizzling links in simulation, there are ${links.length} links`);
      const nodeById = new Map(simNodes.map((d18) => [keyFn(d18), d18]));
      const swizzledLinks = links.map((link4) => ({
        source: link4.source,
        target: link4.target,
        ...link4
      })).filter((link4, index5, arr) => {
        if (typeof link4.source !== "object") {
          link4.source = nodeById.get(link4.source);
        } else {
          link4.source = nodeById.get(keyFn(link4.source));
        }
        if (typeof link4.target !== "object") {
          link4.target = nodeById.get(link4.target);
        } else {
          link4.target = nodeById.get(keyFn(link4.target));
        }
        if (typeof link4.source === "undefined" || link4.target === "undefined") {
          return false;
        } else {
          link4.id = keyFn(link4.source) + "-" + keyFn(link4.target);
          return true;
        }
      });
      return swizzledLinks;
    };
  }
  function getLinkIDs_(link4) {
    return { sourceID: link4.source, targetID: link4.target };
  }
  function getLinksFromSimulation_(simulation) {
    linksForce = simulation.force(linksForceName_);
    if (typeof linksForce === `undefined`) {
      return [];
    }
    const result = linksForce.links();
    if (typeof result === `undefined`) {
      return [];
    }
    return result;
  }
  function onTick_(simulation) {
    return (name16) => (tickFn) => {
      var result = simulation.on("tick." + name16, () => {
        tickFn();
      });
      return result;
    };
  }
  function putForceInSimulation_(simulation) {
    return (label5) => (force2) => {
      simulation.force(label5, force2);
    };
  }
  var linkHorizontal_ = d3.linkHorizontal().x((d18) => d18.y).y((d18) => d18.x);
  var linkHorizontal2_ = d3.linkHorizontal().x((d18) => d18.x).y((d18) => d18.y);
  var linkVertical_ = d3.linkVertical().x((d18) => d18.x).y((d18) => d18.y);
  function chordLayoutWithPadAngle_(matrix) {
    return (padAngle) => d3.chord().padAngle(padAngle)(matrix);
  }
  function chordGroups_(chordLayout) {
    return chordLayout.groups;
  }
  function chordArray_(chordLayout) {
    return Array.from(chordLayout);
  }
  function ribbonGenerator_() {
    return d3.ribbon();
  }
  function arcGenerator_() {
    return d3.arc();
  }
  function ribbonPath_(generator) {
    return (chord) => generator(chord);
  }
  function arcPath_(generator) {
    return (group4) => generator(group4);
  }
  function setRibbonRadius_(generator) {
    return (radius39) => {
      generator.radius(radius39);
      return generator;
    };
  }
  function setArcInnerRadius_(generator) {
    return (radius39) => {
      generator.innerRadius(radius39);
      return generator;
    };
  }
  function setArcOuterRadius_(generator) {
    return (radius39) => {
      generator.outerRadius(radius39);
      return generator;
    };
  }
  function d3AttachZoomDefaultExtent_(selection2) {
    return (config) => {
      function zoomed({ transform: transform20 }) {
        config.target.attr("transform", transform20);
      }
      return selection2.call(
        d3.zoom().scaleExtent(config.scaleExtent).on(`zoom.${config.name}`, zoomed)
      );
    };
  }
  function d3AttachZoom_(selection2) {
    return (config) => {
      selection2.call(
        d3.zoom().extent(config.extent).scaleExtent(config.scaleExtent).on(`zoom.${config.name}`, (event) => {
          config.target.attr("transform", event.transform);
        })
      );
      return selection2;
    };
  }

  // output/PSD3.Internal.Types/index.js
  var compare3 = /* @__PURE__ */ compare(ordInt);
  var MouseEnter = /* @__PURE__ */ (function() {
    function MouseEnter3() {
    }
    ;
    MouseEnter3.value = new MouseEnter3();
    return MouseEnter3;
  })();
  var MouseLeave = /* @__PURE__ */ (function() {
    function MouseLeave3() {
    }
    ;
    MouseLeave3.value = new MouseLeave3();
    return MouseLeave3;
  })();
  var MouseClick = /* @__PURE__ */ (function() {
    function MouseClick2() {
    }
    ;
    MouseClick2.value = new MouseClick2();
    return MouseClick2;
  })();
  var MouseDown = /* @__PURE__ */ (function() {
    function MouseDown2() {
    }
    ;
    MouseDown2.value = new MouseDown2();
    return MouseDown2;
  })();
  var MouseUp = /* @__PURE__ */ (function() {
    function MouseUp2() {
    }
    ;
    MouseUp2.value = new MouseUp2();
    return MouseUp2;
  })();
  var Div = /* @__PURE__ */ (function() {
    function Div3() {
    }
    ;
    Div3.value = new Div3();
    return Div3;
  })();
  var Svg = /* @__PURE__ */ (function() {
    function Svg2() {
    }
    ;
    Svg2.value = new Svg2();
    return Svg2;
  })();
  var Circle = /* @__PURE__ */ (function() {
    function Circle4() {
    }
    ;
    Circle4.value = new Circle4();
    return Circle4;
  })();
  var Line = /* @__PURE__ */ (function() {
    function Line3() {
    }
    ;
    Line3.value = new Line3();
    return Line3;
  })();
  var Group = /* @__PURE__ */ (function() {
    function Group3() {
    }
    ;
    Group3.value = new Group3();
    return Group3;
  })();
  var Text = /* @__PURE__ */ (function() {
    function Text4() {
    }
    ;
    Text4.value = new Text4();
    return Text4;
  })();
  var Path = /* @__PURE__ */ (function() {
    function Path5() {
    }
    ;
    Path5.value = new Path5();
    return Path5;
  })();
  var Rect = /* @__PURE__ */ (function() {
    function Rect3() {
    }
    ;
    Rect3.value = new Rect3();
    return Rect3;
  })();
  var Title = /* @__PURE__ */ (function() {
    function Title2() {
    }
    ;
    Title2.value = new Title2();
    return Title2;
  })();
  var Span = /* @__PURE__ */ (function() {
    function Span3() {
    }
    ;
    Span3.value = new Span3();
    return Span3;
  })();
  var Table = /* @__PURE__ */ (function() {
    function Table3() {
    }
    ;
    Table3.value = new Table3();
    return Table3;
  })();
  var Tr = /* @__PURE__ */ (function() {
    function Tr3() {
    }
    ;
    Tr3.value = new Tr3();
    return Tr3;
  })();
  var Td = /* @__PURE__ */ (function() {
    function Td3() {
    }
    ;
    Td3.value = new Td3();
    return Td3;
  })();
  var DefaultCubic = /* @__PURE__ */ (function() {
    function DefaultCubic2() {
    }
    ;
    DefaultCubic2.value = new DefaultCubic2();
    return DefaultCubic2;
  })();
  var showMouseEvent = {
    show: function(v) {
      if (v instanceof MouseEnter) {
        return "mouseenter";
      }
      ;
      if (v instanceof MouseLeave) {
        return "mouseleave";
      }
      ;
      if (v instanceof MouseClick) {
        return "click";
      }
      ;
      if (v instanceof MouseDown) {
        return "mousedown";
      }
      ;
      if (v instanceof MouseUp) {
        return "mouseup";
      }
      ;
      throw new Error("Failed pattern match at PSD3.Internal.Types (line 63, column 1 - line 68, column 30): " + [v.constructor.name]);
    }
  };
  var showElement = {
    show: function(v) {
      if (v instanceof Div) {
        return "div";
      }
      ;
      if (v instanceof Svg) {
        return "svg";
      }
      ;
      if (v instanceof Circle) {
        return "circle";
      }
      ;
      if (v instanceof Line) {
        return "line";
      }
      ;
      if (v instanceof Group) {
        return "g";
      }
      ;
      if (v instanceof Text) {
        return "text";
      }
      ;
      if (v instanceof Path) {
        return "path";
      }
      ;
      if (v instanceof Rect) {
        return "rect";
      }
      ;
      if (v instanceof Title) {
        return "title";
      }
      ;
      if (v instanceof Span) {
        return "span";
      }
      ;
      if (v instanceof Table) {
        return "table";
      }
      ;
      if (v instanceof Tr) {
        return "tr";
      }
      ;
      if (v instanceof Td) {
        return "td";
      }
      ;
      throw new Error("Failed pattern match at PSD3.Internal.Types (line 37, column 1 - line 50, column 21): " + [v.constructor.name]);
    }
  };
  var index_ToInt = unsafeCoerce2;
  var eqIndex_ = {
    eq: function(a2) {
      return function(b10) {
        return index_ToInt(a2) === index_ToInt(b10);
      };
    }
  };
  var ordIndex_ = {
    compare: function(a2) {
      return function(b10) {
        return compare3(index_ToInt(a2))(index_ToInt(b10));
      };
    },
    Eq0: function() {
      return eqIndex_;
    }
  };

  // output/PSD3.Internal.Zoom/index.js
  var DefaultZoomExtent = /* @__PURE__ */ (function() {
    function DefaultZoomExtent2() {
    }
    ;
    DefaultZoomExtent2.value = new DefaultZoomExtent2();
    return DefaultZoomExtent2;
  })();
  var ZoomExtent = /* @__PURE__ */ (function() {
    function ZoomExtent2(value0) {
      this.value0 = value0;
    }
    ;
    ZoomExtent2.create = function(value0) {
      return new ZoomExtent2(value0);
    };
    return ZoomExtent2;
  })();

  // output/PSD3.Internal.Selection.Types/index.js
  var show3 = /* @__PURE__ */ show(showMouseEvent);
  var Order = /* @__PURE__ */ (function() {
    function Order2() {
    }
    ;
    Order2.value = new Order2();
    return Order2;
  })();
  var Sort = /* @__PURE__ */ (function() {
    function Sort2(value0) {
      this.value0 = value0;
    }
    ;
    Sort2.create = function(value0) {
      return new Sort2(value0);
    };
    return Sort2;
  })();
  var Raise = /* @__PURE__ */ (function() {
    function Raise3() {
    }
    ;
    Raise3.value = new Raise3();
    return Raise3;
  })();
  var Lower = /* @__PURE__ */ (function() {
    function Lower2() {
    }
    ;
    Lower2.value = new Lower2();
    return Lower2;
  })();
  var AttrT = /* @__PURE__ */ (function() {
    function AttrT2(value0) {
      this.value0 = value0;
    }
    ;
    AttrT2.create = function(value0) {
      return new AttrT2(value0);
    };
    return AttrT2;
  })();
  var TextT = /* @__PURE__ */ (function() {
    function TextT2(value0) {
      this.value0 = value0;
    }
    ;
    TextT2.create = function(value0) {
      return new TextT2(value0);
    };
    return TextT2;
  })();
  var HTMLT = /* @__PURE__ */ (function() {
    function HTMLT2(value0) {
      this.value0 = value0;
    }
    ;
    HTMLT2.create = function(value0) {
      return new HTMLT2(value0);
    };
    return HTMLT2;
  })();
  var PropertyT = /* @__PURE__ */ (function() {
    function PropertyT2(value0) {
      this.value0 = value0;
    }
    ;
    PropertyT2.create = function(value0) {
      return new PropertyT2(value0);
    };
    return PropertyT2;
  })();
  var OrderingT = /* @__PURE__ */ (function() {
    function OrderingT2(value0) {
      this.value0 = value0;
    }
    ;
    OrderingT2.create = function(value0) {
      return new OrderingT2(value0);
    };
    return OrderingT2;
  })();
  var TransitionT = /* @__PURE__ */ (function() {
    function TransitionT2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    TransitionT2.create = function(value0) {
      return function(value1) {
        return new TransitionT2(value0, value1);
      };
    };
    return TransitionT2;
  })();
  var RemoveT = /* @__PURE__ */ (function() {
    function RemoveT2() {
    }
    ;
    RemoveT2.value = new RemoveT2();
    return RemoveT2;
  })();
  var OnT = /* @__PURE__ */ (function() {
    function OnT2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    OnT2.create = function(value0) {
      return function(value1) {
        return new OnT2(value0, value1);
      };
    };
    return OnT2;
  })();
  var OnT$prime = /* @__PURE__ */ (function() {
    function OnT$prime2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    OnT$prime2.create = function(value0) {
      return function(value1) {
        return new OnT$prime2(value0, value1);
      };
    };
    return OnT$prime2;
  })();
  var Drag = /* @__PURE__ */ (function() {
    function Drag3(value0) {
      this.value0 = value0;
    }
    ;
    Drag3.create = function(value0) {
      return new Drag3(value0);
    };
    return Drag3;
  })();
  var Zoom = /* @__PURE__ */ (function() {
    function Zoom3(value0) {
      this.value0 = value0;
    }
    ;
    Zoom3.create = function(value0) {
      return new Zoom3(value0);
    };
    return Zoom3;
  })();
  var applySelectionAttributeD3 = function(v) {
    return function(v1) {
      if (v1 instanceof AttrT) {
        return d3SetAttr_(v1.value0.value0)(unboxAttr(v1.value0.value1))(v);
      }
      ;
      if (v1 instanceof TextT) {
        return d3SetText_(unboxAttr(v1.value0.value1))(v);
      }
      ;
      if (v1 instanceof PropertyT) {
        return d3SetProperty_(unboxAttr(v1.value0.value1))(v);
      }
      ;
      if (v1 instanceof HTMLT) {
        return d3SetHTML_(unboxAttr(v1.value0.value1))(v);
      }
      ;
      if (v1 instanceof RemoveT) {
        var removed_ = d3RemoveSelection_(v);
        return removed_;
      }
      ;
      if (v1 instanceof TransitionT) {
        var tHandler = d3AddTransition_(v)(v1.value1);
        var v2 = foldl2(applySelectionAttributeD3)(tHandler)(v1.value0);
        return v;
      }
      ;
      if (v1 instanceof OnT) {
        return selectionOn_(v)(show3(v1.value0))(v1.value1);
      }
      ;
      if (v1 instanceof OnT$prime) {
        return selectionOn_(v)(show3(v1.value0))(v1.value1);
      }
      ;
      if (v1 instanceof OrderingT) {
        if (v1.value0 instanceof Order) {
          return d3OrderSelection_(v);
        }
        ;
        if (v1.value0 instanceof Sort) {
          return d3SortSelection_(v)(v1.value0.value0);
        }
        ;
        if (v1.value0 instanceof Raise) {
          return d3RaiseSelection_(v);
        }
        ;
        if (v1.value0 instanceof Lower) {
          return d3LowerSelection_(v);
        }
        ;
        throw new Error("Failed pattern match at PSD3.Internal.Selection.Types (line 118, column 3 - line 122, column 51): " + [v1.value0.constructor.name]);
      }
      ;
      throw new Error("Failed pattern match at PSD3.Internal.Selection.Types (line 88, column 1 - line 88, column 96): " + [v.constructor.name, v1.constructor.name]);
    };
  };

  // output/PSD3.Internal.Attributes.Sugar/index.js
  var toAttr2 = /* @__PURE__ */ toAttr(toAttrString);
  var intercalate3 = /* @__PURE__ */ intercalate2(monoidString);
  var map16 = /* @__PURE__ */ map(functorArray);
  var show4 = /* @__PURE__ */ show(showNumber);
  var append12 = /* @__PURE__ */ append(semigroupArray);
  var y = function(dictToAttr) {
    var $115 = AttributeSetter.create("y");
    var $116 = toAttr(dictToAttr);
    return function($117) {
      return AttrT.create($115($116($117)));
    };
  };
  var x = function(dictToAttr) {
    var $124 = AttributeSetter.create("x");
    var $125 = toAttr(dictToAttr);
    return function($126) {
      return AttrT.create($124($125($126)));
    };
  };
  var viewBox = function(xo) {
    return function(yo) {
      return function(w) {
        return function(h) {
          var vb = intercalate3(" ")(map16(show4)([xo, yo, w, h]));
          return AttrT.create(AttributeSetter.create("viewBox")(toAttr2(vb)));
        };
      };
    };
  };
  var to = function(v) {
    return function(v1) {
      if (v instanceof TransitionT && v.value0.length === 0) {
        return [new TransitionT(v1, v.value1)];
      }
      ;
      if (v instanceof TransitionT) {
        return [new TransitionT(append12(v.value0)(v1), v.value1)];
      }
      ;
      return cons(v)(v1);
    };
  };
  var text = function(dictToAttr) {
    var $135 = AttributeSetter.create("text");
    var $136 = toAttr(dictToAttr);
    return function($137) {
      return TextT.create($135($136($137)));
    };
  };
  var strokeWidth = function(dictToAttr) {
    var $138 = AttributeSetter.create("stroke-width");
    var $139 = toAttr(dictToAttr);
    return function($140) {
      return AttrT.create($138($139($140)));
    };
  };
  var strokeColor = function(dictToAttr) {
    var $144 = AttributeSetter.create("stroke");
    var $145 = toAttr(dictToAttr);
    return function($146) {
      return AttrT.create($144($145($146)));
    };
  };
  var remove = /* @__PURE__ */ (function() {
    return RemoveT.value;
  })();
  var radius = function(dictToAttr) {
    var $156 = AttributeSetter.create("r");
    var $157 = toAttr(dictToAttr);
    return function($158) {
      return AttrT.create($156($157($158)));
    };
  };
  var fontSize = function(dictToAttr) {
    var $174 = AttributeSetter.create("font-size");
    var $175 = toAttr(dictToAttr);
    return function($176) {
      return AttrT.create($174($175($176)));
    };
  };
  var fill = function(dictToAttr) {
    var $183 = AttributeSetter.create("fill");
    var $184 = toAttr(dictToAttr);
    return function($185) {
      return AttrT.create($183($184($185)));
    };
  };
  var defaultTransition = /* @__PURE__ */ (function() {
    return {
      name: "",
      delay: 0,
      duration: 0,
      easing: DefaultCubic.value
    };
  })();
  var transitionWithDuration = function(duration2) {
    return new TransitionT([], {
      name: defaultTransition.name,
      delay: defaultTransition.delay,
      easing: defaultTransition.easing,
      duration: duration2
    });
  };
  var d = function(dictToAttr) {
    var $192 = AttributeSetter.create("d");
    var $193 = toAttr(dictToAttr);
    return function($194) {
      return AttrT.create($192($193($194)));
    };
  };
  var cy = function(dictToAttr) {
    var $195 = AttributeSetter.create("cy");
    var $196 = toAttr(dictToAttr);
    return function($197) {
      return AttrT.create($195($196($197)));
    };
  };
  var cx = function(dictToAttr) {
    var $198 = AttributeSetter.create("cx");
    var $199 = toAttr(dictToAttr);
    return function($200) {
      return AttrT.create($198($199($200)));
    };
  };
  var classed = function(dictToAttr) {
    var $204 = AttributeSetter.create("class");
    var $205 = toAttr(dictToAttr);
    return function($206) {
      return AttrT.create($204($205($206)));
    };
  };
  var andThen = function(dictSemigroup) {
    return append(dictSemigroup);
  };

  // output/PSD3.Layout.Hierarchy.Cluster4/index.js
  var compare4 = /* @__PURE__ */ compare(ordInt);
  var map17 = /* @__PURE__ */ map(functorList);
  var fromFoldable3 = /* @__PURE__ */ fromFoldable(foldableList);
  var fromFoldable1 = /* @__PURE__ */ fromFoldable2(foldableArray);
  var fromFoldable22 = /* @__PURE__ */ fromFoldable(foldableTree);
  var map18 = /* @__PURE__ */ map(functorArray);
  var maximum2 = /* @__PURE__ */ maximum(ordNumber)(foldableArray);
  var minimum2 = /* @__PURE__ */ minimum(ordNumber)(foldableArray);
  var maximum1 = /* @__PURE__ */ maximum(ordInt)(foldableArray);
  var foldl6 = /* @__PURE__ */ foldl(foldableArray);
  var sortByHeight = function(v) {
    var compareByHeight = function(v1) {
      return function(v2) {
        return compare4(v2.value0.height)(v1.value0.height);
      };
    };
    var sortedGrandchildren = map17(sortByHeight)(v.value1);
    var childArray = fromFoldable3(sortedGrandchildren);
    var sortedArray = sortBy(compareByHeight)(childArray);
    var sortedChildrenList = fromFoldable1(sortedArray);
    return new Node(v.value0, sortedChildrenList);
  };
  var scaleToPixels = function(config) {
    return function(inputTree) {
      var allNodes3 = fromFoldable22(inputTree);
      var allX = map18(function(n) {
        return n.x;
      })(allNodes3);
      var maxX = fromMaybe(1)(maximum2(allX));
      var minX = fromMaybe(0)(minimum2(allX));
      var xRange = (function() {
        var $48 = maxX - minX === 0;
        if ($48) {
          return 1;
        }
        ;
        return maxX - minX;
      })();
      var scaleX3 = function(x47) {
        return (x47 - minX) / xRange * config.size.width;
      };
      var allHeights = map18(function(n) {
        return n.height;
      })(allNodes3);
      var maxHeight = fromMaybe(1)(maximum1(allHeights));
      var scaleY3 = function(height53) {
        return (1 - toNumber(height53) / toNumber(maxHeight)) * config.size.height;
      };
      var go2 = function(v) {
        return new Node((function() {
          var $50 = {};
          for (var $51 in v.value0) {
            if ({}.hasOwnProperty.call(v.value0, $51)) {
              $50[$51] = v["value0"][$51];
            }
            ;
          }
          ;
          $50.x = scaleX3(v.value0.x);
          $50.y = scaleY3(v.value0.height);
          return $50;
        })(), map17(go2)(v.value1));
      };
      return go2(inputTree);
    };
  };
  var render = function(minSep) {
    return function(inputTree) {
      var foldl19 = function(f) {
        return function(init13) {
          return function(arr) {
            return foldl6(f)(init13)(arr);
          };
        };
      };
      var findExtent = function(v) {
        var v1 = fromFoldable3(v.value1);
        if (v1.length === 0) {
          return {
            minX: v.value0.x,
            maxX: v.value0.x
          };
        }
        ;
        var childExtents = map18(findExtent)(v1);
        var maxX = fromMaybe(v.value0.x)(maximum2(map18(function(e) {
          return e.maxX;
        })(childExtents)));
        var minX = fromMaybe(v.value0.x)(minimum2(map18(function(e) {
          return e.minX;
        })(childExtents)));
        return {
          minX,
          maxX
        };
      };
      var renderInternal = function(currentLeafX) {
        return function(v) {
          var v1 = fromFoldable3(v.value1);
          if (v1.length === 0) {
            var leafNode = new Node((function() {
              var $62 = {};
              for (var $63 in v.value0) {
                if ({}.hasOwnProperty.call(v.value0, $63)) {
                  $62[$63] = v["value0"][$63];
                }
                ;
              }
              ;
              $62.x = currentLeafX;
              return $62;
            })(), Nil.value);
            return {
              tree: leafNode,
              lastLeafX: currentLeafX + minSep
            };
          }
          ;
          var processChildren = foldl19(function(acc) {
            return function(child) {
              var result = renderInternal(acc.lastLeafX)(child);
              return {
                trees: snoc(acc.trees)(result.tree),
                lastLeafX: result.lastLeafX
              };
            };
          })({
            trees: [],
            lastLeafX: currentLeafX
          })(v1);
          var childrenList = fromFoldable1(processChildren.trees);
          var allChildExtents = map18(findExtent)(processChildren.trees);
          var maxX = fromMaybe(0)(maximum2(map18(function(e) {
            return e.maxX;
          })(allChildExtents)));
          var minX = fromMaybe(0)(minimum2(map18(function(e) {
            return e.minX;
          })(allChildExtents)));
          var centerX = (minX + maxX) / 2;
          var internalNode = new Node((function() {
            var $65 = {};
            for (var $66 in v.value0) {
              if ({}.hasOwnProperty.call(v.value0, $66)) {
                $65[$66] = v["value0"][$66];
              }
              ;
            }
            ;
            $65.x = centerX;
            return $65;
          })(), childrenList);
          return {
            tree: internalNode,
            lastLeafX: processChildren.lastLeafX
          };
        };
      };
      return renderInternal(0)(inputTree);
    };
  };
  var defaultClusterConfig = {
    size: {
      width: 800,
      height: 600
    },
    minSeparation: 1
  };
  var centerRoot = function(tree3) {
    var allNodes3 = fromFoldable22(tree3);
    var leaves = filter(function(n) {
      return n.height === 0;
    })(allNodes3);
    var firstLeaf = head(leaves);
    var minX = (function() {
      if (firstLeaf instanceof Just) {
        return firstLeaf.value0.x;
      }
      ;
      if (firstLeaf instanceof Nothing) {
        return 0;
      }
      ;
      throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Cluster4 (line 87, column 12 - line 89, column 21): " + [firstLeaf.constructor.name]);
    })();
    var lastLeaf = last(leaves);
    var maxX = (function() {
      if (lastLeaf instanceof Just) {
        return lastLeaf.value0.x;
      }
      ;
      if (lastLeaf instanceof Nothing) {
        return 0;
      }
      ;
      throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Cluster4 (line 91, column 12 - line 93, column 21): " + [lastLeaf.constructor.name]);
    })();
    var targetX = (minX + maxX) / 2;
    var offset = targetX - tree3.value0.x;
    var shiftTree = function(v) {
      return new Node((function() {
        var $76 = {};
        for (var $77 in v.value0) {
          if ({}.hasOwnProperty.call(v.value0, $77)) {
            $76[$77] = v["value0"][$77];
          }
          ;
        }
        ;
        $76.x = v.value0.x + offset;
        return $76;
      })(), map17(shiftTree)(v.value1));
    };
    return shiftTree(tree3);
  };
  var addYCoordinates = function(v) {
    var nodeY = toNumber(v.value0.height);
    var childrenWithY = map17(addYCoordinates)(v.value1);
    return new Node((function() {
      var $84 = {};
      for (var $85 in v.value0) {
        if ({}.hasOwnProperty.call(v.value0, $85)) {
          $84[$85] = v["value0"][$85];
        }
        ;
      }
      ;
      $84.y = nodeY;
      return $84;
    })(), childrenWithY);
  };
  var addHeight = function(v) {
    var childrenWithHeight = map17(addHeight)(v.value1);
    var nodeHeight = (function() {
      var v1 = fromFoldable3(childrenWithHeight);
      if (v1.length === 0) {
        return 0;
      }
      ;
      var childHeights = map18(function(v2) {
        return v2.value0.height;
      })(v1);
      var maxChildHeight = fromMaybe(0)(maximum1(childHeights));
      return 1 + maxChildHeight | 0;
    })();
    return new Node((function() {
      var $94 = {};
      for (var $95 in v.value0) {
        if ({}.hasOwnProperty.call(v.value0, $95)) {
          $94[$95] = v["value0"][$95];
        }
        ;
      }
      ;
      $94.height = nodeHeight;
      return $94;
    })(), childrenWithHeight);
  };
  var cluster = function(config) {
    return function(inputTree) {
      var withHeight = addHeight(inputTree);
      var sorted = sortByHeight(withHeight);
      var rendered = render(config.minSeparation)(sorted);
      var centered = centerRoot(rendered.tree);
      var withCoords = addYCoordinates(centered);
      var scaled = scaleToPixels(config)(withCoords);
      return scaled;
    };
  };

  // output/PSD3.Layout.Hierarchy.Tree4/index.js
  var compare5 = /* @__PURE__ */ compare(ordInt);
  var map19 = /* @__PURE__ */ map(functorList);
  var fromFoldable4 = /* @__PURE__ */ fromFoldable(foldableList);
  var fromFoldable12 = /* @__PURE__ */ fromFoldable2(foldableArray);
  var add2 = /* @__PURE__ */ add(semiringNumber);
  var fromFoldable23 = /* @__PURE__ */ fromFoldable(foldableTree);
  var map110 = /* @__PURE__ */ map(functorArray);
  var maximum3 = /* @__PURE__ */ maximum(ordNumber)(foldableArray);
  var minimum3 = /* @__PURE__ */ minimum(ordNumber)(foldableArray);
  var maximum12 = /* @__PURE__ */ maximum(ordInt)(foldableArray);
  var scanl2 = /* @__PURE__ */ scanl(traversableList);
  var Contours = /* @__PURE__ */ (function() {
    function Contours2(value0) {
      this.value0 = value0;
    }
    ;
    Contours2.create = function(value0) {
      return new Contours2(value0);
    };
    return Contours2;
  })();
  var sortByHeight2 = function(v) {
    var compareByHeight = function(v1) {
      return function(v2) {
        return compare5(v2.value0.height)(v1.value0.height);
      };
    };
    var sortedGrandchildren = map19(sortByHeight2)(v.value1);
    var childArray = fromFoldable4(sortedGrandchildren);
    var sortedArray = sortBy(compareByHeight)(childArray);
    var sortedChildrenList = fromFoldable12(sortedArray);
    return new Node(v.value0, sortedChildrenList);
  };
  var singletonContours = /* @__PURE__ */ (function() {
    return new Contours({
      left: new Cons(0, Nil.value),
      right: new Cons(0, Nil.value)
    });
  })();
  var scanContoursWithBase = function(baseSep) {
    return function(v) {
      return function(v1) {
        var go2 = function($copy_v2) {
          return function($copy_v3) {
            return function($copy_v4) {
              var $tco_var_v2 = $copy_v2;
              var $tco_var_v3 = $copy_v3;
              var $tco_done = false;
              var $tco_result;
              function $tco_loop(v2, v3, v4) {
                if (v3 instanceof Nil) {
                  $tco_done = true;
                  return v2;
                }
                ;
                if (v4 instanceof Nil) {
                  $tco_done = true;
                  return v2;
                }
                ;
                if (v3 instanceof Cons && v4 instanceof Cons) {
                  var actualSep = v2 + v4.value0 - v3.value0;
                  var neededSep = (function() {
                    var $82 = actualSep < baseSep;
                    if ($82) {
                      return v2 + (baseSep - actualSep);
                    }
                    ;
                    return v2;
                  })();
                  $tco_var_v2 = neededSep;
                  $tco_var_v3 = v3.value1;
                  $copy_v4 = v4.value1;
                  return;
                }
                ;
                throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Tree4 (line 267, column 5 - line 267, column 49): " + [v2.constructor.name, v3.constructor.name, v4.constructor.name]);
              }
              ;
              while (!$tco_done) {
                $tco_result = $tco_loop($tco_var_v2, $tco_var_v3, $copy_v4);
              }
              ;
              return $tco_result;
            };
          };
        };
        return go2(baseSep)(v.value0.right)(v1.value0.left);
      };
    };
  };
  var scaleToPixels2 = function(config) {
    return function(inputTree) {
      var layerScaleFn = fromMaybe(toNumber)(config.layerScale);
      var allNodes3 = fromFoldable23(inputTree);
      var allX = map110(function(n) {
        return n.x;
      })(allNodes3);
      var maxX = fromMaybe(1)(maximum3(allX));
      var minX = fromMaybe(0)(minimum3(allX));
      var xRange = (function() {
        var $102 = maxX - minX === 0;
        if ($102) {
          return 1;
        }
        ;
        return maxX - minX;
      })();
      var scaleX3 = function(x47) {
        return (x47 - minX) / xRange * config.size.width;
      };
      var scaledDepths = map110(function(n) {
        return layerScaleFn(n.depth);
      })(allNodes3);
      var maxScaledDepth = fromMaybe(1)(maximum3(scaledDepths));
      var scaleY3 = function(depth) {
        var scaledDepth = layerScaleFn(depth);
        return scaledDepth / maxScaledDepth * config.size.height;
      };
      var go2 = function(v) {
        return new Node((function() {
          var $104 = {};
          for (var $105 in v.value0) {
            if ({}.hasOwnProperty.call(v.value0, $105)) {
              $104[$105] = v["value0"][$105];
            }
            ;
          }
          ;
          $104.x = scaleX3(v.value0.x);
          $104.y = scaleY3(v.value0.depth);
          return $104;
        })(), map19(go2)(v.value1));
      };
      var allDepths = map110(function(n) {
        return n.depth;
      })(allNodes3);
      var maxDepth = fromMaybe(1)(maximum12(allDepths));
      return go2(inputTree);
    };
  };
  var petrify = function(parentX) {
    return function(v) {
      var nodeY = toNumber(v.value0.value1.depth);
      var nodeX = parentX + v.value0.value0.offset;
      var childrenWithCoords = map19(petrify(nodeX))(v.value1);
      return new Node((function() {
        var $111 = {};
        for (var $112 in v.value0.value1) {
          if ({}.hasOwnProperty.call(v.value0.value1, $112)) {
            $111[$112] = v["value0"]["value1"][$112];
          }
          ;
        }
        ;
        $111.x = nodeX;
        $111.y = nodeY;
        return $111;
      })(), childrenWithCoords);
    };
  };
  var mergeContoursRight = function(contours) {
    var mergeLevel = function(cs) {
      var currentLevels = mapMaybe(function(c) {
        if (c instanceof Cons) {
          return new Just(c.value0);
        }
        ;
        if (c instanceof Nil) {
          return Nothing.value;
        }
        ;
        throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Tree4 (line 387, column 18 - line 389, column 27): " + [c.constructor.name]);
      })(cs);
      var v = head(currentLevels);
      if (v instanceof Nothing) {
        return Nil.value;
      }
      ;
      if (v instanceof Just) {
        var restContours = mapMaybe(function(c) {
          if (c instanceof Cons) {
            return new Just(c.value1);
          }
          ;
          if (c instanceof Nil) {
            return Nothing.value;
          }
          ;
          throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Tree4 (line 399, column 24 - line 401, column 33): " + [c.constructor.name]);
        })(cs);
        var maxVal = fromMaybe(0)(maximum3(currentLevels));
        return new Cons(maxVal, mergeLevel(restContours));
      }
      ;
      throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Tree4 (line 392, column 9 - line 404, column 52): " + [v.constructor.name]);
    };
    if (contours.length === 0) {
      return Nil.value;
    }
    ;
    return mergeLevel(contours);
  };
  var mergeContoursLeft = function(contours) {
    var mergeLevel = function(cs) {
      var currentLevels = mapMaybe(function(c) {
        if (c instanceof Cons) {
          return new Just(c.value0);
        }
        ;
        if (c instanceof Nil) {
          return Nothing.value;
        }
        ;
        throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Tree4 (line 356, column 18 - line 358, column 27): " + [c.constructor.name]);
      })(cs);
      var v = head(currentLevels);
      if (v instanceof Nothing) {
        return Nil.value;
      }
      ;
      if (v instanceof Just) {
        var restContours = mapMaybe(function(c) {
          if (c instanceof Cons) {
            return new Just(c.value1);
          }
          ;
          if (c instanceof Nil) {
            return Nothing.value;
          }
          ;
          throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Tree4 (line 368, column 24 - line 370, column 33): " + [c.constructor.name]);
        })(cs);
        var minVal = fromMaybe(0)(minimum3(currentLevels));
        return new Cons(minVal, mergeLevel(restContours));
      }
      ;
      throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Tree4 (line 361, column 9 - line 373, column 52): " + [v.constructor.name]);
    };
    if (contours.length === 0) {
      return Nil.value;
    }
    ;
    return mergeLevel(contours);
  };
  var spliceContours = function(offsets) {
    return function(contours) {
      var v = fromFoldable4(zipWith2(Tuple.create)(offsets)(contours));
      if (v.length === 0) {
        return singletonContours;
      }
      ;
      if (v.length === 1) {
        return new Contours({
          left: new Cons(0, map19(function(x47) {
            return x47 + v[0].value0;
          })(v[0].value1.value0.left)),
          right: new Cons(0, map19(function(x47) {
            return x47 + v[0].value0;
          })(v[0].value1.value0.right))
        });
      }
      ;
      var shiftedContours = map110(function(v1) {
        return new Contours({
          left: map19(function(x47) {
            return x47 + v1.value0;
          })(v1.value1.value0.left),
          right: map19(function(x47) {
            return x47 + v1.value0;
          })(v1.value1.value0.right)
        });
      })(v);
      var mergedRight = mergeContoursRight(map110(function(v1) {
        return v1.value0.right;
      })(shiftedContours));
      var mergedLeft = mergeContoursLeft(map110(function(v1) {
        return v1.value0.left;
      })(shiftedContours));
      return new Contours({
        left: new Cons(0, mergedLeft),
        right: new Cons(0, mergedRight)
      });
    };
  };
  var getRootData = function(v) {
    return v.value0.value1;
  };
  var defaultTreeConfig = /* @__PURE__ */ (function() {
    return {
      size: {
        width: 800,
        height: 600
      },
      minSeparation: 1,
      separation: Nothing.value,
      layerScale: Nothing.value
    };
  })();
  var computeSeparationsWithBase = function(baseSeps) {
    return function(contours) {
      var tailSafe = function(v2) {
        if (v2 instanceof Nil) {
          return Nil.value;
        }
        ;
        if (v2 instanceof Cons) {
          return v2.value1;
        }
        ;
        throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Tree4 (line 258, column 5 - line 258, column 43): " + [v2.constructor.name]);
      };
      var applyBase = function(base2) {
        return function(v2) {
          return scanContoursWithBase(base2)(v2.value0)(v2.value1);
        };
      };
      var v = new Tuple(baseSeps, contours);
      if (v.value0 instanceof Nil) {
        return Nil.value;
      }
      ;
      if (v.value1 instanceof Nil) {
        return Nil.value;
      }
      ;
      if (v.value1 instanceof Cons && v.value1.value1 instanceof Nil) {
        return Nil.value;
      }
      ;
      var contourPairs = zipWith2(Tuple.create)(contours)(tailSafe(contours));
      return zipWith2(applyBase)(baseSeps)(contourPairs);
    };
  };
  var computeBaseSeparations = function(minSep) {
    return function(separationFn) {
      return function(nodes) {
        var tailSafe = function(v) {
          if (v instanceof Nil) {
            return Nil.value;
          }
          ;
          if (v instanceof Cons) {
            return v.value1;
          }
          ;
          throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Tree4 (line 238, column 5 - line 238, column 43): " + [v.constructor.name]);
        };
        var getSep = function(v) {
          return function(v1) {
            return function(v2) {
              return function(v3) {
                if (v instanceof Nothing) {
                  return v1;
                }
                ;
                if (v instanceof Just) {
                  return v.value0(v2)(v3) + v1;
                }
                ;
                throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Tree4 (line 234, column 5 - line 234, column 69): " + [v.constructor.name, v1.constructor.name, v2.constructor.name, v3.constructor.name]);
              };
            };
          };
        };
        if (nodes instanceof Nil) {
          return Nil.value;
        }
        ;
        if (nodes instanceof Cons && nodes.value1 instanceof Nil) {
          return Nil.value;
        }
        ;
        return zipWith2(getSep(separationFn)(minSep))(nodes)(tailSafe(nodes));
      };
    };
  };
  var render2 = function(minSep) {
    return function(separationFn) {
      return function(inputTree) {
        var updateOffset = function(v2) {
          return function(newOffset) {
            return new Node(new Tuple({
              offset: newOffset
            }, v2.value0.value1), v2.value1);
          };
        };
        var renderWithContours = function(v2) {
          var childCount = length2(v2.value1);
          if (childCount === 0) {
            return new Tuple(new Node(new Tuple({
              offset: 0
            }, v2.value0), Nil.value), singletonContours);
          }
          ;
          var childResults = map19(renderWithContours)(v2.value1);
          var childTrees = map19(function(v1) {
            return v1.value0;
          })(childResults);
          var childRootData = map19(getRootData)(childTrees);
          var childContours = map19(function(v1) {
            return v1.value1;
          })(childResults);
          var baseSeparations = computeBaseSeparations(minSep)(separationFn)(childRootData);
          var separations = computeSeparationsWithBase(baseSeparations)(childContours);
          var childAbsoluteOffsets = new Cons(0, scanl2(add2)(0)(separations));
          var leftmostOffset = fromMaybe(0)(head(fromFoldable4(childAbsoluteOffsets)));
          var rightmostOffset = fromMaybe(0)(last(fromFoldable4(childAbsoluteOffsets)));
          var parentOffset = (leftmostOffset + rightmostOffset) / 2;
          var childRelativeOffsets = map19(function(absOffset) {
            return absOffset - parentOffset;
          })(childAbsoluteOffsets);
          var childrenWithOffsets = zipWith2(updateOffset)(childTrees)(childRelativeOffsets);
          var parentContours = spliceContours(childRelativeOffsets)(childContours);
          var resultTree = new Node(new Tuple({
            offset: parentOffset
          }, v2.value0), childrenWithOffsets);
          return new Tuple(resultTree, parentContours);
        };
        var v = renderWithContours(inputTree);
        return v.value0;
      };
    };
  };
  var addHeightField = function(v) {
    var childrenWithHeight = map19(addHeightField)(v.value1);
    var nodeHeight = (function() {
      var v1 = fromFoldable4(childrenWithHeight);
      if (v1.length === 0) {
        return 0;
      }
      ;
      var childHeights = map110(function(v2) {
        return v2.value0.height;
      })(v1);
      var maxChildHeight = fromMaybe(0)(maximum12(childHeights));
      return maxChildHeight + 1 | 0;
    })();
    return new Node((function() {
      var $211 = {};
      for (var $212 in v.value0) {
        if ({}.hasOwnProperty.call(v.value0, $212)) {
          $211[$212] = v["value0"][$212];
        }
        ;
      }
      ;
      $211.height = nodeHeight;
      return $211;
    })(), childrenWithHeight);
  };
  var addDepth = function(currentDepth) {
    return function(v) {
      return new Node((function() {
        var $218 = {};
        for (var $219 in v.value0) {
          if ({}.hasOwnProperty.call(v.value0, $219)) {
            $218[$219] = v["value0"][$219];
          }
          ;
        }
        ;
        $218.depth = currentDepth;
        return $218;
      })(), map19(addDepth(currentDepth + 1 | 0))(v.value1));
    };
  };
  var tree2 = function(config) {
    return function(inputTree) {
      var withDepth = addDepth(0)(inputTree);
      var rendered = render2(config.minSeparation)(config.separation)(withDepth);
      var withCoords = petrify(0)(rendered);
      var scaled = scaleToPixels2(config)(withCoords);
      return scaled;
    };
  };
  var treeWithSorting = function(config) {
    return function(inputTree) {
      var withDepth = addDepth(0)(inputTree);
      var withHeight = addHeightField(withDepth);
      var sorted = sortByHeight2(withHeight);
      var rendered = render2(config.minSeparation)(config.separation)(sorted);
      var withCoords = petrify(0)(rendered);
      var scaled = scaleToPixels2(config)(withCoords);
      return scaled;
    };
  };

  // output/PSD3.Shared.FlareData/foreign.js
  var getName = (node) => node.name || "";
  var getValue = (node) => node.value || 0;
  var getChildren_ = (node) => {
    if (node.children && Array.isArray(node.children) && node.children.length > 0) {
      return node.children;
    }
    return null;
  };

  // output/PSD3.Shared.FlareData/index.js
  var getChildren = function($1) {
    return toMaybe(getChildren_($1));
  };

  // output/D3.Viz.AnimatedTree4Cluster4/index.js
  var show5 = /* @__PURE__ */ show(showNumber);
  var bind2 = /* @__PURE__ */ bind(bindArray);
  var fromFoldable5 = /* @__PURE__ */ fromFoldable(foldableList);
  var append13 = /* @__PURE__ */ append(semigroupArray);
  var fromFoldable13 = /* @__PURE__ */ fromFoldable2(foldableArray);
  var map20 = /* @__PURE__ */ map(functorArray);
  var classed2 = /* @__PURE__ */ classed(toAttrString);
  var discard2 = /* @__PURE__ */ discard(discardUnit);
  var fill2 = /* @__PURE__ */ fill(toAttrString);
  var strokeColor2 = /* @__PURE__ */ strokeColor(toAttrString);
  var strokeWidth2 = /* @__PURE__ */ strokeWidth(toAttrNumber);
  var d2 = /* @__PURE__ */ d(toAttrStringFn);
  var radius2 = /* @__PURE__ */ radius(toAttrNumber);
  var cx2 = /* @__PURE__ */ cx(toAttrNumberFn);
  var cy2 = /* @__PURE__ */ cy(toAttrNumberFn);
  var TreeLayout = /* @__PURE__ */ (function() {
    function TreeLayout2() {
    }
    ;
    TreeLayout2.value = new TreeLayout2();
    return TreeLayout2;
  })();
  var ClusterLayout = /* @__PURE__ */ (function() {
    function ClusterLayout2() {
    }
    ;
    ClusterLayout2.value = new ClusterLayout2();
    return ClusterLayout2;
  })();
  var showLayoutType = {
    show: function(v) {
      if (v instanceof TreeLayout) {
        return "Tree (Reingold-Tilford)";
      }
      ;
      if (v instanceof ClusterLayout) {
        return "Cluster (Dendrogram)";
      }
      ;
      throw new Error("Failed pattern match at D3.Viz.AnimatedTree4Cluster4 (line 29, column 1 - line 31, column 46): " + [v.constructor.name]);
    }
  };
  var verticalLinkPath = function(x116) {
    return function(y116) {
      return function(x217) {
        return function(y217) {
          var midY = (y116 + y217) / 2;
          return "M" + (show5(x116) + ("," + (show5(y116) + (" C" + (show5(x116) + ("," + (show5(midY) + (" " + (show5(x217) + ("," + (show5(midY) + (" " + (show5(x217) + ("," + show5(y217)))))))))))))));
        };
      };
    };
  };
  var toggleLayout = function(v) {
    if (v instanceof TreeLayout) {
      return ClusterLayout.value;
    }
    ;
    if (v instanceof ClusterLayout) {
      return TreeLayout.value;
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.AnimatedTree4Cluster4 (line 34, column 1 - line 34, column 41): " + [v.constructor.name]);
  };
  var nodeKey = function(node) {
    return node.name;
  };
  var makeLinks = function(v) {
    var grandchildLinks = bind2(fromFoldable5(v.value1))(makeLinks);
    var childLinks = bind2(fromFoldable5(v.value1))(function(v1) {
      return [{
        source: {
          name: v.value0.name,
          x: v.value0.x,
          y: v.value0.y
        },
        target: {
          name: v1.value0.name,
          x: v1.value0.x,
          y: v1.value0.y
        }
      }];
    });
    return append13(childLinks)(grandchildLinks);
  };
  var linkKey = function(link4) {
    return link4.source.name + ("->" + link4.target.name);
  };
  var hierDataToTree = function(hierData) {
    var value18 = getValue(hierData);
    var name16 = getName(hierData);
    var childrenMaybe = getChildren(hierData);
    var childrenList = (function() {
      if (childrenMaybe instanceof Nothing) {
        return Nil.value;
      }
      ;
      if (childrenMaybe instanceof Just) {
        return fromFoldable13(map20(hierDataToTree)(childrenMaybe.value0));
      }
      ;
      throw new Error("Failed pattern match at D3.Viz.AnimatedTree4Cluster4 (line 45, column 20 - line 47, column 76): " + [childrenMaybe.constructor.name]);
    })();
    return new Node({
      name: name16,
      value: value18,
      x: 0,
      y: 0,
      depth: 0,
      height: 0
    }, childrenList);
  };
  var flattenTree = /* @__PURE__ */ fromFoldable(foldableTree);
  var draw = function(dictMonadEffect) {
    var Monad0 = dictMonadEffect.Monad0();
    var bind139 = bind(Monad0.Bind1());
    var pure91 = pure(Monad0.Applicative0());
    return function(dictSelectionM) {
      var attach2 = attach(dictSelectionM);
      var appendTo2 = appendTo(dictSelectionM);
      return function(flareData) {
        return function(selector) {
          var dataTree = hierDataToTree(flareData);
          return bind139(attach2(selector))(function(root$prime) {
            return bind139(appendTo2(root$prime)(Svg.value)([viewBox(0)(0)(1200)(900), classed2("animated-tree4-cluster4")]))(function(svg2) {
              return bind139(appendTo2(svg2)(Group.value)([classed2("links")]))(function(linksGroup) {
                return bind139(appendTo2(svg2)(Group.value)([classed2("nodes")]))(function(nodesGroup) {
                  return pure91({
                    dataTree,
                    linksGroup,
                    nodesGroup,
                    chartWidth: 1200,
                    chartHeight: 900
                  });
                });
              });
            });
          });
        };
      };
    };
  };
  var animationStep = function(dictMonadEffect) {
    var Monad0 = dictMonadEffect.Monad0();
    var Bind1 = Monad0.Bind1();
    var bind139 = bind(Bind1);
    var discard120 = discard2(Bind1);
    var pure91 = pure(Monad0.Applicative0());
    return function(dictSelectionM) {
      var openSelection2 = openSelection(dictSelectionM);
      var updateJoin2 = updateJoin(dictSelectionM);
      var setAttributes2 = setAttributes(dictSelectionM);
      var appendTo2 = appendTo(dictSelectionM);
      return function(dataTree) {
        return function(linksGroup) {
          return function(nodesGroup) {
            return function(chartWidth) {
              return function(chartHeight) {
                return function(currentLayout) {
                  var positioned = (function() {
                    if (currentLayout instanceof TreeLayout) {
                      var config = {
                        layerScale: defaultTreeConfig.layerScale,
                        minSeparation: defaultTreeConfig.minSeparation,
                        separation: defaultTreeConfig.separation,
                        size: {
                          width: chartWidth,
                          height: chartHeight
                        }
                      };
                      return treeWithSorting(config)(dataTree);
                    }
                    ;
                    if (currentLayout instanceof ClusterLayout) {
                      var config = {
                        minSeparation: defaultClusterConfig.minSeparation,
                        size: {
                          width: chartWidth,
                          height: chartHeight
                        }
                      };
                      return cluster(config)(dataTree);
                    }
                    ;
                    throw new Error("Failed pattern match at D3.Viz.AnimatedTree4Cluster4 (line 128, column 20 - line 134, column 37): " + [currentLayout.constructor.name]);
                  })();
                  var nodes = flattenTree(positioned);
                  var links = makeLinks(positioned);
                  return bind139(openSelection2(linksGroup)("path"))(function(linksSelection) {
                    return bind139(updateJoin2(linksSelection)(Path.value)(links)(linkKey))(function(linkJoin) {
                      return discard120(setAttributes2(linkJoin.exit)([remove]))(function() {
                        return bind139(appendTo2(linkJoin.enter)(Path.value)([]))(function(newEnterLinks) {
                          var linkPathFn = function(link4) {
                            return verticalLinkPath(link4.source.x)(link4.source.y)(link4.target.x)(link4.target.y);
                          };
                          return bind139(setAttributes2(newEnterLinks)([fill2("none"), strokeColor2("#555"), strokeWidth2(1.5), classed2("link")]))(function() {
                            return bind139(setAttributes2(newEnterLinks)([d2(linkPathFn)]))(function() {
                              return bind139(setAttributes2(linkJoin.update)([fill2("none"), strokeColor2("#555"), strokeWidth2(1.5), classed2("link")]))(function() {
                                return discard120(setAttributes2(linkJoin.update)(to(transitionWithDuration(1500))([d2(linkPathFn)])))(function() {
                                  return bind139(openSelection2(nodesGroup)("circle"))(function(nodesSelection) {
                                    return bind139(updateJoin2(nodesSelection)(Circle.value)(nodes)(nodeKey))(function(nodeJoin) {
                                      return bind139(setAttributes2(nodeJoin.exit)([remove]))(function() {
                                        return bind139(appendTo2(nodeJoin.enter)(Circle.value)([]))(function(newEnterNodes) {
                                          return bind139(setAttributes2(newEnterNodes)([radius2(4), fill2("#999"), strokeColor2("#555"), strokeWidth2(1.5), classed2("node")]))(function() {
                                            return bind139(setAttributes2(newEnterNodes)([cx2(function(v) {
                                              return v.x;
                                            }), cy2(function(v) {
                                              return v.y;
                                            })]))(function() {
                                              return bind139(setAttributes2(nodeJoin.update)([radius2(4), fill2("#999"), strokeColor2("#555"), strokeWidth2(1.5), classed2("node")]))(function() {
                                                return bind139(setAttributes2(nodeJoin.update)(to(transitionWithDuration(1500))([cx2(function(v) {
                                                  return v.x;
                                                }), cy2(function(v) {
                                                  return v.y;
                                                })])))(function() {
                                                  return pure91(unit);
                                                });
                                              });
                                            });
                                          });
                                        });
                                      });
                                    });
                                  });
                                });
                              });
                            });
                          });
                        });
                      });
                    });
                  });
                };
              };
            };
          };
        };
      };
    };
  };

  // output/Control.Monad.State.Trans/index.js
  var runStateT = function(v) {
    return v;
  };
  var monadTransStateT = {
    lift: function(dictMonad) {
      var bind87 = bind(dictMonad.Bind1());
      var pure91 = pure(dictMonad.Applicative0());
      return function(m) {
        return function(s) {
          return bind87(m)(function(x47) {
            return pure91(new Tuple(x47, s));
          });
        };
      };
    }
  };
  var lift3 = /* @__PURE__ */ lift(monadTransStateT);
  var functorStateT = function(dictFunctor) {
    var map95 = map(dictFunctor);
    return {
      map: function(f) {
        return function(v) {
          return function(s) {
            return map95(function(v1) {
              return new Tuple(f(v1.value0), v1.value1);
            })(v(s));
          };
        };
      }
    };
  };
  var monadStateT = function(dictMonad) {
    return {
      Applicative0: function() {
        return applicativeStateT(dictMonad);
      },
      Bind1: function() {
        return bindStateT(dictMonad);
      }
    };
  };
  var bindStateT = function(dictMonad) {
    var bind87 = bind(dictMonad.Bind1());
    return {
      bind: function(v) {
        return function(f) {
          return function(s) {
            return bind87(v(s))(function(v1) {
              var v3 = f(v1.value0);
              return v3(v1.value1);
            });
          };
        };
      },
      Apply0: function() {
        return applyStateT(dictMonad);
      }
    };
  };
  var applyStateT = function(dictMonad) {
    var functorStateT1 = functorStateT(dictMonad.Bind1().Apply0().Functor0());
    return {
      apply: ap(monadStateT(dictMonad)),
      Functor0: function() {
        return functorStateT1;
      }
    };
  };
  var applicativeStateT = function(dictMonad) {
    var pure91 = pure(dictMonad.Applicative0());
    return {
      pure: function(a2) {
        return function(s) {
          return pure91(new Tuple(a2, s));
        };
      },
      Apply0: function() {
        return applyStateT(dictMonad);
      }
    };
  };
  var monadEffectState = function(dictMonadEffect) {
    var Monad0 = dictMonadEffect.Monad0();
    var monadStateT1 = monadStateT(Monad0);
    return {
      liftEffect: (function() {
        var $203 = lift3(Monad0);
        var $204 = liftEffect(dictMonadEffect);
        return function($205) {
          return $203($204($205));
        };
      })(),
      Monad0: function() {
        return monadStateT1;
      }
    };
  };
  var monadStateStateT = function(dictMonad) {
    var pure91 = pure(dictMonad.Applicative0());
    var monadStateT1 = monadStateT(dictMonad);
    return {
      state: function(f) {
        return function($206) {
          return pure91(f($206));
        };
      },
      Monad0: function() {
        return monadStateT1;
      }
    };
  };

  // output/Effect.Aff.Class/index.js
  var lift5 = /* @__PURE__ */ lift(monadTransStateT);
  var monadAffAff = {
    liftAff: /* @__PURE__ */ identity(categoryFn),
    MonadEffect0: function() {
      return monadEffectAff;
    }
  };
  var liftAff = function(dict) {
    return dict.liftAff;
  };
  var monadAffState = function(dictMonadAff) {
    var MonadEffect0 = dictMonadAff.MonadEffect0();
    var monadEffectState3 = monadEffectState(MonadEffect0);
    return {
      liftAff: (function() {
        var $82 = lift5(MonadEffect0.Monad0());
        var $83 = liftAff(dictMonadAff);
        return function($84) {
          return $82($83($84));
        };
      })(),
      MonadEffect0: function() {
        return monadEffectState3;
      }
    };
  };

  // output/Effect.Console/foreign.js
  var log2 = function(s) {
    return function() {
      console.log(s);
    };
  };
  var warn = function(s) {
    return function() {
      console.warn(s);
    };
  };

  // output/Effect.Class.Console/index.js
  var log3 = function(dictMonadEffect) {
    var $67 = liftEffect(dictMonadEffect);
    return function($68) {
      return $67(log2($68));
    };
  };

  // output/Data.Exists/index.js
  var runExists = unsafeCoerce2;
  var mkExists = unsafeCoerce2;

  // output/Data.Coyoneda/index.js
  var CoyonedaF = /* @__PURE__ */ (function() {
    function CoyonedaF2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    CoyonedaF2.create = function(value0) {
      return function(value1) {
        return new CoyonedaF2(value0, value1);
      };
    };
    return CoyonedaF2;
  })();
  var unCoyoneda = function(f) {
    return function(v) {
      return runExists(function(v1) {
        return f(v1.value0)(v1.value1);
      })(v);
    };
  };
  var coyoneda = function(k) {
    return function(fi) {
      return mkExists(new CoyonedaF(k, fi));
    };
  };
  var functorCoyoneda = {
    map: function(f) {
      return function(v) {
        return runExists(function(v1) {
          return coyoneda(function($180) {
            return f(v1.value0($180));
          })(v1.value1);
        })(v);
      };
    }
  };
  var liftCoyoneda = /* @__PURE__ */ coyoneda(/* @__PURE__ */ identity(categoryFn));

  // output/Data.Map.Internal/index.js
  var $runtime_lazy4 = function(name16, moduleName, init13) {
    var state3 = 0;
    var val;
    return function(lineNumber) {
      if (state3 === 2) return val;
      if (state3 === 1) throw new ReferenceError(name16 + " was needed before it finished initializing (module " + moduleName + ", line " + lineNumber + ")", moduleName, lineNumber);
      state3 = 1;
      val = init13();
      state3 = 2;
      return val;
    };
  };
  var map21 = /* @__PURE__ */ map(functorMaybe);
  var Leaf = /* @__PURE__ */ (function() {
    function Leaf2() {
    }
    ;
    Leaf2.value = new Leaf2();
    return Leaf2;
  })();
  var Node2 = /* @__PURE__ */ (function() {
    function Node4(value0, value1, value22, value32, value42, value52) {
      this.value0 = value0;
      this.value1 = value1;
      this.value2 = value22;
      this.value3 = value32;
      this.value4 = value42;
      this.value5 = value52;
    }
    ;
    Node4.create = function(value0) {
      return function(value1) {
        return function(value22) {
          return function(value32) {
            return function(value42) {
              return function(value52) {
                return new Node4(value0, value1, value22, value32, value42, value52);
              };
            };
          };
        };
      };
    };
    return Node4;
  })();
  var IterLeaf = /* @__PURE__ */ (function() {
    function IterLeaf2() {
    }
    ;
    IterLeaf2.value = new IterLeaf2();
    return IterLeaf2;
  })();
  var IterEmit = /* @__PURE__ */ (function() {
    function IterEmit2(value0, value1, value22) {
      this.value0 = value0;
      this.value1 = value1;
      this.value2 = value22;
    }
    ;
    IterEmit2.create = function(value0) {
      return function(value1) {
        return function(value22) {
          return new IterEmit2(value0, value1, value22);
        };
      };
    };
    return IterEmit2;
  })();
  var IterNode = /* @__PURE__ */ (function() {
    function IterNode2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    IterNode2.create = function(value0) {
      return function(value1) {
        return new IterNode2(value0, value1);
      };
    };
    return IterNode2;
  })();
  var Split = /* @__PURE__ */ (function() {
    function Split2(value0, value1, value22) {
      this.value0 = value0;
      this.value1 = value1;
      this.value2 = value22;
    }
    ;
    Split2.create = function(value0) {
      return function(value1) {
        return function(value22) {
          return new Split2(value0, value1, value22);
        };
      };
    };
    return Split2;
  })();
  var SplitLast = /* @__PURE__ */ (function() {
    function SplitLast2(value0, value1, value22) {
      this.value0 = value0;
      this.value1 = value1;
      this.value2 = value22;
    }
    ;
    SplitLast2.create = function(value0) {
      return function(value1) {
        return function(value22) {
          return new SplitLast2(value0, value1, value22);
        };
      };
    };
    return SplitLast2;
  })();
  var unsafeNode = function(k, v, l, r) {
    if (l instanceof Leaf) {
      if (r instanceof Leaf) {
        return new Node2(1, 1, k, v, l, r);
      }
      ;
      if (r instanceof Node2) {
        return new Node2(1 + r.value0 | 0, 1 + r.value1 | 0, k, v, l, r);
      }
      ;
      throw new Error("Failed pattern match at Data.Map.Internal (line 702, column 5 - line 706, column 39): " + [r.constructor.name]);
    }
    ;
    if (l instanceof Node2) {
      if (r instanceof Leaf) {
        return new Node2(1 + l.value0 | 0, 1 + l.value1 | 0, k, v, l, r);
      }
      ;
      if (r instanceof Node2) {
        return new Node2(1 + (function() {
          var $280 = l.value0 > r.value0;
          if ($280) {
            return l.value0;
          }
          ;
          return r.value0;
        })() | 0, (1 + l.value1 | 0) + r.value1 | 0, k, v, l, r);
      }
      ;
      throw new Error("Failed pattern match at Data.Map.Internal (line 708, column 5 - line 712, column 68): " + [r.constructor.name]);
    }
    ;
    throw new Error("Failed pattern match at Data.Map.Internal (line 700, column 32 - line 712, column 68): " + [l.constructor.name]);
  };
  var toMapIter = /* @__PURE__ */ (function() {
    return flip(IterNode.create)(IterLeaf.value);
  })();
  var stepWith = function(f) {
    return function(next2) {
      return function(done) {
        var go2 = function($copy_v) {
          var $tco_done = false;
          var $tco_result;
          function $tco_loop(v) {
            if (v instanceof IterLeaf) {
              $tco_done = true;
              return done(unit);
            }
            ;
            if (v instanceof IterEmit) {
              $tco_done = true;
              return next2(v.value0, v.value1, v.value2);
            }
            ;
            if (v instanceof IterNode) {
              $copy_v = f(v.value1)(v.value0);
              return;
            }
            ;
            throw new Error("Failed pattern match at Data.Map.Internal (line 940, column 8 - line 946, column 20): " + [v.constructor.name]);
          }
          ;
          while (!$tco_done) {
            $tco_result = $tco_loop($copy_v);
          }
          ;
          return $tco_result;
        };
        return go2;
      };
    };
  };
  var size2 = function(v) {
    if (v instanceof Leaf) {
      return 0;
    }
    ;
    if (v instanceof Node2) {
      return v.value1;
    }
    ;
    throw new Error("Failed pattern match at Data.Map.Internal (line 618, column 8 - line 620, column 24): " + [v.constructor.name]);
  };
  var singleton8 = function(k) {
    return function(v) {
      return new Node2(1, 1, k, v, Leaf.value, Leaf.value);
    };
  };
  var unsafeBalancedNode = /* @__PURE__ */ (function() {
    var height53 = function(v) {
      if (v instanceof Leaf) {
        return 0;
      }
      ;
      if (v instanceof Node2) {
        return v.value0;
      }
      ;
      throw new Error("Failed pattern match at Data.Map.Internal (line 757, column 12 - line 759, column 26): " + [v.constructor.name]);
    };
    var rotateLeft = function(k, v, l, rk, rv, rl, rr) {
      if (rl instanceof Node2 && rl.value0 > height53(rr)) {
        return unsafeNode(rl.value2, rl.value3, unsafeNode(k, v, l, rl.value4), unsafeNode(rk, rv, rl.value5, rr));
      }
      ;
      return unsafeNode(rk, rv, unsafeNode(k, v, l, rl), rr);
    };
    var rotateRight = function(k, v, lk, lv, ll, lr, r) {
      if (lr instanceof Node2 && height53(ll) <= lr.value0) {
        return unsafeNode(lr.value2, lr.value3, unsafeNode(lk, lv, ll, lr.value4), unsafeNode(k, v, lr.value5, r));
      }
      ;
      return unsafeNode(lk, lv, ll, unsafeNode(k, v, lr, r));
    };
    return function(k, v, l, r) {
      if (l instanceof Leaf) {
        if (r instanceof Leaf) {
          return singleton8(k)(v);
        }
        ;
        if (r instanceof Node2 && r.value0 > 1) {
          return rotateLeft(k, v, l, r.value2, r.value3, r.value4, r.value5);
        }
        ;
        return unsafeNode(k, v, l, r);
      }
      ;
      if (l instanceof Node2) {
        if (r instanceof Node2) {
          if (r.value0 > (l.value0 + 1 | 0)) {
            return rotateLeft(k, v, l, r.value2, r.value3, r.value4, r.value5);
          }
          ;
          if (l.value0 > (r.value0 + 1 | 0)) {
            return rotateRight(k, v, l.value2, l.value3, l.value4, l.value5, r);
          }
          ;
        }
        ;
        if (r instanceof Leaf && l.value0 > 1) {
          return rotateRight(k, v, l.value2, l.value3, l.value4, l.value5, r);
        }
        ;
        return unsafeNode(k, v, l, r);
      }
      ;
      throw new Error("Failed pattern match at Data.Map.Internal (line 717, column 40 - line 738, column 34): " + [l.constructor.name]);
    };
  })();
  var $lazy_unsafeSplit = /* @__PURE__ */ $runtime_lazy4("unsafeSplit", "Data.Map.Internal", function() {
    return function(comp, k, m) {
      if (m instanceof Leaf) {
        return new Split(Nothing.value, Leaf.value, Leaf.value);
      }
      ;
      if (m instanceof Node2) {
        var v = comp(k)(m.value2);
        if (v instanceof LT) {
          var v1 = $lazy_unsafeSplit(793)(comp, k, m.value4);
          return new Split(v1.value0, v1.value1, unsafeBalancedNode(m.value2, m.value3, v1.value2, m.value5));
        }
        ;
        if (v instanceof GT) {
          var v1 = $lazy_unsafeSplit(796)(comp, k, m.value5);
          return new Split(v1.value0, unsafeBalancedNode(m.value2, m.value3, m.value4, v1.value1), v1.value2);
        }
        ;
        if (v instanceof EQ) {
          return new Split(new Just(m.value3), m.value4, m.value5);
        }
        ;
        throw new Error("Failed pattern match at Data.Map.Internal (line 791, column 5 - line 799, column 30): " + [v.constructor.name]);
      }
      ;
      throw new Error("Failed pattern match at Data.Map.Internal (line 787, column 34 - line 799, column 30): " + [m.constructor.name]);
    };
  });
  var unsafeSplit = /* @__PURE__ */ $lazy_unsafeSplit(786);
  var $lazy_unsafeSplitLast = /* @__PURE__ */ $runtime_lazy4("unsafeSplitLast", "Data.Map.Internal", function() {
    return function(k, v, l, r) {
      if (r instanceof Leaf) {
        return new SplitLast(k, v, l);
      }
      ;
      if (r instanceof Node2) {
        var v1 = $lazy_unsafeSplitLast(779)(r.value2, r.value3, r.value4, r.value5);
        return new SplitLast(v1.value0, v1.value1, unsafeBalancedNode(k, v, l, v1.value2));
      }
      ;
      throw new Error("Failed pattern match at Data.Map.Internal (line 776, column 37 - line 780, column 57): " + [r.constructor.name]);
    };
  });
  var unsafeSplitLast = /* @__PURE__ */ $lazy_unsafeSplitLast(775);
  var unsafeJoinNodes = function(v, v1) {
    if (v instanceof Leaf) {
      return v1;
    }
    ;
    if (v instanceof Node2) {
      var v2 = unsafeSplitLast(v.value2, v.value3, v.value4, v.value5);
      return unsafeBalancedNode(v2.value0, v2.value1, v2.value2, v1);
    }
    ;
    throw new Error("Failed pattern match at Data.Map.Internal (line 764, column 25 - line 768, column 38): " + [v.constructor.name, v1.constructor.name]);
  };
  var $lazy_unsafeDifference = /* @__PURE__ */ $runtime_lazy4("unsafeDifference", "Data.Map.Internal", function() {
    return function(comp, l, r) {
      if (l instanceof Leaf) {
        return Leaf.value;
      }
      ;
      if (r instanceof Leaf) {
        return l;
      }
      ;
      if (r instanceof Node2) {
        var v = unsafeSplit(comp, r.value2, l);
        var l$prime = $lazy_unsafeDifference(841)(comp, v.value1, r.value4);
        var r$prime = $lazy_unsafeDifference(842)(comp, v.value2, r.value5);
        return unsafeJoinNodes(l$prime, r$prime);
      }
      ;
      throw new Error("Failed pattern match at Data.Map.Internal (line 836, column 39 - line 843, column 33): " + [l.constructor.name, r.constructor.name]);
    };
  });
  var unsafeDifference = /* @__PURE__ */ $lazy_unsafeDifference(835);
  var $lazy_unsafeIntersectionWith = /* @__PURE__ */ $runtime_lazy4("unsafeIntersectionWith", "Data.Map.Internal", function() {
    return function(comp, app, l, r) {
      if (l instanceof Leaf) {
        return Leaf.value;
      }
      ;
      if (r instanceof Leaf) {
        return Leaf.value;
      }
      ;
      if (r instanceof Node2) {
        var v = unsafeSplit(comp, r.value2, l);
        var l$prime = $lazy_unsafeIntersectionWith(825)(comp, app, v.value1, r.value4);
        var r$prime = $lazy_unsafeIntersectionWith(826)(comp, app, v.value2, r.value5);
        if (v.value0 instanceof Just) {
          return unsafeBalancedNode(r.value2, app(v.value0.value0)(r.value3), l$prime, r$prime);
        }
        ;
        if (v.value0 instanceof Nothing) {
          return unsafeJoinNodes(l$prime, r$prime);
        }
        ;
        throw new Error("Failed pattern match at Data.Map.Internal (line 827, column 5 - line 831, column 37): " + [v.value0.constructor.name]);
      }
      ;
      throw new Error("Failed pattern match at Data.Map.Internal (line 820, column 49 - line 831, column 37): " + [l.constructor.name, r.constructor.name]);
    };
  });
  var unsafeIntersectionWith = /* @__PURE__ */ $lazy_unsafeIntersectionWith(819);
  var $lazy_unsafeUnionWith = /* @__PURE__ */ $runtime_lazy4("unsafeUnionWith", "Data.Map.Internal", function() {
    return function(comp, app, l, r) {
      if (l instanceof Leaf) {
        return r;
      }
      ;
      if (r instanceof Leaf) {
        return l;
      }
      ;
      if (r instanceof Node2) {
        var v = unsafeSplit(comp, r.value2, l);
        var l$prime = $lazy_unsafeUnionWith(809)(comp, app, v.value1, r.value4);
        var r$prime = $lazy_unsafeUnionWith(810)(comp, app, v.value2, r.value5);
        if (v.value0 instanceof Just) {
          return unsafeBalancedNode(r.value2, app(v.value0.value0)(r.value3), l$prime, r$prime);
        }
        ;
        if (v.value0 instanceof Nothing) {
          return unsafeBalancedNode(r.value2, r.value3, l$prime, r$prime);
        }
        ;
        throw new Error("Failed pattern match at Data.Map.Internal (line 811, column 5 - line 815, column 46): " + [v.value0.constructor.name]);
      }
      ;
      throw new Error("Failed pattern match at Data.Map.Internal (line 804, column 42 - line 815, column 46): " + [l.constructor.name, r.constructor.name]);
    };
  });
  var unsafeUnionWith = /* @__PURE__ */ $lazy_unsafeUnionWith(803);
  var unionWith = function(dictOrd) {
    var compare26 = compare(dictOrd);
    return function(app) {
      return function(m1) {
        return function(m2) {
          return unsafeUnionWith(compare26, app, m1, m2);
        };
      };
    };
  };
  var union2 = function(dictOrd) {
    return unionWith(dictOrd)($$const);
  };
  var pop = function(dictOrd) {
    var compare26 = compare(dictOrd);
    return function(k) {
      return function(m) {
        var v = unsafeSplit(compare26, k, m);
        return map21(function(a2) {
          return new Tuple(a2, unsafeJoinNodes(v.value1, v.value2));
        })(v.value0);
      };
    };
  };
  var member = function(dictOrd) {
    var compare26 = compare(dictOrd);
    return function(k) {
      var go2 = function($copy_v) {
        var $tco_done = false;
        var $tco_result;
        function $tco_loop(v) {
          if (v instanceof Leaf) {
            $tco_done = true;
            return false;
          }
          ;
          if (v instanceof Node2) {
            var v1 = compare26(k)(v.value2);
            if (v1 instanceof LT) {
              $copy_v = v.value4;
              return;
            }
            ;
            if (v1 instanceof GT) {
              $copy_v = v.value5;
              return;
            }
            ;
            if (v1 instanceof EQ) {
              $tco_done = true;
              return true;
            }
            ;
            throw new Error("Failed pattern match at Data.Map.Internal (line 459, column 7 - line 462, column 19): " + [v1.constructor.name]);
          }
          ;
          throw new Error("Failed pattern match at Data.Map.Internal (line 456, column 8 - line 462, column 19): " + [v.constructor.name]);
        }
        ;
        while (!$tco_done) {
          $tco_result = $tco_loop($copy_v);
        }
        ;
        return $tco_result;
      };
      return go2;
    };
  };
  var lookup2 = function(dictOrd) {
    var compare26 = compare(dictOrd);
    return function(k) {
      var go2 = function($copy_v) {
        var $tco_done = false;
        var $tco_result;
        function $tco_loop(v) {
          if (v instanceof Leaf) {
            $tco_done = true;
            return Nothing.value;
          }
          ;
          if (v instanceof Node2) {
            var v1 = compare26(k)(v.value2);
            if (v1 instanceof LT) {
              $copy_v = v.value4;
              return;
            }
            ;
            if (v1 instanceof GT) {
              $copy_v = v.value5;
              return;
            }
            ;
            if (v1 instanceof EQ) {
              $tco_done = true;
              return new Just(v.value3);
            }
            ;
            throw new Error("Failed pattern match at Data.Map.Internal (line 283, column 7 - line 286, column 22): " + [v1.constructor.name]);
          }
          ;
          throw new Error("Failed pattern match at Data.Map.Internal (line 280, column 8 - line 286, column 22): " + [v.constructor.name]);
        }
        ;
        while (!$tco_done) {
          $tco_result = $tco_loop($copy_v);
        }
        ;
        return $tco_result;
      };
      return go2;
    };
  };
  var iterMapL = /* @__PURE__ */ (function() {
    var go2 = function($copy_iter) {
      return function($copy_v) {
        var $tco_var_iter = $copy_iter;
        var $tco_done = false;
        var $tco_result;
        function $tco_loop(iter, v) {
          if (v instanceof Leaf) {
            $tco_done = true;
            return iter;
          }
          ;
          if (v instanceof Node2) {
            if (v.value5 instanceof Leaf) {
              $tco_var_iter = new IterEmit(v.value2, v.value3, iter);
              $copy_v = v.value4;
              return;
            }
            ;
            $tco_var_iter = new IterEmit(v.value2, v.value3, new IterNode(v.value5, iter));
            $copy_v = v.value4;
            return;
          }
          ;
          throw new Error("Failed pattern match at Data.Map.Internal (line 951, column 13 - line 958, column 48): " + [v.constructor.name]);
        }
        ;
        while (!$tco_done) {
          $tco_result = $tco_loop($tco_var_iter, $copy_v);
        }
        ;
        return $tco_result;
      };
    };
    return go2;
  })();
  var stepAscCps = /* @__PURE__ */ stepWith(iterMapL);
  var stepUnfoldr = /* @__PURE__ */ (function() {
    var step4 = function(k, v, next2) {
      return new Just(new Tuple(new Tuple(k, v), next2));
    };
    return stepAscCps(step4)(function(v) {
      return Nothing.value;
    });
  })();
  var toUnfoldable3 = function(dictUnfoldable) {
    var $784 = unfoldr(dictUnfoldable)(stepUnfoldr);
    return function($785) {
      return $784(toMapIter($785));
    };
  };
  var isEmpty = function(v) {
    if (v instanceof Leaf) {
      return true;
    }
    ;
    return false;
  };
  var intersectionWith = function(dictOrd) {
    var compare26 = compare(dictOrd);
    return function(app) {
      return function(m1) {
        return function(m2) {
          return unsafeIntersectionWith(compare26, app, m1, m2);
        };
      };
    };
  };
  var intersection = function(dictOrd) {
    return intersectionWith(dictOrd)($$const);
  };
  var insertWith = function(dictOrd) {
    var compare26 = compare(dictOrd);
    return function(app) {
      return function(k) {
        return function(v) {
          var go2 = function(v1) {
            if (v1 instanceof Leaf) {
              return singleton8(k)(v);
            }
            ;
            if (v1 instanceof Node2) {
              var v2 = compare26(k)(v1.value2);
              if (v2 instanceof LT) {
                return unsafeBalancedNode(v1.value2, v1.value3, go2(v1.value4), v1.value5);
              }
              ;
              if (v2 instanceof GT) {
                return unsafeBalancedNode(v1.value2, v1.value3, v1.value4, go2(v1.value5));
              }
              ;
              if (v2 instanceof EQ) {
                return new Node2(v1.value0, v1.value1, k, app(v1.value3)(v), v1.value4, v1.value5);
              }
              ;
              throw new Error("Failed pattern match at Data.Map.Internal (line 486, column 7 - line 489, column 44): " + [v2.constructor.name]);
            }
            ;
            throw new Error("Failed pattern match at Data.Map.Internal (line 483, column 8 - line 489, column 44): " + [v1.constructor.name]);
          };
          return go2;
        };
      };
    };
  };
  var insert = function(dictOrd) {
    var compare26 = compare(dictOrd);
    return function(k) {
      return function(v) {
        var go2 = function(v1) {
          if (v1 instanceof Leaf) {
            return singleton8(k)(v);
          }
          ;
          if (v1 instanceof Node2) {
            var v2 = compare26(k)(v1.value2);
            if (v2 instanceof LT) {
              return unsafeBalancedNode(v1.value2, v1.value3, go2(v1.value4), v1.value5);
            }
            ;
            if (v2 instanceof GT) {
              return unsafeBalancedNode(v1.value2, v1.value3, v1.value4, go2(v1.value5));
            }
            ;
            if (v2 instanceof EQ) {
              return new Node2(v1.value0, v1.value1, k, v, v1.value4, v1.value5);
            }
            ;
            throw new Error("Failed pattern match at Data.Map.Internal (line 471, column 7 - line 474, column 35): " + [v2.constructor.name]);
          }
          ;
          throw new Error("Failed pattern match at Data.Map.Internal (line 468, column 8 - line 474, column 35): " + [v1.constructor.name]);
        };
        return go2;
      };
    };
  };
  var functorMap = {
    map: function(f) {
      var go2 = function(v) {
        if (v instanceof Leaf) {
          return Leaf.value;
        }
        ;
        if (v instanceof Node2) {
          return new Node2(v.value0, v.value1, v.value2, f(v.value3), go2(v.value4), go2(v.value5));
        }
        ;
        throw new Error("Failed pattern match at Data.Map.Internal (line 147, column 10 - line 150, column 39): " + [v.constructor.name]);
      };
      return go2;
    }
  };
  var foldableMap = {
    foldr: function(f) {
      return function(z) {
        var $lazy_go = $runtime_lazy4("go", "Data.Map.Internal", function() {
          return function(m$prime, z$prime) {
            if (m$prime instanceof Leaf) {
              return z$prime;
            }
            ;
            if (m$prime instanceof Node2) {
              return $lazy_go(172)(m$prime.value4, f(m$prime.value3)($lazy_go(172)(m$prime.value5, z$prime)));
            }
            ;
            throw new Error("Failed pattern match at Data.Map.Internal (line 169, column 26 - line 172, column 43): " + [m$prime.constructor.name]);
          };
        });
        var go2 = $lazy_go(169);
        return function(m) {
          return go2(m, z);
        };
      };
    },
    foldl: function(f) {
      return function(z) {
        var $lazy_go = $runtime_lazy4("go", "Data.Map.Internal", function() {
          return function(z$prime, m$prime) {
            if (m$prime instanceof Leaf) {
              return z$prime;
            }
            ;
            if (m$prime instanceof Node2) {
              return $lazy_go(178)(f($lazy_go(178)(z$prime, m$prime.value4))(m$prime.value3), m$prime.value5);
            }
            ;
            throw new Error("Failed pattern match at Data.Map.Internal (line 175, column 26 - line 178, column 43): " + [m$prime.constructor.name]);
          };
        });
        var go2 = $lazy_go(175);
        return function(m) {
          return go2(z, m);
        };
      };
    },
    foldMap: function(dictMonoid) {
      var mempty3 = mempty(dictMonoid);
      var append127 = append(dictMonoid.Semigroup0());
      return function(f) {
        var go2 = function(v) {
          if (v instanceof Leaf) {
            return mempty3;
          }
          ;
          if (v instanceof Node2) {
            return append127(go2(v.value4))(append127(f(v.value3))(go2(v.value5)));
          }
          ;
          throw new Error("Failed pattern match at Data.Map.Internal (line 181, column 10 - line 184, column 28): " + [v.constructor.name]);
        };
        return go2;
      };
    }
  };
  var foldableWithIndexMap = {
    foldrWithIndex: function(f) {
      return function(z) {
        var $lazy_go = $runtime_lazy4("go", "Data.Map.Internal", function() {
          return function(m$prime, z$prime) {
            if (m$prime instanceof Leaf) {
              return z$prime;
            }
            ;
            if (m$prime instanceof Node2) {
              return $lazy_go(192)(m$prime.value4, f(m$prime.value2)(m$prime.value3)($lazy_go(192)(m$prime.value5, z$prime)));
            }
            ;
            throw new Error("Failed pattern match at Data.Map.Internal (line 189, column 26 - line 192, column 45): " + [m$prime.constructor.name]);
          };
        });
        var go2 = $lazy_go(189);
        return function(m) {
          return go2(m, z);
        };
      };
    },
    foldlWithIndex: function(f) {
      return function(z) {
        var $lazy_go = $runtime_lazy4("go", "Data.Map.Internal", function() {
          return function(z$prime, m$prime) {
            if (m$prime instanceof Leaf) {
              return z$prime;
            }
            ;
            if (m$prime instanceof Node2) {
              return $lazy_go(198)(f(m$prime.value2)($lazy_go(198)(z$prime, m$prime.value4))(m$prime.value3), m$prime.value5);
            }
            ;
            throw new Error("Failed pattern match at Data.Map.Internal (line 195, column 26 - line 198, column 45): " + [m$prime.constructor.name]);
          };
        });
        var go2 = $lazy_go(195);
        return function(m) {
          return go2(z, m);
        };
      };
    },
    foldMapWithIndex: function(dictMonoid) {
      var mempty3 = mempty(dictMonoid);
      var append127 = append(dictMonoid.Semigroup0());
      return function(f) {
        var go2 = function(v) {
          if (v instanceof Leaf) {
            return mempty3;
          }
          ;
          if (v instanceof Node2) {
            return append127(go2(v.value4))(append127(f(v.value2)(v.value3))(go2(v.value5)));
          }
          ;
          throw new Error("Failed pattern match at Data.Map.Internal (line 201, column 10 - line 204, column 30): " + [v.constructor.name]);
        };
        return go2;
      };
    },
    Foldable0: function() {
      return foldableMap;
    }
  };
  var keys2 = /* @__PURE__ */ (function() {
    return foldrWithIndex(foldableWithIndexMap)(function(k) {
      return function(v) {
        return function(acc) {
          return new Cons(k, acc);
        };
      };
    })(Nil.value);
  })();
  var values = /* @__PURE__ */ (function() {
    return foldr(foldableMap)(Cons.create)(Nil.value);
  })();
  var findMin = function($copy_v) {
    var $tco_done = false;
    var $tco_result;
    function $tco_loop(v) {
      if (v instanceof Leaf) {
        $tco_done = true;
        return Nothing.value;
      }
      ;
      if (v instanceof Node2) {
        if (v.value4 instanceof Leaf) {
          $tco_done = true;
          return new Just({
            key: v.value2,
            value: v.value3
          });
        }
        ;
        $copy_v = v.value4;
        return;
      }
      ;
      throw new Error("Failed pattern match at Data.Map.Internal (line 361, column 11 - line 366, column 21): " + [v.constructor.name]);
    }
    ;
    while (!$tco_done) {
      $tco_result = $tco_loop($copy_v);
    }
    ;
    return $tco_result;
  };
  var filterKeys = function(dictOrd) {
    return function(f) {
      var go2 = function(v) {
        if (v instanceof Leaf) {
          return Leaf.value;
        }
        ;
        if (v instanceof Node2) {
          if (f(v.value2)) {
            return unsafeBalancedNode(v.value2, v.value3, go2(v.value4), go2(v.value5));
          }
          ;
          if (otherwise) {
            return unsafeJoinNodes(go2(v.value4), go2(v.value5));
          }
          ;
        }
        ;
        throw new Error("Failed pattern match at Data.Map.Internal (line 640, column 8 - line 646, column 47): " + [v.constructor.name]);
      };
      return go2;
    };
  };
  var empty3 = /* @__PURE__ */ (function() {
    return Leaf.value;
  })();
  var fromFoldable6 = function(dictOrd) {
    var insert16 = insert(dictOrd);
    return function(dictFoldable) {
      return foldl(dictFoldable)(function(m) {
        return function(v) {
          return insert16(v.value0)(v.value1)(m);
        };
      })(empty3);
    };
  };
  var fromFoldableWith = function(dictOrd) {
    var insertWith1 = insertWith(dictOrd);
    return function(dictFoldable) {
      var foldl19 = foldl(dictFoldable);
      return function(f) {
        var f$prime = insertWith1(flip(f));
        return foldl19(function(m) {
          return function(v) {
            return f$prime(v.value0)(v.value1)(m);
          };
        })(empty3);
      };
    };
  };
  var difference2 = function(dictOrd) {
    var compare26 = compare(dictOrd);
    return function(m1) {
      return function(m2) {
        return unsafeDifference(compare26, m1, m2);
      };
    };
  };
  var $$delete3 = function(dictOrd) {
    var compare26 = compare(dictOrd);
    return function(k) {
      var go2 = function(v) {
        if (v instanceof Leaf) {
          return Leaf.value;
        }
        ;
        if (v instanceof Node2) {
          var v1 = compare26(k)(v.value2);
          if (v1 instanceof LT) {
            return unsafeBalancedNode(v.value2, v.value3, go2(v.value4), v.value5);
          }
          ;
          if (v1 instanceof GT) {
            return unsafeBalancedNode(v.value2, v.value3, v.value4, go2(v.value5));
          }
          ;
          if (v1 instanceof EQ) {
            return unsafeJoinNodes(v.value4, v.value5);
          }
          ;
          throw new Error("Failed pattern match at Data.Map.Internal (line 498, column 7 - line 501, column 43): " + [v1.constructor.name]);
        }
        ;
        throw new Error("Failed pattern match at Data.Map.Internal (line 495, column 8 - line 501, column 43): " + [v.constructor.name]);
      };
      return go2;
    };
  };
  var alter = function(dictOrd) {
    var compare26 = compare(dictOrd);
    return function(f) {
      return function(k) {
        return function(m) {
          var v = unsafeSplit(compare26, k, m);
          var v2 = f(v.value0);
          if (v2 instanceof Nothing) {
            return unsafeJoinNodes(v.value1, v.value2);
          }
          ;
          if (v2 instanceof Just) {
            return unsafeBalancedNode(k, v2.value0, v.value1, v.value2);
          }
          ;
          throw new Error("Failed pattern match at Data.Map.Internal (line 514, column 3 - line 518, column 41): " + [v2.constructor.name]);
        };
      };
    };
  };

  // output/Halogen.Data.OrdBox/index.js
  var OrdBox = /* @__PURE__ */ (function() {
    function OrdBox2(value0, value1, value22) {
      this.value0 = value0;
      this.value1 = value1;
      this.value2 = value22;
    }
    ;
    OrdBox2.create = function(value0) {
      return function(value1) {
        return function(value22) {
          return new OrdBox2(value0, value1, value22);
        };
      };
    };
    return OrdBox2;
  })();
  var mkOrdBox = function(dictOrd) {
    return OrdBox.create(eq(dictOrd.Eq0()))(compare(dictOrd));
  };
  var eqOrdBox = {
    eq: function(v) {
      return function(v1) {
        return v.value0(v.value2)(v1.value2);
      };
    }
  };
  var ordOrdBox = {
    compare: function(v) {
      return function(v1) {
        return v.value1(v.value2)(v1.value2);
      };
    },
    Eq0: function() {
      return eqOrdBox;
    }
  };

  // output/Halogen.Data.Slot/index.js
  var ordTuple2 = /* @__PURE__ */ ordTuple(ordString)(ordOrdBox);
  var pop1 = /* @__PURE__ */ pop(ordTuple2);
  var lookup1 = /* @__PURE__ */ lookup2(ordTuple2);
  var insert1 = /* @__PURE__ */ insert(ordTuple2);
  var pop2 = function() {
    return function(dictIsSymbol) {
      var reflectSymbol2 = reflectSymbol(dictIsSymbol);
      return function(dictOrd) {
        var mkOrdBox2 = mkOrdBox(dictOrd);
        return function(sym) {
          return function(key) {
            return function(v) {
              return pop1(new Tuple(reflectSymbol2(sym), mkOrdBox2(key)))(v);
            };
          };
        };
      };
    };
  };
  var lookup3 = function() {
    return function(dictIsSymbol) {
      var reflectSymbol2 = reflectSymbol(dictIsSymbol);
      return function(dictOrd) {
        var mkOrdBox2 = mkOrdBox(dictOrd);
        return function(sym) {
          return function(key) {
            return function(v) {
              return lookup1(new Tuple(reflectSymbol2(sym), mkOrdBox2(key)))(v);
            };
          };
        };
      };
    };
  };
  var insert2 = function() {
    return function(dictIsSymbol) {
      var reflectSymbol2 = reflectSymbol(dictIsSymbol);
      return function(dictOrd) {
        var mkOrdBox2 = mkOrdBox(dictOrd);
        return function(sym) {
          return function(key) {
            return function(val) {
              return function(v) {
                return insert1(new Tuple(reflectSymbol2(sym), mkOrdBox2(key)))(val)(v);
              };
            };
          };
        };
      };
    };
  };
  var foreachSlot = function(dictApplicative) {
    var traverse_10 = traverse_(dictApplicative)(foldableMap);
    return function(v) {
      return function(k) {
        return traverse_10(function($54) {
          return k($54);
        })(v);
      };
    };
  };
  var empty4 = empty3;

  // output/DOM.HTML.Indexed.InputType/index.js
  var InputButton = /* @__PURE__ */ (function() {
    function InputButton2() {
    }
    ;
    InputButton2.value = new InputButton2();
    return InputButton2;
  })();
  var InputCheckbox = /* @__PURE__ */ (function() {
    function InputCheckbox2() {
    }
    ;
    InputCheckbox2.value = new InputCheckbox2();
    return InputCheckbox2;
  })();
  var InputColor = /* @__PURE__ */ (function() {
    function InputColor2() {
    }
    ;
    InputColor2.value = new InputColor2();
    return InputColor2;
  })();
  var InputDate = /* @__PURE__ */ (function() {
    function InputDate2() {
    }
    ;
    InputDate2.value = new InputDate2();
    return InputDate2;
  })();
  var InputDatetimeLocal = /* @__PURE__ */ (function() {
    function InputDatetimeLocal2() {
    }
    ;
    InputDatetimeLocal2.value = new InputDatetimeLocal2();
    return InputDatetimeLocal2;
  })();
  var InputEmail = /* @__PURE__ */ (function() {
    function InputEmail2() {
    }
    ;
    InputEmail2.value = new InputEmail2();
    return InputEmail2;
  })();
  var InputFile = /* @__PURE__ */ (function() {
    function InputFile2() {
    }
    ;
    InputFile2.value = new InputFile2();
    return InputFile2;
  })();
  var InputHidden = /* @__PURE__ */ (function() {
    function InputHidden2() {
    }
    ;
    InputHidden2.value = new InputHidden2();
    return InputHidden2;
  })();
  var InputImage = /* @__PURE__ */ (function() {
    function InputImage2() {
    }
    ;
    InputImage2.value = new InputImage2();
    return InputImage2;
  })();
  var InputMonth = /* @__PURE__ */ (function() {
    function InputMonth2() {
    }
    ;
    InputMonth2.value = new InputMonth2();
    return InputMonth2;
  })();
  var InputNumber = /* @__PURE__ */ (function() {
    function InputNumber2() {
    }
    ;
    InputNumber2.value = new InputNumber2();
    return InputNumber2;
  })();
  var InputPassword = /* @__PURE__ */ (function() {
    function InputPassword2() {
    }
    ;
    InputPassword2.value = new InputPassword2();
    return InputPassword2;
  })();
  var InputRadio = /* @__PURE__ */ (function() {
    function InputRadio2() {
    }
    ;
    InputRadio2.value = new InputRadio2();
    return InputRadio2;
  })();
  var InputRange = /* @__PURE__ */ (function() {
    function InputRange2() {
    }
    ;
    InputRange2.value = new InputRange2();
    return InputRange2;
  })();
  var InputReset = /* @__PURE__ */ (function() {
    function InputReset2() {
    }
    ;
    InputReset2.value = new InputReset2();
    return InputReset2;
  })();
  var InputSearch = /* @__PURE__ */ (function() {
    function InputSearch2() {
    }
    ;
    InputSearch2.value = new InputSearch2();
    return InputSearch2;
  })();
  var InputSubmit = /* @__PURE__ */ (function() {
    function InputSubmit2() {
    }
    ;
    InputSubmit2.value = new InputSubmit2();
    return InputSubmit2;
  })();
  var InputTel = /* @__PURE__ */ (function() {
    function InputTel2() {
    }
    ;
    InputTel2.value = new InputTel2();
    return InputTel2;
  })();
  var InputText = /* @__PURE__ */ (function() {
    function InputText2() {
    }
    ;
    InputText2.value = new InputText2();
    return InputText2;
  })();
  var InputTime = /* @__PURE__ */ (function() {
    function InputTime2() {
    }
    ;
    InputTime2.value = new InputTime2();
    return InputTime2;
  })();
  var InputUrl = /* @__PURE__ */ (function() {
    function InputUrl2() {
    }
    ;
    InputUrl2.value = new InputUrl2();
    return InputUrl2;
  })();
  var InputWeek = /* @__PURE__ */ (function() {
    function InputWeek2() {
    }
    ;
    InputWeek2.value = new InputWeek2();
    return InputWeek2;
  })();
  var renderInputType = function(v) {
    if (v instanceof InputButton) {
      return "button";
    }
    ;
    if (v instanceof InputCheckbox) {
      return "checkbox";
    }
    ;
    if (v instanceof InputColor) {
      return "color";
    }
    ;
    if (v instanceof InputDate) {
      return "date";
    }
    ;
    if (v instanceof InputDatetimeLocal) {
      return "datetime-local";
    }
    ;
    if (v instanceof InputEmail) {
      return "email";
    }
    ;
    if (v instanceof InputFile) {
      return "file";
    }
    ;
    if (v instanceof InputHidden) {
      return "hidden";
    }
    ;
    if (v instanceof InputImage) {
      return "image";
    }
    ;
    if (v instanceof InputMonth) {
      return "month";
    }
    ;
    if (v instanceof InputNumber) {
      return "number";
    }
    ;
    if (v instanceof InputPassword) {
      return "password";
    }
    ;
    if (v instanceof InputRadio) {
      return "radio";
    }
    ;
    if (v instanceof InputRange) {
      return "range";
    }
    ;
    if (v instanceof InputReset) {
      return "reset";
    }
    ;
    if (v instanceof InputSearch) {
      return "search";
    }
    ;
    if (v instanceof InputSubmit) {
      return "submit";
    }
    ;
    if (v instanceof InputTel) {
      return "tel";
    }
    ;
    if (v instanceof InputText) {
      return "text";
    }
    ;
    if (v instanceof InputTime) {
      return "time";
    }
    ;
    if (v instanceof InputUrl) {
      return "url";
    }
    ;
    if (v instanceof InputWeek) {
      return "week";
    }
    ;
    throw new Error("Failed pattern match at DOM.HTML.Indexed.InputType (line 33, column 19 - line 55, column 22): " + [v.constructor.name]);
  };

  // output/DOM.HTML.Indexed.StepValue/index.js
  var show6 = /* @__PURE__ */ show(showNumber);
  var Any = /* @__PURE__ */ (function() {
    function Any2() {
    }
    ;
    Any2.value = new Any2();
    return Any2;
  })();
  var Step = /* @__PURE__ */ (function() {
    function Step5(value0) {
      this.value0 = value0;
    }
    ;
    Step5.create = function(value0) {
      return new Step5(value0);
    };
    return Step5;
  })();
  var renderStepValue = function(v) {
    if (v instanceof Any) {
      return "any";
    }
    ;
    if (v instanceof Step) {
      return show6(v.value0);
    }
    ;
    throw new Error("Failed pattern match at DOM.HTML.Indexed.StepValue (line 13, column 19 - line 15, column 19): " + [v.constructor.name]);
  };

  // output/Halogen.Query.Input/index.js
  var RefUpdate = /* @__PURE__ */ (function() {
    function RefUpdate2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    RefUpdate2.create = function(value0) {
      return function(value1) {
        return new RefUpdate2(value0, value1);
      };
    };
    return RefUpdate2;
  })();
  var Action = /* @__PURE__ */ (function() {
    function Action3(value0) {
      this.value0 = value0;
    }
    ;
    Action3.create = function(value0) {
      return new Action3(value0);
    };
    return Action3;
  })();

  // output/Halogen.VDom.Machine/index.js
  var Step2 = /* @__PURE__ */ (function() {
    function Step5(value0, value1, value22, value32) {
      this.value0 = value0;
      this.value1 = value1;
      this.value2 = value22;
      this.value3 = value32;
    }
    ;
    Step5.create = function(value0) {
      return function(value1) {
        return function(value22) {
          return function(value32) {
            return new Step5(value0, value1, value22, value32);
          };
        };
      };
    };
    return Step5;
  })();
  var unStep = unsafeCoerce2;
  var step = function(v, a2) {
    return v.value2(v.value1, a2);
  };
  var mkStep = unsafeCoerce2;
  var halt = function(v) {
    return v.value3(v.value1);
  };
  var extract2 = /* @__PURE__ */ unStep(function(v) {
    return v.value0;
  });

  // output/Halogen.VDom.Types/index.js
  var map23 = /* @__PURE__ */ map(functorArray);
  var map111 = /* @__PURE__ */ map(functorTuple);
  var Text2 = /* @__PURE__ */ (function() {
    function Text4(value0) {
      this.value0 = value0;
    }
    ;
    Text4.create = function(value0) {
      return new Text4(value0);
    };
    return Text4;
  })();
  var Elem = /* @__PURE__ */ (function() {
    function Elem2(value0, value1, value22, value32) {
      this.value0 = value0;
      this.value1 = value1;
      this.value2 = value22;
      this.value3 = value32;
    }
    ;
    Elem2.create = function(value0) {
      return function(value1) {
        return function(value22) {
          return function(value32) {
            return new Elem2(value0, value1, value22, value32);
          };
        };
      };
    };
    return Elem2;
  })();
  var Keyed = /* @__PURE__ */ (function() {
    function Keyed2(value0, value1, value22, value32) {
      this.value0 = value0;
      this.value1 = value1;
      this.value2 = value22;
      this.value3 = value32;
    }
    ;
    Keyed2.create = function(value0) {
      return function(value1) {
        return function(value22) {
          return function(value32) {
            return new Keyed2(value0, value1, value22, value32);
          };
        };
      };
    };
    return Keyed2;
  })();
  var Widget = /* @__PURE__ */ (function() {
    function Widget2(value0) {
      this.value0 = value0;
    }
    ;
    Widget2.create = function(value0) {
      return new Widget2(value0);
    };
    return Widget2;
  })();
  var Grafted = /* @__PURE__ */ (function() {
    function Grafted2(value0) {
      this.value0 = value0;
    }
    ;
    Grafted2.create = function(value0) {
      return new Grafted2(value0);
    };
    return Grafted2;
  })();
  var Graft = /* @__PURE__ */ (function() {
    function Graft2(value0, value1, value22) {
      this.value0 = value0;
      this.value1 = value1;
      this.value2 = value22;
    }
    ;
    Graft2.create = function(value0) {
      return function(value1) {
        return function(value22) {
          return new Graft2(value0, value1, value22);
        };
      };
    };
    return Graft2;
  })();
  var unGraft = function(f) {
    return function($61) {
      return f($61);
    };
  };
  var graft = unsafeCoerce2;
  var bifunctorGraft = {
    bimap: function(f) {
      return function(g) {
        return unGraft(function(v) {
          return graft(new Graft(function($63) {
            return f(v.value0($63));
          }, function($64) {
            return g(v.value1($64));
          }, v.value2));
        });
      };
    }
  };
  var bimap2 = /* @__PURE__ */ bimap(bifunctorGraft);
  var runGraft = /* @__PURE__ */ unGraft(function(v) {
    var go2 = function(v2) {
      if (v2 instanceof Text2) {
        return new Text2(v2.value0);
      }
      ;
      if (v2 instanceof Elem) {
        return new Elem(v2.value0, v2.value1, v.value0(v2.value2), map23(go2)(v2.value3));
      }
      ;
      if (v2 instanceof Keyed) {
        return new Keyed(v2.value0, v2.value1, v.value0(v2.value2), map23(map111(go2))(v2.value3));
      }
      ;
      if (v2 instanceof Widget) {
        return new Widget(v.value1(v2.value0));
      }
      ;
      if (v2 instanceof Grafted) {
        return new Grafted(bimap2(v.value0)(v.value1)(v2.value0));
      }
      ;
      throw new Error("Failed pattern match at Halogen.VDom.Types (line 86, column 7 - line 86, column 27): " + [v2.constructor.name]);
    };
    return go2(v.value2);
  });

  // output/Halogen.VDom.Util/foreign.js
  function unsafeGetAny(key, obj) {
    return obj[key];
  }
  function unsafeHasAny(key, obj) {
    return obj.hasOwnProperty(key);
  }
  function unsafeSetAny(key, val, obj) {
    obj[key] = val;
  }
  function forE2(a2, f) {
    var b10 = [];
    for (var i2 = 0; i2 < a2.length; i2++) {
      b10.push(f(i2, a2[i2]));
    }
    return b10;
  }
  function forEachE(a2, f) {
    for (var i2 = 0; i2 < a2.length; i2++) {
      f(a2[i2]);
    }
  }
  function forInE(o, f) {
    var ks = Object.keys(o);
    for (var i2 = 0; i2 < ks.length; i2++) {
      var k = ks[i2];
      f(k, o[k]);
    }
  }
  function diffWithIxE(a1, a2, f1, f2, f3) {
    var a3 = [];
    var l1 = a1.length;
    var l2 = a2.length;
    var i2 = 0;
    while (1) {
      if (i2 < l1) {
        if (i2 < l2) {
          a3.push(f1(i2, a1[i2], a2[i2]));
        } else {
          f2(i2, a1[i2]);
        }
      } else if (i2 < l2) {
        a3.push(f3(i2, a2[i2]));
      } else {
        break;
      }
      i2++;
    }
    return a3;
  }
  function strMapWithIxE(as, fk, f) {
    var o = {};
    for (var i2 = 0; i2 < as.length; i2++) {
      var a2 = as[i2];
      var k = fk(a2);
      o[k] = f(k, i2, a2);
    }
    return o;
  }
  function diffWithKeyAndIxE(o1, as, fk, f1, f2, f3) {
    var o2 = {};
    for (var i2 = 0; i2 < as.length; i2++) {
      var a2 = as[i2];
      var k = fk(a2);
      if (o1.hasOwnProperty(k)) {
        o2[k] = f1(k, i2, o1[k], a2);
      } else {
        o2[k] = f3(k, i2, a2);
      }
    }
    for (var k in o1) {
      if (k in o2) {
        continue;
      }
      f2(k, o1[k]);
    }
    return o2;
  }
  function refEq2(a2, b10) {
    return a2 === b10;
  }
  function createTextNode(s, doc) {
    return doc.createTextNode(s);
  }
  function setTextContent(s, n) {
    n.textContent = s;
  }
  function createElement(ns, name16, doc) {
    if (ns != null) {
      return doc.createElementNS(ns, name16);
    } else {
      return doc.createElement(name16);
    }
  }
  function insertChildIx(i2, a2, b10) {
    var n = b10.childNodes.item(i2) || null;
    if (n !== a2) {
      b10.insertBefore(a2, n);
    }
  }
  function removeChild(a2, b10) {
    if (b10 && a2.parentNode === b10) {
      b10.removeChild(a2);
    }
  }
  function parentNode(a2) {
    return a2.parentNode;
  }
  function setAttribute(ns, attr3, val, el) {
    if (ns != null) {
      el.setAttributeNS(ns, attr3, val);
    } else {
      el.setAttribute(attr3, val);
    }
  }
  function removeAttribute(ns, attr3, el) {
    if (ns != null) {
      el.removeAttributeNS(ns, attr3);
    } else {
      el.removeAttribute(attr3);
    }
  }
  function hasAttribute(ns, attr3, el) {
    if (ns != null) {
      return el.hasAttributeNS(ns, attr3);
    } else {
      return el.hasAttribute(attr3);
    }
  }
  function addEventListener(ev, listener, el) {
    el.addEventListener(ev, listener, false);
  }
  function removeEventListener(ev, listener, el) {
    el.removeEventListener(ev, listener, false);
  }
  var jsUndefined = void 0;

  // output/Halogen.VDom.Util/index.js
  var unsafeLookup = unsafeGetAny;
  var unsafeFreeze2 = unsafeCoerce2;
  var pokeMutMap = unsafeSetAny;
  var newMutMap = newImpl;

  // output/Web.DOM.Element/foreign.js
  var getProp = function(name16) {
    return function(doctype) {
      return doctype[name16];
    };
  };
  var _namespaceURI = getProp("namespaceURI");
  var _prefix = getProp("prefix");
  var localName = getProp("localName");
  var tagName = getProp("tagName");
  function setAttribute2(name16) {
    return function(value18) {
      return function(element3) {
        return function() {
          element3.setAttribute(name16, value18);
        };
      };
    };
  }

  // output/Web.DOM.ParentNode/foreign.js
  var getEffProp = function(name16) {
    return function(node) {
      return function() {
        return node[name16];
      };
    };
  };
  var children = getEffProp("children");
  var _firstElementChild = getEffProp("firstElementChild");
  var _lastElementChild = getEffProp("lastElementChild");
  var childElementCount = getEffProp("childElementCount");
  function _querySelector(selector) {
    return function(node) {
      return function() {
        return node.querySelector(selector);
      };
    };
  }
  function querySelectorAll(selector) {
    return function(node) {
      return function() {
        return node.querySelectorAll(selector);
      };
    };
  }

  // output/Web.DOM.ParentNode/index.js
  var map24 = /* @__PURE__ */ map(functorEffect);
  var querySelector = function(qs) {
    var $2 = map24(toMaybe);
    var $3 = _querySelector(qs);
    return function($4) {
      return $2($3($4));
    };
  };

  // output/Web.Internal.FFI/foreign.js
  function _unsafeReadProtoTagged(nothing, just, name16, value18) {
    if (typeof window !== "undefined") {
      var ty = window[name16];
      if (ty != null && value18 instanceof ty) {
        return just(value18);
      }
    }
    var obj = value18;
    while (obj != null) {
      var proto = Object.getPrototypeOf(obj);
      var constructorName = proto.constructor.name;
      if (constructorName === name16) {
        return just(value18);
      } else if (constructorName === "Object") {
        return nothing;
      }
      obj = proto;
    }
    return nothing;
  }

  // output/Web.Internal.FFI/index.js
  var unsafeReadProtoTagged = function(name16) {
    return function(value18) {
      return _unsafeReadProtoTagged(Nothing.value, Just.create, name16, value18);
    };
  };

  // output/Web.DOM.Element/index.js
  var toParentNode = unsafeCoerce2;
  var toNode = unsafeCoerce2;
  var fromNode = /* @__PURE__ */ unsafeReadProtoTagged("Element");

  // output/Halogen.VDom.DOM/index.js
  var $runtime_lazy5 = function(name16, moduleName, init13) {
    var state3 = 0;
    var val;
    return function(lineNumber) {
      if (state3 === 2) return val;
      if (state3 === 1) throw new ReferenceError(name16 + " was needed before it finished initializing (module " + moduleName + ", line " + lineNumber + ")", moduleName, lineNumber);
      state3 = 1;
      val = init13();
      state3 = 2;
      return val;
    };
  };
  var haltWidget = function(v) {
    return halt(v.widget);
  };
  var $lazy_patchWidget = /* @__PURE__ */ $runtime_lazy5("patchWidget", "Halogen.VDom.DOM", function() {
    return function(state3, vdom) {
      if (vdom instanceof Grafted) {
        return $lazy_patchWidget(291)(state3, runGraft(vdom.value0));
      }
      ;
      if (vdom instanceof Widget) {
        var res = step(state3.widget, vdom.value0);
        var res$prime = unStep(function(v) {
          return mkStep(new Step2(v.value0, {
            build: state3.build,
            widget: res
          }, $lazy_patchWidget(296), haltWidget));
        })(res);
        return res$prime;
      }
      ;
      haltWidget(state3);
      return state3.build(vdom);
    };
  });
  var patchWidget = /* @__PURE__ */ $lazy_patchWidget(286);
  var haltText = function(v) {
    var parent2 = parentNode(v.node);
    return removeChild(v.node, parent2);
  };
  var $lazy_patchText = /* @__PURE__ */ $runtime_lazy5("patchText", "Halogen.VDom.DOM", function() {
    return function(state3, vdom) {
      if (vdom instanceof Grafted) {
        return $lazy_patchText(82)(state3, runGraft(vdom.value0));
      }
      ;
      if (vdom instanceof Text2) {
        if (state3.value === vdom.value0) {
          return mkStep(new Step2(state3.node, state3, $lazy_patchText(85), haltText));
        }
        ;
        if (otherwise) {
          var nextState = {
            build: state3.build,
            node: state3.node,
            value: vdom.value0
          };
          setTextContent(vdom.value0, state3.node);
          return mkStep(new Step2(state3.node, nextState, $lazy_patchText(89), haltText));
        }
        ;
      }
      ;
      haltText(state3);
      return state3.build(vdom);
    };
  });
  var patchText = /* @__PURE__ */ $lazy_patchText(77);
  var haltKeyed = function(v) {
    var parent2 = parentNode(v.node);
    removeChild(v.node, parent2);
    forInE(v.children, function(v1, s) {
      return halt(s);
    });
    return halt(v.attrs);
  };
  var haltElem = function(v) {
    var parent2 = parentNode(v.node);
    removeChild(v.node, parent2);
    forEachE(v.children, halt);
    return halt(v.attrs);
  };
  var eqElemSpec = function(ns1, v, ns2, v1) {
    var $63 = v === v1;
    if ($63) {
      if (ns1 instanceof Just && (ns2 instanceof Just && ns1.value0 === ns2.value0)) {
        return true;
      }
      ;
      if (ns1 instanceof Nothing && ns2 instanceof Nothing) {
        return true;
      }
      ;
      return false;
    }
    ;
    return false;
  };
  var $lazy_patchElem = /* @__PURE__ */ $runtime_lazy5("patchElem", "Halogen.VDom.DOM", function() {
    return function(state3, vdom) {
      if (vdom instanceof Grafted) {
        return $lazy_patchElem(135)(state3, runGraft(vdom.value0));
      }
      ;
      if (vdom instanceof Elem && eqElemSpec(state3.ns, state3.name, vdom.value0, vdom.value1)) {
        var v = length(vdom.value3);
        var v1 = length(state3.children);
        if (v1 === 0 && v === 0) {
          var attrs2 = step(state3.attrs, vdom.value2);
          var nextState = {
            build: state3.build,
            node: state3.node,
            attrs: attrs2,
            ns: vdom.value0,
            name: vdom.value1,
            children: state3.children
          };
          return mkStep(new Step2(state3.node, nextState, $lazy_patchElem(149), haltElem));
        }
        ;
        var onThis = function(v2, s) {
          return halt(s);
        };
        var onThese = function(ix, s, v2) {
          var res = step(s, v2);
          insertChildIx(ix, extract2(res), state3.node);
          return res;
        };
        var onThat = function(ix, v2) {
          var res = state3.build(v2);
          insertChildIx(ix, extract2(res), state3.node);
          return res;
        };
        var children22 = diffWithIxE(state3.children, vdom.value3, onThese, onThis, onThat);
        var attrs2 = step(state3.attrs, vdom.value2);
        var nextState = {
          build: state3.build,
          node: state3.node,
          attrs: attrs2,
          ns: vdom.value0,
          name: vdom.value1,
          children: children22
        };
        return mkStep(new Step2(state3.node, nextState, $lazy_patchElem(172), haltElem));
      }
      ;
      haltElem(state3);
      return state3.build(vdom);
    };
  });
  var patchElem = /* @__PURE__ */ $lazy_patchElem(130);
  var $lazy_patchKeyed = /* @__PURE__ */ $runtime_lazy5("patchKeyed", "Halogen.VDom.DOM", function() {
    return function(state3, vdom) {
      if (vdom instanceof Grafted) {
        return $lazy_patchKeyed(222)(state3, runGraft(vdom.value0));
      }
      ;
      if (vdom instanceof Keyed && eqElemSpec(state3.ns, state3.name, vdom.value0, vdom.value1)) {
        var v = length(vdom.value3);
        if (state3.length === 0 && v === 0) {
          var attrs2 = step(state3.attrs, vdom.value2);
          var nextState = {
            build: state3.build,
            node: state3.node,
            attrs: attrs2,
            ns: vdom.value0,
            name: vdom.value1,
            children: state3.children,
            length: 0
          };
          return mkStep(new Step2(state3.node, nextState, $lazy_patchKeyed(237), haltKeyed));
        }
        ;
        var onThis = function(v2, s) {
          return halt(s);
        };
        var onThese = function(v2, ix$prime, s, v3) {
          var res = step(s, v3.value1);
          insertChildIx(ix$prime, extract2(res), state3.node);
          return res;
        };
        var onThat = function(v2, ix, v3) {
          var res = state3.build(v3.value1);
          insertChildIx(ix, extract2(res), state3.node);
          return res;
        };
        var children22 = diffWithKeyAndIxE(state3.children, vdom.value3, fst, onThese, onThis, onThat);
        var attrs2 = step(state3.attrs, vdom.value2);
        var nextState = {
          build: state3.build,
          node: state3.node,
          attrs: attrs2,
          ns: vdom.value0,
          name: vdom.value1,
          children: children22,
          length: v
        };
        return mkStep(new Step2(state3.node, nextState, $lazy_patchKeyed(261), haltKeyed));
      }
      ;
      haltKeyed(state3);
      return state3.build(vdom);
    };
  });
  var patchKeyed = /* @__PURE__ */ $lazy_patchKeyed(217);
  var buildWidget = function(v, build, w) {
    var res = v.buildWidget(v)(w);
    var res$prime = unStep(function(v1) {
      return mkStep(new Step2(v1.value0, {
        build,
        widget: res
      }, patchWidget, haltWidget));
    })(res);
    return res$prime;
  };
  var buildText = function(v, build, s) {
    var node = createTextNode(s, v.document);
    var state3 = {
      build,
      node,
      value: s
    };
    return mkStep(new Step2(node, state3, patchText, haltText));
  };
  var buildKeyed = function(v, build, ns1, name1, as1, ch1) {
    var el = createElement(toNullable(ns1), name1, v.document);
    var node = toNode(el);
    var onChild = function(v1, ix, v2) {
      var res = build(v2.value1);
      insertChildIx(ix, extract2(res), node);
      return res;
    };
    var children3 = strMapWithIxE(ch1, fst, onChild);
    var attrs = v.buildAttributes(el)(as1);
    var state3 = {
      build,
      node,
      attrs,
      ns: ns1,
      name: name1,
      children: children3,
      length: length(ch1)
    };
    return mkStep(new Step2(node, state3, patchKeyed, haltKeyed));
  };
  var buildElem = function(v, build, ns1, name1, as1, ch1) {
    var el = createElement(toNullable(ns1), name1, v.document);
    var node = toNode(el);
    var onChild = function(ix, child) {
      var res = build(child);
      insertChildIx(ix, extract2(res), node);
      return res;
    };
    var children3 = forE2(ch1, onChild);
    var attrs = v.buildAttributes(el)(as1);
    var state3 = {
      build,
      node,
      attrs,
      ns: ns1,
      name: name1,
      children: children3
    };
    return mkStep(new Step2(node, state3, patchElem, haltElem));
  };
  var buildVDom = function(spec) {
    var $lazy_build = $runtime_lazy5("build", "Halogen.VDom.DOM", function() {
      return function(v) {
        if (v instanceof Text2) {
          return buildText(spec, $lazy_build(59), v.value0);
        }
        ;
        if (v instanceof Elem) {
          return buildElem(spec, $lazy_build(60), v.value0, v.value1, v.value2, v.value3);
        }
        ;
        if (v instanceof Keyed) {
          return buildKeyed(spec, $lazy_build(61), v.value0, v.value1, v.value2, v.value3);
        }
        ;
        if (v instanceof Widget) {
          return buildWidget(spec, $lazy_build(62), v.value0);
        }
        ;
        if (v instanceof Grafted) {
          return $lazy_build(63)(runGraft(v.value0));
        }
        ;
        throw new Error("Failed pattern match at Halogen.VDom.DOM (line 58, column 27 - line 63, column 52): " + [v.constructor.name]);
      };
    });
    var build = $lazy_build(58);
    return build;
  };

  // output/Web.Event.EventTarget/foreign.js
  function eventListener(fn) {
    return function() {
      return function(event) {
        return fn(event)();
      };
    };
  }
  function addEventListener2(type2) {
    return function(listener) {
      return function(useCapture) {
        return function(target7) {
          return function() {
            return target7.addEventListener(type2, listener, useCapture);
          };
        };
      };
    };
  }
  function removeEventListener2(type2) {
    return function(listener) {
      return function(useCapture) {
        return function(target7) {
          return function() {
            return target7.removeEventListener(type2, listener, useCapture);
          };
        };
      };
    };
  }

  // output/Halogen.VDom.DOM.Prop/index.js
  var $runtime_lazy6 = function(name16, moduleName, init13) {
    var state3 = 0;
    var val;
    return function(lineNumber) {
      if (state3 === 2) return val;
      if (state3 === 1) throw new ReferenceError(name16 + " was needed before it finished initializing (module " + moduleName + ", line " + lineNumber + ")", moduleName, lineNumber);
      state3 = 1;
      val = init13();
      state3 = 2;
      return val;
    };
  };
  var Created = /* @__PURE__ */ (function() {
    function Created2(value0) {
      this.value0 = value0;
    }
    ;
    Created2.create = function(value0) {
      return new Created2(value0);
    };
    return Created2;
  })();
  var Removed = /* @__PURE__ */ (function() {
    function Removed2(value0) {
      this.value0 = value0;
    }
    ;
    Removed2.create = function(value0) {
      return new Removed2(value0);
    };
    return Removed2;
  })();
  var Attribute = /* @__PURE__ */ (function() {
    function Attribute2(value0, value1, value22) {
      this.value0 = value0;
      this.value1 = value1;
      this.value2 = value22;
    }
    ;
    Attribute2.create = function(value0) {
      return function(value1) {
        return function(value22) {
          return new Attribute2(value0, value1, value22);
        };
      };
    };
    return Attribute2;
  })();
  var Property = /* @__PURE__ */ (function() {
    function Property2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Property2.create = function(value0) {
      return function(value1) {
        return new Property2(value0, value1);
      };
    };
    return Property2;
  })();
  var Handler = /* @__PURE__ */ (function() {
    function Handler2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Handler2.create = function(value0) {
      return function(value1) {
        return new Handler2(value0, value1);
      };
    };
    return Handler2;
  })();
  var Ref = /* @__PURE__ */ (function() {
    function Ref2(value0) {
      this.value0 = value0;
    }
    ;
    Ref2.create = function(value0) {
      return new Ref2(value0);
    };
    return Ref2;
  })();
  var unsafeGetProperty = unsafeGetAny;
  var setProperty = unsafeSetAny;
  var removeProperty = function(key, el) {
    var v = hasAttribute(nullImpl, key, el);
    if (v) {
      return removeAttribute(nullImpl, key, el);
    }
    ;
    var v1 = typeOf(unsafeGetAny(key, el));
    if (v1 === "string") {
      return unsafeSetAny(key, "", el);
    }
    ;
    if (key === "rowSpan") {
      return unsafeSetAny(key, 1, el);
    }
    ;
    if (key === "colSpan") {
      return unsafeSetAny(key, 1, el);
    }
    ;
    return unsafeSetAny(key, jsUndefined, el);
  };
  var propToStrKey = function(v) {
    if (v instanceof Attribute && v.value0 instanceof Just) {
      return "attr/" + (v.value0.value0 + (":" + v.value1));
    }
    ;
    if (v instanceof Attribute) {
      return "attr/:" + v.value1;
    }
    ;
    if (v instanceof Property) {
      return "prop/" + v.value0;
    }
    ;
    if (v instanceof Handler) {
      return "handler/" + v.value0;
    }
    ;
    if (v instanceof Ref) {
      return "ref";
    }
    ;
    throw new Error("Failed pattern match at Halogen.VDom.DOM.Prop (line 182, column 16 - line 187, column 16): " + [v.constructor.name]);
  };
  var propFromString = unsafeCoerce2;
  var propFromNumber = unsafeCoerce2;
  var propFromBoolean = unsafeCoerce2;
  var buildProp = function(emit) {
    return function(el) {
      var removeProp = function(prevEvents) {
        return function(v, v1) {
          if (v1 instanceof Attribute) {
            return removeAttribute(toNullable(v1.value0), v1.value1, el);
          }
          ;
          if (v1 instanceof Property) {
            return removeProperty(v1.value0, el);
          }
          ;
          if (v1 instanceof Handler) {
            var handler3 = unsafeLookup(v1.value0, prevEvents);
            return removeEventListener(v1.value0, fst(handler3), el);
          }
          ;
          if (v1 instanceof Ref) {
            return unit;
          }
          ;
          throw new Error("Failed pattern match at Halogen.VDom.DOM.Prop (line 169, column 5 - line 179, column 18): " + [v1.constructor.name]);
        };
      };
      var mbEmit = function(v) {
        if (v instanceof Just) {
          return emit(v.value0)();
        }
        ;
        return unit;
      };
      var haltProp = function(state3) {
        var v = lookup("ref")(state3.props);
        if (v instanceof Just && v.value0 instanceof Ref) {
          return mbEmit(v.value0.value0(new Removed(el)));
        }
        ;
        return unit;
      };
      var diffProp = function(prevEvents, events) {
        return function(v, v1, v11, v2) {
          if (v11 instanceof Attribute && v2 instanceof Attribute) {
            var $66 = v11.value2 === v2.value2;
            if ($66) {
              return v2;
            }
            ;
            setAttribute(toNullable(v2.value0), v2.value1, v2.value2, el);
            return v2;
          }
          ;
          if (v11 instanceof Property && v2 instanceof Property) {
            var v4 = refEq2(v11.value1, v2.value1);
            if (v4) {
              return v2;
            }
            ;
            if (v2.value0 === "value") {
              var elVal = unsafeGetProperty("value", el);
              var $75 = refEq2(elVal, v2.value1);
              if ($75) {
                return v2;
              }
              ;
              setProperty(v2.value0, v2.value1, el);
              return v2;
            }
            ;
            setProperty(v2.value0, v2.value1, el);
            return v2;
          }
          ;
          if (v11 instanceof Handler && v2 instanceof Handler) {
            var handler3 = unsafeLookup(v2.value0, prevEvents);
            write(v2.value1)(snd(handler3))();
            pokeMutMap(v2.value0, handler3, events);
            return v2;
          }
          ;
          return v2;
        };
      };
      var applyProp = function(events) {
        return function(v, v1, v2) {
          if (v2 instanceof Attribute) {
            setAttribute(toNullable(v2.value0), v2.value1, v2.value2, el);
            return v2;
          }
          ;
          if (v2 instanceof Property) {
            setProperty(v2.value0, v2.value1, el);
            return v2;
          }
          ;
          if (v2 instanceof Handler) {
            var v3 = unsafeGetAny(v2.value0, events);
            if (unsafeHasAny(v2.value0, events)) {
              write(v2.value1)(snd(v3))();
              return v2;
            }
            ;
            var ref2 = $$new(v2.value1)();
            var listener = eventListener(function(ev) {
              return function __do3() {
                var f$prime = read(ref2)();
                return mbEmit(f$prime(ev));
              };
            })();
            pokeMutMap(v2.value0, new Tuple(listener, ref2), events);
            addEventListener(v2.value0, listener, el);
            return v2;
          }
          ;
          if (v2 instanceof Ref) {
            mbEmit(v2.value0(new Created(el)));
            return v2;
          }
          ;
          throw new Error("Failed pattern match at Halogen.VDom.DOM.Prop (line 113, column 5 - line 135, column 15): " + [v2.constructor.name]);
        };
      };
      var $lazy_patchProp = $runtime_lazy6("patchProp", "Halogen.VDom.DOM.Prop", function() {
        return function(state3, ps2) {
          var events = newMutMap();
          var onThis = removeProp(state3.events);
          var onThese = diffProp(state3.events, events);
          var onThat = applyProp(events);
          var props = diffWithKeyAndIxE(state3.props, ps2, propToStrKey, onThese, onThis, onThat);
          var nextState = {
            events: unsafeFreeze2(events),
            props
          };
          return mkStep(new Step2(unit, nextState, $lazy_patchProp(100), haltProp));
        };
      });
      var patchProp = $lazy_patchProp(87);
      var renderProp = function(ps1) {
        var events = newMutMap();
        var ps1$prime = strMapWithIxE(ps1, propToStrKey, applyProp(events));
        var state3 = {
          events: unsafeFreeze2(events),
          props: ps1$prime
        };
        return mkStep(new Step2(unit, state3, patchProp, haltProp));
      };
      return renderProp;
    };
  };

  // output/Web.HTML.Common/index.js
  var ClassName = function(x47) {
    return x47;
  };

  // output/Halogen.HTML.Core/index.js
  var HTML = function(x47) {
    return x47;
  };
  var widget = function($28) {
    return HTML(Widget.create($28));
  };
  var toPropValue = function(dict) {
    return dict.toPropValue;
  };
  var text2 = function($29) {
    return HTML(Text2.create($29));
  };
  var prop = function(dictIsProp) {
    var toPropValue1 = toPropValue(dictIsProp);
    return function(v) {
      var $31 = Property.create(v);
      return function($32) {
        return $31(toPropValue1($32));
      };
    };
  };
  var isPropString = {
    toPropValue: propFromString
  };
  var isPropStepValue = {
    toPropValue: function($36) {
      return propFromString(renderStepValue($36));
    }
  };
  var isPropNumber = {
    toPropValue: propFromNumber
  };
  var isPropInputType = {
    toPropValue: function($45) {
      return propFromString(renderInputType($45));
    }
  };
  var isPropBoolean = {
    toPropValue: propFromBoolean
  };
  var handler = /* @__PURE__ */ (function() {
    return Handler.create;
  })();
  var element = function(ns) {
    return function(name16) {
      return function(props) {
        return function(children3) {
          return new Elem(ns, name16, props, children3);
        };
      };
    };
  };
  var attr = function(ns) {
    return function(v) {
      return Attribute.create(ns)(v);
    };
  };

  // output/Control.Applicative.Free/index.js
  var identity10 = /* @__PURE__ */ identity(categoryFn);
  var Pure = /* @__PURE__ */ (function() {
    function Pure2(value0) {
      this.value0 = value0;
    }
    ;
    Pure2.create = function(value0) {
      return new Pure2(value0);
    };
    return Pure2;
  })();
  var Lift = /* @__PURE__ */ (function() {
    function Lift3(value0) {
      this.value0 = value0;
    }
    ;
    Lift3.create = function(value0) {
      return new Lift3(value0);
    };
    return Lift3;
  })();
  var Ap = /* @__PURE__ */ (function() {
    function Ap2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Ap2.create = function(value0) {
      return function(value1) {
        return new Ap2(value0, value1);
      };
    };
    return Ap2;
  })();
  var mkAp = function(fba) {
    return function(fb) {
      return new Ap(fba, fb);
    };
  };
  var liftFreeAp = /* @__PURE__ */ (function() {
    return Lift.create;
  })();
  var goLeft = function(dictApplicative) {
    var pure91 = pure(dictApplicative);
    return function(fStack) {
      return function(valStack) {
        return function(nat) {
          return function(func) {
            return function(count) {
              if (func instanceof Pure) {
                return new Tuple(new Cons({
                  func: pure91(func.value0),
                  count
                }, fStack), valStack);
              }
              ;
              if (func instanceof Lift) {
                return new Tuple(new Cons({
                  func: nat(func.value0),
                  count
                }, fStack), valStack);
              }
              ;
              if (func instanceof Ap) {
                return goLeft(dictApplicative)(fStack)(cons2(func.value1)(valStack))(nat)(func.value0)(count + 1 | 0);
              }
              ;
              throw new Error("Failed pattern match at Control.Applicative.Free (line 102, column 41 - line 105, column 81): " + [func.constructor.name]);
            };
          };
        };
      };
    };
  };
  var goApply = function(dictApplicative) {
    var apply8 = apply(dictApplicative.Apply0());
    return function(fStack) {
      return function(vals) {
        return function(gVal) {
          if (fStack instanceof Nil) {
            return new Left(gVal);
          }
          ;
          if (fStack instanceof Cons) {
            var gRes = apply8(fStack.value0.func)(gVal);
            var $31 = fStack.value0.count === 1;
            if ($31) {
              if (fStack.value1 instanceof Nil) {
                return new Left(gRes);
              }
              ;
              return goApply(dictApplicative)(fStack.value1)(vals)(gRes);
            }
            ;
            if (vals instanceof Nil) {
              return new Left(gRes);
            }
            ;
            if (vals instanceof Cons) {
              return new Right(new Tuple(new Cons({
                func: gRes,
                count: fStack.value0.count - 1 | 0
              }, fStack.value1), new NonEmpty(vals.value0, vals.value1)));
            }
            ;
            throw new Error("Failed pattern match at Control.Applicative.Free (line 83, column 11 - line 88, column 50): " + [vals.constructor.name]);
          }
          ;
          throw new Error("Failed pattern match at Control.Applicative.Free (line 72, column 3 - line 88, column 50): " + [fStack.constructor.name]);
        };
      };
    };
  };
  var functorFreeAp = {
    map: function(f) {
      return function(x47) {
        return mkAp(new Pure(f))(x47);
      };
    }
  };
  var foldFreeAp = function(dictApplicative) {
    var goApply1 = goApply(dictApplicative);
    var pure91 = pure(dictApplicative);
    var goLeft1 = goLeft(dictApplicative);
    return function(nat) {
      return function(z) {
        var go2 = function($copy_v) {
          var $tco_done = false;
          var $tco_result;
          function $tco_loop(v) {
            if (v.value1.value0 instanceof Pure) {
              var v1 = goApply1(v.value0)(v.value1.value1)(pure91(v.value1.value0.value0));
              if (v1 instanceof Left) {
                $tco_done = true;
                return v1.value0;
              }
              ;
              if (v1 instanceof Right) {
                $copy_v = v1.value0;
                return;
              }
              ;
              throw new Error("Failed pattern match at Control.Applicative.Free (line 54, column 17 - line 56, column 24): " + [v1.constructor.name]);
            }
            ;
            if (v.value1.value0 instanceof Lift) {
              var v1 = goApply1(v.value0)(v.value1.value1)(nat(v.value1.value0.value0));
              if (v1 instanceof Left) {
                $tco_done = true;
                return v1.value0;
              }
              ;
              if (v1 instanceof Right) {
                $copy_v = v1.value0;
                return;
              }
              ;
              throw new Error("Failed pattern match at Control.Applicative.Free (line 57, column 17 - line 59, column 24): " + [v1.constructor.name]);
            }
            ;
            if (v.value1.value0 instanceof Ap) {
              var nextVals = new NonEmpty(v.value1.value0.value1, v.value1.value1);
              $copy_v = goLeft1(v.value0)(nextVals)(nat)(v.value1.value0.value0)(1);
              return;
            }
            ;
            throw new Error("Failed pattern match at Control.Applicative.Free (line 53, column 5 - line 62, column 47): " + [v.value1.value0.constructor.name]);
          }
          ;
          while (!$tco_done) {
            $tco_result = $tco_loop($copy_v);
          }
          ;
          return $tco_result;
        };
        return go2(new Tuple(Nil.value, singleton6(z)));
      };
    };
  };
  var retractFreeAp = function(dictApplicative) {
    return foldFreeAp(dictApplicative)(identity10);
  };
  var applyFreeAp = {
    apply: function(fba) {
      return function(fb) {
        return mkAp(fba)(fb);
      };
    },
    Functor0: function() {
      return functorFreeAp;
    }
  };
  var applicativeFreeAp = /* @__PURE__ */ (function() {
    return {
      pure: Pure.create,
      Apply0: function() {
        return applyFreeAp;
      }
    };
  })();
  var foldFreeAp1 = /* @__PURE__ */ foldFreeAp(applicativeFreeAp);
  var hoistFreeAp = function(f) {
    return foldFreeAp1(function($54) {
      return liftFreeAp(f($54));
    });
  };

  // output/Data.CatQueue/index.js
  var CatQueue = /* @__PURE__ */ (function() {
    function CatQueue2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    CatQueue2.create = function(value0) {
      return function(value1) {
        return new CatQueue2(value0, value1);
      };
    };
    return CatQueue2;
  })();
  var uncons3 = function($copy_v) {
    var $tco_done = false;
    var $tco_result;
    function $tco_loop(v) {
      if (v.value0 instanceof Nil && v.value1 instanceof Nil) {
        $tco_done = true;
        return Nothing.value;
      }
      ;
      if (v.value0 instanceof Nil) {
        $copy_v = new CatQueue(reverse2(v.value1), Nil.value);
        return;
      }
      ;
      if (v.value0 instanceof Cons) {
        $tco_done = true;
        return new Just(new Tuple(v.value0.value0, new CatQueue(v.value0.value1, v.value1)));
      }
      ;
      throw new Error("Failed pattern match at Data.CatQueue (line 82, column 1 - line 82, column 63): " + [v.constructor.name]);
    }
    ;
    while (!$tco_done) {
      $tco_result = $tco_loop($copy_v);
    }
    ;
    return $tco_result;
  };
  var snoc3 = function(v) {
    return function(a2) {
      return new CatQueue(v.value0, new Cons(a2, v.value1));
    };
  };
  var $$null4 = function(v) {
    if (v.value0 instanceof Nil && v.value1 instanceof Nil) {
      return true;
    }
    ;
    return false;
  };
  var empty5 = /* @__PURE__ */ (function() {
    return new CatQueue(Nil.value, Nil.value);
  })();

  // output/Data.CatList/index.js
  var CatNil = /* @__PURE__ */ (function() {
    function CatNil2() {
    }
    ;
    CatNil2.value = new CatNil2();
    return CatNil2;
  })();
  var CatCons = /* @__PURE__ */ (function() {
    function CatCons2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    CatCons2.create = function(value0) {
      return function(value1) {
        return new CatCons2(value0, value1);
      };
    };
    return CatCons2;
  })();
  var link = function(v) {
    return function(v1) {
      if (v instanceof CatNil) {
        return v1;
      }
      ;
      if (v1 instanceof CatNil) {
        return v;
      }
      ;
      if (v instanceof CatCons) {
        return new CatCons(v.value0, snoc3(v.value1)(v1));
      }
      ;
      throw new Error("Failed pattern match at Data.CatList (line 108, column 1 - line 108, column 54): " + [v.constructor.name, v1.constructor.name]);
    };
  };
  var foldr5 = function(k) {
    return function(b10) {
      return function(q2) {
        var foldl19 = function($copy_v) {
          return function($copy_v1) {
            return function($copy_v2) {
              var $tco_var_v = $copy_v;
              var $tco_var_v1 = $copy_v1;
              var $tco_done = false;
              var $tco_result;
              function $tco_loop(v, v1, v2) {
                if (v2 instanceof Nil) {
                  $tco_done = true;
                  return v1;
                }
                ;
                if (v2 instanceof Cons) {
                  $tco_var_v = v;
                  $tco_var_v1 = v(v1)(v2.value0);
                  $copy_v2 = v2.value1;
                  return;
                }
                ;
                throw new Error("Failed pattern match at Data.CatList (line 124, column 3 - line 124, column 59): " + [v.constructor.name, v1.constructor.name, v2.constructor.name]);
              }
              ;
              while (!$tco_done) {
                $tco_result = $tco_loop($tco_var_v, $tco_var_v1, $copy_v2);
              }
              ;
              return $tco_result;
            };
          };
        };
        var go2 = function($copy_xs) {
          return function($copy_ys) {
            var $tco_var_xs = $copy_xs;
            var $tco_done1 = false;
            var $tco_result;
            function $tco_loop(xs, ys) {
              var v = uncons3(xs);
              if (v instanceof Nothing) {
                $tco_done1 = true;
                return foldl19(function(x47) {
                  return function(i2) {
                    return i2(x47);
                  };
                })(b10)(ys);
              }
              ;
              if (v instanceof Just) {
                $tco_var_xs = v.value0.value1;
                $copy_ys = new Cons(k(v.value0.value0), ys);
                return;
              }
              ;
              throw new Error("Failed pattern match at Data.CatList (line 120, column 14 - line 122, column 67): " + [v.constructor.name]);
            }
            ;
            while (!$tco_done1) {
              $tco_result = $tco_loop($tco_var_xs, $copy_ys);
            }
            ;
            return $tco_result;
          };
        };
        return go2(q2)(Nil.value);
      };
    };
  };
  var uncons4 = function(v) {
    if (v instanceof CatNil) {
      return Nothing.value;
    }
    ;
    if (v instanceof CatCons) {
      return new Just(new Tuple(v.value0, (function() {
        var $66 = $$null4(v.value1);
        if ($66) {
          return CatNil.value;
        }
        ;
        return foldr5(link)(CatNil.value)(v.value1);
      })()));
    }
    ;
    throw new Error("Failed pattern match at Data.CatList (line 99, column 1 - line 99, column 61): " + [v.constructor.name]);
  };
  var empty6 = /* @__PURE__ */ (function() {
    return CatNil.value;
  })();
  var append3 = link;
  var cons3 = function(a2) {
    return function(cat) {
      return append3(new CatCons(a2, empty5))(cat);
    };
  };
  var singleton9 = function(a2) {
    return cons3(a2)(CatNil.value);
  };
  var semigroupCatList = {
    append: append3
  };
  var monoidCatList = /* @__PURE__ */ (function() {
    return {
      mempty: CatNil.value,
      Semigroup0: function() {
        return semigroupCatList;
      }
    };
  })();
  var fromFoldable7 = function(dictFoldable) {
    var foldMap12 = foldMap(dictFoldable)(monoidCatList);
    return function(f) {
      return foldMap12(singleton9)(f);
    };
  };
  var snoc4 = function(cat) {
    return function(a2) {
      return append3(cat)(new CatCons(a2, empty5));
    };
  };

  // output/Control.Monad.Free/index.js
  var $runtime_lazy7 = function(name16, moduleName, init13) {
    var state3 = 0;
    var val;
    return function(lineNumber) {
      if (state3 === 2) return val;
      if (state3 === 1) throw new ReferenceError(name16 + " was needed before it finished initializing (module " + moduleName + ", line " + lineNumber + ")", moduleName, lineNumber);
      state3 = 1;
      val = init13();
      state3 = 2;
      return val;
    };
  };
  var append4 = /* @__PURE__ */ append(semigroupCatList);
  var Free = /* @__PURE__ */ (function() {
    function Free2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Free2.create = function(value0) {
      return function(value1) {
        return new Free2(value0, value1);
      };
    };
    return Free2;
  })();
  var Return = /* @__PURE__ */ (function() {
    function Return2(value0) {
      this.value0 = value0;
    }
    ;
    Return2.create = function(value0) {
      return new Return2(value0);
    };
    return Return2;
  })();
  var Bind = /* @__PURE__ */ (function() {
    function Bind2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Bind2.create = function(value0) {
      return function(value1) {
        return new Bind2(value0, value1);
      };
    };
    return Bind2;
  })();
  var toView = function($copy_v) {
    var $tco_done = false;
    var $tco_result;
    function $tco_loop(v) {
      var runExpF = function(v22) {
        return v22;
      };
      var concatF = function(v22) {
        return function(r) {
          return new Free(v22.value0, append4(v22.value1)(r));
        };
      };
      if (v.value0 instanceof Return) {
        var v2 = uncons4(v.value1);
        if (v2 instanceof Nothing) {
          $tco_done = true;
          return new Return(v.value0.value0);
        }
        ;
        if (v2 instanceof Just) {
          $copy_v = concatF(runExpF(v2.value0.value0)(v.value0.value0))(v2.value0.value1);
          return;
        }
        ;
        throw new Error("Failed pattern match at Control.Monad.Free (line 227, column 7 - line 231, column 64): " + [v2.constructor.name]);
      }
      ;
      if (v.value0 instanceof Bind) {
        $tco_done = true;
        return new Bind(v.value0.value0, function(a2) {
          return concatF(v.value0.value1(a2))(v.value1);
        });
      }
      ;
      throw new Error("Failed pattern match at Control.Monad.Free (line 225, column 3 - line 233, column 56): " + [v.value0.constructor.name]);
    }
    ;
    while (!$tco_done) {
      $tco_result = $tco_loop($copy_v);
    }
    ;
    return $tco_result;
  };
  var fromView = function(f) {
    return new Free(f, empty6);
  };
  var freeMonad = {
    Applicative0: function() {
      return freeApplicative;
    },
    Bind1: function() {
      return freeBind;
    }
  };
  var freeFunctor = {
    map: function(k) {
      return function(f) {
        return bindFlipped(freeBind)((function() {
          var $189 = pure(freeApplicative);
          return function($190) {
            return $189(k($190));
          };
        })())(f);
      };
    }
  };
  var freeBind = {
    bind: function(v) {
      return function(k) {
        return new Free(v.value0, snoc4(v.value1)(k));
      };
    },
    Apply0: function() {
      return $lazy_freeApply(0);
    }
  };
  var freeApplicative = {
    pure: function($191) {
      return fromView(Return.create($191));
    },
    Apply0: function() {
      return $lazy_freeApply(0);
    }
  };
  var $lazy_freeApply = /* @__PURE__ */ $runtime_lazy7("freeApply", "Control.Monad.Free", function() {
    return {
      apply: ap(freeMonad),
      Functor0: function() {
        return freeFunctor;
      }
    };
  });
  var pure4 = /* @__PURE__ */ pure(freeApplicative);
  var liftF = function(f) {
    return fromView(new Bind(f, function($192) {
      return pure4($192);
    }));
  };
  var foldFree = function(dictMonadRec) {
    var Monad0 = dictMonadRec.Monad0();
    var map124 = map(Monad0.Bind1().Apply0().Functor0());
    var pure128 = pure(Monad0.Applicative0());
    var tailRecM4 = tailRecM(dictMonadRec);
    return function(k) {
      var go2 = function(f) {
        var v = toView(f);
        if (v instanceof Return) {
          return map124(Done.create)(pure128(v.value0));
        }
        ;
        if (v instanceof Bind) {
          return map124(function($199) {
            return Loop.create(v.value1($199));
          })(k(v.value0));
        }
        ;
        throw new Error("Failed pattern match at Control.Monad.Free (line 158, column 10 - line 160, column 37): " + [v.constructor.name]);
      };
      return tailRecM4(go2);
    };
  };

  // output/Halogen.Query.ChildQuery/index.js
  var unChildQueryBox = unsafeCoerce2;

  // output/Unsafe.Reference/foreign.js
  function reallyUnsafeRefEq(a2) {
    return function(b10) {
      return a2 === b10;
    };
  }

  // output/Unsafe.Reference/index.js
  var unsafeRefEq = reallyUnsafeRefEq;

  // output/Halogen.Subscription/index.js
  var $$void6 = /* @__PURE__ */ $$void(functorEffect);
  var coerce3 = /* @__PURE__ */ coerce();
  var bind3 = /* @__PURE__ */ bind(bindEffect);
  var append5 = /* @__PURE__ */ append(semigroupArray);
  var traverse_2 = /* @__PURE__ */ traverse_(applicativeEffect);
  var traverse_1 = /* @__PURE__ */ traverse_2(foldableArray);
  var unsubscribe = function(v) {
    return v;
  };
  var subscribe = function(v) {
    return function(k) {
      return v(function($76) {
        return $$void6(k($76));
      });
    };
  };
  var notify = function(v) {
    return function(a2) {
      return v(a2);
    };
  };
  var makeEmitter = coerce3;
  var create = function __do() {
    var subscribers = $$new([])();
    return {
      emitter: function(k) {
        return function __do3() {
          modify_(function(v) {
            return append5(v)([k]);
          })(subscribers)();
          return modify_(deleteBy(unsafeRefEq)(k))(subscribers);
        };
      },
      listener: function(a2) {
        return bind3(read(subscribers))(traverse_1(function(k) {
          return k(a2);
        }));
      }
    };
  };

  // output/Halogen.Query.HalogenM/index.js
  var identity11 = /* @__PURE__ */ identity(categoryFn);
  var SubscriptionId = function(x47) {
    return x47;
  };
  var ForkId = function(x47) {
    return x47;
  };
  var State = /* @__PURE__ */ (function() {
    function State2(value0) {
      this.value0 = value0;
    }
    ;
    State2.create = function(value0) {
      return new State2(value0);
    };
    return State2;
  })();
  var Subscribe = /* @__PURE__ */ (function() {
    function Subscribe2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Subscribe2.create = function(value0) {
      return function(value1) {
        return new Subscribe2(value0, value1);
      };
    };
    return Subscribe2;
  })();
  var Unsubscribe = /* @__PURE__ */ (function() {
    function Unsubscribe2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Unsubscribe2.create = function(value0) {
      return function(value1) {
        return new Unsubscribe2(value0, value1);
      };
    };
    return Unsubscribe2;
  })();
  var Lift2 = /* @__PURE__ */ (function() {
    function Lift3(value0) {
      this.value0 = value0;
    }
    ;
    Lift3.create = function(value0) {
      return new Lift3(value0);
    };
    return Lift3;
  })();
  var ChildQuery2 = /* @__PURE__ */ (function() {
    function ChildQuery3(value0) {
      this.value0 = value0;
    }
    ;
    ChildQuery3.create = function(value0) {
      return new ChildQuery3(value0);
    };
    return ChildQuery3;
  })();
  var Raise2 = /* @__PURE__ */ (function() {
    function Raise3(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Raise3.create = function(value0) {
      return function(value1) {
        return new Raise3(value0, value1);
      };
    };
    return Raise3;
  })();
  var Par = /* @__PURE__ */ (function() {
    function Par2(value0) {
      this.value0 = value0;
    }
    ;
    Par2.create = function(value0) {
      return new Par2(value0);
    };
    return Par2;
  })();
  var Fork = /* @__PURE__ */ (function() {
    function Fork2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Fork2.create = function(value0) {
      return function(value1) {
        return new Fork2(value0, value1);
      };
    };
    return Fork2;
  })();
  var Join = /* @__PURE__ */ (function() {
    function Join3(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Join3.create = function(value0) {
      return function(value1) {
        return new Join3(value0, value1);
      };
    };
    return Join3;
  })();
  var Kill = /* @__PURE__ */ (function() {
    function Kill2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Kill2.create = function(value0) {
      return function(value1) {
        return new Kill2(value0, value1);
      };
    };
    return Kill2;
  })();
  var GetRef = /* @__PURE__ */ (function() {
    function GetRef2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    GetRef2.create = function(value0) {
      return function(value1) {
        return new GetRef2(value0, value1);
      };
    };
    return GetRef2;
  })();
  var HalogenM = function(x47) {
    return x47;
  };
  var unsubscribe2 = function(sid) {
    return liftF(new Unsubscribe(sid, unit));
  };
  var subscribe2 = function(es) {
    return liftF(new Subscribe(function(v) {
      return es;
    }, identity11));
  };
  var ordSubscriptionId = ordInt;
  var ordForkId = ordInt;
  var monadHalogenM = freeMonad;
  var monadStateHalogenM = {
    state: function($181) {
      return HalogenM(liftF(State.create($181)));
    },
    Monad0: function() {
      return monadHalogenM;
    }
  };
  var monadEffectHalogenM = function(dictMonadEffect) {
    return {
      liftEffect: (function() {
        var $186 = liftEffect(dictMonadEffect);
        return function($187) {
          return HalogenM(liftF(Lift2.create($186($187))));
        };
      })(),
      Monad0: function() {
        return monadHalogenM;
      }
    };
  };
  var monadAffHalogenM = function(dictMonadAff) {
    var monadEffectHalogenM1 = monadEffectHalogenM(dictMonadAff.MonadEffect0());
    return {
      liftAff: (function() {
        var $188 = liftAff(dictMonadAff);
        return function($189) {
          return HalogenM(liftF(Lift2.create($188($189))));
        };
      })(),
      MonadEffect0: function() {
        return monadEffectHalogenM1;
      }
    };
  };
  var kill = function(fid) {
    return liftF(new Kill(fid, unit));
  };
  var functorHalogenM = freeFunctor;
  var fork = function(hmu) {
    return liftF(new Fork(hmu, identity11));
  };
  var bindHalogenM = freeBind;
  var bind4 = /* @__PURE__ */ bind(bindHalogenM);
  var applicativeHalogenM = freeApplicative;
  var pure5 = /* @__PURE__ */ pure(applicativeHalogenM);
  var monadRecHalogenM = {
    tailRecM: function(k) {
      return function(a2) {
        return bind4(k(a2))(function(v) {
          if (v instanceof Loop) {
            return tailRecM(monadRecHalogenM)(k)(v.value0);
          }
          ;
          if (v instanceof Done) {
            return pure5(v.value0);
          }
          ;
          throw new Error("Failed pattern match at Halogen.Query.HalogenM (line 105, column 26 - line 107, column 21): " + [v.constructor.name]);
        });
      };
    },
    Monad0: function() {
      return monadHalogenM;
    }
  };

  // output/Halogen.Query.HalogenQ/index.js
  var Initialize = /* @__PURE__ */ (function() {
    function Initialize53(value0) {
      this.value0 = value0;
    }
    ;
    Initialize53.create = function(value0) {
      return new Initialize53(value0);
    };
    return Initialize53;
  })();
  var Finalize = /* @__PURE__ */ (function() {
    function Finalize5(value0) {
      this.value0 = value0;
    }
    ;
    Finalize5.create = function(value0) {
      return new Finalize5(value0);
    };
    return Finalize5;
  })();
  var Receive = /* @__PURE__ */ (function() {
    function Receive3(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Receive3.create = function(value0) {
      return function(value1) {
        return new Receive3(value0, value1);
      };
    };
    return Receive3;
  })();
  var Action2 = /* @__PURE__ */ (function() {
    function Action3(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Action3.create = function(value0) {
      return function(value1) {
        return new Action3(value0, value1);
      };
    };
    return Action3;
  })();
  var Query = /* @__PURE__ */ (function() {
    function Query3(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Query3.create = function(value0) {
      return function(value1) {
        return new Query3(value0, value1);
      };
    };
    return Query3;
  })();

  // output/Halogen.VDom.Thunk/index.js
  var $runtime_lazy8 = function(name16, moduleName, init13) {
    var state3 = 0;
    var val;
    return function(lineNumber) {
      if (state3 === 2) return val;
      if (state3 === 1) throw new ReferenceError(name16 + " was needed before it finished initializing (module " + moduleName + ", line " + lineNumber + ")", moduleName, lineNumber);
      state3 = 1;
      val = init13();
      state3 = 2;
      return val;
    };
  };
  var unsafeEqThunk = function(v, v1) {
    return refEq2(v.value0, v1.value0) && (refEq2(v.value1, v1.value1) && v.value1(v.value3, v1.value3));
  };
  var runThunk = function(v) {
    return v.value2(v.value3);
  };
  var buildThunk = function(toVDom) {
    var haltThunk = function(state3) {
      return halt(state3.vdom);
    };
    var $lazy_patchThunk = $runtime_lazy8("patchThunk", "Halogen.VDom.Thunk", function() {
      return function(state3, t2) {
        var $48 = unsafeEqThunk(state3.thunk, t2);
        if ($48) {
          return mkStep(new Step2(extract2(state3.vdom), state3, $lazy_patchThunk(112), haltThunk));
        }
        ;
        var vdom = step(state3.vdom, toVDom(runThunk(t2)));
        return mkStep(new Step2(extract2(vdom), {
          vdom,
          thunk: t2
        }, $lazy_patchThunk(115), haltThunk));
      };
    });
    var patchThunk = $lazy_patchThunk(108);
    var renderThunk = function(spec) {
      return function(t) {
        var vdom = buildVDom(spec)(toVDom(runThunk(t)));
        return mkStep(new Step2(extract2(vdom), {
          thunk: t,
          vdom
        }, patchThunk, haltThunk));
      };
    };
    return renderThunk;
  };

  // output/Halogen.Component/index.js
  var voidLeft2 = /* @__PURE__ */ voidLeft(functorHalogenM);
  var traverse_3 = /* @__PURE__ */ traverse_(applicativeHalogenM)(foldableMaybe);
  var map25 = /* @__PURE__ */ map(functorHalogenM);
  var pure6 = /* @__PURE__ */ pure(applicativeHalogenM);
  var lookup4 = /* @__PURE__ */ lookup3();
  var pop3 = /* @__PURE__ */ pop2();
  var insert3 = /* @__PURE__ */ insert2();
  var ComponentSlot = /* @__PURE__ */ (function() {
    function ComponentSlot2(value0) {
      this.value0 = value0;
    }
    ;
    ComponentSlot2.create = function(value0) {
      return new ComponentSlot2(value0);
    };
    return ComponentSlot2;
  })();
  var ThunkSlot = /* @__PURE__ */ (function() {
    function ThunkSlot2(value0) {
      this.value0 = value0;
    }
    ;
    ThunkSlot2.create = function(value0) {
      return new ThunkSlot2(value0);
    };
    return ThunkSlot2;
  })();
  var unComponentSlot = unsafeCoerce2;
  var unComponent = unsafeCoerce2;
  var mkEval = function(args) {
    return function(v) {
      if (v instanceof Initialize) {
        return voidLeft2(traverse_3(args.handleAction)(args.initialize))(v.value0);
      }
      ;
      if (v instanceof Finalize) {
        return voidLeft2(traverse_3(args.handleAction)(args.finalize))(v.value0);
      }
      ;
      if (v instanceof Receive) {
        return voidLeft2(traverse_3(args.handleAction)(args.receive(v.value0)))(v.value1);
      }
      ;
      if (v instanceof Action2) {
        return voidLeft2(args.handleAction(v.value0))(v.value1);
      }
      ;
      if (v instanceof Query) {
        return unCoyoneda(function(g) {
          var $45 = map25(maybe(v.value1(unit))(g));
          return function($46) {
            return $45(args.handleQuery($46));
          };
        })(v.value0);
      }
      ;
      throw new Error("Failed pattern match at Halogen.Component (line 182, column 15 - line 192, column 71): " + [v.constructor.name]);
    };
  };
  var mkComponentSlot = unsafeCoerce2;
  var mkComponent = unsafeCoerce2;
  var defaultEval = /* @__PURE__ */ (function() {
    return {
      handleAction: $$const(pure6(unit)),
      handleQuery: $$const(pure6(Nothing.value)),
      receive: $$const(Nothing.value),
      initialize: Nothing.value,
      finalize: Nothing.value
    };
  })();
  var componentSlot = function() {
    return function(dictIsSymbol) {
      var lookup112 = lookup4(dictIsSymbol);
      var pop12 = pop3(dictIsSymbol);
      var insert16 = insert3(dictIsSymbol);
      return function(dictOrd) {
        var lookup211 = lookup112(dictOrd);
        var pop22 = pop12(dictOrd);
        var insert23 = insert16(dictOrd);
        return function(label5) {
          return function(p2) {
            return function(comp) {
              return function(input3) {
                return function(output2) {
                  return mkComponentSlot({
                    get: lookup211(label5)(p2),
                    pop: pop22(label5)(p2),
                    set: insert23(label5)(p2),
                    component: comp,
                    input: input3,
                    output: output2
                  });
                };
              };
            };
          };
        };
      };
    };
  };

  // output/Halogen.HTML.Elements/index.js
  var pure7 = /* @__PURE__ */ pure(applicativeMaybe);
  var elementNS = function($15) {
    return element(pure7($15));
  };
  var element2 = /* @__PURE__ */ (function() {
    return element(Nothing.value);
  })();
  var em = /* @__PURE__ */ element2("em");
  var em_ = /* @__PURE__ */ em([]);
  var footer = /* @__PURE__ */ element2("footer");
  var h1 = /* @__PURE__ */ element2("h1");
  var h1_ = /* @__PURE__ */ h1([]);
  var h2 = /* @__PURE__ */ element2("h2");
  var h2_ = /* @__PURE__ */ h2([]);
  var h3 = /* @__PURE__ */ element2("h3");
  var h3_ = /* @__PURE__ */ h3([]);
  var h4 = /* @__PURE__ */ element2("h4");
  var h4_ = /* @__PURE__ */ h4([]);
  var header = /* @__PURE__ */ element2("header");
  var hr = function(props) {
    return element2("hr")(props)([]);
  };
  var img = function(props) {
    return element2("img")(props)([]);
  };
  var input = function(props) {
    return element2("input")(props)([]);
  };
  var label = /* @__PURE__ */ element2("label");
  var label_ = /* @__PURE__ */ label([]);
  var li = /* @__PURE__ */ element2("li");
  var li_ = /* @__PURE__ */ li([]);
  var main = /* @__PURE__ */ element2("main");
  var main_ = /* @__PURE__ */ main([]);
  var nav = /* @__PURE__ */ element2("nav");
  var ol = /* @__PURE__ */ element2("ol");
  var ol_ = /* @__PURE__ */ ol([]);
  var p = /* @__PURE__ */ element2("p");
  var p_ = /* @__PURE__ */ p([]);
  var pre = /* @__PURE__ */ element2("pre");
  var pre_ = /* @__PURE__ */ pre([]);
  var section = /* @__PURE__ */ element2("section");
  var span2 = /* @__PURE__ */ element2("span");
  var strong = /* @__PURE__ */ element2("strong");
  var strong_ = /* @__PURE__ */ strong([]);
  var summary = /* @__PURE__ */ element2("summary");
  var summary_ = /* @__PURE__ */ summary([]);
  var table = /* @__PURE__ */ element2("table");
  var tbody = /* @__PURE__ */ element2("tbody");
  var tbody_ = /* @__PURE__ */ tbody([]);
  var td = /* @__PURE__ */ element2("td");
  var td_ = /* @__PURE__ */ td([]);
  var th = /* @__PURE__ */ element2("th");
  var th_ = /* @__PURE__ */ th([]);
  var thead = /* @__PURE__ */ element2("thead");
  var thead_ = /* @__PURE__ */ thead([]);
  var tr = /* @__PURE__ */ element2("tr");
  var tr_ = /* @__PURE__ */ tr([]);
  var ul = /* @__PURE__ */ element2("ul");
  var ul_ = /* @__PURE__ */ ul([]);
  var div2 = /* @__PURE__ */ element2("div");
  var div_ = /* @__PURE__ */ div2([]);
  var details = /* @__PURE__ */ element2("details");
  var code = /* @__PURE__ */ element2("code");
  var code_ = /* @__PURE__ */ code([]);
  var button = /* @__PURE__ */ element2("button");
  var aside = /* @__PURE__ */ element2("aside");
  var a = /* @__PURE__ */ element2("a");

  // output/Foreign.Index/foreign.js
  function unsafeReadPropImpl(f, s, key, value18) {
    return value18 == null ? f : s(value18[key]);
  }

  // output/Foreign.Index/index.js
  var unsafeReadProp = function(dictMonad) {
    var fail3 = fail(dictMonad);
    var pure91 = pure(applicativeExceptT(dictMonad));
    return function(k) {
      return function(value18) {
        return unsafeReadPropImpl(fail3(new TypeMismatch("object", typeOf(value18))), pure91, k, value18);
      };
    };
  };
  var readProp = function(dictMonad) {
    return unsafeReadProp(dictMonad);
  };

  // output/Web.Event.Event/foreign.js
  function _currentTarget(e) {
    return e.currentTarget;
  }

  // output/Data.Enum/foreign.js
  function toCharCode(c) {
    return c.charCodeAt(0);
  }
  function fromCharCode(c) {
    return String.fromCharCode(c);
  }

  // output/Control.Alternative/index.js
  var guard = function(dictAlternative) {
    var pure91 = pure(dictAlternative.Applicative0());
    var empty9 = empty2(dictAlternative.Plus1());
    return function(v) {
      if (v) {
        return pure91(unit);
      }
      ;
      if (!v) {
        return empty9;
      }
      ;
      throw new Error("Failed pattern match at Control.Alternative (line 48, column 1 - line 48, column 54): " + [v.constructor.name]);
    };
  };

  // output/Data.Enum/index.js
  var bottom1 = /* @__PURE__ */ bottom(boundedChar);
  var top1 = /* @__PURE__ */ top(boundedChar);
  var toEnum = function(dict) {
    return dict.toEnum;
  };
  var fromEnum = function(dict) {
    return dict.fromEnum;
  };
  var toEnumWithDefaults = function(dictBoundedEnum) {
    var toEnum1 = toEnum(dictBoundedEnum);
    var fromEnum1 = fromEnum(dictBoundedEnum);
    var bottom22 = bottom(dictBoundedEnum.Bounded0());
    return function(low2) {
      return function(high2) {
        return function(x47) {
          var v = toEnum1(x47);
          if (v instanceof Just) {
            return v.value0;
          }
          ;
          if (v instanceof Nothing) {
            var $140 = x47 < fromEnum1(bottom22);
            if ($140) {
              return low2;
            }
            ;
            return high2;
          }
          ;
          throw new Error("Failed pattern match at Data.Enum (line 158, column 33 - line 160, column 62): " + [v.constructor.name]);
        };
      };
    };
  };
  var defaultSucc = function(toEnum$prime) {
    return function(fromEnum$prime) {
      return function(a2) {
        return toEnum$prime(fromEnum$prime(a2) + 1 | 0);
      };
    };
  };
  var defaultPred = function(toEnum$prime) {
    return function(fromEnum$prime) {
      return function(a2) {
        return toEnum$prime(fromEnum$prime(a2) - 1 | 0);
      };
    };
  };
  var charToEnum = function(v) {
    if (v >= toCharCode(bottom1) && v <= toCharCode(top1)) {
      return new Just(fromCharCode(v));
    }
    ;
    return Nothing.value;
  };
  var enumChar = {
    succ: /* @__PURE__ */ defaultSucc(charToEnum)(toCharCode),
    pred: /* @__PURE__ */ defaultPred(charToEnum)(toCharCode),
    Ord0: function() {
      return ordChar;
    }
  };
  var boundedEnumChar = /* @__PURE__ */ (function() {
    return {
      cardinality: toCharCode(top1) - toCharCode(bottom1) | 0,
      toEnum: charToEnum,
      fromEnum: toCharCode,
      Bounded0: function() {
        return boundedChar;
      },
      Enum1: function() {
        return enumChar;
      }
    };
  })();

  // output/Web.Event.Event/index.js
  var currentTarget = function($5) {
    return toMaybe(_currentTarget($5));
  };

  // output/Web.HTML.Event.EventTypes/index.js
  var input2 = "input";
  var domcontentloaded = "DOMContentLoaded";
  var change = "change";

  // output/Web.UIEvent.MouseEvent.EventTypes/index.js
  var click = "click";

  // output/Halogen.HTML.Events/index.js
  var map26 = /* @__PURE__ */ map(functorMaybe);
  var composeKleisli2 = /* @__PURE__ */ composeKleisli(bindMaybe);
  var composeKleisliFlipped3 = /* @__PURE__ */ composeKleisliFlipped(/* @__PURE__ */ bindExceptT(monadIdentity));
  var readProp2 = /* @__PURE__ */ readProp(monadIdentity);
  var readString2 = /* @__PURE__ */ readString(monadIdentity);
  var mouseHandler = unsafeCoerce2;
  var handler$prime = function(et) {
    return function(f) {
      return handler(et)(function(ev) {
        return map26(Action.create)(f(ev));
      });
    };
  };
  var handler2 = function(et) {
    return function(f) {
      return handler(et)(function(ev) {
        return new Just(new Action(f(ev)));
      });
    };
  };
  var onClick = /* @__PURE__ */ (function() {
    var $15 = handler2(click);
    return function($16) {
      return $15(mouseHandler($16));
    };
  })();
  var addForeignPropHandler = function(key) {
    return function(prop7) {
      return function(reader) {
        return function(f) {
          var go2 = function(a2) {
            return composeKleisliFlipped3(reader)(readProp2(prop7))(unsafeToForeign(a2));
          };
          return handler$prime(key)(composeKleisli2(currentTarget)(function(e) {
            return either($$const(Nothing.value))(function($85) {
              return Just.create(f($85));
            })(runExcept(go2(e)));
          }));
        };
      };
    };
  };
  var onChecked = /* @__PURE__ */ addForeignPropHandler(change)("checked")(/* @__PURE__ */ readBoolean(monadIdentity));
  var onValueInput = /* @__PURE__ */ addForeignPropHandler(input2)("value")(readString2);

  // output/Halogen.HTML.Properties/index.js
  var unwrap4 = /* @__PURE__ */ unwrap();
  var prop2 = function(dictIsProp) {
    return prop(dictIsProp);
  };
  var prop1 = /* @__PURE__ */ prop2(isPropBoolean);
  var prop22 = /* @__PURE__ */ prop2(isPropString);
  var prop4 = /* @__PURE__ */ prop2(isPropNumber);
  var rel = /* @__PURE__ */ prop22("rel");
  var src2 = /* @__PURE__ */ prop22("src");
  var step3 = /* @__PURE__ */ prop2(isPropStepValue)("step");
  var target2 = /* @__PURE__ */ prop22("target");
  var title = /* @__PURE__ */ prop22("title");
  var type_3 = function(dictIsProp) {
    return prop2(dictIsProp)("type");
  };
  var value3 = function(dictIsProp) {
    return prop2(dictIsProp)("value");
  };
  var placeholder2 = /* @__PURE__ */ prop22("placeholder");
  var min4 = /* @__PURE__ */ prop4("min");
  var max4 = /* @__PURE__ */ prop4("max");
  var id3 = /* @__PURE__ */ prop22("id");
  var href = /* @__PURE__ */ prop22("href");
  var $$for = /* @__PURE__ */ prop22("htmlFor");
  var disabled2 = /* @__PURE__ */ prop1("disabled");
  var classes = /* @__PURE__ */ (function() {
    var $32 = prop22("className");
    var $33 = joinWith(" ");
    var $34 = map(functorArray)(unwrap4);
    return function($35) {
      return $32($33($34($35)));
    };
  })();
  var class_ = /* @__PURE__ */ (function() {
    var $36 = prop22("className");
    return function($37) {
      return $36(unwrap4($37));
    };
  })();
  var checked2 = /* @__PURE__ */ prop1("checked");
  var attr2 = /* @__PURE__ */ (function() {
    return attr(Nothing.value);
  })();
  var style = /* @__PURE__ */ attr2("style");
  var alt4 = /* @__PURE__ */ prop22("alt");

  // output/Data.Lens.Internal.Forget/index.js
  var profunctorForget = {
    dimap: function(f) {
      return function(v) {
        return function(v1) {
          return function($36) {
            return v1(f($36));
          };
        };
      };
    }
  };
  var strongForget = {
    first: function(v) {
      return function($37) {
        return v(fst($37));
      };
    },
    second: function(v) {
      return function($38) {
        return v(snd($38));
      };
    },
    Profunctor0: function() {
      return profunctorForget;
    }
  };

  // output/Data.Profunctor.Strong/index.js
  var strongFn = {
    first: function(a2b) {
      return function(v) {
        return new Tuple(a2b(v.value0), v.value1);
      };
    },
    second: /* @__PURE__ */ map(functorTuple),
    Profunctor0: function() {
      return profunctorFn;
    }
  };
  var first = function(dict) {
    return dict.first;
  };

  // output/Data.Lens.Getter/index.js
  var unwrap5 = /* @__PURE__ */ unwrap();
  var identity12 = /* @__PURE__ */ identity(categoryFn);
  var view = function(l) {
    return unwrap5(l(identity12));
  };
  var viewOn = function(s) {
    return function(l) {
      return view(l)(s);
    };
  };
  var use = function(dictMonadState) {
    var gets2 = gets(dictMonadState);
    return function(p2) {
      return gets2(function(v) {
        return viewOn(v)(p2);
      });
    };
  };

  // output/Data.Lens.Iso/index.js
  var coerce4 = /* @__PURE__ */ coerce();
  var iso = function(f) {
    return function(g) {
      return function(dictProfunctor) {
        var dimap2 = dimap(dictProfunctor);
        return function(pab) {
          return dimap2(f)(g)(pab);
        };
      };
    };
  };
  var coerced = function() {
    return function() {
      return function(dictProfunctor) {
        return iso(coerce4)(coerce4)(dictProfunctor);
      };
    };
  };

  // output/Data.Lens.Iso.Newtype/index.js
  var coerced2 = /* @__PURE__ */ coerced()();
  var _Newtype = function() {
    return function() {
      return function(dictProfunctor) {
        return coerced2(dictProfunctor);
      };
    };
  };

  // output/Data.Lens.Lens/index.js
  var lens$prime = function(to2) {
    return function(dictStrong) {
      var dimap2 = dimap(dictStrong.Profunctor0());
      var first2 = first(dictStrong);
      return function(pab) {
        return dimap2(to2)(function(v) {
          return v.value1(v.value0);
        })(first2(pab));
      };
    };
  };
  var lens = function(get26) {
    return function(set5) {
      return function(dictStrong) {
        return lens$prime(function(s) {
          return new Tuple(get26(s), function(b10) {
            return set5(s)(b10);
          });
        })(dictStrong);
      };
    };
  };

  // output/Record/index.js
  var set = function(dictIsSymbol) {
    var reflectSymbol2 = reflectSymbol(dictIsSymbol);
    return function() {
      return function() {
        return function(l) {
          return function(b10) {
            return function(r) {
              return unsafeSet(reflectSymbol2(l))(b10)(r);
            };
          };
        };
      };
    };
  };
  var get4 = function(dictIsSymbol) {
    var reflectSymbol2 = reflectSymbol(dictIsSymbol);
    return function() {
      return function(l) {
        return function(r) {
          return unsafeGet(reflectSymbol2(l))(r);
        };
      };
    };
  };

  // output/Data.Lens.Record/index.js
  var prop3 = function(dictIsSymbol) {
    var get26 = get4(dictIsSymbol)();
    var set5 = set(dictIsSymbol)()();
    return function() {
      return function() {
        return function(l) {
          return function(dictStrong) {
            return lens(get26(l))(flip(set5(l)))(dictStrong);
          };
        };
      };
    };
  };

  // output/Data.Lens.Setter/index.js
  var over2 = function(l) {
    return l;
  };
  var set2 = function(l) {
    return function(b10) {
      return over2(l)($$const(b10));
    };
  };
  var modifying = function(dictMonadState) {
    var $$void18 = $$void(dictMonadState.Monad0().Bind1().Apply0().Functor0());
    var modify5 = modify3(dictMonadState);
    return function(p2) {
      return function(f) {
        return $$void18(modify5(over2(p2)(f)));
      };
    };
  };

  // node_modules/d3-dispatch/src/dispatch.js
  var noop = { value: () => {
  } };
  function dispatch() {
    for (var i2 = 0, n = arguments.length, _ = {}, t; i2 < n; ++i2) {
      if (!(t = arguments[i2] + "") || t in _ || /[\s.]/.test(t)) throw new Error("illegal type: " + t);
      _[t] = [];
    }
    return new Dispatch(_);
  }
  function Dispatch(_) {
    this._ = _;
  }
  function parseTypenames(typenames, types) {
    return typenames.trim().split(/^|\s+/).map(function(t) {
      var name16 = "", i2 = t.indexOf(".");
      if (i2 >= 0) name16 = t.slice(i2 + 1), t = t.slice(0, i2);
      if (t && !types.hasOwnProperty(t)) throw new Error("unknown type: " + t);
      return { type: t, name: name16 };
    });
  }
  Dispatch.prototype = dispatch.prototype = {
    constructor: Dispatch,
    on: function(typename, callback) {
      var _ = this._, T = parseTypenames(typename + "", _), t, i2 = -1, n = T.length;
      if (arguments.length < 2) {
        while (++i2 < n) if ((t = (typename = T[i2]).type) && (t = get5(_[t], typename.name))) return t;
        return;
      }
      if (callback != null && typeof callback !== "function") throw new Error("invalid callback: " + callback);
      while (++i2 < n) {
        if (t = (typename = T[i2]).type) _[t] = set3(_[t], typename.name, callback);
        else if (callback == null) for (t in _) _[t] = set3(_[t], typename.name, null);
      }
      return this;
    },
    copy: function() {
      var copy2 = {}, _ = this._;
      for (var t in _) copy2[t] = _[t].slice();
      return new Dispatch(copy2);
    },
    call: function(type2, that) {
      if ((n = arguments.length - 2) > 0) for (var args = new Array(n), i2 = 0, n, t; i2 < n; ++i2) args[i2] = arguments[i2 + 2];
      if (!this._.hasOwnProperty(type2)) throw new Error("unknown type: " + type2);
      for (t = this._[type2], i2 = 0, n = t.length; i2 < n; ++i2) t[i2].value.apply(that, args);
    },
    apply: function(type2, that, args) {
      if (!this._.hasOwnProperty(type2)) throw new Error("unknown type: " + type2);
      for (var t = this._[type2], i2 = 0, n = t.length; i2 < n; ++i2) t[i2].value.apply(that, args);
    }
  };
  function get5(type2, name16) {
    for (var i2 = 0, n = type2.length, c; i2 < n; ++i2) {
      if ((c = type2[i2]).name === name16) {
        return c.value;
      }
    }
  }
  function set3(type2, name16, callback) {
    for (var i2 = 0, n = type2.length; i2 < n; ++i2) {
      if (type2[i2].name === name16) {
        type2[i2] = noop, type2 = type2.slice(0, i2).concat(type2.slice(i2 + 1));
        break;
      }
    }
    if (callback != null) type2.push({ name: name16, value: callback });
    return type2;
  }
  var dispatch_default = dispatch;

  // node_modules/d3-selection/src/namespaces.js
  var xhtml = "http://www.w3.org/1999/xhtml";
  var namespaces_default = {
    svg: "http://www.w3.org/2000/svg",
    xhtml,
    xlink: "http://www.w3.org/1999/xlink",
    xml: "http://www.w3.org/XML/1998/namespace",
    xmlns: "http://www.w3.org/2000/xmlns/"
  };

  // node_modules/d3-selection/src/namespace.js
  function namespace_default(name16) {
    var prefix = name16 += "", i2 = prefix.indexOf(":");
    if (i2 >= 0 && (prefix = name16.slice(0, i2)) !== "xmlns") name16 = name16.slice(i2 + 1);
    return namespaces_default.hasOwnProperty(prefix) ? { space: namespaces_default[prefix], local: name16 } : name16;
  }

  // node_modules/d3-selection/src/creator.js
  function creatorInherit(name16) {
    return function() {
      var document3 = this.ownerDocument, uri = this.namespaceURI;
      return uri === xhtml && document3.documentElement.namespaceURI === xhtml ? document3.createElement(name16) : document3.createElementNS(uri, name16);
    };
  }
  function creatorFixed(fullname) {
    return function() {
      return this.ownerDocument.createElementNS(fullname.space, fullname.local);
    };
  }
  function creator_default(name16) {
    var fullname = namespace_default(name16);
    return (fullname.local ? creatorFixed : creatorInherit)(fullname);
  }

  // node_modules/d3-selection/src/selector.js
  function none2() {
  }
  function selector_default(selector) {
    return selector == null ? none2 : function() {
      return this.querySelector(selector);
    };
  }

  // node_modules/d3-selection/src/selection/select.js
  function select_default(select44) {
    if (typeof select44 !== "function") select44 = selector_default(select44);
    for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {
      for (var group4 = groups[j], n = group4.length, subgroup = subgroups[j] = new Array(n), node, subnode, i2 = 0; i2 < n; ++i2) {
        if ((node = group4[i2]) && (subnode = select44.call(node, node.__data__, i2, group4))) {
          if ("__data__" in node) subnode.__data__ = node.__data__;
          subgroup[i2] = subnode;
        }
      }
    }
    return new Selection(subgroups, this._parents);
  }

  // node_modules/d3-selection/src/array.js
  function array(x47) {
    return x47 == null ? [] : Array.isArray(x47) ? x47 : Array.from(x47);
  }

  // node_modules/d3-selection/src/selectorAll.js
  function empty7() {
    return [];
  }
  function selectorAll_default(selector) {
    return selector == null ? empty7 : function() {
      return this.querySelectorAll(selector);
    };
  }

  // node_modules/d3-selection/src/selection/selectAll.js
  function arrayAll(select44) {
    return function() {
      return array(select44.apply(this, arguments));
    };
  }
  function selectAll_default(select44) {
    if (typeof select44 === "function") select44 = arrayAll(select44);
    else select44 = selectorAll_default(select44);
    for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {
      for (var group4 = groups[j], n = group4.length, node, i2 = 0; i2 < n; ++i2) {
        if (node = group4[i2]) {
          subgroups.push(select44.call(node, node.__data__, i2, group4));
          parents.push(node);
        }
      }
    }
    return new Selection(subgroups, parents);
  }

  // node_modules/d3-selection/src/matcher.js
  function matcher_default(selector) {
    return function() {
      return this.matches(selector);
    };
  }
  function childMatcher(selector) {
    return function(node) {
      return node.matches(selector);
    };
  }

  // node_modules/d3-selection/src/selection/selectChild.js
  var find3 = Array.prototype.find;
  function childFind(match2) {
    return function() {
      return find3.call(this.children, match2);
    };
  }
  function childFirst() {
    return this.firstElementChild;
  }
  function selectChild_default(match2) {
    return this.select(match2 == null ? childFirst : childFind(typeof match2 === "function" ? match2 : childMatcher(match2)));
  }

  // node_modules/d3-selection/src/selection/selectChildren.js
  var filter3 = Array.prototype.filter;
  function children2() {
    return Array.from(this.children);
  }
  function childrenFilter(match2) {
    return function() {
      return filter3.call(this.children, match2);
    };
  }
  function selectChildren_default(match2) {
    return this.selectAll(match2 == null ? children2 : childrenFilter(typeof match2 === "function" ? match2 : childMatcher(match2)));
  }

  // node_modules/d3-selection/src/selection/filter.js
  function filter_default(match2) {
    if (typeof match2 !== "function") match2 = matcher_default(match2);
    for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {
      for (var group4 = groups[j], n = group4.length, subgroup = subgroups[j] = [], node, i2 = 0; i2 < n; ++i2) {
        if ((node = group4[i2]) && match2.call(node, node.__data__, i2, group4)) {
          subgroup.push(node);
        }
      }
    }
    return new Selection(subgroups, this._parents);
  }

  // node_modules/d3-selection/src/selection/sparse.js
  function sparse_default(update7) {
    return new Array(update7.length);
  }

  // node_modules/d3-selection/src/selection/enter.js
  function enter_default() {
    return new Selection(this._enter || this._groups.map(sparse_default), this._parents);
  }
  function EnterNode(parent2, datum2) {
    this.ownerDocument = parent2.ownerDocument;
    this.namespaceURI = parent2.namespaceURI;
    this._next = null;
    this._parent = parent2;
    this.__data__ = datum2;
  }
  EnterNode.prototype = {
    constructor: EnterNode,
    appendChild: function(child) {
      return this._parent.insertBefore(child, this._next);
    },
    insertBefore: function(child, next2) {
      return this._parent.insertBefore(child, next2);
    },
    querySelector: function(selector) {
      return this._parent.querySelector(selector);
    },
    querySelectorAll: function(selector) {
      return this._parent.querySelectorAll(selector);
    }
  };

  // node_modules/d3-selection/src/constant.js
  function constant_default(x47) {
    return function() {
      return x47;
    };
  }

  // node_modules/d3-selection/src/selection/data.js
  function bindIndex(parent2, group4, enter, update7, exit, data) {
    var i2 = 0, node, groupLength = group4.length, dataLength = data.length;
    for (; i2 < dataLength; ++i2) {
      if (node = group4[i2]) {
        node.__data__ = data[i2];
        update7[i2] = node;
      } else {
        enter[i2] = new EnterNode(parent2, data[i2]);
      }
    }
    for (; i2 < groupLength; ++i2) {
      if (node = group4[i2]) {
        exit[i2] = node;
      }
    }
  }
  function bindKey(parent2, group4, enter, update7, exit, data, key) {
    var i2, node, nodeByKeyValue = /* @__PURE__ */ new Map(), groupLength = group4.length, dataLength = data.length, keyValues = new Array(groupLength), keyValue;
    for (i2 = 0; i2 < groupLength; ++i2) {
      if (node = group4[i2]) {
        keyValues[i2] = keyValue = key.call(node, node.__data__, i2, group4) + "";
        if (nodeByKeyValue.has(keyValue)) {
          exit[i2] = node;
        } else {
          nodeByKeyValue.set(keyValue, node);
        }
      }
    }
    for (i2 = 0; i2 < dataLength; ++i2) {
      keyValue = key.call(parent2, data[i2], i2, data) + "";
      if (node = nodeByKeyValue.get(keyValue)) {
        update7[i2] = node;
        node.__data__ = data[i2];
        nodeByKeyValue.delete(keyValue);
      } else {
        enter[i2] = new EnterNode(parent2, data[i2]);
      }
    }
    for (i2 = 0; i2 < groupLength; ++i2) {
      if ((node = group4[i2]) && nodeByKeyValue.get(keyValues[i2]) === node) {
        exit[i2] = node;
      }
    }
  }
  function datum(node) {
    return node.__data__;
  }
  function data_default(value18, key) {
    if (!arguments.length) return Array.from(this, datum);
    var bind87 = key ? bindKey : bindIndex, parents = this._parents, groups = this._groups;
    if (typeof value18 !== "function") value18 = constant_default(value18);
    for (var m = groups.length, update7 = new Array(m), enter = new Array(m), exit = new Array(m), j = 0; j < m; ++j) {
      var parent2 = parents[j], group4 = groups[j], groupLength = group4.length, data = arraylike(value18.call(parent2, parent2 && parent2.__data__, j, parents)), dataLength = data.length, enterGroup = enter[j] = new Array(dataLength), updateGroup = update7[j] = new Array(dataLength), exitGroup = exit[j] = new Array(groupLength);
      bind87(parent2, group4, enterGroup, updateGroup, exitGroup, data, key);
      for (var i0 = 0, i1 = 0, previous, next2; i0 < dataLength; ++i0) {
        if (previous = enterGroup[i0]) {
          if (i0 >= i1) i1 = i0 + 1;
          while (!(next2 = updateGroup[i1]) && ++i1 < dataLength) ;
          previous._next = next2 || null;
        }
      }
    }
    update7 = new Selection(update7, parents);
    update7._enter = enter;
    update7._exit = exit;
    return update7;
  }
  function arraylike(data) {
    return typeof data === "object" && "length" in data ? data : Array.from(data);
  }

  // node_modules/d3-selection/src/selection/exit.js
  function exit_default() {
    return new Selection(this._exit || this._groups.map(sparse_default), this._parents);
  }

  // node_modules/d3-selection/src/selection/join.js
  function join_default(onenter, onupdate, onexit) {
    var enter = this.enter(), update7 = this, exit = this.exit();
    if (typeof onenter === "function") {
      enter = onenter(enter);
      if (enter) enter = enter.selection();
    } else {
      enter = enter.append(onenter + "");
    }
    if (onupdate != null) {
      update7 = onupdate(update7);
      if (update7) update7 = update7.selection();
    }
    if (onexit == null) exit.remove();
    else onexit(exit);
    return enter && update7 ? enter.merge(update7).order() : update7;
  }

  // node_modules/d3-selection/src/selection/merge.js
  function merge_default(context) {
    var selection2 = context.selection ? context.selection() : context;
    for (var groups0 = this._groups, groups1 = selection2._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {
      for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge6 = merges[j] = new Array(n), node, i2 = 0; i2 < n; ++i2) {
        if (node = group0[i2] || group1[i2]) {
          merge6[i2] = node;
        }
      }
    }
    for (; j < m0; ++j) {
      merges[j] = groups0[j];
    }
    return new Selection(merges, this._parents);
  }

  // node_modules/d3-selection/src/selection/order.js
  function order_default() {
    for (var groups = this._groups, j = -1, m = groups.length; ++j < m; ) {
      for (var group4 = groups[j], i2 = group4.length - 1, next2 = group4[i2], node; --i2 >= 0; ) {
        if (node = group4[i2]) {
          if (next2 && node.compareDocumentPosition(next2) ^ 4) next2.parentNode.insertBefore(node, next2);
          next2 = node;
        }
      }
    }
    return this;
  }

  // node_modules/d3-selection/src/selection/sort.js
  function sort_default(compare26) {
    if (!compare26) compare26 = ascending;
    function compareNode(a2, b10) {
      return a2 && b10 ? compare26(a2.__data__, b10.__data__) : !a2 - !b10;
    }
    for (var groups = this._groups, m = groups.length, sortgroups = new Array(m), j = 0; j < m; ++j) {
      for (var group4 = groups[j], n = group4.length, sortgroup = sortgroups[j] = new Array(n), node, i2 = 0; i2 < n; ++i2) {
        if (node = group4[i2]) {
          sortgroup[i2] = node;
        }
      }
      sortgroup.sort(compareNode);
    }
    return new Selection(sortgroups, this._parents).order();
  }
  function ascending(a2, b10) {
    return a2 < b10 ? -1 : a2 > b10 ? 1 : a2 >= b10 ? 0 : NaN;
  }

  // node_modules/d3-selection/src/selection/call.js
  function call_default() {
    var callback = arguments[0];
    arguments[0] = this;
    callback.apply(null, arguments);
    return this;
  }

  // node_modules/d3-selection/src/selection/nodes.js
  function nodes_default() {
    return Array.from(this);
  }

  // node_modules/d3-selection/src/selection/node.js
  function node_default() {
    for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {
      for (var group4 = groups[j], i2 = 0, n = group4.length; i2 < n; ++i2) {
        var node = group4[i2];
        if (node) return node;
      }
    }
    return null;
  }

  // node_modules/d3-selection/src/selection/size.js
  function size_default() {
    let size6 = 0;
    for (const node of this) ++size6;
    return size6;
  }

  // node_modules/d3-selection/src/selection/empty.js
  function empty_default() {
    return !this.node();
  }

  // node_modules/d3-selection/src/selection/each.js
  function each_default(callback) {
    for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {
      for (var group4 = groups[j], i2 = 0, n = group4.length, node; i2 < n; ++i2) {
        if (node = group4[i2]) callback.call(node, node.__data__, i2, group4);
      }
    }
    return this;
  }

  // node_modules/d3-selection/src/selection/attr.js
  function attrRemove(name16) {
    return function() {
      this.removeAttribute(name16);
    };
  }
  function attrRemoveNS(fullname) {
    return function() {
      this.removeAttributeNS(fullname.space, fullname.local);
    };
  }
  function attrConstant(name16, value18) {
    return function() {
      this.setAttribute(name16, value18);
    };
  }
  function attrConstantNS(fullname, value18) {
    return function() {
      this.setAttributeNS(fullname.space, fullname.local, value18);
    };
  }
  function attrFunction(name16, value18) {
    return function() {
      var v = value18.apply(this, arguments);
      if (v == null) this.removeAttribute(name16);
      else this.setAttribute(name16, v);
    };
  }
  function attrFunctionNS(fullname, value18) {
    return function() {
      var v = value18.apply(this, arguments);
      if (v == null) this.removeAttributeNS(fullname.space, fullname.local);
      else this.setAttributeNS(fullname.space, fullname.local, v);
    };
  }
  function attr_default(name16, value18) {
    var fullname = namespace_default(name16);
    if (arguments.length < 2) {
      var node = this.node();
      return fullname.local ? node.getAttributeNS(fullname.space, fullname.local) : node.getAttribute(fullname);
    }
    return this.each((value18 == null ? fullname.local ? attrRemoveNS : attrRemove : typeof value18 === "function" ? fullname.local ? attrFunctionNS : attrFunction : fullname.local ? attrConstantNS : attrConstant)(fullname, value18));
  }

  // node_modules/d3-selection/src/window.js
  function window_default(node) {
    return node.ownerDocument && node.ownerDocument.defaultView || node.document && node || node.defaultView;
  }

  // node_modules/d3-selection/src/selection/style.js
  function styleRemove(name16) {
    return function() {
      this.style.removeProperty(name16);
    };
  }
  function styleConstant(name16, value18, priority) {
    return function() {
      this.style.setProperty(name16, value18, priority);
    };
  }
  function styleFunction(name16, value18, priority) {
    return function() {
      var v = value18.apply(this, arguments);
      if (v == null) this.style.removeProperty(name16);
      else this.style.setProperty(name16, v, priority);
    };
  }
  function style_default(name16, value18, priority) {
    return arguments.length > 1 ? this.each((value18 == null ? styleRemove : typeof value18 === "function" ? styleFunction : styleConstant)(name16, value18, priority == null ? "" : priority)) : styleValue(this.node(), name16);
  }
  function styleValue(node, name16) {
    return node.style.getPropertyValue(name16) || window_default(node).getComputedStyle(node, null).getPropertyValue(name16);
  }

  // node_modules/d3-selection/src/selection/property.js
  function propertyRemove(name16) {
    return function() {
      delete this[name16];
    };
  }
  function propertyConstant(name16, value18) {
    return function() {
      this[name16] = value18;
    };
  }
  function propertyFunction(name16, value18) {
    return function() {
      var v = value18.apply(this, arguments);
      if (v == null) delete this[name16];
      else this[name16] = v;
    };
  }
  function property_default(name16, value18) {
    return arguments.length > 1 ? this.each((value18 == null ? propertyRemove : typeof value18 === "function" ? propertyFunction : propertyConstant)(name16, value18)) : this.node()[name16];
  }

  // node_modules/d3-selection/src/selection/classed.js
  function classArray(string2) {
    return string2.trim().split(/^|\s+/);
  }
  function classList2(node) {
    return node.classList || new ClassList(node);
  }
  function ClassList(node) {
    this._node = node;
    this._names = classArray(node.getAttribute("class") || "");
  }
  ClassList.prototype = {
    add: function(name16) {
      var i2 = this._names.indexOf(name16);
      if (i2 < 0) {
        this._names.push(name16);
        this._node.setAttribute("class", this._names.join(" "));
      }
    },
    remove: function(name16) {
      var i2 = this._names.indexOf(name16);
      if (i2 >= 0) {
        this._names.splice(i2, 1);
        this._node.setAttribute("class", this._names.join(" "));
      }
    },
    contains: function(name16) {
      return this._names.indexOf(name16) >= 0;
    }
  };
  function classedAdd(node, names) {
    var list = classList2(node), i2 = -1, n = names.length;
    while (++i2 < n) list.add(names[i2]);
  }
  function classedRemove(node, names) {
    var list = classList2(node), i2 = -1, n = names.length;
    while (++i2 < n) list.remove(names[i2]);
  }
  function classedTrue(names) {
    return function() {
      classedAdd(this, names);
    };
  }
  function classedFalse(names) {
    return function() {
      classedRemove(this, names);
    };
  }
  function classedFunction(names, value18) {
    return function() {
      (value18.apply(this, arguments) ? classedAdd : classedRemove)(this, names);
    };
  }
  function classed_default(name16, value18) {
    var names = classArray(name16 + "");
    if (arguments.length < 2) {
      var list = classList2(this.node()), i2 = -1, n = names.length;
      while (++i2 < n) if (!list.contains(names[i2])) return false;
      return true;
    }
    return this.each((typeof value18 === "function" ? classedFunction : value18 ? classedTrue : classedFalse)(names, value18));
  }

  // node_modules/d3-selection/src/selection/text.js
  function textRemove() {
    this.textContent = "";
  }
  function textConstant(value18) {
    return function() {
      this.textContent = value18;
    };
  }
  function textFunction(value18) {
    return function() {
      var v = value18.apply(this, arguments);
      this.textContent = v == null ? "" : v;
    };
  }
  function text_default(value18) {
    return arguments.length ? this.each(value18 == null ? textRemove : (typeof value18 === "function" ? textFunction : textConstant)(value18)) : this.node().textContent;
  }

  // node_modules/d3-selection/src/selection/html.js
  function htmlRemove() {
    this.innerHTML = "";
  }
  function htmlConstant(value18) {
    return function() {
      this.innerHTML = value18;
    };
  }
  function htmlFunction(value18) {
    return function() {
      var v = value18.apply(this, arguments);
      this.innerHTML = v == null ? "" : v;
    };
  }
  function html_default(value18) {
    return arguments.length ? this.each(value18 == null ? htmlRemove : (typeof value18 === "function" ? htmlFunction : htmlConstant)(value18)) : this.node().innerHTML;
  }

  // node_modules/d3-selection/src/selection/raise.js
  function raise() {
    if (this.nextSibling) this.parentNode.appendChild(this);
  }
  function raise_default() {
    return this.each(raise);
  }

  // node_modules/d3-selection/src/selection/lower.js
  function lower() {
    if (this.previousSibling) this.parentNode.insertBefore(this, this.parentNode.firstChild);
  }
  function lower_default() {
    return this.each(lower);
  }

  // node_modules/d3-selection/src/selection/append.js
  function append_default(name16) {
    var create5 = typeof name16 === "function" ? name16 : creator_default(name16);
    return this.select(function() {
      return this.appendChild(create5.apply(this, arguments));
    });
  }

  // node_modules/d3-selection/src/selection/insert.js
  function constantNull() {
    return null;
  }
  function insert_default(name16, before) {
    var create5 = typeof name16 === "function" ? name16 : creator_default(name16), select44 = before == null ? constantNull : typeof before === "function" ? before : selector_default(before);
    return this.select(function() {
      return this.insertBefore(create5.apply(this, arguments), select44.apply(this, arguments) || null);
    });
  }

  // node_modules/d3-selection/src/selection/remove.js
  function remove2() {
    var parent2 = this.parentNode;
    if (parent2) parent2.removeChild(this);
  }
  function remove_default() {
    return this.each(remove2);
  }

  // node_modules/d3-selection/src/selection/clone.js
  function selection_cloneShallow() {
    var clone2 = this.cloneNode(false), parent2 = this.parentNode;
    return parent2 ? parent2.insertBefore(clone2, this.nextSibling) : clone2;
  }
  function selection_cloneDeep() {
    var clone2 = this.cloneNode(true), parent2 = this.parentNode;
    return parent2 ? parent2.insertBefore(clone2, this.nextSibling) : clone2;
  }
  function clone_default(deep) {
    return this.select(deep ? selection_cloneDeep : selection_cloneShallow);
  }

  // node_modules/d3-selection/src/selection/datum.js
  function datum_default(value18) {
    return arguments.length ? this.property("__data__", value18) : this.node().__data__;
  }

  // node_modules/d3-selection/src/selection/on.js
  function contextListener(listener) {
    return function(event) {
      listener.call(this, event, this.__data__);
    };
  }
  function parseTypenames2(typenames) {
    return typenames.trim().split(/^|\s+/).map(function(t) {
      var name16 = "", i2 = t.indexOf(".");
      if (i2 >= 0) name16 = t.slice(i2 + 1), t = t.slice(0, i2);
      return { type: t, name: name16 };
    });
  }
  function onRemove(typename) {
    return function() {
      var on14 = this.__on;
      if (!on14) return;
      for (var j = 0, i2 = -1, m = on14.length, o; j < m; ++j) {
        if (o = on14[j], (!typename.type || o.type === typename.type) && o.name === typename.name) {
          this.removeEventListener(o.type, o.listener, o.options);
        } else {
          on14[++i2] = o;
        }
      }
      if (++i2) on14.length = i2;
      else delete this.__on;
    };
  }
  function onAdd(typename, value18, options2) {
    return function() {
      var on14 = this.__on, o, listener = contextListener(value18);
      if (on14) for (var j = 0, m = on14.length; j < m; ++j) {
        if ((o = on14[j]).type === typename.type && o.name === typename.name) {
          this.removeEventListener(o.type, o.listener, o.options);
          this.addEventListener(o.type, o.listener = listener, o.options = options2);
          o.value = value18;
          return;
        }
      }
      this.addEventListener(typename.type, listener, options2);
      o = { type: typename.type, name: typename.name, value: value18, listener, options: options2 };
      if (!on14) this.__on = [o];
      else on14.push(o);
    };
  }
  function on_default(typename, value18, options2) {
    var typenames = parseTypenames2(typename + ""), i2, n = typenames.length, t;
    if (arguments.length < 2) {
      var on14 = this.node().__on;
      if (on14) for (var j = 0, m = on14.length, o; j < m; ++j) {
        for (i2 = 0, o = on14[j]; i2 < n; ++i2) {
          if ((t = typenames[i2]).type === o.type && t.name === o.name) {
            return o.value;
          }
        }
      }
      return;
    }
    on14 = value18 ? onAdd : onRemove;
    for (i2 = 0; i2 < n; ++i2) this.each(on14(typenames[i2], value18, options2));
    return this;
  }

  // node_modules/d3-selection/src/selection/dispatch.js
  function dispatchEvent2(node, type2, params) {
    var window2 = window_default(node), event = window2.CustomEvent;
    if (typeof event === "function") {
      event = new event(type2, params);
    } else {
      event = window2.document.createEvent("Event");
      if (params) event.initEvent(type2, params.bubbles, params.cancelable), event.detail = params.detail;
      else event.initEvent(type2, false, false);
    }
    node.dispatchEvent(event);
  }
  function dispatchConstant(type2, params) {
    return function() {
      return dispatchEvent2(this, type2, params);
    };
  }
  function dispatchFunction(type2, params) {
    return function() {
      return dispatchEvent2(this, type2, params.apply(this, arguments));
    };
  }
  function dispatch_default2(type2, params) {
    return this.each((typeof params === "function" ? dispatchFunction : dispatchConstant)(type2, params));
  }

  // node_modules/d3-selection/src/selection/iterator.js
  function* iterator_default() {
    for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {
      for (var group4 = groups[j], i2 = 0, n = group4.length, node; i2 < n; ++i2) {
        if (node = group4[i2]) yield node;
      }
    }
  }

  // node_modules/d3-selection/src/selection/index.js
  var root = [null];
  function Selection(groups, parents) {
    this._groups = groups;
    this._parents = parents;
  }
  function selection() {
    return new Selection([[document.documentElement]], root);
  }
  function selection_selection() {
    return this;
  }
  Selection.prototype = selection.prototype = {
    constructor: Selection,
    select: select_default,
    selectAll: selectAll_default,
    selectChild: selectChild_default,
    selectChildren: selectChildren_default,
    filter: filter_default,
    data: data_default,
    enter: enter_default,
    exit: exit_default,
    join: join_default,
    merge: merge_default,
    selection: selection_selection,
    order: order_default,
    sort: sort_default,
    call: call_default,
    nodes: nodes_default,
    node: node_default,
    size: size_default,
    empty: empty_default,
    each: each_default,
    attr: attr_default,
    style: style_default,
    property: property_default,
    classed: classed_default,
    text: text_default,
    html: html_default,
    raise: raise_default,
    lower: lower_default,
    append: append_default,
    insert: insert_default,
    remove: remove_default,
    clone: clone_default,
    datum: datum_default,
    on: on_default,
    dispatch: dispatch_default2,
    [Symbol.iterator]: iterator_default
  };
  var selection_default = selection;

  // node_modules/d3-selection/src/select.js
  function select_default2(selector) {
    return typeof selector === "string" ? new Selection([[document.querySelector(selector)]], [document.documentElement]) : new Selection([[selector]], root);
  }

  // node_modules/d3-selection/src/sourceEvent.js
  function sourceEvent_default(event) {
    let sourceEvent;
    while (sourceEvent = event.sourceEvent) event = sourceEvent;
    return event;
  }

  // node_modules/d3-selection/src/pointer.js
  function pointer_default(event, node) {
    event = sourceEvent_default(event);
    if (node === void 0) node = event.currentTarget;
    if (node) {
      var svg2 = node.ownerSVGElement || node;
      if (svg2.createSVGPoint) {
        var point = svg2.createSVGPoint();
        point.x = event.clientX, point.y = event.clientY;
        point = point.matrixTransform(node.getScreenCTM().inverse());
        return [point.x, point.y];
      }
      if (node.getBoundingClientRect) {
        var rect = node.getBoundingClientRect();
        return [event.clientX - rect.left - node.clientLeft, event.clientY - rect.top - node.clientTop];
      }
    }
    return [event.pageX, event.pageY];
  }

  // node_modules/d3-drag/src/noevent.js
  var nonpassive = { passive: false };
  var nonpassivecapture = { capture: true, passive: false };
  function nopropagation(event) {
    event.stopImmediatePropagation();
  }
  function noevent_default(event) {
    event.preventDefault();
    event.stopImmediatePropagation();
  }

  // node_modules/d3-drag/src/nodrag.js
  function nodrag_default(view2) {
    var root3 = view2.document.documentElement, selection2 = select_default2(view2).on("dragstart.drag", noevent_default, nonpassivecapture);
    if ("onselectstart" in root3) {
      selection2.on("selectstart.drag", noevent_default, nonpassivecapture);
    } else {
      root3.__noselect = root3.style.MozUserSelect;
      root3.style.MozUserSelect = "none";
    }
  }
  function yesdrag(view2, noclick) {
    var root3 = view2.document.documentElement, selection2 = select_default2(view2).on("dragstart.drag", null);
    if (noclick) {
      selection2.on("click.drag", noevent_default, nonpassivecapture);
      setTimeout(function() {
        selection2.on("click.drag", null);
      }, 0);
    }
    if ("onselectstart" in root3) {
      selection2.on("selectstart.drag", null);
    } else {
      root3.style.MozUserSelect = root3.__noselect;
      delete root3.__noselect;
    }
  }

  // node_modules/d3-drag/src/constant.js
  var constant_default2 = (x47) => () => x47;

  // node_modules/d3-drag/src/event.js
  function DragEvent(type2, {
    sourceEvent,
    subject,
    target: target7,
    identifier,
    active,
    x: x47,
    y: y48,
    dx,
    dy: dy4,
    dispatch: dispatch2
  }) {
    Object.defineProperties(this, {
      type: { value: type2, enumerable: true, configurable: true },
      sourceEvent: { value: sourceEvent, enumerable: true, configurable: true },
      subject: { value: subject, enumerable: true, configurable: true },
      target: { value: target7, enumerable: true, configurable: true },
      identifier: { value: identifier, enumerable: true, configurable: true },
      active: { value: active, enumerable: true, configurable: true },
      x: { value: x47, enumerable: true, configurable: true },
      y: { value: y48, enumerable: true, configurable: true },
      dx: { value: dx, enumerable: true, configurable: true },
      dy: { value: dy4, enumerable: true, configurable: true },
      _: { value: dispatch2 }
    });
  }
  DragEvent.prototype.on = function() {
    var value18 = this._.on.apply(this._, arguments);
    return value18 === this._ ? this : value18;
  };

  // node_modules/d3-drag/src/drag.js
  function defaultFilter(event) {
    return !event.ctrlKey && !event.button;
  }
  function defaultContainer() {
    return this.parentNode;
  }
  function defaultSubject(event, d18) {
    return d18 == null ? { x: event.x, y: event.y } : d18;
  }
  function defaultTouchable() {
    return navigator.maxTouchPoints || "ontouchstart" in this;
  }
  function drag_default() {
    var filter7 = defaultFilter, container = defaultContainer, subject = defaultSubject, touchable = defaultTouchable, gestures = {}, listeners = dispatch_default("start", "drag", "end"), active = 0, mousedownx, mousedowny, mousemoving, touchending, clickDistance2 = 0;
    function drag2(selection2) {
      selection2.on("mousedown.drag", mousedowned).filter(touchable).on("touchstart.drag", touchstarted).on("touchmove.drag", touchmoved, nonpassive).on("touchend.drag touchcancel.drag", touchended).style("touch-action", "none").style("-webkit-tap-highlight-color", "rgba(0,0,0,0)");
    }
    function mousedowned(event, d18) {
      if (touchending || !filter7.call(this, event, d18)) return;
      var gesture = beforestart(this, container.call(this, event, d18), event, d18, "mouse");
      if (!gesture) return;
      select_default2(event.view).on("mousemove.drag", mousemoved, nonpassivecapture).on("mouseup.drag", mouseupped, nonpassivecapture);
      nodrag_default(event.view);
      nopropagation(event);
      mousemoving = false;
      mousedownx = event.clientX;
      mousedowny = event.clientY;
      gesture("start", event);
    }
    function mousemoved(event) {
      noevent_default(event);
      if (!mousemoving) {
        var dx = event.clientX - mousedownx, dy4 = event.clientY - mousedowny;
        mousemoving = dx * dx + dy4 * dy4 > clickDistance2;
      }
      gestures.mouse("drag", event);
    }
    function mouseupped(event) {
      select_default2(event.view).on("mousemove.drag mouseup.drag", null);
      yesdrag(event.view, mousemoving);
      noevent_default(event);
      gestures.mouse("end", event);
    }
    function touchstarted(event, d18) {
      if (!filter7.call(this, event, d18)) return;
      var touches = event.changedTouches, c = container.call(this, event, d18), n = touches.length, i2, gesture;
      for (i2 = 0; i2 < n; ++i2) {
        if (gesture = beforestart(this, c, event, d18, touches[i2].identifier, touches[i2])) {
          nopropagation(event);
          gesture("start", event, touches[i2]);
        }
      }
    }
    function touchmoved(event) {
      var touches = event.changedTouches, n = touches.length, i2, gesture;
      for (i2 = 0; i2 < n; ++i2) {
        if (gesture = gestures[touches[i2].identifier]) {
          noevent_default(event);
          gesture("drag", event, touches[i2]);
        }
      }
    }
    function touchended(event) {
      var touches = event.changedTouches, n = touches.length, i2, gesture;
      if (touchending) clearTimeout(touchending);
      touchending = setTimeout(function() {
        touchending = null;
      }, 500);
      for (i2 = 0; i2 < n; ++i2) {
        if (gesture = gestures[touches[i2].identifier]) {
          nopropagation(event);
          gesture("end", event, touches[i2]);
        }
      }
    }
    function beforestart(that, container2, event, d18, identifier, touch) {
      var dispatch2 = listeners.copy(), p2 = pointer_default(touch || event, container2), dx, dy4, s;
      if ((s = subject.call(that, new DragEvent("beforestart", {
        sourceEvent: event,
        target: drag2,
        identifier,
        active,
        x: p2[0],
        y: p2[1],
        dx: 0,
        dy: 0,
        dispatch: dispatch2
      }), d18)) == null) return;
      dx = s.x - p2[0] || 0;
      dy4 = s.y - p2[1] || 0;
      return function gesture(type2, event2, touch2) {
        var p0 = p2, n;
        switch (type2) {
          case "start":
            gestures[identifier] = gesture, n = active++;
            break;
          case "end":
            delete gestures[identifier], --active;
          // falls through
          case "drag":
            p2 = pointer_default(touch2 || event2, container2), n = active;
            break;
        }
        dispatch2.call(
          type2,
          that,
          new DragEvent(type2, {
            sourceEvent: event2,
            subject: s,
            target: drag2,
            identifier,
            active: n,
            x: p2[0] + dx,
            y: p2[1] + dy4,
            dx: p2[0] - p0[0],
            dy: p2[1] - p0[1],
            dispatch: dispatch2
          }),
          d18
        );
      };
    }
    drag2.filter = function(_) {
      return arguments.length ? (filter7 = typeof _ === "function" ? _ : constant_default2(!!_), drag2) : filter7;
    };
    drag2.container = function(_) {
      return arguments.length ? (container = typeof _ === "function" ? _ : constant_default2(_), drag2) : container;
    };
    drag2.subject = function(_) {
      return arguments.length ? (subject = typeof _ === "function" ? _ : constant_default2(_), drag2) : subject;
    };
    drag2.touchable = function(_) {
      return arguments.length ? (touchable = typeof _ === "function" ? _ : constant_default2(!!_), drag2) : touchable;
    };
    drag2.on = function() {
      var value18 = listeners.on.apply(listeners, arguments);
      return value18 === listeners ? drag2 : value18;
    };
    drag2.clickDistance = function(_) {
      return arguments.length ? (clickDistance2 = (_ = +_) * _, drag2) : Math.sqrt(clickDistance2);
    };
    return drag2;
  }

  // node_modules/d3-color/src/define.js
  function define_default(constructor, factory, prototype) {
    constructor.prototype = factory.prototype = prototype;
    prototype.constructor = constructor;
  }
  function extend2(parent2, definition) {
    var prototype = Object.create(parent2.prototype);
    for (var key in definition) prototype[key] = definition[key];
    return prototype;
  }

  // node_modules/d3-color/src/color.js
  function Color() {
  }
  var darker = 0.7;
  var brighter = 1 / darker;
  var reI = "\\s*([+-]?\\d+)\\s*";
  var reN = "\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*";
  var reP = "\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*";
  var reHex = /^#([0-9a-f]{3,8})$/;
  var reRgbInteger = new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`);
  var reRgbPercent = new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`);
  var reRgbaInteger = new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`);
  var reRgbaPercent = new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`);
  var reHslPercent = new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`);
  var reHslaPercent = new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`);
  var named = {
    aliceblue: 15792383,
    antiquewhite: 16444375,
    aqua: 65535,
    aquamarine: 8388564,
    azure: 15794175,
    beige: 16119260,
    bisque: 16770244,
    black: 0,
    blanchedalmond: 16772045,
    blue: 255,
    blueviolet: 9055202,
    brown: 10824234,
    burlywood: 14596231,
    cadetblue: 6266528,
    chartreuse: 8388352,
    chocolate: 13789470,
    coral: 16744272,
    cornflowerblue: 6591981,
    cornsilk: 16775388,
    crimson: 14423100,
    cyan: 65535,
    darkblue: 139,
    darkcyan: 35723,
    darkgoldenrod: 12092939,
    darkgray: 11119017,
    darkgreen: 25600,
    darkgrey: 11119017,
    darkkhaki: 12433259,
    darkmagenta: 9109643,
    darkolivegreen: 5597999,
    darkorange: 16747520,
    darkorchid: 10040012,
    darkred: 9109504,
    darksalmon: 15308410,
    darkseagreen: 9419919,
    darkslateblue: 4734347,
    darkslategray: 3100495,
    darkslategrey: 3100495,
    darkturquoise: 52945,
    darkviolet: 9699539,
    deeppink: 16716947,
    deepskyblue: 49151,
    dimgray: 6908265,
    dimgrey: 6908265,
    dodgerblue: 2003199,
    firebrick: 11674146,
    floralwhite: 16775920,
    forestgreen: 2263842,
    fuchsia: 16711935,
    gainsboro: 14474460,
    ghostwhite: 16316671,
    gold: 16766720,
    goldenrod: 14329120,
    gray: 8421504,
    green: 32768,
    greenyellow: 11403055,
    grey: 8421504,
    honeydew: 15794160,
    hotpink: 16738740,
    indianred: 13458524,
    indigo: 4915330,
    ivory: 16777200,
    khaki: 15787660,
    lavender: 15132410,
    lavenderblush: 16773365,
    lawngreen: 8190976,
    lemonchiffon: 16775885,
    lightblue: 11393254,
    lightcoral: 15761536,
    lightcyan: 14745599,
    lightgoldenrodyellow: 16448210,
    lightgray: 13882323,
    lightgreen: 9498256,
    lightgrey: 13882323,
    lightpink: 16758465,
    lightsalmon: 16752762,
    lightseagreen: 2142890,
    lightskyblue: 8900346,
    lightslategray: 7833753,
    lightslategrey: 7833753,
    lightsteelblue: 11584734,
    lightyellow: 16777184,
    lime: 65280,
    limegreen: 3329330,
    linen: 16445670,
    magenta: 16711935,
    maroon: 8388608,
    mediumaquamarine: 6737322,
    mediumblue: 205,
    mediumorchid: 12211667,
    mediumpurple: 9662683,
    mediumseagreen: 3978097,
    mediumslateblue: 8087790,
    mediumspringgreen: 64154,
    mediumturquoise: 4772300,
    mediumvioletred: 13047173,
    midnightblue: 1644912,
    mintcream: 16121850,
    mistyrose: 16770273,
    moccasin: 16770229,
    navajowhite: 16768685,
    navy: 128,
    oldlace: 16643558,
    olive: 8421376,
    olivedrab: 7048739,
    orange: 16753920,
    orangered: 16729344,
    orchid: 14315734,
    palegoldenrod: 15657130,
    palegreen: 10025880,
    paleturquoise: 11529966,
    palevioletred: 14381203,
    papayawhip: 16773077,
    peachpuff: 16767673,
    peru: 13468991,
    pink: 16761035,
    plum: 14524637,
    powderblue: 11591910,
    purple: 8388736,
    rebeccapurple: 6697881,
    red: 16711680,
    rosybrown: 12357519,
    royalblue: 4286945,
    saddlebrown: 9127187,
    salmon: 16416882,
    sandybrown: 16032864,
    seagreen: 3050327,
    seashell: 16774638,
    sienna: 10506797,
    silver: 12632256,
    skyblue: 8900331,
    slateblue: 6970061,
    slategray: 7372944,
    slategrey: 7372944,
    snow: 16775930,
    springgreen: 65407,
    steelblue: 4620980,
    tan: 13808780,
    teal: 32896,
    thistle: 14204888,
    tomato: 16737095,
    turquoise: 4251856,
    violet: 15631086,
    wheat: 16113331,
    white: 16777215,
    whitesmoke: 16119285,
    yellow: 16776960,
    yellowgreen: 10145074
  };
  define_default(Color, color, {
    copy(channels) {
      return Object.assign(new this.constructor(), this, channels);
    },
    displayable() {
      return this.rgb().displayable();
    },
    hex: color_formatHex,
    // Deprecated! Use color.formatHex.
    formatHex: color_formatHex,
    formatHex8: color_formatHex8,
    formatHsl: color_formatHsl,
    formatRgb: color_formatRgb,
    toString: color_formatRgb
  });
  function color_formatHex() {
    return this.rgb().formatHex();
  }
  function color_formatHex8() {
    return this.rgb().formatHex8();
  }
  function color_formatHsl() {
    return hslConvert(this).formatHsl();
  }
  function color_formatRgb() {
    return this.rgb().formatRgb();
  }
  function color(format) {
    var m, l;
    format = (format + "").trim().toLowerCase();
    return (m = reHex.exec(format)) ? (l = m[1].length, m = parseInt(m[1], 16), l === 6 ? rgbn(m) : l === 3 ? new Rgb(m >> 8 & 15 | m >> 4 & 240, m >> 4 & 15 | m & 240, (m & 15) << 4 | m & 15, 1) : l === 8 ? rgba(m >> 24 & 255, m >> 16 & 255, m >> 8 & 255, (m & 255) / 255) : l === 4 ? rgba(m >> 12 & 15 | m >> 8 & 240, m >> 8 & 15 | m >> 4 & 240, m >> 4 & 15 | m & 240, ((m & 15) << 4 | m & 15) / 255) : null) : (m = reRgbInteger.exec(format)) ? new Rgb(m[1], m[2], m[3], 1) : (m = reRgbPercent.exec(format)) ? new Rgb(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) : (m = reRgbaInteger.exec(format)) ? rgba(m[1], m[2], m[3], m[4]) : (m = reRgbaPercent.exec(format)) ? rgba(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) : (m = reHslPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, 1) : (m = reHslaPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, m[4]) : named.hasOwnProperty(format) ? rgbn(named[format]) : format === "transparent" ? new Rgb(NaN, NaN, NaN, 0) : null;
  }
  function rgbn(n) {
    return new Rgb(n >> 16 & 255, n >> 8 & 255, n & 255, 1);
  }
  function rgba(r, g, b10, a2) {
    if (a2 <= 0) r = g = b10 = NaN;
    return new Rgb(r, g, b10, a2);
  }
  function rgbConvert(o) {
    if (!(o instanceof Color)) o = color(o);
    if (!o) return new Rgb();
    o = o.rgb();
    return new Rgb(o.r, o.g, o.b, o.opacity);
  }
  function rgb(r, g, b10, opacity4) {
    return arguments.length === 1 ? rgbConvert(r) : new Rgb(r, g, b10, opacity4 == null ? 1 : opacity4);
  }
  function Rgb(r, g, b10, opacity4) {
    this.r = +r;
    this.g = +g;
    this.b = +b10;
    this.opacity = +opacity4;
  }
  define_default(Rgb, rgb, extend2(Color, {
    brighter(k) {
      k = k == null ? brighter : Math.pow(brighter, k);
      return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);
    },
    darker(k) {
      k = k == null ? darker : Math.pow(darker, k);
      return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);
    },
    rgb() {
      return this;
    },
    clamp() {
      return new Rgb(clampi(this.r), clampi(this.g), clampi(this.b), clampa(this.opacity));
    },
    displayable() {
      return -0.5 <= this.r && this.r < 255.5 && (-0.5 <= this.g && this.g < 255.5) && (-0.5 <= this.b && this.b < 255.5) && (0 <= this.opacity && this.opacity <= 1);
    },
    hex: rgb_formatHex,
    // Deprecated! Use color.formatHex.
    formatHex: rgb_formatHex,
    formatHex8: rgb_formatHex8,
    formatRgb: rgb_formatRgb,
    toString: rgb_formatRgb
  }));
  function rgb_formatHex() {
    return `#${hex(this.r)}${hex(this.g)}${hex(this.b)}`;
  }
  function rgb_formatHex8() {
    return `#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity) ? 1 : this.opacity) * 255)}`;
  }
  function rgb_formatRgb() {
    const a2 = clampa(this.opacity);
    return `${a2 === 1 ? "rgb(" : "rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${a2 === 1 ? ")" : `, ${a2})`}`;
  }
  function clampa(opacity4) {
    return isNaN(opacity4) ? 1 : Math.max(0, Math.min(1, opacity4));
  }
  function clampi(value18) {
    return Math.max(0, Math.min(255, Math.round(value18) || 0));
  }
  function hex(value18) {
    value18 = clampi(value18);
    return (value18 < 16 ? "0" : "") + value18.toString(16);
  }
  function hsla(h, s, l, a2) {
    if (a2 <= 0) h = s = l = NaN;
    else if (l <= 0 || l >= 1) h = s = NaN;
    else if (s <= 0) h = NaN;
    return new Hsl(h, s, l, a2);
  }
  function hslConvert(o) {
    if (o instanceof Hsl) return new Hsl(o.h, o.s, o.l, o.opacity);
    if (!(o instanceof Color)) o = color(o);
    if (!o) return new Hsl();
    if (o instanceof Hsl) return o;
    o = o.rgb();
    var r = o.r / 255, g = o.g / 255, b10 = o.b / 255, min12 = Math.min(r, g, b10), max15 = Math.max(r, g, b10), h = NaN, s = max15 - min12, l = (max15 + min12) / 2;
    if (s) {
      if (r === max15) h = (g - b10) / s + (g < b10) * 6;
      else if (g === max15) h = (b10 - r) / s + 2;
      else h = (r - g) / s + 4;
      s /= l < 0.5 ? max15 + min12 : 2 - max15 - min12;
      h *= 60;
    } else {
      s = l > 0 && l < 1 ? 0 : h;
    }
    return new Hsl(h, s, l, o.opacity);
  }
  function hsl(h, s, l, opacity4) {
    return arguments.length === 1 ? hslConvert(h) : new Hsl(h, s, l, opacity4 == null ? 1 : opacity4);
  }
  function Hsl(h, s, l, opacity4) {
    this.h = +h;
    this.s = +s;
    this.l = +l;
    this.opacity = +opacity4;
  }
  define_default(Hsl, hsl, extend2(Color, {
    brighter(k) {
      k = k == null ? brighter : Math.pow(brighter, k);
      return new Hsl(this.h, this.s, this.l * k, this.opacity);
    },
    darker(k) {
      k = k == null ? darker : Math.pow(darker, k);
      return new Hsl(this.h, this.s, this.l * k, this.opacity);
    },
    rgb() {
      var h = this.h % 360 + (this.h < 0) * 360, s = isNaN(h) || isNaN(this.s) ? 0 : this.s, l = this.l, m2 = l + (l < 0.5 ? l : 1 - l) * s, m1 = 2 * l - m2;
      return new Rgb(
        hsl2rgb(h >= 240 ? h - 240 : h + 120, m1, m2),
        hsl2rgb(h, m1, m2),
        hsl2rgb(h < 120 ? h + 240 : h - 120, m1, m2),
        this.opacity
      );
    },
    clamp() {
      return new Hsl(clamph(this.h), clampt(this.s), clampt(this.l), clampa(this.opacity));
    },
    displayable() {
      return (0 <= this.s && this.s <= 1 || isNaN(this.s)) && (0 <= this.l && this.l <= 1) && (0 <= this.opacity && this.opacity <= 1);
    },
    formatHsl() {
      const a2 = clampa(this.opacity);
      return `${a2 === 1 ? "hsl(" : "hsla("}${clamph(this.h)}, ${clampt(this.s) * 100}%, ${clampt(this.l) * 100}%${a2 === 1 ? ")" : `, ${a2})`}`;
    }
  }));
  function clamph(value18) {
    value18 = (value18 || 0) % 360;
    return value18 < 0 ? value18 + 360 : value18;
  }
  function clampt(value18) {
    return Math.max(0, Math.min(1, value18 || 0));
  }
  function hsl2rgb(h, m1, m2) {
    return (h < 60 ? m1 + (m2 - m1) * h / 60 : h < 180 ? m2 : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60 : m1) * 255;
  }

  // node_modules/d3-interpolate/src/basis.js
  function basis(t1, v0, v1, v2, v3) {
    var t2 = t1 * t1, t3 = t2 * t1;
    return ((1 - 3 * t1 + 3 * t2 - t3) * v0 + (4 - 6 * t2 + 3 * t3) * v1 + (1 + 3 * t1 + 3 * t2 - 3 * t3) * v2 + t3 * v3) / 6;
  }
  function basis_default(values2) {
    var n = values2.length - 1;
    return function(t) {
      var i2 = t <= 0 ? t = 0 : t >= 1 ? (t = 1, n - 1) : Math.floor(t * n), v1 = values2[i2], v2 = values2[i2 + 1], v0 = i2 > 0 ? values2[i2 - 1] : 2 * v1 - v2, v3 = i2 < n - 1 ? values2[i2 + 2] : 2 * v2 - v1;
      return basis((t - i2 / n) * n, v0, v1, v2, v3);
    };
  }

  // node_modules/d3-interpolate/src/basisClosed.js
  function basisClosed_default(values2) {
    var n = values2.length;
    return function(t) {
      var i2 = Math.floor(((t %= 1) < 0 ? ++t : t) * n), v0 = values2[(i2 + n - 1) % n], v1 = values2[i2 % n], v2 = values2[(i2 + 1) % n], v3 = values2[(i2 + 2) % n];
      return basis((t - i2 / n) * n, v0, v1, v2, v3);
    };
  }

  // node_modules/d3-interpolate/src/constant.js
  var constant_default3 = (x47) => () => x47;

  // node_modules/d3-interpolate/src/color.js
  function linear(a2, d18) {
    return function(t) {
      return a2 + t * d18;
    };
  }
  function exponential(a2, b10, y48) {
    return a2 = Math.pow(a2, y48), b10 = Math.pow(b10, y48) - a2, y48 = 1 / y48, function(t) {
      return Math.pow(a2 + t * b10, y48);
    };
  }
  function gamma(y48) {
    return (y48 = +y48) === 1 ? nogamma : function(a2, b10) {
      return b10 - a2 ? exponential(a2, b10, y48) : constant_default3(isNaN(a2) ? b10 : a2);
    };
  }
  function nogamma(a2, b10) {
    var d18 = b10 - a2;
    return d18 ? linear(a2, d18) : constant_default3(isNaN(a2) ? b10 : a2);
  }

  // node_modules/d3-interpolate/src/rgb.js
  var rgb_default = (function rgbGamma(y48) {
    var color2 = gamma(y48);
    function rgb2(start13, end2) {
      var r = color2((start13 = rgb(start13)).r, (end2 = rgb(end2)).r), g = color2(start13.g, end2.g), b10 = color2(start13.b, end2.b), opacity4 = nogamma(start13.opacity, end2.opacity);
      return function(t) {
        start13.r = r(t);
        start13.g = g(t);
        start13.b = b10(t);
        start13.opacity = opacity4(t);
        return start13 + "";
      };
    }
    rgb2.gamma = rgbGamma;
    return rgb2;
  })(1);
  function rgbSpline(spline) {
    return function(colors5) {
      var n = colors5.length, r = new Array(n), g = new Array(n), b10 = new Array(n), i2, color2;
      for (i2 = 0; i2 < n; ++i2) {
        color2 = rgb(colors5[i2]);
        r[i2] = color2.r || 0;
        g[i2] = color2.g || 0;
        b10[i2] = color2.b || 0;
      }
      r = spline(r);
      g = spline(g);
      b10 = spline(b10);
      color2.opacity = 1;
      return function(t) {
        color2.r = r(t);
        color2.g = g(t);
        color2.b = b10(t);
        return color2 + "";
      };
    };
  }
  var rgbBasis = rgbSpline(basis_default);
  var rgbBasisClosed = rgbSpline(basisClosed_default);

  // node_modules/d3-interpolate/src/numberArray.js
  function numberArray_default(a2, b10) {
    if (!b10) b10 = [];
    var n = a2 ? Math.min(b10.length, a2.length) : 0, c = b10.slice(), i2;
    return function(t) {
      for (i2 = 0; i2 < n; ++i2) c[i2] = a2[i2] * (1 - t) + b10[i2] * t;
      return c;
    };
  }
  function isNumberArray(x47) {
    return ArrayBuffer.isView(x47) && !(x47 instanceof DataView);
  }

  // node_modules/d3-interpolate/src/array.js
  function genericArray(a2, b10) {
    var nb = b10 ? b10.length : 0, na = a2 ? Math.min(nb, a2.length) : 0, x47 = new Array(na), c = new Array(nb), i2;
    for (i2 = 0; i2 < na; ++i2) x47[i2] = value_default(a2[i2], b10[i2]);
    for (; i2 < nb; ++i2) c[i2] = b10[i2];
    return function(t) {
      for (i2 = 0; i2 < na; ++i2) c[i2] = x47[i2](t);
      return c;
    };
  }

  // node_modules/d3-interpolate/src/date.js
  function date_default(a2, b10) {
    var d18 = /* @__PURE__ */ new Date();
    return a2 = +a2, b10 = +b10, function(t) {
      return d18.setTime(a2 * (1 - t) + b10 * t), d18;
    };
  }

  // node_modules/d3-interpolate/src/number.js
  function number_default(a2, b10) {
    return a2 = +a2, b10 = +b10, function(t) {
      return a2 * (1 - t) + b10 * t;
    };
  }

  // node_modules/d3-interpolate/src/object.js
  function object_default(a2, b10) {
    var i2 = {}, c = {}, k;
    if (a2 === null || typeof a2 !== "object") a2 = {};
    if (b10 === null || typeof b10 !== "object") b10 = {};
    for (k in b10) {
      if (k in a2) {
        i2[k] = value_default(a2[k], b10[k]);
      } else {
        c[k] = b10[k];
      }
    }
    return function(t) {
      for (k in i2) c[k] = i2[k](t);
      return c;
    };
  }

  // node_modules/d3-interpolate/src/string.js
  var reA = /[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;
  var reB = new RegExp(reA.source, "g");
  function zero2(b10) {
    return function() {
      return b10;
    };
  }
  function one2(b10) {
    return function(t) {
      return b10(t) + "";
    };
  }
  function string_default(a2, b10) {
    var bi = reA.lastIndex = reB.lastIndex = 0, am, bm, bs, i2 = -1, s = [], q2 = [];
    a2 = a2 + "", b10 = b10 + "";
    while ((am = reA.exec(a2)) && (bm = reB.exec(b10))) {
      if ((bs = bm.index) > bi) {
        bs = b10.slice(bi, bs);
        if (s[i2]) s[i2] += bs;
        else s[++i2] = bs;
      }
      if ((am = am[0]) === (bm = bm[0])) {
        if (s[i2]) s[i2] += bm;
        else s[++i2] = bm;
      } else {
        s[++i2] = null;
        q2.push({ i: i2, x: number_default(am, bm) });
      }
      bi = reB.lastIndex;
    }
    if (bi < b10.length) {
      bs = b10.slice(bi);
      if (s[i2]) s[i2] += bs;
      else s[++i2] = bs;
    }
    return s.length < 2 ? q2[0] ? one2(q2[0].x) : zero2(b10) : (b10 = q2.length, function(t) {
      for (var i3 = 0, o; i3 < b10; ++i3) s[(o = q2[i3]).i] = o.x(t);
      return s.join("");
    });
  }

  // node_modules/d3-interpolate/src/value.js
  function value_default(a2, b10) {
    var t = typeof b10, c;
    return b10 == null || t === "boolean" ? constant_default3(b10) : (t === "number" ? number_default : t === "string" ? (c = color(b10)) ? (b10 = c, rgb_default) : string_default : b10 instanceof color ? rgb_default : b10 instanceof Date ? date_default : isNumberArray(b10) ? numberArray_default : Array.isArray(b10) ? genericArray : typeof b10.valueOf !== "function" && typeof b10.toString !== "function" || isNaN(b10) ? object_default : number_default)(a2, b10);
  }

  // node_modules/d3-interpolate/src/transform/decompose.js
  var degrees = 180 / Math.PI;
  var identity13 = {
    translateX: 0,
    translateY: 0,
    rotate: 0,
    skewX: 0,
    scaleX: 1,
    scaleY: 1
  };
  function decompose_default(a2, b10, c, d18, e, f) {
    var scaleX3, scaleY3, skewX;
    if (scaleX3 = Math.sqrt(a2 * a2 + b10 * b10)) a2 /= scaleX3, b10 /= scaleX3;
    if (skewX = a2 * c + b10 * d18) c -= a2 * skewX, d18 -= b10 * skewX;
    if (scaleY3 = Math.sqrt(c * c + d18 * d18)) c /= scaleY3, d18 /= scaleY3, skewX /= scaleY3;
    if (a2 * d18 < b10 * c) a2 = -a2, b10 = -b10, skewX = -skewX, scaleX3 = -scaleX3;
    return {
      translateX: e,
      translateY: f,
      rotate: Math.atan2(b10, a2) * degrees,
      skewX: Math.atan(skewX) * degrees,
      scaleX: scaleX3,
      scaleY: scaleY3
    };
  }

  // node_modules/d3-interpolate/src/transform/parse.js
  var svgNode;
  function parseCss(value18) {
    const m = new (typeof DOMMatrix === "function" ? DOMMatrix : WebKitCSSMatrix)(value18 + "");
    return m.isIdentity ? identity13 : decompose_default(m.a, m.b, m.c, m.d, m.e, m.f);
  }
  function parseSvg(value18) {
    if (value18 == null) return identity13;
    if (!svgNode) svgNode = document.createElementNS("http://www.w3.org/2000/svg", "g");
    svgNode.setAttribute("transform", value18);
    if (!(value18 = svgNode.transform.baseVal.consolidate())) return identity13;
    value18 = value18.matrix;
    return decompose_default(value18.a, value18.b, value18.c, value18.d, value18.e, value18.f);
  }

  // node_modules/d3-interpolate/src/transform/index.js
  function interpolateTransform(parse9, pxComma, pxParen, degParen) {
    function pop4(s) {
      return s.length ? s.pop() + " " : "";
    }
    function translate(xa, ya, xb, yb, s, q2) {
      if (xa !== xb || ya !== yb) {
        var i2 = s.push("translate(", null, pxComma, null, pxParen);
        q2.push({ i: i2 - 4, x: number_default(xa, xb) }, { i: i2 - 2, x: number_default(ya, yb) });
      } else if (xb || yb) {
        s.push("translate(" + xb + pxComma + yb + pxParen);
      }
    }
    function rotate(a2, b10, s, q2) {
      if (a2 !== b10) {
        if (a2 - b10 > 180) b10 += 360;
        else if (b10 - a2 > 180) a2 += 360;
        q2.push({ i: s.push(pop4(s) + "rotate(", null, degParen) - 2, x: number_default(a2, b10) });
      } else if (b10) {
        s.push(pop4(s) + "rotate(" + b10 + degParen);
      }
    }
    function skewX(a2, b10, s, q2) {
      if (a2 !== b10) {
        q2.push({ i: s.push(pop4(s) + "skewX(", null, degParen) - 2, x: number_default(a2, b10) });
      } else if (b10) {
        s.push(pop4(s) + "skewX(" + b10 + degParen);
      }
    }
    function scale(xa, ya, xb, yb, s, q2) {
      if (xa !== xb || ya !== yb) {
        var i2 = s.push(pop4(s) + "scale(", null, ",", null, ")");
        q2.push({ i: i2 - 4, x: number_default(xa, xb) }, { i: i2 - 2, x: number_default(ya, yb) });
      } else if (xb !== 1 || yb !== 1) {
        s.push(pop4(s) + "scale(" + xb + "," + yb + ")");
      }
    }
    return function(a2, b10) {
      var s = [], q2 = [];
      a2 = parse9(a2), b10 = parse9(b10);
      translate(a2.translateX, a2.translateY, b10.translateX, b10.translateY, s, q2);
      rotate(a2.rotate, b10.rotate, s, q2);
      skewX(a2.skewX, b10.skewX, s, q2);
      scale(a2.scaleX, a2.scaleY, b10.scaleX, b10.scaleY, s, q2);
      a2 = b10 = null;
      return function(t) {
        var i2 = -1, n = q2.length, o;
        while (++i2 < n) s[(o = q2[i2]).i] = o.x(t);
        return s.join("");
      };
    };
  }
  var interpolateTransformCss = interpolateTransform(parseCss, "px, ", "px)", "deg)");
  var interpolateTransformSvg = interpolateTransform(parseSvg, ", ", ")", ")");

  // node_modules/d3-interpolate/src/zoom.js
  var epsilon2 = 1e-12;
  function cosh(x47) {
    return ((x47 = Math.exp(x47)) + 1 / x47) / 2;
  }
  function sinh(x47) {
    return ((x47 = Math.exp(x47)) - 1 / x47) / 2;
  }
  function tanh(x47) {
    return ((x47 = Math.exp(2 * x47)) - 1) / (x47 + 1);
  }
  var zoom_default = (function zoomRho(rho, rho2, rho4) {
    function zoom(p0, p1) {
      var ux0 = p0[0], uy0 = p0[1], w0 = p0[2], ux1 = p1[0], uy1 = p1[1], w1 = p1[2], dx = ux1 - ux0, dy4 = uy1 - uy0, d22 = dx * dx + dy4 * dy4, i2, S;
      if (d22 < epsilon2) {
        S = Math.log(w1 / w0) / rho;
        i2 = function(t) {
          return [
            ux0 + t * dx,
            uy0 + t * dy4,
            w0 * Math.exp(rho * t * S)
          ];
        };
      } else {
        var d1 = Math.sqrt(d22), b02 = (w1 * w1 - w0 * w0 + rho4 * d22) / (2 * w0 * rho2 * d1), b12 = (w1 * w1 - w0 * w0 - rho4 * d22) / (2 * w1 * rho2 * d1), r0 = Math.log(Math.sqrt(b02 * b02 + 1) - b02), r1 = Math.log(Math.sqrt(b12 * b12 + 1) - b12);
        S = (r1 - r0) / rho;
        i2 = function(t) {
          var s = t * S, coshr0 = cosh(r0), u2 = w0 / (rho2 * d1) * (coshr0 * tanh(rho * s + r0) - sinh(r0));
          return [
            ux0 + u2 * dx,
            uy0 + u2 * dy4,
            w0 * coshr0 / cosh(rho * s + r0)
          ];
        };
      }
      i2.duration = S * 1e3 * rho / Math.SQRT2;
      return i2;
    }
    zoom.rho = function(_) {
      var _1 = Math.max(1e-3, +_), _2 = _1 * _1, _4 = _2 * _2;
      return zoomRho(_1, _2, _4);
    };
    return zoom;
  })(Math.SQRT2, 2, 4);

  // node_modules/d3-timer/src/timer.js
  var frame = 0;
  var timeout = 0;
  var interval = 0;
  var pokeDelay = 1e3;
  var taskHead;
  var taskTail;
  var clockLast = 0;
  var clockNow = 0;
  var clockSkew = 0;
  var clock = typeof performance === "object" && performance.now ? performance : Date;
  var setFrame = typeof window === "object" && window.requestAnimationFrame ? window.requestAnimationFrame.bind(window) : function(f) {
    setTimeout(f, 17);
  };
  function now() {
    return clockNow || (setFrame(clearNow), clockNow = clock.now() + clockSkew);
  }
  function clearNow() {
    clockNow = 0;
  }
  function Timer() {
    this._call = this._time = this._next = null;
  }
  Timer.prototype = timer.prototype = {
    constructor: Timer,
    restart: function(callback, delay2, time3) {
      if (typeof callback !== "function") throw new TypeError("callback is not a function");
      time3 = (time3 == null ? now() : +time3) + (delay2 == null ? 0 : +delay2);
      if (!this._next && taskTail !== this) {
        if (taskTail) taskTail._next = this;
        else taskHead = this;
        taskTail = this;
      }
      this._call = callback;
      this._time = time3;
      sleep();
    },
    stop: function() {
      if (this._call) {
        this._call = null;
        this._time = Infinity;
        sleep();
      }
    }
  };
  function timer(callback, delay2, time3) {
    var t = new Timer();
    t.restart(callback, delay2, time3);
    return t;
  }
  function timerFlush() {
    now();
    ++frame;
    var t = taskHead, e;
    while (t) {
      if ((e = clockNow - t._time) >= 0) t._call.call(void 0, e);
      t = t._next;
    }
    --frame;
  }
  function wake() {
    clockNow = (clockLast = clock.now()) + clockSkew;
    frame = timeout = 0;
    try {
      timerFlush();
    } finally {
      frame = 0;
      nap();
      clockNow = 0;
    }
  }
  function poke3() {
    var now3 = clock.now(), delay2 = now3 - clockLast;
    if (delay2 > pokeDelay) clockSkew -= delay2, clockLast = now3;
  }
  function nap() {
    var t0, t1 = taskHead, t2, time3 = Infinity;
    while (t1) {
      if (t1._call) {
        if (time3 > t1._time) time3 = t1._time;
        t0 = t1, t1 = t1._next;
      } else {
        t2 = t1._next, t1._next = null;
        t1 = t0 ? t0._next = t2 : taskHead = t2;
      }
    }
    taskTail = t0;
    sleep(time3);
  }
  function sleep(time3) {
    if (frame) return;
    if (timeout) timeout = clearTimeout(timeout);
    var delay2 = time3 - clockNow;
    if (delay2 > 24) {
      if (time3 < Infinity) timeout = setTimeout(wake, time3 - clock.now() - clockSkew);
      if (interval) interval = clearInterval(interval);
    } else {
      if (!interval) clockLast = clock.now(), interval = setInterval(poke3, pokeDelay);
      frame = 1, setFrame(wake);
    }
  }

  // node_modules/d3-timer/src/timeout.js
  function timeout_default(callback, delay2, time3) {
    var t = new Timer();
    delay2 = delay2 == null ? 0 : +delay2;
    t.restart((elapsed) => {
      t.stop();
      callback(elapsed + delay2);
    }, delay2, time3);
    return t;
  }

  // node_modules/d3-transition/src/transition/schedule.js
  var emptyOn = dispatch_default("start", "end", "cancel", "interrupt");
  var emptyTween = [];
  var CREATED = 0;
  var SCHEDULED = 1;
  var STARTING = 2;
  var STARTED = 3;
  var RUNNING = 4;
  var ENDING = 5;
  var ENDED = 6;
  function schedule_default(node, name16, id5, index5, group4, timing) {
    var schedules = node.__transition;
    if (!schedules) node.__transition = {};
    else if (id5 in schedules) return;
    create2(node, id5, {
      name: name16,
      index: index5,
      // For context during callback.
      group: group4,
      // For context during callback.
      on: emptyOn,
      tween: emptyTween,
      time: timing.time,
      delay: timing.delay,
      duration: timing.duration,
      ease: timing.ease,
      timer: null,
      state: CREATED
    });
  }
  function init2(node, id5) {
    var schedule = get6(node, id5);
    if (schedule.state > CREATED) throw new Error("too late; already scheduled");
    return schedule;
  }
  function set4(node, id5) {
    var schedule = get6(node, id5);
    if (schedule.state > STARTED) throw new Error("too late; already running");
    return schedule;
  }
  function get6(node, id5) {
    var schedule = node.__transition;
    if (!schedule || !(schedule = schedule[id5])) throw new Error("transition not found");
    return schedule;
  }
  function create2(node, id5, self) {
    var schedules = node.__transition, tween;
    schedules[id5] = self;
    self.timer = timer(schedule, 0, self.time);
    function schedule(elapsed) {
      self.state = SCHEDULED;
      self.timer.restart(start13, self.delay, self.time);
      if (self.delay <= elapsed) start13(elapsed - self.delay);
    }
    function start13(elapsed) {
      var i2, j, n, o;
      if (self.state !== SCHEDULED) return stop5();
      for (i2 in schedules) {
        o = schedules[i2];
        if (o.name !== self.name) continue;
        if (o.state === STARTED) return timeout_default(start13);
        if (o.state === RUNNING) {
          o.state = ENDED;
          o.timer.stop();
          o.on.call("interrupt", node, node.__data__, o.index, o.group);
          delete schedules[i2];
        } else if (+i2 < id5) {
          o.state = ENDED;
          o.timer.stop();
          o.on.call("cancel", node, node.__data__, o.index, o.group);
          delete schedules[i2];
        }
      }
      timeout_default(function() {
        if (self.state === STARTED) {
          self.state = RUNNING;
          self.timer.restart(tick, self.delay, self.time);
          tick(elapsed);
        }
      });
      self.state = STARTING;
      self.on.call("start", node, node.__data__, self.index, self.group);
      if (self.state !== STARTING) return;
      self.state = STARTED;
      tween = new Array(n = self.tween.length);
      for (i2 = 0, j = -1; i2 < n; ++i2) {
        if (o = self.tween[i2].value.call(node, node.__data__, self.index, self.group)) {
          tween[++j] = o;
        }
      }
      tween.length = j + 1;
    }
    function tick(elapsed) {
      var t = elapsed < self.duration ? self.ease.call(null, elapsed / self.duration) : (self.timer.restart(stop5), self.state = ENDING, 1), i2 = -1, n = tween.length;
      while (++i2 < n) {
        tween[i2].call(node, t);
      }
      if (self.state === ENDING) {
        self.on.call("end", node, node.__data__, self.index, self.group);
        stop5();
      }
    }
    function stop5() {
      self.state = ENDED;
      self.timer.stop();
      delete schedules[id5];
      for (var i2 in schedules) return;
      delete node.__transition;
    }
  }

  // node_modules/d3-transition/src/interrupt.js
  function interrupt_default(node, name16) {
    var schedules = node.__transition, schedule, active, empty9 = true, i2;
    if (!schedules) return;
    name16 = name16 == null ? null : name16 + "";
    for (i2 in schedules) {
      if ((schedule = schedules[i2]).name !== name16) {
        empty9 = false;
        continue;
      }
      active = schedule.state > STARTING && schedule.state < ENDING;
      schedule.state = ENDED;
      schedule.timer.stop();
      schedule.on.call(active ? "interrupt" : "cancel", node, node.__data__, schedule.index, schedule.group);
      delete schedules[i2];
    }
    if (empty9) delete node.__transition;
  }

  // node_modules/d3-transition/src/selection/interrupt.js
  function interrupt_default2(name16) {
    return this.each(function() {
      interrupt_default(this, name16);
    });
  }

  // node_modules/d3-transition/src/transition/tween.js
  function tweenRemove(id5, name16) {
    var tween0, tween1;
    return function() {
      var schedule = set4(this, id5), tween = schedule.tween;
      if (tween !== tween0) {
        tween1 = tween0 = tween;
        for (var i2 = 0, n = tween1.length; i2 < n; ++i2) {
          if (tween1[i2].name === name16) {
            tween1 = tween1.slice();
            tween1.splice(i2, 1);
            break;
          }
        }
      }
      schedule.tween = tween1;
    };
  }
  function tweenFunction(id5, name16, value18) {
    var tween0, tween1;
    if (typeof value18 !== "function") throw new Error();
    return function() {
      var schedule = set4(this, id5), tween = schedule.tween;
      if (tween !== tween0) {
        tween1 = (tween0 = tween).slice();
        for (var t = { name: name16, value: value18 }, i2 = 0, n = tween1.length; i2 < n; ++i2) {
          if (tween1[i2].name === name16) {
            tween1[i2] = t;
            break;
          }
        }
        if (i2 === n) tween1.push(t);
      }
      schedule.tween = tween1;
    };
  }
  function tween_default(name16, value18) {
    var id5 = this._id;
    name16 += "";
    if (arguments.length < 2) {
      var tween = get6(this.node(), id5).tween;
      for (var i2 = 0, n = tween.length, t; i2 < n; ++i2) {
        if ((t = tween[i2]).name === name16) {
          return t.value;
        }
      }
      return null;
    }
    return this.each((value18 == null ? tweenRemove : tweenFunction)(id5, name16, value18));
  }
  function tweenValue(transition2, name16, value18) {
    var id5 = transition2._id;
    transition2.each(function() {
      var schedule = set4(this, id5);
      (schedule.value || (schedule.value = {}))[name16] = value18.apply(this, arguments);
    });
    return function(node) {
      return get6(node, id5).value[name16];
    };
  }

  // node_modules/d3-transition/src/transition/interpolate.js
  function interpolate_default(a2, b10) {
    var c;
    return (typeof b10 === "number" ? number_default : b10 instanceof color ? rgb_default : (c = color(b10)) ? (b10 = c, rgb_default) : string_default)(a2, b10);
  }

  // node_modules/d3-transition/src/transition/attr.js
  function attrRemove2(name16) {
    return function() {
      this.removeAttribute(name16);
    };
  }
  function attrRemoveNS2(fullname) {
    return function() {
      this.removeAttributeNS(fullname.space, fullname.local);
    };
  }
  function attrConstant2(name16, interpolate, value1) {
    var string00, string1 = value1 + "", interpolate0;
    return function() {
      var string0 = this.getAttribute(name16);
      return string0 === string1 ? null : string0 === string00 ? interpolate0 : interpolate0 = interpolate(string00 = string0, value1);
    };
  }
  function attrConstantNS2(fullname, interpolate, value1) {
    var string00, string1 = value1 + "", interpolate0;
    return function() {
      var string0 = this.getAttributeNS(fullname.space, fullname.local);
      return string0 === string1 ? null : string0 === string00 ? interpolate0 : interpolate0 = interpolate(string00 = string0, value1);
    };
  }
  function attrFunction2(name16, interpolate, value18) {
    var string00, string10, interpolate0;
    return function() {
      var string0, value1 = value18(this), string1;
      if (value1 == null) return void this.removeAttribute(name16);
      string0 = this.getAttribute(name16);
      string1 = value1 + "";
      return string0 === string1 ? null : string0 === string00 && string1 === string10 ? interpolate0 : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));
    };
  }
  function attrFunctionNS2(fullname, interpolate, value18) {
    var string00, string10, interpolate0;
    return function() {
      var string0, value1 = value18(this), string1;
      if (value1 == null) return void this.removeAttributeNS(fullname.space, fullname.local);
      string0 = this.getAttributeNS(fullname.space, fullname.local);
      string1 = value1 + "";
      return string0 === string1 ? null : string0 === string00 && string1 === string10 ? interpolate0 : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));
    };
  }
  function attr_default2(name16, value18) {
    var fullname = namespace_default(name16), i2 = fullname === "transform" ? interpolateTransformSvg : interpolate_default;
    return this.attrTween(name16, typeof value18 === "function" ? (fullname.local ? attrFunctionNS2 : attrFunction2)(fullname, i2, tweenValue(this, "attr." + name16, value18)) : value18 == null ? (fullname.local ? attrRemoveNS2 : attrRemove2)(fullname) : (fullname.local ? attrConstantNS2 : attrConstant2)(fullname, i2, value18));
  }

  // node_modules/d3-transition/src/transition/attrTween.js
  function attrInterpolate(name16, i2) {
    return function(t) {
      this.setAttribute(name16, i2.call(this, t));
    };
  }
  function attrInterpolateNS(fullname, i2) {
    return function(t) {
      this.setAttributeNS(fullname.space, fullname.local, i2.call(this, t));
    };
  }
  function attrTweenNS(fullname, value18) {
    var t0, i0;
    function tween() {
      var i2 = value18.apply(this, arguments);
      if (i2 !== i0) t0 = (i0 = i2) && attrInterpolateNS(fullname, i2);
      return t0;
    }
    tween._value = value18;
    return tween;
  }
  function attrTween(name16, value18) {
    var t0, i0;
    function tween() {
      var i2 = value18.apply(this, arguments);
      if (i2 !== i0) t0 = (i0 = i2) && attrInterpolate(name16, i2);
      return t0;
    }
    tween._value = value18;
    return tween;
  }
  function attrTween_default(name16, value18) {
    var key = "attr." + name16;
    if (arguments.length < 2) return (key = this.tween(key)) && key._value;
    if (value18 == null) return this.tween(key, null);
    if (typeof value18 !== "function") throw new Error();
    var fullname = namespace_default(name16);
    return this.tween(key, (fullname.local ? attrTweenNS : attrTween)(fullname, value18));
  }

  // node_modules/d3-transition/src/transition/delay.js
  function delayFunction(id5, value18) {
    return function() {
      init2(this, id5).delay = +value18.apply(this, arguments);
    };
  }
  function delayConstant(id5, value18) {
    return value18 = +value18, function() {
      init2(this, id5).delay = value18;
    };
  }
  function delay_default(value18) {
    var id5 = this._id;
    return arguments.length ? this.each((typeof value18 === "function" ? delayFunction : delayConstant)(id5, value18)) : get6(this.node(), id5).delay;
  }

  // node_modules/d3-transition/src/transition/duration.js
  function durationFunction(id5, value18) {
    return function() {
      set4(this, id5).duration = +value18.apply(this, arguments);
    };
  }
  function durationConstant(id5, value18) {
    return value18 = +value18, function() {
      set4(this, id5).duration = value18;
    };
  }
  function duration_default(value18) {
    var id5 = this._id;
    return arguments.length ? this.each((typeof value18 === "function" ? durationFunction : durationConstant)(id5, value18)) : get6(this.node(), id5).duration;
  }

  // node_modules/d3-transition/src/transition/ease.js
  function easeConstant(id5, value18) {
    if (typeof value18 !== "function") throw new Error();
    return function() {
      set4(this, id5).ease = value18;
    };
  }
  function ease_default(value18) {
    var id5 = this._id;
    return arguments.length ? this.each(easeConstant(id5, value18)) : get6(this.node(), id5).ease;
  }

  // node_modules/d3-transition/src/transition/easeVarying.js
  function easeVarying(id5, value18) {
    return function() {
      var v = value18.apply(this, arguments);
      if (typeof v !== "function") throw new Error();
      set4(this, id5).ease = v;
    };
  }
  function easeVarying_default(value18) {
    if (typeof value18 !== "function") throw new Error();
    return this.each(easeVarying(this._id, value18));
  }

  // node_modules/d3-transition/src/transition/filter.js
  function filter_default2(match2) {
    if (typeof match2 !== "function") match2 = matcher_default(match2);
    for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {
      for (var group4 = groups[j], n = group4.length, subgroup = subgroups[j] = [], node, i2 = 0; i2 < n; ++i2) {
        if ((node = group4[i2]) && match2.call(node, node.__data__, i2, group4)) {
          subgroup.push(node);
        }
      }
    }
    return new Transition(subgroups, this._parents, this._name, this._id);
  }

  // node_modules/d3-transition/src/transition/merge.js
  function merge_default2(transition2) {
    if (transition2._id !== this._id) throw new Error();
    for (var groups0 = this._groups, groups1 = transition2._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {
      for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge6 = merges[j] = new Array(n), node, i2 = 0; i2 < n; ++i2) {
        if (node = group0[i2] || group1[i2]) {
          merge6[i2] = node;
        }
      }
    }
    for (; j < m0; ++j) {
      merges[j] = groups0[j];
    }
    return new Transition(merges, this._parents, this._name, this._id);
  }

  // node_modules/d3-transition/src/transition/on.js
  function start(name16) {
    return (name16 + "").trim().split(/^|\s+/).every(function(t) {
      var i2 = t.indexOf(".");
      if (i2 >= 0) t = t.slice(0, i2);
      return !t || t === "start";
    });
  }
  function onFunction(id5, name16, listener) {
    var on0, on1, sit = start(name16) ? init2 : set4;
    return function() {
      var schedule = sit(this, id5), on14 = schedule.on;
      if (on14 !== on0) (on1 = (on0 = on14).copy()).on(name16, listener);
      schedule.on = on1;
    };
  }
  function on_default2(name16, listener) {
    var id5 = this._id;
    return arguments.length < 2 ? get6(this.node(), id5).on.on(name16) : this.each(onFunction(id5, name16, listener));
  }

  // node_modules/d3-transition/src/transition/remove.js
  function removeFunction(id5) {
    return function() {
      var parent2 = this.parentNode;
      for (var i2 in this.__transition) if (+i2 !== id5) return;
      if (parent2) parent2.removeChild(this);
    };
  }
  function remove_default2() {
    return this.on("end.remove", removeFunction(this._id));
  }

  // node_modules/d3-transition/src/transition/select.js
  function select_default3(select44) {
    var name16 = this._name, id5 = this._id;
    if (typeof select44 !== "function") select44 = selector_default(select44);
    for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {
      for (var group4 = groups[j], n = group4.length, subgroup = subgroups[j] = new Array(n), node, subnode, i2 = 0; i2 < n; ++i2) {
        if ((node = group4[i2]) && (subnode = select44.call(node, node.__data__, i2, group4))) {
          if ("__data__" in node) subnode.__data__ = node.__data__;
          subgroup[i2] = subnode;
          schedule_default(subgroup[i2], name16, id5, i2, subgroup, get6(node, id5));
        }
      }
    }
    return new Transition(subgroups, this._parents, name16, id5);
  }

  // node_modules/d3-transition/src/transition/selectAll.js
  function selectAll_default2(select44) {
    var name16 = this._name, id5 = this._id;
    if (typeof select44 !== "function") select44 = selectorAll_default(select44);
    for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {
      for (var group4 = groups[j], n = group4.length, node, i2 = 0; i2 < n; ++i2) {
        if (node = group4[i2]) {
          for (var children3 = select44.call(node, node.__data__, i2, group4), child, inherit2 = get6(node, id5), k = 0, l = children3.length; k < l; ++k) {
            if (child = children3[k]) {
              schedule_default(child, name16, id5, k, children3, inherit2);
            }
          }
          subgroups.push(children3);
          parents.push(node);
        }
      }
    }
    return new Transition(subgroups, parents, name16, id5);
  }

  // node_modules/d3-transition/src/transition/selection.js
  var Selection2 = selection_default.prototype.constructor;
  function selection_default2() {
    return new Selection2(this._groups, this._parents);
  }

  // node_modules/d3-transition/src/transition/style.js
  function styleNull(name16, interpolate) {
    var string00, string10, interpolate0;
    return function() {
      var string0 = styleValue(this, name16), string1 = (this.style.removeProperty(name16), styleValue(this, name16));
      return string0 === string1 ? null : string0 === string00 && string1 === string10 ? interpolate0 : interpolate0 = interpolate(string00 = string0, string10 = string1);
    };
  }
  function styleRemove2(name16) {
    return function() {
      this.style.removeProperty(name16);
    };
  }
  function styleConstant2(name16, interpolate, value1) {
    var string00, string1 = value1 + "", interpolate0;
    return function() {
      var string0 = styleValue(this, name16);
      return string0 === string1 ? null : string0 === string00 ? interpolate0 : interpolate0 = interpolate(string00 = string0, value1);
    };
  }
  function styleFunction2(name16, interpolate, value18) {
    var string00, string10, interpolate0;
    return function() {
      var string0 = styleValue(this, name16), value1 = value18(this), string1 = value1 + "";
      if (value1 == null) string1 = value1 = (this.style.removeProperty(name16), styleValue(this, name16));
      return string0 === string1 ? null : string0 === string00 && string1 === string10 ? interpolate0 : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));
    };
  }
  function styleMaybeRemove(id5, name16) {
    var on0, on1, listener0, key = "style." + name16, event = "end." + key, remove9;
    return function() {
      var schedule = set4(this, id5), on14 = schedule.on, listener = schedule.value[key] == null ? remove9 || (remove9 = styleRemove2(name16)) : void 0;
      if (on14 !== on0 || listener0 !== listener) (on1 = (on0 = on14).copy()).on(event, listener0 = listener);
      schedule.on = on1;
    };
  }
  function style_default2(name16, value18, priority) {
    var i2 = (name16 += "") === "transform" ? interpolateTransformCss : interpolate_default;
    return value18 == null ? this.styleTween(name16, styleNull(name16, i2)).on("end.style." + name16, styleRemove2(name16)) : typeof value18 === "function" ? this.styleTween(name16, styleFunction2(name16, i2, tweenValue(this, "style." + name16, value18))).each(styleMaybeRemove(this._id, name16)) : this.styleTween(name16, styleConstant2(name16, i2, value18), priority).on("end.style." + name16, null);
  }

  // node_modules/d3-transition/src/transition/styleTween.js
  function styleInterpolate(name16, i2, priority) {
    return function(t) {
      this.style.setProperty(name16, i2.call(this, t), priority);
    };
  }
  function styleTween(name16, value18, priority) {
    var t, i0;
    function tween() {
      var i2 = value18.apply(this, arguments);
      if (i2 !== i0) t = (i0 = i2) && styleInterpolate(name16, i2, priority);
      return t;
    }
    tween._value = value18;
    return tween;
  }
  function styleTween_default(name16, value18, priority) {
    var key = "style." + (name16 += "");
    if (arguments.length < 2) return (key = this.tween(key)) && key._value;
    if (value18 == null) return this.tween(key, null);
    if (typeof value18 !== "function") throw new Error();
    return this.tween(key, styleTween(name16, value18, priority == null ? "" : priority));
  }

  // node_modules/d3-transition/src/transition/text.js
  function textConstant2(value18) {
    return function() {
      this.textContent = value18;
    };
  }
  function textFunction2(value18) {
    return function() {
      var value1 = value18(this);
      this.textContent = value1 == null ? "" : value1;
    };
  }
  function text_default2(value18) {
    return this.tween("text", typeof value18 === "function" ? textFunction2(tweenValue(this, "text", value18)) : textConstant2(value18 == null ? "" : value18 + ""));
  }

  // node_modules/d3-transition/src/transition/textTween.js
  function textInterpolate(i2) {
    return function(t) {
      this.textContent = i2.call(this, t);
    };
  }
  function textTween(value18) {
    var t0, i0;
    function tween() {
      var i2 = value18.apply(this, arguments);
      if (i2 !== i0) t0 = (i0 = i2) && textInterpolate(i2);
      return t0;
    }
    tween._value = value18;
    return tween;
  }
  function textTween_default(value18) {
    var key = "text";
    if (arguments.length < 1) return (key = this.tween(key)) && key._value;
    if (value18 == null) return this.tween(key, null);
    if (typeof value18 !== "function") throw new Error();
    return this.tween(key, textTween(value18));
  }

  // node_modules/d3-transition/src/transition/transition.js
  function transition_default() {
    var name16 = this._name, id0 = this._id, id1 = newId();
    for (var groups = this._groups, m = groups.length, j = 0; j < m; ++j) {
      for (var group4 = groups[j], n = group4.length, node, i2 = 0; i2 < n; ++i2) {
        if (node = group4[i2]) {
          var inherit2 = get6(node, id0);
          schedule_default(node, name16, id1, i2, group4, {
            time: inherit2.time + inherit2.delay + inherit2.duration,
            delay: 0,
            duration: inherit2.duration,
            ease: inherit2.ease
          });
        }
      }
    }
    return new Transition(groups, this._parents, name16, id1);
  }

  // node_modules/d3-transition/src/transition/end.js
  function end_default() {
    var on0, on1, that = this, id5 = that._id, size6 = that.size();
    return new Promise(function(resolve, reject) {
      var cancel = { value: reject }, end2 = { value: function() {
        if (--size6 === 0) resolve();
      } };
      that.each(function() {
        var schedule = set4(this, id5), on14 = schedule.on;
        if (on14 !== on0) {
          on1 = (on0 = on14).copy();
          on1._.cancel.push(cancel);
          on1._.interrupt.push(cancel);
          on1._.end.push(end2);
        }
        schedule.on = on1;
      });
      if (size6 === 0) resolve();
    });
  }

  // node_modules/d3-transition/src/transition/index.js
  var id4 = 0;
  function Transition(groups, parents, name16, id5) {
    this._groups = groups;
    this._parents = parents;
    this._name = name16;
    this._id = id5;
  }
  function transition(name16) {
    return selection_default().transition(name16);
  }
  function newId() {
    return ++id4;
  }
  var selection_prototype = selection_default.prototype;
  Transition.prototype = transition.prototype = {
    constructor: Transition,
    select: select_default3,
    selectAll: selectAll_default2,
    selectChild: selection_prototype.selectChild,
    selectChildren: selection_prototype.selectChildren,
    filter: filter_default2,
    merge: merge_default2,
    selection: selection_default2,
    transition: transition_default,
    call: selection_prototype.call,
    nodes: selection_prototype.nodes,
    node: selection_prototype.node,
    size: selection_prototype.size,
    empty: selection_prototype.empty,
    each: selection_prototype.each,
    on: on_default2,
    attr: attr_default2,
    attrTween: attrTween_default,
    style: style_default2,
    styleTween: styleTween_default,
    text: text_default2,
    textTween: textTween_default,
    remove: remove_default2,
    tween: tween_default,
    delay: delay_default,
    duration: duration_default,
    ease: ease_default,
    easeVarying: easeVarying_default,
    end: end_default,
    [Symbol.iterator]: selection_prototype[Symbol.iterator]
  };

  // node_modules/d3-ease/src/linear.js
  var linear2 = (t) => +t;

  // node_modules/d3-ease/src/quad.js
  function quadIn(t) {
    return t * t;
  }
  function quadOut(t) {
    return t * (2 - t);
  }
  function quadInOut(t) {
    return ((t *= 2) <= 1 ? t * t : --t * (2 - t) + 1) / 2;
  }

  // node_modules/d3-ease/src/cubic.js
  function cubicIn(t) {
    return t * t * t;
  }
  function cubicOut(t) {
    return --t * t * t + 1;
  }
  function cubicInOut(t) {
    return ((t *= 2) <= 1 ? t * t * t : (t -= 2) * t * t + 2) / 2;
  }

  // node_modules/d3-ease/src/sin.js
  var pi2 = Math.PI;
  var halfPi = pi2 / 2;
  function sinIn(t) {
    return +t === 1 ? 1 : 1 - Math.cos(t * halfPi);
  }
  function sinOut(t) {
    return Math.sin(t * halfPi);
  }
  function sinInOut(t) {
    return (1 - Math.cos(pi2 * t)) / 2;
  }

  // node_modules/d3-ease/src/math.js
  function tpmt(x47) {
    return (Math.pow(2, -10 * x47) - 9765625e-10) * 1.0009775171065494;
  }

  // node_modules/d3-ease/src/exp.js
  function expIn(t) {
    return tpmt(1 - +t);
  }
  function expOut(t) {
    return 1 - tpmt(t);
  }
  function expInOut(t) {
    return ((t *= 2) <= 1 ? tpmt(1 - t) : 2 - tpmt(t - 1)) / 2;
  }

  // node_modules/d3-ease/src/circle.js
  function circleIn(t) {
    return 1 - Math.sqrt(1 - t * t);
  }
  function circleOut(t) {
    return Math.sqrt(1 - --t * t);
  }
  function circleInOut(t) {
    return ((t *= 2) <= 1 ? 1 - Math.sqrt(1 - t * t) : Math.sqrt(1 - (t -= 2) * t) + 1) / 2;
  }

  // node_modules/d3-ease/src/bounce.js
  var b1 = 4 / 11;
  var b2 = 6 / 11;
  var b3 = 8 / 11;
  var b4 = 3 / 4;
  var b5 = 9 / 11;
  var b6 = 10 / 11;
  var b7 = 15 / 16;
  var b8 = 21 / 22;
  var b9 = 63 / 64;
  var b0 = 1 / b1 / b1;
  function bounceIn(t) {
    return 1 - bounceOut(1 - t);
  }
  function bounceOut(t) {
    return (t = +t) < b1 ? b0 * t * t : t < b3 ? b0 * (t -= b2) * t + b4 : t < b6 ? b0 * (t -= b5) * t + b7 : b0 * (t -= b8) * t + b9;
  }
  function bounceInOut(t) {
    return ((t *= 2) <= 1 ? 1 - bounceOut(1 - t) : bounceOut(t - 1) + 1) / 2;
  }

  // node_modules/d3-ease/src/back.js
  var overshoot = 1.70158;
  var backIn = (function custom(s) {
    s = +s;
    function backIn2(t) {
      return (t = +t) * t * (s * (t - 1) + t);
    }
    backIn2.overshoot = custom;
    return backIn2;
  })(overshoot);
  var backOut = (function custom2(s) {
    s = +s;
    function backOut2(t) {
      return --t * t * ((t + 1) * s + t) + 1;
    }
    backOut2.overshoot = custom2;
    return backOut2;
  })(overshoot);
  var backInOut = (function custom3(s) {
    s = +s;
    function backInOut2(t) {
      return ((t *= 2) < 1 ? t * t * ((s + 1) * t - s) : (t -= 2) * t * ((s + 1) * t + s) + 2) / 2;
    }
    backInOut2.overshoot = custom3;
    return backInOut2;
  })(overshoot);

  // node_modules/d3-ease/src/elastic.js
  var tau = 2 * Math.PI;
  var amplitude = 1;
  var period = 0.3;
  var elasticIn = (function custom4(a2, p2) {
    var s = Math.asin(1 / (a2 = Math.max(1, a2))) * (p2 /= tau);
    function elasticIn2(t) {
      return a2 * tpmt(- --t) * Math.sin((s - t) / p2);
    }
    elasticIn2.amplitude = function(a3) {
      return custom4(a3, p2 * tau);
    };
    elasticIn2.period = function(p3) {
      return custom4(a2, p3);
    };
    return elasticIn2;
  })(amplitude, period);
  var elasticOut = (function custom5(a2, p2) {
    var s = Math.asin(1 / (a2 = Math.max(1, a2))) * (p2 /= tau);
    function elasticOut2(t) {
      return 1 - a2 * tpmt(t = +t) * Math.sin((t + s) / p2);
    }
    elasticOut2.amplitude = function(a3) {
      return custom5(a3, p2 * tau);
    };
    elasticOut2.period = function(p3) {
      return custom5(a2, p3);
    };
    return elasticOut2;
  })(amplitude, period);
  var elasticInOut = (function custom6(a2, p2) {
    var s = Math.asin(1 / (a2 = Math.max(1, a2))) * (p2 /= tau);
    function elasticInOut2(t) {
      return ((t = t * 2 - 1) < 0 ? a2 * tpmt(-t) * Math.sin((s - t) / p2) : 2 - a2 * tpmt(t) * Math.sin((s + t) / p2)) / 2;
    }
    elasticInOut2.amplitude = function(a3) {
      return custom6(a3, p2 * tau);
    };
    elasticInOut2.period = function(p3) {
      return custom6(a2, p3);
    };
    return elasticInOut2;
  })(amplitude, period);

  // node_modules/d3-transition/src/selection/transition.js
  var defaultTiming = {
    time: null,
    // Set on use.
    delay: 0,
    duration: 250,
    ease: cubicInOut
  };
  function inherit(node, id5) {
    var timing;
    while (!(timing = node.__transition) || !(timing = timing[id5])) {
      if (!(node = node.parentNode)) {
        throw new Error(`transition ${id5} not found`);
      }
    }
    return timing;
  }
  function transition_default2(name16) {
    var id5, timing;
    if (name16 instanceof Transition) {
      id5 = name16._id, name16 = name16._name;
    } else {
      id5 = newId(), (timing = defaultTiming).time = now(), name16 = name16 == null ? null : name16 + "";
    }
    for (var groups = this._groups, m = groups.length, j = 0; j < m; ++j) {
      for (var group4 = groups[j], n = group4.length, node, i2 = 0; i2 < n; ++i2) {
        if (node = group4[i2]) {
          schedule_default(node, name16, id5, i2, group4, timing || inherit(node, id5));
        }
      }
    }
    return new Transition(groups, this._parents, name16, id5);
  }

  // node_modules/d3-transition/src/selection/index.js
  selection_default.prototype.interrupt = interrupt_default2;
  selection_default.prototype.transition = transition_default2;

  // node_modules/d3-brush/src/brush.js
  var { abs: abs3, max: max5, min: min5 } = Math;
  function number1(e) {
    return [+e[0], +e[1]];
  }
  function number2(e) {
    return [number1(e[0]), number1(e[1])];
  }
  var X = {
    name: "x",
    handles: ["w", "e"].map(type),
    input: function(x47, e) {
      return x47 == null ? null : [[+x47[0], e[0][1]], [+x47[1], e[1][1]]];
    },
    output: function(xy) {
      return xy && [xy[0][0], xy[1][0]];
    }
  };
  var Y = {
    name: "y",
    handles: ["n", "s"].map(type),
    input: function(y48, e) {
      return y48 == null ? null : [[e[0][0], +y48[0]], [e[1][0], +y48[1]]];
    },
    output: function(xy) {
      return xy && [xy[0][1], xy[1][1]];
    }
  };
  var XY = {
    name: "xy",
    handles: ["n", "w", "e", "s", "nw", "ne", "sw", "se"].map(type),
    input: function(xy) {
      return xy == null ? null : number2(xy);
    },
    output: function(xy) {
      return xy;
    }
  };
  function type(t) {
    return { type: t };
  }

  // node_modules/d3-zoom/src/constant.js
  var constant_default5 = (x47) => () => x47;

  // node_modules/d3-zoom/src/event.js
  function ZoomEvent(type2, {
    sourceEvent,
    target: target7,
    transform: transform20,
    dispatch: dispatch2
  }) {
    Object.defineProperties(this, {
      type: { value: type2, enumerable: true, configurable: true },
      sourceEvent: { value: sourceEvent, enumerable: true, configurable: true },
      target: { value: target7, enumerable: true, configurable: true },
      transform: { value: transform20, enumerable: true, configurable: true },
      _: { value: dispatch2 }
    });
  }

  // node_modules/d3-zoom/src/transform.js
  function Transform(k, x47, y48) {
    this.k = k;
    this.x = x47;
    this.y = y48;
  }
  Transform.prototype = {
    constructor: Transform,
    scale: function(k) {
      return k === 1 ? this : new Transform(this.k * k, this.x, this.y);
    },
    translate: function(x47, y48) {
      return x47 === 0 & y48 === 0 ? this : new Transform(this.k, this.x + this.k * x47, this.y + this.k * y48);
    },
    apply: function(point) {
      return [point[0] * this.k + this.x, point[1] * this.k + this.y];
    },
    applyX: function(x47) {
      return x47 * this.k + this.x;
    },
    applyY: function(y48) {
      return y48 * this.k + this.y;
    },
    invert: function(location2) {
      return [(location2[0] - this.x) / this.k, (location2[1] - this.y) / this.k];
    },
    invertX: function(x47) {
      return (x47 - this.x) / this.k;
    },
    invertY: function(y48) {
      return (y48 - this.y) / this.k;
    },
    rescaleX: function(x47) {
      return x47.copy().domain(x47.range().map(this.invertX, this).map(x47.invert, x47));
    },
    rescaleY: function(y48) {
      return y48.copy().domain(y48.range().map(this.invertY, this).map(y48.invert, y48));
    },
    toString: function() {
      return "translate(" + this.x + "," + this.y + ") scale(" + this.k + ")";
    }
  };
  var identity14 = new Transform(1, 0, 0);
  transform.prototype = Transform.prototype;
  function transform(node) {
    while (!node.__zoom) if (!(node = node.parentNode)) return identity14;
    return node.__zoom;
  }

  // node_modules/d3-zoom/src/noevent.js
  function nopropagation3(event) {
    event.stopImmediatePropagation();
  }
  function noevent_default3(event) {
    event.preventDefault();
    event.stopImmediatePropagation();
  }

  // node_modules/d3-zoom/src/zoom.js
  function defaultFilter2(event) {
    return (!event.ctrlKey || event.type === "wheel") && !event.button;
  }
  function defaultExtent() {
    var e = this;
    if (e instanceof SVGElement) {
      e = e.ownerSVGElement || e;
      if (e.hasAttribute("viewBox")) {
        e = e.viewBox.baseVal;
        return [[e.x, e.y], [e.x + e.width, e.y + e.height]];
      }
      return [[0, 0], [e.width.baseVal.value, e.height.baseVal.value]];
    }
    return [[0, 0], [e.clientWidth, e.clientHeight]];
  }
  function defaultTransform() {
    return this.__zoom || identity14;
  }
  function defaultWheelDelta(event) {
    return -event.deltaY * (event.deltaMode === 1 ? 0.05 : event.deltaMode ? 1 : 2e-3) * (event.ctrlKey ? 10 : 1);
  }
  function defaultTouchable2() {
    return navigator.maxTouchPoints || "ontouchstart" in this;
  }
  function defaultConstrain(transform20, extent, translateExtent) {
    var dx0 = transform20.invertX(extent[0][0]) - translateExtent[0][0], dx1 = transform20.invertX(extent[1][0]) - translateExtent[1][0], dy0 = transform20.invertY(extent[0][1]) - translateExtent[0][1], dy1 = transform20.invertY(extent[1][1]) - translateExtent[1][1];
    return transform20.translate(
      dx1 > dx0 ? (dx0 + dx1) / 2 : Math.min(0, dx0) || Math.max(0, dx1),
      dy1 > dy0 ? (dy0 + dy1) / 2 : Math.min(0, dy0) || Math.max(0, dy1)
    );
  }
  function zoom_default2() {
    var filter7 = defaultFilter2, extent = defaultExtent, constrain = defaultConstrain, wheelDelta = defaultWheelDelta, touchable = defaultTouchable2, scaleExtent = [0, Infinity], translateExtent = [[-Infinity, -Infinity], [Infinity, Infinity]], duration2 = 250, interpolate = zoom_default, listeners = dispatch_default("start", "zoom", "end"), touchstarting, touchfirst, touchending, touchDelay = 500, wheelDelay = 150, clickDistance2 = 0, tapDistance = 10;
    function zoom(selection2) {
      selection2.property("__zoom", defaultTransform).on("wheel.zoom", wheeled, { passive: false }).on("mousedown.zoom", mousedowned).on("dblclick.zoom", dblclicked).filter(touchable).on("touchstart.zoom", touchstarted).on("touchmove.zoom", touchmoved).on("touchend.zoom touchcancel.zoom", touchended).style("-webkit-tap-highlight-color", "rgba(0,0,0,0)");
    }
    zoom.transform = function(collection, transform20, point, event) {
      var selection2 = collection.selection ? collection.selection() : collection;
      selection2.property("__zoom", defaultTransform);
      if (collection !== selection2) {
        schedule(collection, transform20, point, event);
      } else {
        selection2.interrupt().each(function() {
          gesture(this, arguments).event(event).start().zoom(null, typeof transform20 === "function" ? transform20.apply(this, arguments) : transform20).end();
        });
      }
    };
    zoom.scaleBy = function(selection2, k, p2, event) {
      zoom.scaleTo(selection2, function() {
        var k0 = this.__zoom.k, k1 = typeof k === "function" ? k.apply(this, arguments) : k;
        return k0 * k1;
      }, p2, event);
    };
    zoom.scaleTo = function(selection2, k, p2, event) {
      zoom.transform(selection2, function() {
        var e = extent.apply(this, arguments), t0 = this.__zoom, p0 = p2 == null ? centroid(e) : typeof p2 === "function" ? p2.apply(this, arguments) : p2, p1 = t0.invert(p0), k1 = typeof k === "function" ? k.apply(this, arguments) : k;
        return constrain(translate(scale(t0, k1), p0, p1), e, translateExtent);
      }, p2, event);
    };
    zoom.translateBy = function(selection2, x47, y48, event) {
      zoom.transform(selection2, function() {
        return constrain(this.__zoom.translate(
          typeof x47 === "function" ? x47.apply(this, arguments) : x47,
          typeof y48 === "function" ? y48.apply(this, arguments) : y48
        ), extent.apply(this, arguments), translateExtent);
      }, null, event);
    };
    zoom.translateTo = function(selection2, x47, y48, p2, event) {
      zoom.transform(selection2, function() {
        var e = extent.apply(this, arguments), t = this.__zoom, p0 = p2 == null ? centroid(e) : typeof p2 === "function" ? p2.apply(this, arguments) : p2;
        return constrain(identity14.translate(p0[0], p0[1]).scale(t.k).translate(
          typeof x47 === "function" ? -x47.apply(this, arguments) : -x47,
          typeof y48 === "function" ? -y48.apply(this, arguments) : -y48
        ), e, translateExtent);
      }, p2, event);
    };
    function scale(transform20, k) {
      k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], k));
      return k === transform20.k ? transform20 : new Transform(k, transform20.x, transform20.y);
    }
    function translate(transform20, p0, p1) {
      var x47 = p0[0] - p1[0] * transform20.k, y48 = p0[1] - p1[1] * transform20.k;
      return x47 === transform20.x && y48 === transform20.y ? transform20 : new Transform(transform20.k, x47, y48);
    }
    function centroid(extent2) {
      return [(+extent2[0][0] + +extent2[1][0]) / 2, (+extent2[0][1] + +extent2[1][1]) / 2];
    }
    function schedule(transition2, transform20, point, event) {
      transition2.on("start.zoom", function() {
        gesture(this, arguments).event(event).start();
      }).on("interrupt.zoom end.zoom", function() {
        gesture(this, arguments).event(event).end();
      }).tween("zoom", function() {
        var that = this, args = arguments, g = gesture(that, args).event(event), e = extent.apply(that, args), p2 = point == null ? centroid(e) : typeof point === "function" ? point.apply(that, args) : point, w = Math.max(e[1][0] - e[0][0], e[1][1] - e[0][1]), a2 = that.__zoom, b10 = typeof transform20 === "function" ? transform20.apply(that, args) : transform20, i2 = interpolate(a2.invert(p2).concat(w / a2.k), b10.invert(p2).concat(w / b10.k));
        return function(t) {
          if (t === 1) t = b10;
          else {
            var l = i2(t), k = w / l[2];
            t = new Transform(k, p2[0] - l[0] * k, p2[1] - l[1] * k);
          }
          g.zoom(null, t);
        };
      });
    }
    function gesture(that, args, clean) {
      return !clean && that.__zooming || new Gesture(that, args);
    }
    function Gesture(that, args) {
      this.that = that;
      this.args = args;
      this.active = 0;
      this.sourceEvent = null;
      this.extent = extent.apply(that, args);
      this.taps = 0;
    }
    Gesture.prototype = {
      event: function(event) {
        if (event) this.sourceEvent = event;
        return this;
      },
      start: function() {
        if (++this.active === 1) {
          this.that.__zooming = this;
          this.emit("start");
        }
        return this;
      },
      zoom: function(key, transform20) {
        if (this.mouse && key !== "mouse") this.mouse[1] = transform20.invert(this.mouse[0]);
        if (this.touch0 && key !== "touch") this.touch0[1] = transform20.invert(this.touch0[0]);
        if (this.touch1 && key !== "touch") this.touch1[1] = transform20.invert(this.touch1[0]);
        this.that.__zoom = transform20;
        this.emit("zoom");
        return this;
      },
      end: function() {
        if (--this.active === 0) {
          delete this.that.__zooming;
          this.emit("end");
        }
        return this;
      },
      emit: function(type2) {
        var d18 = select_default2(this.that).datum();
        listeners.call(
          type2,
          this.that,
          new ZoomEvent(type2, {
            sourceEvent: this.sourceEvent,
            target: zoom,
            type: type2,
            transform: this.that.__zoom,
            dispatch: listeners
          }),
          d18
        );
      }
    };
    function wheeled(event, ...args) {
      if (!filter7.apply(this, arguments)) return;
      var g = gesture(this, args).event(event), t = this.__zoom, k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], t.k * Math.pow(2, wheelDelta.apply(this, arguments)))), p2 = pointer_default(event);
      if (g.wheel) {
        if (g.mouse[0][0] !== p2[0] || g.mouse[0][1] !== p2[1]) {
          g.mouse[1] = t.invert(g.mouse[0] = p2);
        }
        clearTimeout(g.wheel);
      } else if (t.k === k) return;
      else {
        g.mouse = [p2, t.invert(p2)];
        interrupt_default(this);
        g.start();
      }
      noevent_default3(event);
      g.wheel = setTimeout(wheelidled, wheelDelay);
      g.zoom("mouse", constrain(translate(scale(t, k), g.mouse[0], g.mouse[1]), g.extent, translateExtent));
      function wheelidled() {
        g.wheel = null;
        g.end();
      }
    }
    function mousedowned(event, ...args) {
      if (touchending || !filter7.apply(this, arguments)) return;
      var currentTarget2 = event.currentTarget, g = gesture(this, args, true).event(event), v = select_default2(event.view).on("mousemove.zoom", mousemoved, true).on("mouseup.zoom", mouseupped, true), p2 = pointer_default(event, currentTarget2), x0 = event.clientX, y0 = event.clientY;
      nodrag_default(event.view);
      nopropagation3(event);
      g.mouse = [p2, this.__zoom.invert(p2)];
      interrupt_default(this);
      g.start();
      function mousemoved(event2) {
        noevent_default3(event2);
        if (!g.moved) {
          var dx = event2.clientX - x0, dy4 = event2.clientY - y0;
          g.moved = dx * dx + dy4 * dy4 > clickDistance2;
        }
        g.event(event2).zoom("mouse", constrain(translate(g.that.__zoom, g.mouse[0] = pointer_default(event2, currentTarget2), g.mouse[1]), g.extent, translateExtent));
      }
      function mouseupped(event2) {
        v.on("mousemove.zoom mouseup.zoom", null);
        yesdrag(event2.view, g.moved);
        noevent_default3(event2);
        g.event(event2).end();
      }
    }
    function dblclicked(event, ...args) {
      if (!filter7.apply(this, arguments)) return;
      var t0 = this.__zoom, p0 = pointer_default(event.changedTouches ? event.changedTouches[0] : event, this), p1 = t0.invert(p0), k1 = t0.k * (event.shiftKey ? 0.5 : 2), t1 = constrain(translate(scale(t0, k1), p0, p1), extent.apply(this, args), translateExtent);
      noevent_default3(event);
      if (duration2 > 0) select_default2(this).transition().duration(duration2).call(schedule, t1, p0, event);
      else select_default2(this).call(zoom.transform, t1, p0, event);
    }
    function touchstarted(event, ...args) {
      if (!filter7.apply(this, arguments)) return;
      var touches = event.touches, n = touches.length, g = gesture(this, args, event.changedTouches.length === n).event(event), started, i2, t, p2;
      nopropagation3(event);
      for (i2 = 0; i2 < n; ++i2) {
        t = touches[i2], p2 = pointer_default(t, this);
        p2 = [p2, this.__zoom.invert(p2), t.identifier];
        if (!g.touch0) g.touch0 = p2, started = true, g.taps = 1 + !!touchstarting;
        else if (!g.touch1 && g.touch0[2] !== p2[2]) g.touch1 = p2, g.taps = 0;
      }
      if (touchstarting) touchstarting = clearTimeout(touchstarting);
      if (started) {
        if (g.taps < 2) touchfirst = p2[0], touchstarting = setTimeout(function() {
          touchstarting = null;
        }, touchDelay);
        interrupt_default(this);
        g.start();
      }
    }
    function touchmoved(event, ...args) {
      if (!this.__zooming) return;
      var g = gesture(this, args).event(event), touches = event.changedTouches, n = touches.length, i2, t, p2, l;
      noevent_default3(event);
      for (i2 = 0; i2 < n; ++i2) {
        t = touches[i2], p2 = pointer_default(t, this);
        if (g.touch0 && g.touch0[2] === t.identifier) g.touch0[0] = p2;
        else if (g.touch1 && g.touch1[2] === t.identifier) g.touch1[0] = p2;
      }
      t = g.that.__zoom;
      if (g.touch1) {
        var p0 = g.touch0[0], l0 = g.touch0[1], p1 = g.touch1[0], l1 = g.touch1[1], dp = (dp = p1[0] - p0[0]) * dp + (dp = p1[1] - p0[1]) * dp, dl2 = (dl2 = l1[0] - l0[0]) * dl2 + (dl2 = l1[1] - l0[1]) * dl2;
        t = scale(t, Math.sqrt(dp / dl2));
        p2 = [(p0[0] + p1[0]) / 2, (p0[1] + p1[1]) / 2];
        l = [(l0[0] + l1[0]) / 2, (l0[1] + l1[1]) / 2];
      } else if (g.touch0) p2 = g.touch0[0], l = g.touch0[1];
      else return;
      g.zoom("touch", constrain(translate(t, p2, l), g.extent, translateExtent));
    }
    function touchended(event, ...args) {
      if (!this.__zooming) return;
      var g = gesture(this, args).event(event), touches = event.changedTouches, n = touches.length, i2, t;
      nopropagation3(event);
      if (touchending) clearTimeout(touchending);
      touchending = setTimeout(function() {
        touchending = null;
      }, touchDelay);
      for (i2 = 0; i2 < n; ++i2) {
        t = touches[i2];
        if (g.touch0 && g.touch0[2] === t.identifier) delete g.touch0;
        else if (g.touch1 && g.touch1[2] === t.identifier) delete g.touch1;
      }
      if (g.touch1 && !g.touch0) g.touch0 = g.touch1, delete g.touch1;
      if (g.touch0) g.touch0[1] = this.__zoom.invert(g.touch0[0]);
      else {
        g.end();
        if (g.taps === 2) {
          t = pointer_default(t, this);
          if (Math.hypot(touchfirst[0] - t[0], touchfirst[1] - t[1]) < tapDistance) {
            var p2 = select_default2(this).on("dblclick.zoom");
            if (p2) p2.apply(this, arguments);
          }
        }
      }
    }
    zoom.wheelDelta = function(_) {
      return arguments.length ? (wheelDelta = typeof _ === "function" ? _ : constant_default5(+_), zoom) : wheelDelta;
    };
    zoom.filter = function(_) {
      return arguments.length ? (filter7 = typeof _ === "function" ? _ : constant_default5(!!_), zoom) : filter7;
    };
    zoom.touchable = function(_) {
      return arguments.length ? (touchable = typeof _ === "function" ? _ : constant_default5(!!_), zoom) : touchable;
    };
    zoom.extent = function(_) {
      return arguments.length ? (extent = typeof _ === "function" ? _ : constant_default5([[+_[0][0], +_[0][1]], [+_[1][0], +_[1][1]]]), zoom) : extent;
    };
    zoom.scaleExtent = function(_) {
      return arguments.length ? (scaleExtent[0] = +_[0], scaleExtent[1] = +_[1], zoom) : [scaleExtent[0], scaleExtent[1]];
    };
    zoom.translateExtent = function(_) {
      return arguments.length ? (translateExtent[0][0] = +_[0][0], translateExtent[1][0] = +_[1][0], translateExtent[0][1] = +_[0][1], translateExtent[1][1] = +_[1][1], zoom) : [[translateExtent[0][0], translateExtent[0][1]], [translateExtent[1][0], translateExtent[1][1]]];
    };
    zoom.constrain = function(_) {
      return arguments.length ? (constrain = _, zoom) : constrain;
    };
    zoom.duration = function(_) {
      return arguments.length ? (duration2 = +_, zoom) : duration2;
    };
    zoom.interpolate = function(_) {
      return arguments.length ? (interpolate = _, zoom) : interpolate;
    };
    zoom.on = function() {
      var value18 = listeners.on.apply(listeners, arguments);
      return value18 === listeners ? zoom : value18;
    };
    zoom.clickDistance = function(_) {
      return arguments.length ? (clickDistance2 = (_ = +_) * _, zoom) : Math.sqrt(clickDistance2);
    };
    zoom.tapDistance = function(_) {
      return arguments.length ? (tapDistance = +_, zoom) : tapDistance;
    };
    return zoom;
  }

  // node_modules/d3-sankey/node_modules/d3-path/src/path.js
  var pi3 = Math.PI;
  var tau2 = 2 * pi3;
  var epsilon = 1e-6;
  var tauEpsilon = tau2 - epsilon;
  function Path2() {
    this._x0 = this._y0 = // start of current subpath
    this._x1 = this._y1 = null;
    this._ = "";
  }
  function path() {
    return new Path2();
  }
  Path2.prototype = path.prototype = {
    constructor: Path2,
    moveTo: function(x47, y48) {
      this._ += "M" + (this._x0 = this._x1 = +x47) + "," + (this._y0 = this._y1 = +y48);
    },
    closePath: function() {
      if (this._x1 !== null) {
        this._x1 = this._x0, this._y1 = this._y0;
        this._ += "Z";
      }
    },
    lineTo: function(x47, y48) {
      this._ += "L" + (this._x1 = +x47) + "," + (this._y1 = +y48);
    },
    quadraticCurveTo: function(x116, y116, x47, y48) {
      this._ += "Q" + +x116 + "," + +y116 + "," + (this._x1 = +x47) + "," + (this._y1 = +y48);
    },
    bezierCurveTo: function(x116, y116, x217, y217, x47, y48) {
      this._ += "C" + +x116 + "," + +y116 + "," + +x217 + "," + +y217 + "," + (this._x1 = +x47) + "," + (this._y1 = +y48);
    },
    arcTo: function(x116, y116, x217, y217, r) {
      x116 = +x116, y116 = +y116, x217 = +x217, y217 = +y217, r = +r;
      var x0 = this._x1, y0 = this._y1, x218 = x217 - x116, y218 = y217 - y116, x01 = x0 - x116, y01 = y0 - y116, l01_2 = x01 * x01 + y01 * y01;
      if (r < 0) throw new Error("negative radius: " + r);
      if (this._x1 === null) {
        this._ += "M" + (this._x1 = x116) + "," + (this._y1 = y116);
      } else if (!(l01_2 > epsilon)) ;
      else if (!(Math.abs(y01 * x218 - y218 * x01) > epsilon) || !r) {
        this._ += "L" + (this._x1 = x116) + "," + (this._y1 = y116);
      } else {
        var x202 = x217 - x0, y202 = y217 - y0, l21_2 = x218 * x218 + y218 * y218, l20_2 = x202 * x202 + y202 * y202, l21 = Math.sqrt(l21_2), l01 = Math.sqrt(l01_2), l = r * Math.tan((pi3 - Math.acos((l21_2 + l01_2 - l20_2) / (2 * l21 * l01))) / 2), t01 = l / l01, t21 = l / l21;
        if (Math.abs(t01 - 1) > epsilon) {
          this._ += "L" + (x116 + t01 * x01) + "," + (y116 + t01 * y01);
        }
        this._ += "A" + r + "," + r + ",0,0," + +(y01 * x202 > x01 * y202) + "," + (this._x1 = x116 + t21 * x218) + "," + (this._y1 = y116 + t21 * y218);
      }
    },
    arc: function(x47, y48, r, a0, a1, ccw) {
      x47 = +x47, y48 = +y48, r = +r, ccw = !!ccw;
      var dx = r * Math.cos(a0), dy4 = r * Math.sin(a0), x0 = x47 + dx, y0 = y48 + dy4, cw = 1 ^ ccw, da = ccw ? a0 - a1 : a1 - a0;
      if (r < 0) throw new Error("negative radius: " + r);
      if (this._x1 === null) {
        this._ += "M" + x0 + "," + y0;
      } else if (Math.abs(this._x1 - x0) > epsilon || Math.abs(this._y1 - y0) > epsilon) {
        this._ += "L" + x0 + "," + y0;
      }
      if (!r) return;
      if (da < 0) da = da % tau2 + tau2;
      if (da > tauEpsilon) {
        this._ += "A" + r + "," + r + ",0,1," + cw + "," + (x47 - dx) + "," + (y48 - dy4) + "A" + r + "," + r + ",0,1," + cw + "," + (this._x1 = x0) + "," + (this._y1 = y0);
      } else if (da > epsilon) {
        this._ += "A" + r + "," + r + ",0," + +(da >= pi3) + "," + cw + "," + (this._x1 = x47 + r * Math.cos(a1)) + "," + (this._y1 = y48 + r * Math.sin(a1));
      }
    },
    rect: function(x47, y48, w, h) {
      this._ += "M" + (this._x0 = this._x1 = +x47) + "," + (this._y0 = this._y1 = +y48) + "h" + +w + "v" + +h + "h" + -w + "Z";
    },
    toString: function() {
      return this._;
    }
  };
  var path_default = path;

  // node_modules/d3-sankey/node_modules/d3-shape/src/constant.js
  function constant_default6(x47) {
    return function constant2() {
      return x47;
    };
  }

  // node_modules/d3-sankey/node_modules/d3-shape/src/point.js
  function x2(p2) {
    return p2[0];
  }
  function y2(p2) {
    return p2[1];
  }

  // node_modules/d3-sankey/node_modules/d3-shape/src/array.js
  var slice3 = Array.prototype.slice;

  // node_modules/d3-sankey/node_modules/d3-shape/src/link/index.js
  function linkSource(d18) {
    return d18.source;
  }
  function linkTarget(d18) {
    return d18.target;
  }
  function link2(curve) {
    var source2 = linkSource, target7 = linkTarget, x47 = x2, y48 = y2, context = null;
    function link4() {
      var buffer, argv = slice3.call(arguments), s = source2.apply(this, argv), t = target7.apply(this, argv);
      if (!context) context = buffer = path_default();
      curve(context, +x47.apply(this, (argv[0] = s, argv)), +y48.apply(this, argv), +x47.apply(this, (argv[0] = t, argv)), +y48.apply(this, argv));
      if (buffer) return context = null, buffer + "" || null;
    }
    link4.source = function(_) {
      return arguments.length ? (source2 = _, link4) : source2;
    };
    link4.target = function(_) {
      return arguments.length ? (target7 = _, link4) : target7;
    };
    link4.x = function(_) {
      return arguments.length ? (x47 = typeof _ === "function" ? _ : constant_default6(+_), link4) : x47;
    };
    link4.y = function(_) {
      return arguments.length ? (y48 = typeof _ === "function" ? _ : constant_default6(+_), link4) : y48;
    };
    link4.context = function(_) {
      return arguments.length ? (context = _ == null ? null : _, link4) : context;
    };
    return link4;
  }
  function curveHorizontal(context, x0, y0, x116, y116) {
    context.moveTo(x0, y0);
    context.bezierCurveTo(x0 = (x0 + x116) / 2, y0, x0, y116, x116, y116);
  }
  function linkHorizontal() {
    return link2(curveHorizontal);
  }

  // node_modules/d3-sankey/src/sankeyLinkHorizontal.js
  function horizontalSource(d18) {
    return [d18.source.x1, d18.y0];
  }
  function horizontalTarget(d18) {
    return [d18.target.x0, d18.y1];
  }
  function sankeyLinkHorizontal_default() {
    return linkHorizontal().source(horizontalSource).target(horizontalTarget);
  }

  // output/PSD3.Internal.Sankey.Functions/foreign.js
  var sankeyLinkPath_ = sankeyLinkHorizontal_default();

  // output/Debug/foreign.js
  var req = typeof module === "undefined" ? void 0 : module.require;
  var util = (function() {
    try {
      return req === void 0 ? void 0 : req("util");
    } catch (e) {
      return void 0;
    }
  })();
  function _trace(x47, k) {
    if (util !== void 0) {
      console.log(util.inspect(x47, { depth: null, colors: true }));
    } else {
      console.log(x47);
    }
    return k({});
  }
  function _spy(tag, x47) {
    if (util !== void 0) {
      console.log(tag + ":", util.inspect(x47, { depth: null, colors: true }));
    } else {
      console.log(tag + ":", x47);
    }
    return x47;
  }
  var now2 = (function() {
    var perf;
    if (typeof performance !== "undefined") {
      perf = performance;
    } else if (req) {
      try {
        perf = req("perf_hooks").performance;
      } catch (e) {
      }
    }
    return (function() {
      return (perf || Date).now();
    });
  })();

  // output/Debug/index.js
  var trace = function() {
    return function(a2) {
      return function(k) {
        return _trace(a2, k);
      };
    };
  };
  var spy = function() {
    return function(tag) {
      return function(a2) {
        return _spy(tag, a2);
      };
    };
  };

  // output/PSD3.Internal.Selection.Functions/index.js
  var spy2 = /* @__PURE__ */ spy();
  var show7 = /* @__PURE__ */ show(showElement);
  var foldl7 = /* @__PURE__ */ foldl(foldableArray);
  var discard3 = /* @__PURE__ */ discard(discardUnit);
  var selectionUpdateJoin = function(dictSelectionM) {
    var pure91 = pure(dictSelectionM.Monad0().Applicative0());
    return function(openSelection2) {
      return function(e) {
        return function(theData) {
          return function(keyFn) {
            var updateSelection = d3DataWithKeyFunction_(theData)(keyFn)(openSelection2);
            var exitSelection = d3GetExitSelection_(updateSelection);
            var enterSelection = d3GetEnterSelection_(updateSelection);
            return pure91({
              enter: enterSelection,
              exit: exitSelection,
              update: updateSelection
            });
          };
        };
      };
    };
  };
  var selectionSelectUnder = function(dictSelectionM) {
    var pure91 = pure(dictSelectionM.Monad0().Applicative0());
    return function(selection2) {
      return function(selector) {
        return pure91(d3SelectionSelectAll_(selector)(selection2));
      };
    };
  };
  var selectionOpenSelection = function(dictSelectionM) {
    var pure91 = pure(dictSelectionM.Monad0().Applicative0());
    return function(selection2) {
      return function(selector) {
        return pure91(d3SelectionSelectAll_(selector)(selection2));
      };
    };
  };
  var selectionOn = function(dictSelectionM) {
    var pure91 = pure(dictSelectionM.Monad0().Applicative0());
    return function(v) {
      return function(v1) {
        if (v1 instanceof Drag) {
          return pure91(unit);
        }
        ;
        if (v1 instanceof Zoom) {
          var v2 = (function() {
            if (v1.value0.extent instanceof DefaultZoomExtent) {
              return d3AttachZoomDefaultExtent_(v)({
                scaleExtent: [v1.value0.scale.value0, v1.value0.scale.value1],
                name: v1.value0.name,
                target: v1.value0.target
              });
            }
            ;
            if (v1.value0.extent instanceof ZoomExtent) {
              return d3AttachZoom_(v)({
                extent: [[v1.value0.extent.value0.left, v1.value0.extent.value0.top], [v1.value0.extent.value0.right, v1.value0.extent.value0.bottom]],
                scaleExtent: [v1.value0.scale.value0, v1.value0.scale.value1],
                name: v1.value0.name,
                target: v1.value0.target
              });
            }
            ;
            throw new Error("Failed pattern match at PSD3.Internal.Selection.Functions (line 98, column 9 - line 112, column 14): " + [v1.value0.extent.constructor.name]);
          })();
          return pure91(unit);
        }
        ;
        throw new Error("Failed pattern match at PSD3.Internal.Selection.Functions (line 80, column 1 - line 80, column 112): " + [v.constructor.name, v1.constructor.name]);
      };
    };
  };
  var selectionNestedJoin = function(dictFoldable) {
    var fromFoldable57 = fromFoldable(dictFoldable);
    return function(dictSelectionM) {
      var pure91 = pure(dictSelectionM.Monad0().Applicative0());
      return function(selection2) {
        return function(e) {
          return function(extractChildren) {
            return function(keyFn) {
              var extractFn = function($67) {
                return fromFoldable57(extractChildren($67));
              };
              var element3 = spy2("NestedJoin: ")(show7(e));
              var selectS = d3SelectionSelectAll_(element3)(selection2);
              var dataSelection = d3DataWithFunction_(extractFn)(keyFn)(selectS);
              var enterSelection = d3EnterAndAppend_(element3)(dataSelection);
              return pure91(enterSelection);
            };
          };
        };
      };
    };
  };
  var selectionModifySelection = function(dictSelectionM) {
    var pure91 = pure(dictSelectionM.Monad0().Applicative0());
    return function(selection_) {
      return function(attributes) {
        var v = foldl7(applySelectionAttributeD3)(selection_)(attributes);
        return pure91(unit);
      };
    };
  };
  var selectionMergeSelections = function(dictSelectionM) {
    var pure91 = pure(dictSelectionM.Monad0().Applicative0());
    return function(selectionA) {
      return function(selectionB) {
        return pure91(d3MergeSelectionWith_(selectionA)(selectionB));
      };
    };
  };
  var selectionJoin = function(dictSelectionM) {
    var pure91 = pure(dictSelectionM.Monad0().Applicative0());
    return function(selection2) {
      return function(e) {
        return function(theData) {
          return function(keyFn) {
            var element3 = spy2("Join: ")(show7(e));
            var selectS = d3SelectionSelectAll_(element3)(selection2);
            var dataSelection = d3DataWithKeyFunction_(theData)(keyFn)(selectS);
            var enterSelection = d3EnterAndAppend_(element3)(dataSelection);
            return pure91(enterSelection);
          };
        };
      };
    };
  };
  var selectionFilterSelection = function(dictSelectionM) {
    var pure91 = pure(dictSelectionM.Monad0().Applicative0());
    return function(selection_) {
      return function(selector) {
        return pure91(d3FilterSelection_(selection_)(selector));
      };
    };
  };
  var selectionAttach = function(dictSelectionM) {
    var pure91 = pure(dictSelectionM.Monad0().Applicative0());
    return function(selector) {
      return pure91(d3SelectAllInDOM_(selector));
    };
  };
  var selectionAppendElement = function(dictSelectionM) {
    var Monad0 = dictSelectionM.Monad0();
    var discard120 = discard3(Monad0.Bind1());
    var selectionModifySelection1 = selectionModifySelection(dictSelectionM);
    var pure91 = pure(Monad0.Applicative0());
    return function(selection_) {
      return function(element3) {
        return function(attributes) {
          var appended_ = d3Append_(show7(element3))(selection_);
          return discard120(selectionModifySelection1(appended_)(attributes))(function() {
            return pure91(appended_);
          });
        };
      };
    };
  };

  // output/Data.Set/index.js
  var coerce5 = /* @__PURE__ */ coerce();
  var foldMap3 = /* @__PURE__ */ foldMap(foldableList);
  var foldl9 = /* @__PURE__ */ foldl(foldableList);
  var foldr6 = /* @__PURE__ */ foldr(foldableList);
  var $$Set = function(x47) {
    return x47;
  };
  var union3 = function(dictOrd) {
    return coerce5(union2(dictOrd));
  };
  var toList2 = function(v) {
    return keys2(v);
  };
  var toUnfoldable4 = function(dictUnfoldable) {
    var $96 = toUnfoldable2(dictUnfoldable);
    return function($97) {
      return $96(toList2($97));
    };
  };
  var toUnfoldable1 = /* @__PURE__ */ toUnfoldable4(unfoldableArray);
  var size4 = /* @__PURE__ */ coerce5(size2);
  var singleton10 = function(a2) {
    return singleton8(a2)(unit);
  };
  var showSet = function(dictShow) {
    var show83 = show(showArray(dictShow));
    return {
      show: function(s) {
        return "(fromFoldable " + (show83(toUnfoldable1(s)) + ")");
      }
    };
  };
  var semigroupSet = function(dictOrd) {
    return {
      append: union3(dictOrd)
    };
  };
  var member2 = function(dictOrd) {
    return coerce5(member(dictOrd));
  };
  var isEmpty2 = /* @__PURE__ */ coerce5(isEmpty);
  var intersection2 = function(dictOrd) {
    return coerce5(intersection(dictOrd));
  };
  var insert4 = function(dictOrd) {
    var insert16 = insert(dictOrd);
    return function(a2) {
      return function(v) {
        return insert16(a2)(unit)(v);
      };
    };
  };
  var fromMap = $$Set;
  var foldableSet = {
    foldMap: function(dictMonoid) {
      var foldMap12 = foldMap3(dictMonoid);
      return function(f) {
        var $98 = foldMap12(f);
        return function($99) {
          return $98(toList2($99));
        };
      };
    },
    foldl: function(f) {
      return function(x47) {
        var $100 = foldl9(f)(x47);
        return function($101) {
          return $100(toList2($101));
        };
      };
    },
    foldr: function(f) {
      return function(x47) {
        var $102 = foldr6(f)(x47);
        return function($103) {
          return $102(toList2($103));
        };
      };
    }
  };
  var filter4 = function(dictOrd) {
    return coerce5(filterKeys(dictOrd));
  };
  var empty8 = empty3;
  var fromFoldable8 = function(dictFoldable) {
    var foldl22 = foldl(dictFoldable);
    return function(dictOrd) {
      var insert16 = insert4(dictOrd);
      return foldl22(function(m) {
        return function(a2) {
          return insert16(a2)(m);
        };
      })(empty8);
    };
  };
  var unions = function(dictFoldable) {
    var foldl22 = foldl(dictFoldable);
    return function(dictOrd) {
      return foldl22(union3(dictOrd))(empty8);
    };
  };
  var difference3 = function(dictOrd) {
    return coerce5(difference2(dictOrd));
  };
  var $$delete4 = function(dictOrd) {
    return coerce5($$delete3(dictOrd));
  };

  // output/Data.Map/index.js
  var keys3 = /* @__PURE__ */ (function() {
    var $38 = $$void(functorMap);
    return function($39) {
      return fromMap($38($39));
    };
  })();

  // output/Data.Array.NonEmpty.Internal/index.js
  var functorNonEmptyArray = functorArray;

  // output/Data.Array.NonEmpty/index.js
  var fromJust5 = /* @__PURE__ */ fromJust();
  var toArray2 = function(v) {
    return v;
  };
  var adaptMaybe = function(f) {
    return function($126) {
      return fromJust5(f(toArray2($126)));
    };
  };
  var head4 = /* @__PURE__ */ adaptMaybe(head);

  // output/PSD3.Internal.Simulation.Types/index.js
  var trace2 = /* @__PURE__ */ trace();
  var _Newtype2 = /* @__PURE__ */ _Newtype()();
  var prop5 = /* @__PURE__ */ prop3({
    reflectSymbol: function() {
      return "velocityDecay";
    }
  })()();
  var prop32 = /* @__PURE__ */ prop3({
    reflectSymbol: function() {
      return "status";
    }
  })()();
  var prop42 = /* @__PURE__ */ prop3({
    reflectSymbol: function() {
      return "name";
    }
  })()();
  var prop11 = /* @__PURE__ */ prop3({
    reflectSymbol: function() {
      return "simulation";
    }
  })()();
  var prop12 = /* @__PURE__ */ prop3({
    reflectSymbol: function() {
      return "forceLibrary";
    }
  })()();
  var prop13 = /* @__PURE__ */ prop3({
    reflectSymbol: function() {
      return "handle_";
    }
  })()();
  var prop15 = /* @__PURE__ */ prop3({
    reflectSymbol: function() {
      return "alphaTarget";
    }
  })()();
  var prop16 = /* @__PURE__ */ prop3({
    reflectSymbol: function() {
      return "alphaMin";
    }
  })()();
  var prop17 = /* @__PURE__ */ prop3({
    reflectSymbol: function() {
      return "alphaDecay";
    }
  })()();
  var prop18 = /* @__PURE__ */ prop3({
    reflectSymbol: function() {
      return "alpha";
    }
  })()();
  var Alpha = /* @__PURE__ */ (function() {
    function Alpha2(value0) {
      this.value0 = value0;
    }
    ;
    Alpha2.create = function(value0) {
      return new Alpha2(value0);
    };
    return Alpha2;
  })();
  var AlphaTarget = /* @__PURE__ */ (function() {
    function AlphaTarget2(value0) {
      this.value0 = value0;
    }
    ;
    AlphaTarget2.create = function(value0) {
      return new AlphaTarget2(value0);
    };
    return AlphaTarget2;
  })();
  var AlphaMin = /* @__PURE__ */ (function() {
    function AlphaMin2(value0) {
      this.value0 = value0;
    }
    ;
    AlphaMin2.create = function(value0) {
      return new AlphaMin2(value0);
    };
    return AlphaMin2;
  })();
  var AlphaDecay = /* @__PURE__ */ (function() {
    function AlphaDecay2(value0) {
      this.value0 = value0;
    }
    ;
    AlphaDecay2.create = function(value0) {
      return new AlphaDecay2(value0);
    };
    return AlphaDecay2;
  })();
  var VelocityDecay = /* @__PURE__ */ (function() {
    function VelocityDecay2(value0) {
      this.value0 = value0;
    }
    ;
    VelocityDecay2.create = function(value0) {
      return new VelocityDecay2(value0);
    };
    return VelocityDecay2;
  })();
  var ForceManyBody = /* @__PURE__ */ (function() {
    function ForceManyBody2() {
    }
    ;
    ForceManyBody2.value = new ForceManyBody2();
    return ForceManyBody2;
  })();
  var ForceCenter = /* @__PURE__ */ (function() {
    function ForceCenter2() {
    }
    ;
    ForceCenter2.value = new ForceCenter2();
    return ForceCenter2;
  })();
  var ForceCollide = /* @__PURE__ */ (function() {
    function ForceCollide2() {
    }
    ;
    ForceCollide2.value = new ForceCollide2();
    return ForceCollide2;
  })();
  var ForceX = /* @__PURE__ */ (function() {
    function ForceX2() {
    }
    ;
    ForceX2.value = new ForceX2();
    return ForceX2;
  })();
  var ForceY = /* @__PURE__ */ (function() {
    function ForceY2() {
    }
    ;
    ForceY2.value = new ForceY2();
    return ForceY2;
  })();
  var ForceRadial = /* @__PURE__ */ (function() {
    function ForceRadial2() {
    }
    ;
    ForceRadial2.value = new ForceRadial2();
    return ForceRadial2;
  })();
  var RegularForce = /* @__PURE__ */ (function() {
    function RegularForce2(value0) {
      this.value0 = value0;
    }
    ;
    RegularForce2.create = function(value0) {
      return new RegularForce2(value0);
    };
    return RegularForce2;
  })();
  var LinkForce = /* @__PURE__ */ (function() {
    function LinkForce2() {
    }
    ;
    LinkForce2.value = new LinkForce2();
    return LinkForce2;
  })();
  var ForceActive = /* @__PURE__ */ (function() {
    function ForceActive2() {
    }
    ;
    ForceActive2.value = new ForceActive2();
    return ForceActive2;
  })();
  var ForceDisabled = /* @__PURE__ */ (function() {
    function ForceDisabled2() {
    }
    ;
    ForceDisabled2.value = new ForceDisabled2();
    return ForceDisabled2;
  })();
  var ForceFilter = /* @__PURE__ */ (function() {
    function ForceFilter2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    ForceFilter2.create = function(value0) {
      return function(value1) {
        return new ForceFilter2(value0, value1);
      };
    };
    return ForceFilter2;
  })();
  var showRegularForceType = {
    show: function(v) {
      if (v instanceof ForceManyBody) {
        return "ForceManyBody";
      }
      ;
      if (v instanceof ForceCenter) {
        return "ForceCenter";
      }
      ;
      if (v instanceof ForceCollide) {
        return "ForceCollide";
      }
      ;
      if (v instanceof ForceX) {
        return "ForceX";
      }
      ;
      if (v instanceof ForceY) {
        return "ForceY";
      }
      ;
      if (v instanceof ForceRadial) {
        return "ForceRadial";
      }
      ;
      throw new Error("Failed pattern match at PSD3.Internal.Simulation.Types (line 222, column 1 - line 228, column 46): " + [v.constructor.name]);
    }
  };
  var showForceFilter = function(v) {
    if (v instanceof Just) {
      return v.value0.value0;
    }
    ;
    if (v instanceof Nothing) {
      return " (no filter)";
    }
    ;
    throw new Error("Failed pattern match at PSD3.Internal.Simulation.Types (line 204, column 1 - line 204, column 61): " + [v.constructor.name]);
  };
  var defaultConfigSimulation = {
    alpha: 1,
    alphaTarget: 0,
    alphaMin: 1e-3,
    alphaDecay: 0.0228,
    velocityDecay: 0.4
  };
  var initialSimulationState = function(forces9) {
    var v = trace2({
      simulation: "initialized",
      forceLibrary: forces9
    })(function(v1) {
      return unit;
    });
    return {
      handle_: initSimulation_(defaultConfigSimulation)(keyIsID_),
      data: {
        nodes: [],
        links: []
      },
      key: keyIsID_,
      forceLibrary: forces9,
      ticks: empty3,
      alpha: defaultConfigSimulation.alpha,
      alphaTarget: defaultConfigSimulation.alphaTarget,
      alphaMin: defaultConfigSimulation.alphaMin,
      alphaDecay: defaultConfigSimulation.alphaDecay,
      velocityDecay: defaultConfigSimulation.velocityDecay
    };
  };
  var allNodes = /* @__PURE__ */ (function() {
    return Nothing.value;
  })();
  var _velocityDecay = function(dictStrong) {
    var $225 = _Newtype2(dictStrong.Profunctor0());
    var $226 = prop5($$Proxy.value)(dictStrong);
    return function($227) {
      return $225($226($227));
    };
  };
  var _status = function(dictStrong) {
    var $238 = _Newtype2(dictStrong.Profunctor0());
    var $239 = prop32($$Proxy.value)(dictStrong);
    return function($240) {
      return $238($239($240));
    };
  };
  var _name = function(dictStrong) {
    var $241 = _Newtype2(dictStrong.Profunctor0());
    var $242 = prop42($$Proxy.value)(dictStrong);
    return function($243) {
      return $241($242($243));
    };
  };
  var _d3Simulation = function(dictStrong) {
    return prop11($$Proxy.value)(dictStrong);
  };
  var _forceLibrary = function(dictStrong) {
    var $265 = _d3Simulation(dictStrong);
    var $266 = _Newtype2(dictStrong.Profunctor0());
    var $267 = prop12($$Proxy.value)(dictStrong);
    return function($268) {
      return $265($266($267($268)));
    };
  };
  var _handle = function(dictStrong) {
    var $272 = _d3Simulation(dictStrong);
    var $273 = _Newtype2(dictStrong.Profunctor0());
    var $274 = prop13($$Proxy.value)(dictStrong);
    return function($275) {
      return $272($273($274($275)));
    };
  };
  var _alphaTarget = function(dictStrong) {
    var $279 = _Newtype2(dictStrong.Profunctor0());
    var $280 = prop15($$Proxy.value)(dictStrong);
    return function($281) {
      return $279($280($281));
    };
  };
  var _alphaMin = function(dictStrong) {
    var $282 = _Newtype2(dictStrong.Profunctor0());
    var $283 = prop16($$Proxy.value)(dictStrong);
    return function($284) {
      return $282($283($284));
    };
  };
  var _alphaDecay = function(dictStrong) {
    var $285 = _Newtype2(dictStrong.Profunctor0());
    var $286 = prop17($$Proxy.value)(dictStrong);
    return function($287) {
      return $285($286($287));
    };
  };
  var _alpha = function(dictStrong) {
    var $288 = _Newtype2(dictStrong.Profunctor0());
    var $289 = prop18($$Proxy.value)(dictStrong);
    return function($290) {
      return $288($289($290));
    };
  };

  // output/PSD3.Internal.Simulation.Forces/index.js
  var _status2 = /* @__PURE__ */ _status(strongFn);
  var show8 = /* @__PURE__ */ show(showRegularForceType);
  var _name2 = /* @__PURE__ */ _name(strongForget);
  var fromFoldable9 = /* @__PURE__ */ fromFoldable6(ordString);
  var elem3 = /* @__PURE__ */ elem2(eqString);
  var unwrap6 = /* @__PURE__ */ unwrap();
  var map112 = /* @__PURE__ */ map(functorArray);
  var showType = function(v) {
    if (v instanceof LinkForce) {
      return "linkForce";
    }
    ;
    if (v instanceof RegularForce) {
      return show8(v.value0);
    }
    ;
    throw new Error("Failed pattern match at PSD3.Internal.Simulation.Forces (line 33, column 3 - line 35, column 29): " + [v.constructor.name]);
  };
  var removeForceFromSimulation = function(v) {
    return function(simulation_) {
      if (v.type instanceof RegularForce) {
        return setAsNullForceInSimulation_(simulation_)(v.name);
      }
      ;
      if (v.type instanceof LinkForce) {
        return setAsNullForceInSimulation_(simulation_)(v.name);
      }
      ;
      throw new Error("Failed pattern match at PSD3.Internal.Simulation.Forces (line 112, column 3 - line 115, column 73): " + [v.type.constructor.name]);
    };
  };
  var putForceInSimulation = function(v) {
    return function(simulation_) {
      if (v.type instanceof RegularForce) {
        return putForceInSimulation_(simulation_)(v.name)(v.force_);
      }
      ;
      if (v.type instanceof LinkForce) {
        return putForceInSimulation_(simulation_)(v.name)(v.force_);
      }
      ;
      throw new Error("Failed pattern match at PSD3.Internal.Simulation.Forces (line 103, column 3 - line 107, column 80): " + [v.type.constructor.name]);
    };
  };
  var initialize = function(dictFoldable) {
    var fromFoldable120 = fromFoldable9(dictFoldable);
    return function(dictFunctor) {
      var map212 = map(dictFunctor);
      return function(forces9) {
        return fromFoldable120(map212(function(f) {
          return new Tuple(view(_name2)(f), f);
        })(forces9));
      };
    };
  };
  var enableForce = /* @__PURE__ */ (function() {
    return set2(_status2)(ForceActive.value);
  })();
  var enableByLabels = function(simulation) {
    return function(labels9) {
      return function(force2) {
        var $43 = elem3(view(_name2)(force2))(labels9);
        if ($43) {
          var v = putForceInSimulation(force2)(simulation);
          return enableForce(force2);
        }
        ;
        return force2;
      };
    };
  };
  var disableForce = /* @__PURE__ */ (function() {
    return set2(_status2)(ForceDisabled.value);
  })();
  var disableByLabels = function(simulation) {
    return function(labels9) {
      return function(force2) {
        var $45 = elem3(view(_name2)(force2))(labels9);
        if ($45) {
          var v = removeForceFromSimulation(force2)(simulation);
          return disableForce(force2);
        }
        ;
        return force2;
      };
    };
  };
  var createRegularForce_ = function(v) {
    if (v instanceof ForceManyBody) {
      return forceMany_(unit);
    }
    ;
    if (v instanceof ForceCenter) {
      return forceCenter_(unit);
    }
    ;
    if (v instanceof ForceCollide) {
      return forceCollideFn_(unit);
    }
    ;
    if (v instanceof ForceX) {
      return forceX_(unit);
    }
    ;
    if (v instanceof ForceY) {
      return forceY_(unit);
    }
    ;
    if (v instanceof ForceRadial) {
      return forceRadial_(unit);
    }
    ;
    throw new Error("Failed pattern match at PSD3.Internal.Simulation.Forces (line 167, column 23 - line 173, column 52): " + [v.constructor.name]);
  };
  var createForce_ = function(v) {
    if (v instanceof RegularForce) {
      return createRegularForce_(v.value0);
    }
    ;
    if (v instanceof LinkForce) {
      return forceLink_(unit);
    }
    ;
    throw new Error("Failed pattern match at PSD3.Internal.Simulation.Forces (line 161, column 3 - line 163, column 38): " + [v.constructor.name]);
  };
  var createLinkForce = function(f) {
    return function(cs) {
      return {
        type: LinkForce.value,
        name: linksForceName_,
        status: ForceDisabled.value,
        filter: f,
        attributes: cs,
        force_: createForce_(LinkForce.value)
      };
    };
  };
  var createForce = function(l) {
    return function(t) {
      return function(f) {
        return function(cs) {
          return {
            type: t,
            name: l,
            status: ForceDisabled.value,
            filter: f,
            attributes: cs,
            force_: createForce_(t)
          };
        };
      };
    };
  };
  var attrFilter = function(filter$prime) {
    return function(default$prime) {
      var addFilterToStatic = function(filter7) {
        return function(value18) {
          return function($$default) {
            return function(d18) {
              var $49 = filter7(d18);
              if ($49) {
                return value18;
              }
              ;
              return $$default;
            };
          };
        };
      };
      var addFilterToFn = function(filter7) {
        return function(fn) {
          return function($$default) {
            return function(d18) {
              var $50 = filter7(d18);
              if ($50) {
                return fn(d18);
              }
              ;
              return $$default;
            };
          };
        };
      };
      return function(v) {
        if (v instanceof StringAttr && v.value0 instanceof Static) {
          return new StringAttr(new Static(v.value0.value0));
        }
        ;
        if (v instanceof StringAttr && v.value0 instanceof Fn) {
          return new StringAttr(new Fn(v.value0.value0));
        }
        ;
        if (v instanceof StringAttr && v.value0 instanceof FnI) {
          return new StringAttr(new FnI(v.value0.value0));
        }
        ;
        if (v instanceof NumberAttr && v.value0 instanceof Static) {
          return new NumberAttr(new Fn(addFilterToStatic(filter$prime)(v.value0.value0)(default$prime)));
        }
        ;
        if (v instanceof NumberAttr && v.value0 instanceof Fn) {
          return new NumberAttr(new Fn(addFilterToFn(filter$prime)(v.value0.value0)(default$prime)));
        }
        ;
        if (v instanceof NumberAttr && v.value0 instanceof FnI) {
          return new NumberAttr(new FnI(v.value0.value0));
        }
        ;
        if (v instanceof ArrayAttr && v.value0 instanceof Static) {
          return new ArrayAttr(new Static(v.value0.value0));
        }
        ;
        if (v instanceof ArrayAttr && v.value0 instanceof Fn) {
          return new ArrayAttr(new Fn(v.value0.value0));
        }
        ;
        if (v instanceof ArrayAttr && v.value0 instanceof FnI) {
          return new ArrayAttr(new FnI(v.value0.value0));
        }
        ;
        throw new Error("Failed pattern match at PSD3.Internal.Simulation.Forces (line 212, column 3 - line 224, column 49): " + [v.constructor.name]);
      };
    };
  };
  var setForceAttr = function(force_) {
    return function(maybeFilter) {
      return function(v) {
        if (v.value0 === "strength") {
          if (maybeFilter instanceof Nothing) {
            return setForceStrength_(force_)(unboxAttr(v.value1));
          }
          ;
          if (maybeFilter instanceof Just) {
            return setForceStrength_(force_)(unboxAttr(attrFilter(maybeFilter.value0.value1)(0)(v.value1)));
          }
          ;
          throw new Error("Failed pattern match at PSD3.Internal.Simulation.Forces (line 182, column 7 - line 186, column 82): " + [maybeFilter.constructor.name]);
        }
        ;
        if (v.value0 === "radius") {
          return setForceRadius_(force_)(unboxAttr(v.value1));
        }
        ;
        if (v.value0 === "theta") {
          return setForceTheta_(force_)(unboxAttr(v.value1));
        }
        ;
        if (v.value0 === "distanceMin") {
          return setForceDistanceMin_(force_)(unboxAttr(v.value1));
        }
        ;
        if (v.value0 === "distanceMax") {
          return setForceDistanceMax_(force_)(unboxAttr(v.value1));
        }
        ;
        if (v.value0 === "iterations") {
          return setForceIterations_(force_)(unboxAttr(v.value1));
        }
        ;
        if (v.value0 === "x") {
          return setForceX_(force_)(unboxAttr(v.value1));
        }
        ;
        if (v.value0 === "y") {
          return setForceY_(force_)(unboxAttr(v.value1));
        }
        ;
        if (v.value0 === "distance") {
          return setForceDistance_(force_)(unboxAttr(v.value1));
        }
        ;
        return force_;
      };
    };
  };
  var updateForceInSimulation = function(simulation) {
    return function(force2) {
      var f = unwrap6(force2);
      var v = map112(function(a2) {
        return setForceAttr(f.force_)(f.filter)(unwrap6(a2));
      })(f.attributes);
      if (f.status instanceof ForceActive) {
        return putForceInSimulation(force2)(simulation);
      }
      ;
      if (f.status instanceof ForceDisabled) {
        return removeForceFromSimulation(force2)(simulation);
      }
      ;
      throw new Error("Failed pattern match at PSD3.Internal.Simulation.Forces (line 96, column 5 - line 98, column 66): " + [f.status.constructor.name]);
    };
  };

  // output/PSD3.Internal.Simulation.Functions/index.js
  var _handle2 = /* @__PURE__ */ _handle(strongForget);
  var discard4 = /* @__PURE__ */ discard(discardUnit);
  var _forceLibrary2 = /* @__PURE__ */ _forceLibrary(strongFn);
  var _forceLibrary1 = /* @__PURE__ */ _forceLibrary(strongForget);
  var map27 = /* @__PURE__ */ map(functorMap);
  var _d3Simulation2 = /* @__PURE__ */ _d3Simulation(strongFn);
  var _alpha2 = /* @__PURE__ */ _alpha(strongFn);
  var _alphaTarget2 = /* @__PURE__ */ _alphaTarget(strongFn);
  var _alphaMin2 = /* @__PURE__ */ _alphaMin(strongFn);
  var _alphaDecay2 = /* @__PURE__ */ _alphaDecay(strongFn);
  var _velocityDecay2 = /* @__PURE__ */ _velocityDecay(strongFn);
  var fromFoldable10 = /* @__PURE__ */ fromFoldable(foldableSet);
  var difference4 = /* @__PURE__ */ difference3(ordString);
  var fromFoldable14 = /* @__PURE__ */ fromFoldable8(foldableSet)(ordString);
  var intersection3 = /* @__PURE__ */ intersection2(ordString);
  var spy3 = /* @__PURE__ */ spy();
  var simulationStop = function(dictMonadState) {
    var Monad0 = dictMonadState.Monad0();
    var pure91 = pure(Monad0.Applicative0());
    return bind(Monad0.Bind1())(use(dictMonadState)(_handle2))(function(handle) {
      var v = stopSimulation_(handle);
      return pure91(unit);
    });
  };
  var simulationStart = function(dictMonadState) {
    var Monad0 = dictMonadState.Monad0();
    var Bind1 = Monad0.Bind1();
    var discard120 = discard4(Bind1);
    var modifying2 = modifying(dictMonadState);
    var pure91 = pure(Monad0.Applicative0());
    return bind(Bind1)(use(dictMonadState)(_handle2))(function(handle) {
      return discard120(modifying2(function($247) {
        return _d3Simulation2(_alpha2($247));
      })($$const(1)))(function() {
        return pure91(startSimulation_(handle));
      });
    });
  };
  var simulationSetVariable = function(dictMonadState) {
    var bind87 = bind(dictMonadState.Monad0().Bind1());
    var use3 = use(dictMonadState);
    var modifying2 = modifying(dictMonadState);
    return function(v) {
      return bind87(use3(_handle2))(function(handle) {
        if (v instanceof Alpha) {
          var v1 = setAlpha_(handle)(v.value0);
          return modifying2(function($248) {
            return _d3Simulation2(_alpha2($248));
          })($$const(v.value0));
        }
        ;
        if (v instanceof AlphaTarget) {
          var v1 = setAlphaTarget_(handle)(v.value0);
          return modifying2(function($249) {
            return _d3Simulation2(_alphaTarget2($249));
          })($$const(v.value0));
        }
        ;
        if (v instanceof AlphaMin) {
          var v1 = setAlphaMin_(handle)(v.value0);
          return modifying2(function($250) {
            return _d3Simulation2(_alphaMin2($250));
          })($$const(v.value0));
        }
        ;
        if (v instanceof AlphaDecay) {
          var v1 = setAlphaDecay_(handle)(v.value0);
          return modifying2(function($251) {
            return _d3Simulation2(_alphaDecay2($251));
          })($$const(v.value0));
        }
        ;
        if (v instanceof VelocityDecay) {
          var v1 = setVelocityDecay_(handle)(v.value0);
          return modifying2(function($252) {
            return _d3Simulation2(_velocityDecay2($252));
          })($$const(v.value0));
        }
        ;
        throw new Error("Failed pattern match at PSD3.Internal.Simulation.Functions (line 129, column 3 - line 144, column 52): " + [v.constructor.name]);
      });
    };
  };
  var simulationSetNodes = function(dictBind) {
    var bind87 = bind(dictBind);
    return function(dictMonadState) {
      var use3 = use(dictMonadState);
      var pure91 = pure(dictMonadState.Monad0().Applicative0());
      return function(nodes) {
        return bind87(use3(_handle2))(function(handle) {
          var v = setNodes_(handle)(nodes);
          var opaqueNodes = getNodes_(handle);
          return pure91(opaqueNodes);
        });
      };
    };
  };
  var simulationSetLinks = function(dictBind) {
    var bind87 = bind(dictBind);
    return function(dictMonadState) {
      var use3 = use(dictMonadState);
      var pure91 = pure(dictMonadState.Monad0().Applicative0());
      return function(links) {
        return function(nodes) {
          return function(keyFn) {
            return bind87(use3(_handle2))(function(handle) {
              var swizzledLinks = swizzleLinks_(links)(nodes)(keyFn);
              var v = setLinks_(handle)(swizzledLinks);
              return pure91(swizzledLinks);
            });
          };
        };
      };
    };
  };
  var simulationEnableForcesByLabel = function(dictMonadState) {
    var bind87 = bind(dictMonadState.Monad0().Bind1());
    var use3 = use(dictMonadState);
    var modifying2 = modifying(dictMonadState);
    return function(labels9) {
      return bind87(use3(_handle2))(function(handle) {
        return bind87(use3(_forceLibrary1))(function(forces9) {
          return modifying2(_forceLibrary2)($$const(map27(enableByLabels(handle)(labels9))(forces9)));
        });
      });
    };
  };
  var simulationDisableForcesByLabel = function(dictMonadState) {
    var bind87 = bind(dictMonadState.Monad0().Bind1());
    var use3 = use(dictMonadState);
    var modifying2 = modifying(dictMonadState);
    return function(labels9) {
      return bind87(use3(_handle2))(function(handle) {
        return bind87(use3(_forceLibrary1))(function(forces9) {
          return modifying2(_forceLibrary2)($$const(map27(disableByLabels(handle)(labels9))(forces9)));
        });
      });
    };
  };
  var simulationActualizeForces = function(dictMonadState) {
    var Monad0 = dictMonadState.Monad0();
    var Bind1 = Monad0.Bind1();
    var bind87 = bind(Bind1);
    var use3 = use(dictMonadState);
    var discard120 = discard4(Bind1);
    var simulationEnableForcesByLabel1 = simulationEnableForcesByLabel(dictMonadState);
    var simulationDisableForcesByLabel1 = simulationDisableForcesByLabel(dictMonadState);
    var pure91 = pure(Monad0.Applicative0());
    return function(activeForces2) {
      return bind87(use3(_handle2))(function(handle) {
        return bind87(use3(_forceLibrary1))(function(library) {
          var allLabels = keys3(library);
          var disableLabels = fromFoldable10(difference4(fromFoldable14(allLabels))(activeForces2));
          var enableLabels = fromFoldable10(intersection3(activeForces2)(fromFoldable14(allLabels)));
          var v = spy3("\u{1F527} actualizeForces - enabling")(enableLabels);
          var v1 = spy3("\u{1F527} actualizeForces - disabling")(disableLabels);
          return discard120(simulationEnableForcesByLabel1(enableLabels))(function() {
            return discard120(simulationDisableForcesByLabel1(disableLabels))(function() {
              return bind87(use3(_forceLibrary1))(function(updatedLibrary) {
                var v2 = map27(updateForceInSimulation(handle))(updatedLibrary);
                return pure91(unit);
              });
            });
          });
        });
      });
    };
  };

  // output/PSD3.Interpreter.D3/index.js
  var monadEffectState2 = /* @__PURE__ */ monadEffectState(monadEffectEffect);
  var monadStateT2 = /* @__PURE__ */ monadStateT(monadEffect);
  var liftA11 = /* @__PURE__ */ liftA1(applicativeEffect);
  var runD3M = function(v) {
    return runStateT(v)(unit);
  };
  var monadEffD3M = monadEffectState2;
  var monadD3M = monadStateT2;
  var eval_D3M = function(v) {
    return liftA11(fst)(runStateT(v)(unit));
  };
  var d3TaglessD3M = {
    attach: function(selector) {
      return selectionAttach(d3TaglessD3M)(selector);
    },
    selectUnder: function(s_) {
      return selectionSelectUnder(d3TaglessD3M)(s_);
    },
    appendTo: function(s_) {
      return selectionAppendElement(d3TaglessD3M)(s_);
    },
    filterSelection: function(s_) {
      return selectionFilterSelection(d3TaglessD3M)(s_);
    },
    openSelection: function(s_) {
      return selectionOpenSelection(d3TaglessD3M)(s_);
    },
    mergeSelections: function(s_) {
      return selectionMergeSelections(d3TaglessD3M)(s_);
    },
    setAttributes: function(s_) {
      return selectionModifySelection(d3TaglessD3M)(s_);
    },
    simpleJoin: function(s_) {
      return selectionJoin(d3TaglessD3M)(s_);
    },
    nestedJoin: function(dictFoldable) {
      var selectionNestedJoin2 = selectionNestedJoin(dictFoldable);
      return function(s_) {
        return selectionNestedJoin2(d3TaglessD3M)(s_);
      };
    },
    updateJoin: function(s_) {
      return selectionUpdateJoin(d3TaglessD3M)(s_);
    },
    on: function(s_) {
      return selectionOn(d3TaglessD3M)(s_);
    },
    Monad0: function() {
      return monadD3M;
    }
  };

  // output/Component.AnimatedTreeCluster/index.js
  var show9 = /* @__PURE__ */ show(showLayoutType);
  var discard5 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var bind5 = /* @__PURE__ */ bind(bindHalogenM);
  var draw2 = /* @__PURE__ */ draw(monadEffD3M)(d3TaglessD3M);
  var modify_3 = /* @__PURE__ */ modify_2(monadStateHalogenM);
  var animationStep2 = /* @__PURE__ */ animationStep(monadEffD3M)(d3TaglessD3M);
  var get7 = /* @__PURE__ */ get(monadStateHalogenM);
  var pure8 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize2 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var ToggleLayout = /* @__PURE__ */ (function() {
    function ToggleLayout2() {
    }
    ;
    ToggleLayout2.value = new ToggleLayout2();
    return ToggleLayout2;
  })();
  var render3 = function(state3) {
    return div2([classes(["animated-tree-cluster-page"])])([div2([classes(["page-header"])])([h1_([text2("Animated Tree \u2194 Cluster")]), p([classes(["page-description"])])([text2("Smooth transitions between Tree (Reingold-Tilford) and Cluster (dendrogram) layouts using proper D3 data joins with stable keys.")])]), div2([classes(["controls"])])([button([classes(["button"]), onClick(function(v) {
      return ToggleLayout.value;
    })])([text2("Switch to " + show9(toggleLayout(state3.currentLayout)))]), p([classes(["current-layout"])])([text2("Current: " + show9(state3.currentLayout))])]), div2([classes(["viz-container"]), id3("animated-tree-cluster")])([])]);
  };
  var handleAction = function(dictMonadAff) {
    var monadEffectHalogenM2 = monadEffectHalogenM(dictMonadAff.MonadEffect0());
    var log9 = log3(monadEffectHalogenM2);
    var liftAff3 = liftAff(monadAffHalogenM(dictMonadAff));
    var liftEffect51 = liftEffect(monadEffectHalogenM2);
    return function(v) {
      if (v instanceof Initialize2) {
        return discard5(log9("AnimatedTreeCluster: Initializing"))(function() {
          return discard5(liftAff3(delay(100)))(function() {
            return bind5(liftAff3(get3(json)("./data/flare-2.json")))(function(flareResult) {
              if (flareResult instanceof Left) {
                return log9("Failed to load Flare data: " + printError(flareResult.value0));
              }
              ;
              if (flareResult instanceof Right) {
                return bind5(liftEffect51(runD3M(draw2(flareResult.value0.body)("#animated-tree-cluster"))))(function(v1) {
                  return discard5(modify_3(function(v2) {
                    var $32 = {};
                    for (var $33 in v2) {
                      if ({}.hasOwnProperty.call(v2, $33)) {
                        $32[$33] = v2[$33];
                      }
                      ;
                    }
                    ;
                    $32.vizState = new Just(v1.value0);
                    return $32;
                  }))(function() {
                    return bind5(liftEffect51(runD3M(animationStep2(v1.value0.dataTree)(v1.value0.linksGroup)(v1.value0.nodesGroup)(v1.value0.chartWidth)(v1.value0.chartHeight)(TreeLayout.value))))(function() {
                      return log9("AnimatedTreeCluster: Initialized");
                    });
                  });
                });
              }
              ;
              throw new Error("Failed pattern match at Component.AnimatedTreeCluster (line 96, column 5 - line 116, column 47): " + [flareResult.constructor.name]);
            });
          });
        });
      }
      ;
      if (v instanceof ToggleLayout) {
        return bind5(get7)(function(state3) {
          var newLayout = toggleLayout(state3.currentLayout);
          return discard5(log9("Toggling to " + show9(newLayout)))(function() {
            return discard5(modify_3(function(v1) {
              var $38 = {};
              for (var $39 in v1) {
                if ({}.hasOwnProperty.call(v1, $39)) {
                  $38[$39] = v1[$39];
                }
                ;
              }
              ;
              $38.currentLayout = newLayout;
              return $38;
            }))(function() {
              if (state3.vizState instanceof Nothing) {
                return log9("No viz state available");
              }
              ;
              if (state3.vizState instanceof Just) {
                return bind5(liftEffect51(runD3M(animationStep2(state3.vizState.value0.dataTree)(state3.vizState.value0.linksGroup)(state3.vizState.value0.nodesGroup)(state3.vizState.value0.chartWidth)(state3.vizState.value0.chartHeight)(newLayout))))(function() {
                  return pure8(unit);
                });
              }
              ;
              throw new Error("Failed pattern match at Component.AnimatedTreeCluster (line 124, column 5 - line 134, column 18): " + [state3.vizState.constructor.name]);
            });
          });
        });
      }
      ;
      throw new Error("Failed pattern match at Component.AnimatedTreeCluster (line 88, column 16 - line 134, column 18): " + [v.constructor.name]);
    };
  };
  var component = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return {
          currentLayout: TreeLayout.value,
          vizState: Nothing.value
        };
      },
      render: render3,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction(dictMonadAff),
        initialize: new Just(Initialize2.value)
      })
    });
  };

  // output/Component.CodeExplorerV2.Types/index.js
  var PackageGraph = /* @__PURE__ */ (function() {
    function PackageGraph3() {
    }
    ;
    PackageGraph3.value = new PackageGraph3();
    return PackageGraph3;
  })();
  var HorizontalTree = /* @__PURE__ */ (function() {
    function HorizontalTree2() {
    }
    ;
    HorizontalTree2.value = new HorizontalTree2();
    return HorizontalTree2;
  })();
  var showScene = {
    show: function(v) {
      if (v instanceof PackageGraph) {
        return "PackageGraph";
      }
      ;
      if (v instanceof HorizontalTree) {
        return "HorizontalTree";
      }
      ;
      throw new Error("Failed pattern match at Component.CodeExplorerV2.Types (line 10, column 1 - line 12, column 41): " + [v.constructor.name]);
    }
  };
  var eqScene = {
    eq: function(x47) {
      return function(y48) {
        if (x47 instanceof PackageGraph && y48 instanceof PackageGraph) {
          return true;
        }
        ;
        if (x47 instanceof HorizontalTree && y48 instanceof HorizontalTree) {
          return true;
        }
        ;
        return false;
      };
    }
  };

  // output/D3.Viz.Spago.Files/foreign.js
  function readSpago_Raw_JSON_(modulesBody) {
    return (packagesBody) => (lsdepsBody) => (locBody) => {
      const modules = decodeModulesFile(modulesBody);
      const packages = decodePackagesFile(packagesBody);
      const lsDeps = decodeLsDepsFile(lsdepsBody);
      const loc = decodeLOCFile(locBody);
      const pathToLOC = buildPathLookup(loc);
      const modulesWithLOC = modules.map((module2) => ({
        ...module2,
        loc: lookupLOC(module2.path, pathToLOC, loc)
      }));
      return { modules: modulesWithLOC, packages, lsDeps, loc };
    };
  }
  function buildPathLookup(locArray) {
    const lookup40 = {};
    for (const entry of locArray) {
      lookup40[entry.path] = entry.loc;
      const parts = entry.path.split("/");
      if (parts[0] === ".spago" && parts.length >= 4) {
        const pkg = parts[1];
        const relPath = parts.slice(3).join("/");
        lookup40[`${pkg}::${relPath}`] = entry.loc;
      }
    }
    return lookup40;
  }
  function lookupLOC(modulePath, pathToLOC, locArray) {
    if (pathToLOC[modulePath]) {
      return pathToLOC[modulePath];
    }
    const parts = modulePath.split("/");
    if (parts[0] === ".spago" && parts.length >= 4) {
      let pkg, relPath;
      if (parts[1] === "p" && parts.length >= 5) {
        pkg = parts[2];
        relPath = parts.slice(4).join("/");
      } else {
        pkg = parts[1];
        relPath = parts.slice(3).join("/");
      }
      const fuzzyKey = `${pkg}::${relPath}`;
      if (pathToLOC[fuzzyKey]) {
        return pathToLOC[fuzzyKey];
      }
    }
    return 10;
  }
  var decodeModulesFile = function(filecontents) {
    const json2 = JSON.parse(filecontents);
    const modules = Object.keys(json2).map((key) => {
      return { key, depends: json2[key].depends, path: json2[key].path };
    });
    return modules;
  };
  var decodePackagesFile = function(filecontents) {
    const json2 = JSON.parse(filecontents);
    const packages = Object.keys(json2).map((key) => {
      return { key, depends: json2[key].depends };
    });
    return packages;
  };
  var decodeLOCFile = function(filecontents) {
    const json2 = JSON.parse(filecontents);
    return json2.loc;
  };
  var decodeLsDepsFile = function(filecontents) {
    const jsonlines = splitIntoLines(filecontents);
    jsonlines.length = jsonlines.length - 1;
    var objectArray = jsonlines.map((d18) => JSON.parse(d18));
    return objectArray;
  };
  function splitIntoLines(str2) {
    return str2.split(/\r\n|[\n\v\f\r\u0085\u2028\u2029]/);
  }

  // output/Data.Graph/index.js
  var map28 = /* @__PURE__ */ map(functorList);
  var mempty2 = /* @__PURE__ */ mempty(monoidList);
  var append6 = /* @__PURE__ */ append(semigroupCatList);
  var fromFoldable11 = /* @__PURE__ */ fromFoldable7(foldableList);
  var fromFoldable15 = /* @__PURE__ */ fromFoldable7(foldableArray);
  var Emit = /* @__PURE__ */ (function() {
    function Emit2(value0) {
      this.value0 = value0;
    }
    ;
    Emit2.create = function(value0) {
      return new Emit2(value0);
    };
    return Emit2;
  })();
  var Visit = /* @__PURE__ */ (function() {
    function Visit2(value0) {
      this.value0 = value0;
    }
    ;
    Visit2.create = function(value0) {
      return new Visit2(value0);
    };
    return Visit2;
  })();
  var Graph = function(x47) {
    return x47;
  };
  var topologicalSort = function(dictOrd) {
    var member10 = member(dictOrd);
    var $$delete9 = $$delete3(dictOrd);
    var lookup112 = lookup2(dictOrd);
    return function(v) {
      var visit = function($copy_state) {
        return function($copy_stack) {
          var $tco_var_state = $copy_state;
          var $tco_done = false;
          var $tco_result;
          function $tco_loop(state3, stack) {
            var v1 = uncons4(stack);
            if (v1 instanceof Nothing) {
              $tco_done = true;
              return state3;
            }
            ;
            if (v1 instanceof Just && v1.value0.value0 instanceof Emit) {
              var state$prime = {
                result: new Cons(v1.value0.value0.value0, state3.result),
                unvisited: state3.unvisited
              };
              $tco_var_state = state$prime;
              $copy_stack = v1.value0.value1;
              return;
            }
            ;
            if (v1 instanceof Just && v1.value0.value0 instanceof Visit) {
              if (member10(v1.value0.value0.value0)(state3.unvisited)) {
                var start13 = {
                  result: state3.result,
                  unvisited: $$delete9(v1.value0.value0.value0)(state3.unvisited)
                };
                var next2 = maybe(mempty2)(snd)(lookup112(v1.value0.value0.value0)(v));
                $tco_var_state = start13;
                $copy_stack = append6(fromFoldable11(map28(Visit.create)(next2)))(cons3(new Emit(v1.value0.value0.value0))(v1.value0.value1));
                return;
              }
              ;
              if (otherwise) {
                $tco_var_state = state3;
                $copy_stack = v1.value0.value1;
                return;
              }
              ;
            }
            ;
            throw new Error("Failed pattern match at Data.Graph (line 126, column 7 - line 144, column 40): " + [v1.constructor.name]);
          }
          ;
          while (!$tco_done) {
            $tco_result = $tco_loop($tco_var_state, $copy_stack);
          }
          ;
          return $tco_result;
        };
      };
      var initialState4 = {
        unvisited: v,
        result: Nil.value
      };
      var go2 = function($copy_v1) {
        var $tco_done1 = false;
        var $tco_result;
        function $tco_loop(v1) {
          var v2 = findMin(v1.unvisited);
          if (v2 instanceof Just) {
            $copy_v1 = visit(v1)(fromFoldable15([new Visit(v2.value0.key)]));
            return;
          }
          ;
          if (v2 instanceof Nothing) {
            $tco_done1 = true;
            return v1.result;
          }
          ;
          throw new Error("Failed pattern match at Data.Graph (line 120, column 7 - line 122, column 26): " + [v2.constructor.name]);
        }
        ;
        while (!$tco_done1) {
          $tco_result = $tco_loop($copy_v1);
        }
        ;
        return $tco_result;
      };
      return go2(initialState4);
    };
  };
  var fromMap2 = Graph;

  // output/PSD3.Data.Graph/index.js
  var map29 = /* @__PURE__ */ map(functorArray);
  var lookup5 = /* @__PURE__ */ lookup2(ordInt);
  var fromFoldable16 = /* @__PURE__ */ fromFoldable2(foldableArray);
  var fromFoldable17 = /* @__PURE__ */ fromFoldable6(ordInt)(foldableArray);
  var append7 = /* @__PURE__ */ append(semigroupArray);
  var fromFoldable24 = /* @__PURE__ */ fromFoldable8(foldableArray)(ordInt);
  var alter2 = /* @__PURE__ */ alter(ordInt);
  var getLinksTo = function(nodeId) {
    return function(model) {
      var v = lookup5(nodeId)(model.maps.linksByTarget);
      if (v instanceof Nothing) {
        return [];
      }
      ;
      if (v instanceof Just) {
        return v.value0;
      }
      ;
      throw new Error("Failed pattern match at PSD3.Data.Graph (line 206, column 3 - line 208, column 24): " + [v.constructor.name]);
    };
  };
  var getLinksFrom = function(nodeId) {
    return function(model) {
      var v = lookup5(nodeId)(model.maps.linksBySource);
      if (v instanceof Nothing) {
        return [];
      }
      ;
      if (v instanceof Just) {
        return v.value0;
      }
      ;
      throw new Error("Failed pattern match at PSD3.Data.Graph (line 196, column 3 - line 198, column 24): " + [v.constructor.name]);
    };
  };
  var toDataGraph = function(config) {
    return function(model) {
      var buildEntry = function(node) {
        var nodeId = config.getNodeId(node);
        var links = getLinksFrom(nodeId)(model);
        var targets = fromFoldable16(map29(config.getLinkTarget)(links));
        return new Tuple(nodeId, new Tuple(node, targets));
      };
      var entries = map29(buildEntry)(model.nodes);
      var graphMap = fromFoldable17(entries);
      return fromMap2(graphMap);
    };
  };
  var buildGraphModel = function(config) {
    return function(nodes) {
      return function(links) {
        var addToArray = function(v) {
          return function(v1) {
            if (v1 instanceof Nothing) {
              return new Just([v]);
            }
            ;
            if (v1 instanceof Just) {
              return new Just(append7(v1.value0)([v]));
            }
            ;
            throw new Error("Failed pattern match at PSD3.Data.Graph (line 112, column 5 - line 112, column 68): " + [v.constructor.name, v1.constructor.name]);
          };
        };
        var nodeIds = fromFoldable24(map29(config.getNodeId)(nodes));
        var nodeById = fromFoldable17(map29(function(n) {
          return new Tuple(config.getNodeId(n), n);
        })(nodes));
        var linksByTarget = foldl2(function(acc) {
          return function(link4) {
            var targetId = config.getLinkTarget(link4);
            return alter2(addToArray(link4))(targetId)(acc);
          };
        })(empty3)(links);
        var linksBySource = foldl2(function(acc) {
          return function(link4) {
            var sourceId = config.getLinkSource(link4);
            return alter2(addToArray(link4))(sourceId)(acc);
          };
        })(empty3)(links);
        var maps = {
          nodeById,
          linksBySource,
          linksByTarget,
          nodeIds
        };
        return {
          nodes,
          links,
          maps
        };
      };
    };
  };

  // output/Web.HTML/foreign.js
  var windowImpl = function() {
    return window;
  };

  // output/Web.HTML.HTMLDocument/foreign.js
  function _readyState(doc) {
    return doc.readyState;
  }

  // output/Web.HTML.HTMLDocument.ReadyState/index.js
  var Loading = /* @__PURE__ */ (function() {
    function Loading2() {
    }
    ;
    Loading2.value = new Loading2();
    return Loading2;
  })();
  var Interactive = /* @__PURE__ */ (function() {
    function Interactive2() {
    }
    ;
    Interactive2.value = new Interactive2();
    return Interactive2;
  })();
  var Complete = /* @__PURE__ */ (function() {
    function Complete2() {
    }
    ;
    Complete2.value = new Complete2();
    return Complete2;
  })();
  var parse = function(v) {
    if (v === "loading") {
      return new Just(Loading.value);
    }
    ;
    if (v === "interactive") {
      return new Just(Interactive.value);
    }
    ;
    if (v === "complete") {
      return new Just(Complete.value);
    }
    ;
    return Nothing.value;
  };

  // output/Web.HTML.HTMLDocument/index.js
  var map30 = /* @__PURE__ */ map(functorEffect);
  var toParentNode2 = unsafeCoerce2;
  var toDocument = unsafeCoerce2;
  var readyState = function(doc) {
    return map30((function() {
      var $4 = fromMaybe(Loading.value);
      return function($5) {
        return $4(parse($5));
      };
    })())(function() {
      return _readyState(doc);
    });
  };

  // output/Web.HTML.HTMLElement/foreign.js
  function _read(nothing, just, value18) {
    var tag = Object.prototype.toString.call(value18);
    if (tag.indexOf("[object HTML") === 0 && tag.indexOf("Element]") === tag.length - 8) {
      return just(value18);
    } else {
      return nothing;
    }
  }

  // output/Web.HTML.HTMLElement/index.js
  var toNode2 = unsafeCoerce2;
  var fromElement = function(x47) {
    return _read(Nothing.value, Just.create, x47);
  };

  // output/Web.HTML.Location/foreign.js
  function hash(location2) {
    return function() {
      return location2.hash;
    };
  }
  function setHash(hash2) {
    return function(location2) {
      return function() {
        location2.hash = hash2;
      };
    };
  }

  // output/Web.HTML.Window/foreign.js
  function document2(window2) {
    return function() {
      return window2.document;
    };
  }
  function location(window2) {
    return function() {
      return window2.location;
    };
  }
  function innerWidth(window2) {
    return function() {
      return window2.innerWidth;
    };
  }
  function innerHeight(window2) {
    return function() {
      return window2.innerHeight;
    };
  }

  // output/Web.HTML.Window/index.js
  var toEventTarget = unsafeCoerce2;

  // output/Utility/index.js
  var map31 = /* @__PURE__ */ map(functorNonEmptyArray);
  var getWindowWidthHeight = function __do2() {
    var win = windowImpl();
    var w = innerWidth(win)();
    var h = innerHeight(win)();
    return new Tuple(toNumber(w), toNumber(h));
  };
  var equalSnd = function(dictEq) {
    var eq20 = eq(dictEq);
    return function(a2) {
      return function(b10) {
        return eq20(snd(a2))(snd(b10));
      };
    };
  };
  var compareSnd = function(dictOrd) {
    var compare26 = compare(dictOrd);
    return function(a2) {
      return function(b10) {
        return compare26(snd(a2))(snd(b10));
      };
    };
  };
  var chunk = function(tuples) {
    var $$package = snd(head4(tuples));
    var contains4 = toArray2(map31(fst)(tuples));
    return new Tuple($$package, contains4);
  };

  // output/D3.Viz.Spago.Files/index.js
  var append8 = /* @__PURE__ */ append(semigroupArray);
  var map32 = /* @__PURE__ */ map(functorArray);
  var fromFoldableWith2 = /* @__PURE__ */ fromFoldableWith(ordString)(foldableArray);
  var lookup6 = /* @__PURE__ */ lookup2(ordString);
  var fromFoldable18 = /* @__PURE__ */ fromFoldable6(ordString)(foldableArray);
  var mapFlipped3 = /* @__PURE__ */ mapFlipped(functorArray);
  var bind6 = /* @__PURE__ */ bind(bindMaybe);
  var sum2 = /* @__PURE__ */ sum(foldableArray)(semiringNumber);
  var equalSnd2 = /* @__PURE__ */ equalSnd(eqString);
  var compareSnd2 = /* @__PURE__ */ compareSnd(ordString);
  var fromFoldable19 = /* @__PURE__ */ fromFoldable6(ordInt)(foldableArray);
  var compare6 = /* @__PURE__ */ compare(ordString);
  var PackageInfo = /* @__PURE__ */ (function() {
    function PackageInfo2(value0) {
      this.value0 = value0;
    }
    ;
    PackageInfo2.create = function(value0) {
      return new PackageInfo2(value0);
    };
    return PackageInfo2;
  })();
  var IsModule = /* @__PURE__ */ (function() {
    function IsModule2(value0) {
      this.value0 = value0;
    }
    ;
    IsModule2.create = function(value0) {
      return new IsModule2(value0);
    };
    return IsModule2;
  })();
  var IsPackage = /* @__PURE__ */ (function() {
    function IsPackage2(value0) {
      this.value0 = value0;
    }
    ;
    IsPackage2.create = function(value0) {
      return new IsPackage2(value0);
    };
    return IsPackage2;
  })();
  var M2M_Tree = /* @__PURE__ */ (function() {
    function M2M_Tree2() {
    }
    ;
    M2M_Tree2.value = new M2M_Tree2();
    return M2M_Tree2;
  })();
  var M2M_Graph = /* @__PURE__ */ (function() {
    function M2M_Graph2() {
    }
    ;
    M2M_Graph2.value = new M2M_Graph2();
    return M2M_Graph2;
  })();
  var P2P = /* @__PURE__ */ (function() {
    function P2P2() {
    }
    ;
    P2P2.value = new P2P2();
    return P2P2;
  })();
  var M2P = /* @__PURE__ */ (function() {
    function M2P2() {
    }
    ;
    M2P2.value = new M2P2();
    return M2P2;
  })();
  var eqLinkType = {
    eq: function(x47) {
      return function(y48) {
        if (x47 instanceof M2M_Tree && y48 instanceof M2M_Tree) {
          return true;
        }
        ;
        if (x47 instanceof M2M_Graph && y48 instanceof M2M_Graph) {
          return true;
        }
        ;
        if (x47 instanceof P2P && y48 instanceof P2P) {
          return true;
        }
        ;
        if (x47 instanceof M2P && y48 instanceof M2P) {
          return true;
        }
        ;
        return false;
      };
    }
  };
  var eq13 = /* @__PURE__ */ eq(eqLinkType);
  var showLinkType = {
    show: function(v) {
      if (v instanceof M2M_Tree) {
        return "M2M-Tree";
      }
      ;
      if (v instanceof M2M_Graph) {
        return "M2M-Graph";
      }
      ;
      if (v instanceof P2P) {
        return "P2P";
      }
      ;
      if (v instanceof M2P) {
        return "module to package dependency";
      }
      ;
      throw new Error("Failed pattern match at D3.Viz.Spago.Files (line 331, column 1 - line 335, column 44): " + [v.constructor.name]);
    }
  };
  var isP2P_Link = function(link4) {
    return eq13(link4.linktype)(P2P.value);
  };
  var isM2P_Link = function(link4) {
    return eq13(link4.linktype)(M2P.value);
  };
  var isM2M_Tree_Link = function(link4) {
    return eq13(link4.linktype)(M2M_Tree.value);
  };
  var isM2M_Graph_Link = function(link4) {
    return eq13(link4.linktype)(M2M_Graph.value);
  };
  var getGraphJSONData = function(v) {
    var names = append8(map32(function(v1) {
      return v1.key;
    })(v.modules))(map32(function(v1) {
      return v1.key;
    })(v.packages));
    var makeModuleToPackageLink = function(m) {
      return {
        source: m.id,
        target: m.containerID,
        linktype: M2P.value,
        inSim: true
      };
    };
    var makeLink = function(linktype) {
      return function(v1) {
        return {
          source: v1.value0,
          target: v1.value1,
          linktype,
          inSim: true
        };
      };
    };
    var linkGraphConfig = {
      getNodeId: function(v1) {
        return v1.id;
      },
      getLinkSource: function(v1) {
        return v1.source;
      },
      getLinkTarget: function(v1) {
        return v1.target;
      }
    };
    var ids = range2(0)(length(names) - 1 | 0);
    var name2ID = fromFoldableWith2(function(v1) {
      return function(v2) {
        return v1;
      };
    })(zip(names)(ids));
    var getId = function(s) {
      return fromMaybe(0)(lookup6(s)(name2ID));
    };
    var makeNodeFromModuleJSONPL = function(m) {
      var id5 = getId(m.key);
      return {
        id: id5,
        name: m.key,
        containerID: getId(m["package"]),
        containerName: m["package"],
        loc: m.loc,
        nodetype: new IsModule(m.path),
        inSim: true,
        links: {
          targets: map32(getId)(m.depends),
          sources: [],
          treeChildren: [],
          inPackage: [],
          outPackage: [],
          contains: []
        },
        connected: false,
        showChildren: false,
        containsMany: false,
        treeXY: nullImpl,
        treeDepth: nullImpl,
        gridXY: nullImpl
      };
    };
    var foldDepends = function(b10) {
      return function(a2) {
        var id5 = getId(a2.key);
        var makeTuple = function(s) {
          return new Tuple(id5, getId(s));
        };
        return append8(map32(makeTuple)(a2.depends))(b10);
      };
    };
    var moduleLinks = map32(makeLink(M2M_Graph.value))(foldl2(foldDepends)([])(v.modules));
    var packageLinks = map32(makeLink(P2P.value))(foldl2(foldDepends)([])(v.packages));
    var depsMap = fromFoldable18(mapFlipped3(v.lsDeps)(function(d18) {
      return new Tuple(d18.packageName, {
        version: d18.version,
        repo: d18.repo.contents
      });
    }));
    var makeNodeFromPackageJSONCL = function(p2) {
      var repo = fromMaybe({
        version: "not found",
        repo: "not found"
      })(lookup6(p2.key)(depsMap));
      var id5 = getId(p2.key);
      return {
        id: id5,
        name: p2.key,
        inSim: true,
        nodetype: new IsPackage(new PackageInfo(repo)),
        containerID: id5,
        containerName: p2.key,
        loc: p2.loc,
        links: {
          targets: map32(getId)(p2.depends),
          sources: [],
          treeChildren: [],
          inPackage: [],
          outPackage: [],
          contains: map32(getId)(p2.contains)
        },
        connected: true,
        showChildren: true,
        containsMany: length(p2.contains) > 1,
        treeXY: nullImpl,
        treeDepth: nullImpl,
        gridXY: nullImpl
      };
    };
    var addPackageInfo = function(v1) {
      var packageName = (function() {
        var pieces = split("/")(v1.path);
        return bind6(index(pieces)(0))(function(root3) {
          return bind6(index(pieces)(1))(function(packageString) {
            if (root3 === ".spago") {
              var $78 = packageString === "p";
              if ($78) {
                return index(pieces)(2);
              }
              ;
              return new Just(packageString);
            }
            ;
            if (root3 === "src") {
              return new Just("my-project");
            }
            ;
            return Nothing.value;
          });
        });
      })();
      var $$package = fromMaybe("")(packageName);
      return {
        key: v1.key,
        depends: v1.depends,
        path: v1.path,
        loc: v1.loc,
        "package": $$package
      };
    };
    var modulesPL = map32(addPackageInfo)(v.modules);
    var mapNamesToModules = fromFoldable18(map32(function(m) {
      return new Tuple(m.key, m);
    })(modulesPL));
    var maybeModules = function(ms) {
      return catMaybes(map32(function(k) {
        return lookup6(k)(mapNamesToModules);
      })(ms));
    };
    var rollUpLOC = function(ms) {
      return sum2(map32(function(v1) {
        return v1.loc;
      })(maybeModules(ms)));
    };
    var moduleNodes = map32(makeNodeFromModuleJSONPL)(modulesPL);
    var modulePackageLinks = map32(makeModuleToPackageLink)(moduleNodes);
    var links = append8(moduleLinks)(append8(packageLinks)(modulePackageLinks));
    var modulePackageTuples = map32(function(m) {
      return new Tuple(m.key, m["package"]);
    })(modulesPL);
    var packageContains = map32(chunk)(groupBy(equalSnd2)(sortBy(compareSnd2)(modulePackageTuples)));
    var packageContainsMap = fromFoldable18(packageContains);
    var packageLOC = map32(function(v1) {
      return new Tuple(v1.value0, rollUpLOC(v1.value1));
    })(packageContains);
    var packageLOCMap = fromFoldable18(packageLOC);
    var addRollUpLOC = function(v1) {
      return {
        key: v1.key,
        depends: v1.depends,
        contains: v1.contains,
        loc: fromMaybe(0)(lookup6(v1.key)(packageLOCMap))
      };
    };
    var addContains = function(v1) {
      return {
        key: v1.key,
        depends: v1.depends,
        contains: fromMaybe([])(lookup6(v1.key)(packageContainsMap))
      };
    };
    var packagesCL = map32(function($122) {
      return addRollUpLOC(addContains($122));
    })(v.packages);
    var packageNodes = map32(makeNodeFromPackageJSONCL)(packagesCL);
    var nodes = append8(moduleNodes)(packageNodes);
    var linkGraph = buildGraphModel(linkGraphConfig)(nodes)(links);
    var getSourceLinks = function(v1) {
      var incomingLinks = getLinksTo(v1.id)(linkGraph);
      var sources = map32(function(v2) {
        return v2.source;
      })(incomingLinks);
      return new Tuple(v1.id, sources);
    };
    var sourceLinksMap = fromFoldable19(map32(getSourceLinks)(nodes));
    return {
      links,
      nodes,
      moduleNodes,
      packageNodes,
      moduleLinks,
      packageLinks,
      modulePackageLinks,
      sourceLinksMap,
      name2ID,
      id2Name: empty3,
      id2Package: empty3,
      id2LOC: empty3
    };
  };
  var eqPackageInfo = {
    eq: function(x47) {
      return function(y48) {
        return x47.value0.repo === y48.value0.repo && x47.value0.version === y48.value0.version;
      };
    }
  };
  var eq22 = /* @__PURE__ */ eq(eqPackageInfo);
  var ordPackageInfo = {
    compare: function(x47) {
      return function(y48) {
        var v = compare6(x47.value0.repo)(y48.value0.repo);
        if (v instanceof LT) {
          return LT.value;
        }
        ;
        if (v instanceof GT) {
          return GT.value;
        }
        ;
        return compare6(x47.value0.version)(y48.value0.version);
      };
    },
    Eq0: function() {
      return eqPackageInfo;
    }
  };
  var compare12 = /* @__PURE__ */ compare(ordPackageInfo);
  var eqNodeType = {
    eq: function(x47) {
      return function(y48) {
        if (x47 instanceof IsModule && y48 instanceof IsModule) {
          return x47.value0 === y48.value0;
        }
        ;
        if (x47 instanceof IsPackage && y48 instanceof IsPackage) {
          return eq22(x47.value0)(y48.value0);
        }
        ;
        return false;
      };
    }
  };
  var ordNodeType = {
    compare: function(x47) {
      return function(y48) {
        if (x47 instanceof IsModule && y48 instanceof IsModule) {
          return compare6(x47.value0)(y48.value0);
        }
        ;
        if (x47 instanceof IsModule) {
          return LT.value;
        }
        ;
        if (y48 instanceof IsModule) {
          return GT.value;
        }
        ;
        if (x47 instanceof IsPackage && y48 instanceof IsPackage) {
          return compare12(x47.value0)(y48.value0);
        }
        ;
        throw new Error("Failed pattern match at D3.Viz.Spago.Files (line 0, column 0 - line 0, column 0): " + [x47.constructor.name, y48.constructor.name]);
      };
    },
    Eq0: function() {
      return eqNodeType;
    }
  };

  // output/D3.Viz.Spago.GitMetrics/foreign.js
  var metricsData = null;
  function loadGitMetrics_() {
    fetch("./data/module-metrics.json").then((response) => response.json()).then((data) => {
      metricsData = data;
      window.__metricsData = data;
      console.log("Loaded git metrics for", Object.keys(data.modules).length, "modules");
    }).catch((err) => {
      console.warn("Failed to load git metrics:", err);
    });
  }
  function getModuleMetric_(moduleName) {
    return function(metricType) {
      if (!metricsData || !metricsData.modules) return 0;
      let module2 = metricsData.modules[moduleName];
      if (!module2) {
        const prefixes = ["D3.Viz.", "PSD3.", "Component."];
        for (const prefix of prefixes) {
          if (moduleName.startsWith(prefix)) {
            module2 = metricsData.modules[moduleName.slice(prefix.length)];
            if (module2) break;
          }
        }
      }
      if (!module2) {
        const parts = moduleName.split(".");
        const lastName = parts[parts.length - 1];
        for (const key of Object.keys(metricsData.modules)) {
          if (key.endsWith("." + lastName) || key === lastName) {
            module2 = metricsData.modules[key];
            break;
          }
        }
      }
      if (!module2 || !module2.normalized) return 0;
      return module2.normalized[metricType] || 0;
    };
  }

  // output/D3.Viz.Spago.GitMetrics/index.js
  var ColorByGroup = /* @__PURE__ */ (function() {
    function ColorByGroup2() {
    }
    ;
    ColorByGroup2.value = new ColorByGroup2();
    return ColorByGroup2;
  })();
  var ColorByDepth = /* @__PURE__ */ (function() {
    function ColorByDepth2() {
    }
    ;
    ColorByDepth2.value = new ColorByDepth2();
    return ColorByDepth2;
  })();
  var ColorByCommits = /* @__PURE__ */ (function() {
    function ColorByCommits2() {
    }
    ;
    ColorByCommits2.value = new ColorByCommits2();
    return ColorByCommits2;
  })();
  var ColorByRecency = /* @__PURE__ */ (function() {
    function ColorByRecency2() {
    }
    ;
    ColorByRecency2.value = new ColorByRecency2();
    return ColorByRecency2;
  })();
  var ColorByAge = /* @__PURE__ */ (function() {
    function ColorByAge2() {
    }
    ;
    ColorByAge2.value = new ColorByAge2();
    return ColorByAge2;
  })();
  var ColorByAuthors = /* @__PURE__ */ (function() {
    function ColorByAuthors2() {
    }
    ;
    ColorByAuthors2.value = new ColorByAuthors2();
    return ColorByAuthors2;
  })();
  var ColorByChurn = /* @__PURE__ */ (function() {
    function ColorByChurn2() {
    }
    ;
    ColorByChurn2.value = new ColorByChurn2();
    return ColorByChurn2;
  })();
  var ColorBySize = /* @__PURE__ */ (function() {
    function ColorBySize2() {
    }
    ;
    ColorBySize2.value = new ColorBySize2();
    return ColorBySize2;
  })();
  var ColorByReplay = /* @__PURE__ */ (function() {
    function ColorByReplay2() {
    }
    ;
    ColorByReplay2.value = new ColorByReplay2();
    return ColorByReplay2;
  })();

  // output/D3.Viz.Spago.GitReplay/foreign.js
  var timelineData = null;
  var replayState = {
    isPlaying: false,
    currentIndex: 0,
    speed: 100,
    // ms per commit
    intervalId: null,
    fadeSteps: 5,
    // How many commits before red fades to green
    moduleStates: /* @__PURE__ */ new Map(),
    // moduleName -> { exists: bool, heat: 0-1 }
    onUpdate: null
    // Callback when state changes
  };
  function loadTimeline_() {
    fetch("./data/commit-timeline.json").then((response) => response.json()).then((data) => {
      timelineData = data;
      replayState.moduleStates.clear();
      console.log("Loaded commit timeline:", data.commitCount, "commits,", data.moduleCount, "modules");
    }).catch((err) => {
      console.warn("Failed to load commit timeline:", err);
    });
  }
  function setUpdateCallback_(callback) {
    return function() {
      replayState.onUpdate = callback;
    };
  }
  function stepForward() {
    if (!timelineData || replayState.currentIndex >= timelineData.timeline.length) {
      stopReplay();
      return false;
    }
    const commit = timelineData.timeline[replayState.currentIndex];
    for (const [name16, state3] of replayState.moduleStates) {
      if (state3.exists && state3.heat > 0) {
        state3.heat = Math.max(0, state3.heat - 1 / replayState.fadeSteps);
      }
    }
    for (const moduleName of commit.created) {
      replayState.moduleStates.set(moduleName, { exists: true, heat: 1 });
    }
    for (const moduleName of commit.modified) {
      const state3 = replayState.moduleStates.get(moduleName);
      if (state3) {
        state3.heat = 0.9;
      } else {
        replayState.moduleStates.set(moduleName, { exists: true, heat: 0.9 });
      }
    }
    for (const moduleName of commit.deleted) {
      const state3 = replayState.moduleStates.get(moduleName);
      if (state3) {
        state3.exists = false;
        state3.heat = 0;
      }
    }
    replayState.currentIndex++;
    if (replayState.onUpdate) {
      replayState.onUpdate();
    }
    return true;
  }
  function startReplay_() {
    if (replayState.isPlaying) return;
    replayState.isPlaying = true;
    replayState.intervalId = setInterval(() => {
      if (!stepForward()) {
        stopReplay();
      }
    }, replayState.speed);
  }
  function stopReplay_() {
    stopReplay();
  }
  function stopReplay() {
    replayState.isPlaying = false;
    if (replayState.intervalId) {
      clearInterval(replayState.intervalId);
      replayState.intervalId = null;
    }
  }
  function resetReplay_() {
    stopReplay();
    replayState.currentIndex = 0;
    replayState.moduleStates.clear();
    if (replayState.onUpdate) {
      replayState.onUpdate();
    }
  }
  function getReplayColor_(moduleName) {
    const state3 = replayState.moduleStates.get(moduleName);
    if (!state3 || !state3.exists) {
      return "rgba(128, 128, 128, 0.1)";
    }
    const heat = state3.heat;
    if (heat >= 1) {
      return "rgb(255, 235, 59)";
    } else if (heat > 0) {
      if (heat > 0.5) {
        const t = (heat - 0.5) * 2;
        const r = 255;
        const g = Math.round(82 + (167 - 82) * (1 - t));
        const b10 = Math.round(82 + (38 - 82) * (1 - t));
        return `rgb(${r}, ${g}, ${b10})`;
      } else {
        const t = heat * 2;
        const r = Math.round(76 + (255 - 76) * t);
        const g = Math.round(175 + (167 - 175) * t);
        const b10 = Math.round(80 + (38 - 80) * t);
        return `rgb(${r}, ${g}, ${b10})`;
      }
    } else {
      return "rgb(76, 175, 80)";
    }
  }

  // output/PSD3.Internal.Scales.Scales/foreign.js
  var d3SchemeCategory10 = d3.scaleOrdinal(d3.schemeCategory10);
  function d3SchemeCategory10N_(number) {
    return d3SchemeCategory10(number);
  }
  var d3SchemePaired = d3.scaleOrdinal(d3.schemePaired);
  var d3SchemeDiverging10 = d3.scaleDiverging(d3.interpolateBrBG).domain([0, 250, 500]);
  var d3SchemeSequential10 = d3.scaleSequential().interpolator(d3.interpolateYlOrRd).domain([0, 5, 10]);
  function d3SchemeSequential10N_(number) {
    return d3SchemeSequential10(number);
  }
  function d3InterpolateViridis_(t) {
    return d3.interpolateViridis(t);
  }
  function d3InterpolateRdYlGn_(t) {
    return d3.interpolateRdYlGn(t);
  }
  function d3InterpolatePlasma_(t) {
    return d3.interpolatePlasma(t);
  }

  // output/PSD3v2.Attribute.Types/index.js
  var StringValue = /* @__PURE__ */ (function() {
    function StringValue2(value0) {
      this.value0 = value0;
    }
    ;
    StringValue2.create = function(value0) {
      return new StringValue2(value0);
    };
    return StringValue2;
  })();
  var NumberValue = /* @__PURE__ */ (function() {
    function NumberValue2(value0) {
      this.value0 = value0;
    }
    ;
    NumberValue2.create = function(value0) {
      return new NumberValue2(value0);
    };
    return NumberValue2;
  })();
  var BooleanValue = /* @__PURE__ */ (function() {
    function BooleanValue2(value0) {
      this.value0 = value0;
    }
    ;
    BooleanValue2.create = function(value0) {
      return new BooleanValue2(value0);
    };
    return BooleanValue2;
  })();
  var StaticAttr = /* @__PURE__ */ (function() {
    function StaticAttr2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    StaticAttr2.create = function(value0) {
      return function(value1) {
        return new StaticAttr2(value0, value1);
      };
    };
    return StaticAttr2;
  })();
  var DataAttr = /* @__PURE__ */ (function() {
    function DataAttr2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    DataAttr2.create = function(value0) {
      return function(value1) {
        return new DataAttr2(value0, value1);
      };
    };
    return DataAttr2;
  })();
  var IndexedAttr = /* @__PURE__ */ (function() {
    function IndexedAttr2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    IndexedAttr2.create = function(value0) {
      return function(value1) {
        return new IndexedAttr2(value0, value1);
      };
    };
    return IndexedAttr2;
  })();
  var toAttrStringString = {
    toAttr: function(value18) {
      return function(name16) {
        return new StaticAttr(name16, new StringValue(value18));
      };
    }
  };
  var toAttrStringFunctionStrin = {
    toAttr: function(fn) {
      return function(name16) {
        return new DataAttr(name16, function($158) {
          return StringValue.create(fn($158));
        });
      };
    }
  };
  var toAttrNumberNumber = {
    toAttr: function(value18) {
      return function(name16) {
        return new StaticAttr(name16, new NumberValue(value18));
      };
    }
  };
  var toAttrNumberFunctionNumbe = {
    toAttr: function(fn) {
      return function(name16) {
        return new DataAttr(name16, function($159) {
          return NumberValue.create(fn($159));
        });
      };
    }
  };
  var toAttr3 = function(dict) {
    return dict.toAttr;
  };
  var transform2 = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("transform");
    };
  };
  var viewBox2 = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("viewBox");
    };
  };
  var width8 = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("width");
    };
  };
  var x3 = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("x");
    };
  };
  var x1 = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("x1");
    };
  };
  var x22 = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("x2");
    };
  };
  var y3 = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("y");
    };
  };
  var y1 = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("y1");
    };
  };
  var y22 = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("y2");
    };
  };
  var textContent = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("textContent");
    };
  };
  var textAnchor = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("text-anchor");
    };
  };
  var strokeWidth3 = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("stroke-width");
    };
  };
  var strokeOpacity = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("stroke-opacity");
    };
  };
  var stroke = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("stroke");
    };
  };
  var radius3 = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("r");
    };
  };
  var opacity = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("opacity");
    };
  };
  var id_ = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("id");
    };
  };
  var height8 = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("height");
    };
  };
  var fontSize2 = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("font-size");
    };
  };
  var fillOpacity = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("fill-opacity");
    };
  };
  var fill3 = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("fill");
    };
  };
  var dy = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("dy");
    };
  };
  var d4 = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("d");
    };
  };
  var cy3 = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("cy");
    };
  };
  var cx3 = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("cx");
    };
  };
  var class_2 = function(dictToAttr) {
    var toAttr1 = toAttr3(dictToAttr);
    return function(value18) {
      return toAttr1(value18)("class");
    };
  };

  // output/D3.Viz.Spago.Draw.Attributes/index.js
  var show10 = /* @__PURE__ */ show(showNumber);
  var viewBox3 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var class_3 = /* @__PURE__ */ class_2(toAttrStringString);
  var width9 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height9 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var radius4 = /* @__PURE__ */ radius3(toAttrNumberFunctionNumbe);
  var fill4 = /* @__PURE__ */ fill3(toAttrStringFunctionStrin);
  var opacity2 = /* @__PURE__ */ opacity(toAttrNumberFunctionNumbe);
  var x4 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y4 = /* @__PURE__ */ y3(toAttrNumberFunctionNumbe);
  var textAnchor2 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var textContent2 = /* @__PURE__ */ textContent(toAttrStringFunctionStrin);
  var stroke2 = /* @__PURE__ */ stroke(toAttrStringFunctionStrin);
  var strokeWidth4 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var translateNode = function(d18) {
    return "translate(" + (show10(d18.x) + ("," + (show10(d18.y) + ")")));
  };
  var svgAttrs = function(w) {
    return function(h) {
      return [viewBox3(show10(-w / 2.1) + (" " + (show10(-h / 2.05) + (" " + (show10(w) + (" " + show10(h))))))), class_3("overlay"), width9(w), height9(h)];
    };
  };
  var positionLabel = function(d18) {
    if (d18.nodetype instanceof IsModule) {
      return -d18.r;
    }
    ;
    if (d18.nodetype instanceof IsPackage) {
      return 0;
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.Spago.Draw.Attributes (line 34, column 19 - line 36, column 23): " + [d18.nodetype.constructor.name]);
  };
  var opacityByType = function(d18) {
    if (d18.nodetype instanceof IsPackage) {
      return 0.4;
    }
    ;
    if (d18.nodetype instanceof IsModule) {
      return 0.7;
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.Spago.Draw.Attributes (line 76, column 19 - line 78, column 22): " + [d18.nodetype.constructor.name]);
  };
  var nodeRadius = function(d18) {
    return d18.r;
  };
  var nodeName = function(d18) {
    return d18.name;
  };
  var colorByGroup = function(d18) {
    return d3SchemeCategory10N_(toNumber(d18.cluster));
  };
  var fillByUsage = function(d18) {
    if (d18.connected) {
      return colorByGroup(d18);
    }
    ;
    return "none";
  };
  var graphSceneAttributes = /* @__PURE__ */ (function() {
    return {
      circles: [radius4(function(v) {
        return nodeRadius(v);
      }), fill4(function(v) {
        return colorByGroup(v);
      }), opacity2(function(v) {
        return opacityByType(v);
      })],
      labels: [class_3("label"), x4(0.2), y4(function(v) {
        return positionLabel(v);
      }), textAnchor2("middle"), textContent2(function(v) {
        return nodeName(v);
      })],
      tagMap: Nothing.value,
      nodeClick: Nothing.value
    };
  })();
  var strokeByUsage = function(d18) {
    if (d18.connected) {
      return "none";
    }
    ;
    return colorByGroup(d18);
  };
  var colorByDepth = function(d18) {
    var v = toMaybe(d18.treeDepth);
    if (v instanceof Nothing) {
      return "none";
    }
    ;
    if (v instanceof Just) {
      return d3SchemeSequential10N_(toNumber(v.value0));
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.Spago.Draw.Attributes (line 48, column 18 - line 50, column 56): " + [v.constructor.name]);
  };
  var colorByMetric = function(option2) {
    return function(d18) {
      var interpolateViridis = function(t) {
        return d3InterpolateViridis_(t);
      };
      var interpolateRdYlGn = function(t) {
        return d3InterpolateRdYlGn_(t);
      };
      var interpolatePlasma = function(t) {
        return d3InterpolatePlasma_(t);
      };
      if (option2 instanceof ColorByGroup) {
        return colorByGroup(d18);
      }
      ;
      if (option2 instanceof ColorByDepth) {
        return colorByDepth(d18);
      }
      ;
      if (option2 instanceof ColorByCommits) {
        return interpolateViridis(getModuleMetric_(d18.name)("commits"));
      }
      ;
      if (option2 instanceof ColorByRecency) {
        return interpolateRdYlGn(getModuleMetric_(d18.name)("recency"));
      }
      ;
      if (option2 instanceof ColorByAge) {
        return interpolatePlasma(getModuleMetric_(d18.name)("age"));
      }
      ;
      if (option2 instanceof ColorByAuthors) {
        return interpolateViridis(getModuleMetric_(d18.name)("authors"));
      }
      ;
      if (option2 instanceof ColorByChurn) {
        return interpolatePlasma(getModuleMetric_(d18.name)("churn"));
      }
      ;
      if (option2 instanceof ColorBySize) {
        return interpolateViridis(getModuleMetric_(d18.name)("size"));
      }
      ;
      if (option2 instanceof ColorByReplay) {
        return getReplayColor_(d18.name);
      }
      ;
      throw new Error("Failed pattern match at D3.Viz.Spago.Draw.Attributes (line 54, column 26 - line 63, column 42): " + [option2.constructor.name]);
    };
  };
  var sceneAttributesWithColorBy = function(colorOption) {
    return {
      circles: [radius4(function(v) {
        return nodeRadius(v);
      }), fill4(function(v) {
        return colorByMetric(colorOption)(v);
      }), opacity2(function(v) {
        return opacityByType(v);
      })],
      labels: [class_3("label"), x4(0.2), y4(function(v) {
        return positionLabel(v);
      }), textAnchor2("middle"), textContent2(function(v) {
        return nodeName(v);
      })],
      tagMap: Nothing.value,
      nodeClick: Nothing.value
    };
  };
  var treeSceneAttributes = /* @__PURE__ */ (function() {
    return {
      circles: [radius4(function(v) {
        return nodeRadius(v);
      }), fill4(function(v) {
        return colorByDepth(v);
      }), stroke2(function(v) {
        return colorByGroup(v);
      }), strokeWidth4(3)],
      labels: [class_3("label"), x4(4), y3(toAttrNumberNumber)(2), textContent2(function(v) {
        return nodeName(v);
      })],
      tagMap: Nothing.value,
      nodeClick: Nothing.value
    };
  })();
  var clusterSceneAttributes = /* @__PURE__ */ (function() {
    return {
      circles: [radius4(function(v) {
        return nodeRadius(v);
      }), fill4(function(v) {
        return fillByUsage(v);
      }), stroke2(function(v) {
        return strokeByUsage(v);
      }), strokeWidth4(3), opacity2(function(v) {
        return opacityByType(v);
      })],
      labels: [class_3("label"), x4(0.2), y4(function(v) {
        return positionLabel(v);
      }), textAnchor2("middle"), textContent2(function(v) {
        return nodeName(v);
      })],
      tagMap: Nothing.value,
      nodeClick: Nothing.value
    };
  })();

  // output/D3.Viz.Spago.Model/foreign.js
  var spotlitSelection;
  var spotlitNode;
  var sourcesSelection;
  var targetSelection;
  var spotlitID;
  var spotlit = false;
  spotlightNeighbours_ = (simulation, id5, nodetype) => {
    spotlit = true;
    spotlitID = id5;
    simulation.stop();
    svg = d3.select("div.svg-container svg");
    nodeSelection = svg.selectAll("g.nodes g");
    spotlitSelection = nodeSelection.filter((d18, i2) => d18.id == id5);
    spotlitNode = spotlitSelection.node();
    spotlitNode.__data__.fx = spotlitNode.__data__.fx || spotlitNode.__data__.x;
    spotlitNode.__data__.fy = spotlitNode.__data__.fy || spotlitNode.__data__.y;
    const targets = spotlitNode.__data__.links.targets;
    const sources = spotlitNode.__data__.links.sources;
    sourcesSelection = nodeSelection.filter((d18, i2) => sources.includes(d18.id));
    targetSelection = nodeSelection.filter((d18, i2) => targets.includes(d18.id));
    svg.classed("spotlight", true);
    sourcesSelection.classed("source", true);
    targetSelection.classed("target", true);
    spotlitSelection.classed("spotlight", true);
    spotlitSelection.classed("source target", false);
    simulation.force(
      "collide",
      d3.forceCollide().radius(
        (d18) => sources.includes(d18.id) || targets.includes(d18.id) ? d18.r * 4 : d18.id === d18.containerID ? 10 : d18.r
      )
    );
    simulation.alpha(1).restart();
  };
  unSpotlightNeighbours_ = (simulation) => {
    simulation.stop();
    svg.classed("spotlight", false);
    spotlitNode.__data__.fx = null;
    spotlitNode.__data__.fy = null;
    spotlitSelection.classed("spotlight", false);
    sourcesSelection.classed("source", false);
    targetSelection.classed("target", false);
    simulation.force(
      "collide",
      d3.forceCollide().radius((d18) => d18.id === d18.containerID ? 10 : d18.r)
    );
    simulation.restart();
    spotlit = false;
  };

  // output/D3.Viz.Spago.Model/index.js
  var lookup7 = /* @__PURE__ */ lookup2(ordInt);
  var map33 = /* @__PURE__ */ map(functorArray);
  var append9 = /* @__PURE__ */ append(semigroupArray);
  var fromFoldable20 = /* @__PURE__ */ fromFoldable6(ordInt)(foldableArray);
  var foldlWithIndex2 = /* @__PURE__ */ foldlWithIndex(foldableWithIndexArray);
  var bind7 = /* @__PURE__ */ bind(bindArray);
  var mapFlipped4 = /* @__PURE__ */ mapFlipped(functorArray);
  var upgradeSpagoNodeData = function(sourcesMap) {
    return function(node) {
      return {
        links: {
          targets: node.links.targets,
          treeChildren: node.links.treeChildren,
          inPackage: node.links.inPackage,
          outPackage: node.links.outPackage,
          contains: node.links.contains,
          sources: fromMaybe([])(lookup7(node.id)(sourcesMap))
        },
        id: node.id,
        cluster: node.containerID,
        connected: node.connected,
        showChildren: (function() {
          if (node.nodetype instanceof IsPackage) {
            return true;
          }
          ;
          if (node.nodetype instanceof IsModule) {
            return false;
          }
          ;
          throw new Error("Failed pattern match at D3.Viz.Spago.Model (line 101, column 20 - line 103, column 45): " + [node.nodetype.constructor.name]);
        })(),
        containerID: node.containerID,
        containerName: node.containerName,
        containsMany: node.containsMany,
        focusX: 0,
        focusY: 0,
        fx: nullImpl,
        fy: nullImpl,
        inSim: true,
        loc: node.loc,
        name: node.name,
        nodetype: node.nodetype,
        r: sqrt(node.loc),
        treeXY: nullImpl,
        treeDepth: nullImpl,
        gridXY: nullImpl,
        vx: 0,
        vy: 0,
        x: 0,
        y: 0
      };
    };
  };
  var unpinAllNodes = function(nodes) {
    var unpin = function(d18) {
      return {
        x: d18.x,
        y: d18.y,
        vx: d18.vx,
        vy: d18.vy,
        id: d18.id,
        links: d18.links,
        connected: d18.connected,
        showChildren: d18.showChildren,
        containerID: d18.containerID,
        containerName: d18.containerName,
        containsMany: d18.containsMany,
        inSim: d18.inSim,
        loc: d18.loc,
        name: d18.name,
        nodetype: d18.nodetype,
        treeXY: d18.treeXY,
        treeDepth: d18.treeDepth,
        gridXY: d18.gridXY,
        cluster: d18.cluster,
        focusX: d18.focusX,
        focusY: d18.focusY,
        r: d18.r,
        fx: nullImpl,
        fy: nullImpl
      };
    };
    return map33(unpin)(nodes);
  };
  var treeDepthMultiplier = 2;
  var spagoGraphConfig = {
    getNodeId: function(v) {
      return v.id;
    },
    getLinkSource: function(v) {
      return v.source;
    },
    getLinkTarget: function(v) {
      return v.target;
    }
  };
  var scalePoint = function(xFactor) {
    return function(yFactor) {
      return function(xy) {
        return {
          x: xy.x * xFactor,
          y: xy.y * yFactor
        };
      };
    };
  };
  var offsetXY = function(offset) {
    return function(xy) {
      return {
        x: xy.x + offset.x,
        y: xy.y + offset.y
      };
    };
  };
  var numberToGridPoint = function(columns) {
    return function(i2) {
      var d18 = toNumber(i2);
      var c = toNumber(columns);
      var x47 = remainder(d18)(c);
      var y48 = floor(d18 / c);
      return {
        x: x47,
        y: y48
      };
    };
  };
  var isUsedModule = function(d18) {
    if (d18.nodetype instanceof IsPackage) {
      return false;
    }
    ;
    if (d18.nodetype instanceof IsModule) {
      return d18.connected;
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.Spago.Model (line 91, column 18 - line 93, column 30): " + [d18.nodetype.constructor.name]);
  };
  var treeNodesToSwarmStart = function(nodes) {
    var setSwarmStart = function(d18) {
      var treeXY = fromMaybe({
        x: d18.x,
        y: d18.y
      })(toMaybe(d18.treeXY));
      return {
        vx: d18.vx,
        vy: d18.vy,
        id: d18.id,
        links: d18.links,
        connected: d18.connected,
        showChildren: d18.showChildren,
        containerID: d18.containerID,
        containerName: d18.containerName,
        containsMany: d18.containsMany,
        inSim: d18.inSim,
        loc: d18.loc,
        name: d18.name,
        nodetype: d18.nodetype,
        treeXY: d18.treeXY,
        treeDepth: d18.treeDepth,
        gridXY: d18.gridXY,
        cluster: d18.cluster,
        focusX: d18.focusX,
        focusY: d18.focusY,
        r: d18.r,
        x: treeXY.y,
        y: 0,
        fx: nullImpl,
        fy: nullImpl
      };
    };
    var partitioned = partition(isUsedModule)(nodes);
    return append9(partitioned.no)(map33(setSwarmStart)(partitioned.yes));
  };
  var treeNodesToTreeXY_H = function(nodes) {
    var setXYtoTreeXY = function(d18) {
      var treeXY = fromMaybe({
        x: d18.y,
        y: d18.x
      })(toMaybe(d18.treeXY));
      return {
        vx: d18.vx,
        vy: d18.vy,
        fx: d18.fx,
        fy: d18.fy,
        id: d18.id,
        links: d18.links,
        connected: d18.connected,
        showChildren: d18.showChildren,
        containerID: d18.containerID,
        containerName: d18.containerName,
        containsMany: d18.containsMany,
        inSim: d18.inSim,
        loc: d18.loc,
        name: d18.name,
        nodetype: d18.nodetype,
        treeDepth: d18.treeDepth,
        gridXY: d18.gridXY,
        cluster: d18.cluster,
        focusX: d18.focusX,
        focusY: d18.focusY,
        r: d18.r,
        treeXY: notNull(treeXY),
        x: treeXY.y * treeDepthMultiplier,
        y: treeXY.x
      };
    };
    var partitioned = partition(isUsedModule)(nodes);
    return append9(partitioned.no)(map33(setXYtoTreeXY)(partitioned.yes));
  };
  var treeNodesToTreeXY_R = function(nodes) {
    var setXYtoTreeXY = function(d18) {
      var treeXY = fromMaybe({
        x: d18.x,
        y: d18.y
      })(toMaybe(d18.treeXY));
      var radialTranslate = function(p2) {
        var radius39 = p2.y * treeDepthMultiplier;
        var x47 = radius39 * cos(p2.x);
        var y48 = radius39 * sin(p2.x);
        return {
          x: x47,
          y: y48
        };
      };
      var radialXY = radialTranslate(treeXY);
      return {
        vx: d18.vx,
        vy: d18.vy,
        fx: d18.fx,
        fy: d18.fy,
        id: d18.id,
        links: d18.links,
        connected: d18.connected,
        showChildren: d18.showChildren,
        containerID: d18.containerID,
        containerName: d18.containerName,
        containsMany: d18.containsMany,
        inSim: d18.inSim,
        loc: d18.loc,
        name: d18.name,
        nodetype: d18.nodetype,
        treeDepth: d18.treeDepth,
        gridXY: d18.gridXY,
        cluster: d18.cluster,
        focusX: d18.focusX,
        focusY: d18.focusY,
        r: d18.r,
        treeXY: notNull(treeXY),
        x: radialXY.x,
        y: radialXY.y
      };
    };
    var partitioned = partition(isUsedModule)(nodes);
    return append9(partitioned.no)(map33(setXYtoTreeXY)(partitioned.yes));
  };
  var treeNodesToTreeXY_V = function(nodes) {
    var setXYtoTreeXY = function(d18) {
      var treeXY = fromMaybe({
        x: d18.x,
        y: d18.y
      })(toMaybe(d18.treeXY));
      return {
        vx: d18.vx,
        vy: d18.vy,
        fx: d18.fx,
        fy: d18.fy,
        id: d18.id,
        links: d18.links,
        connected: d18.connected,
        showChildren: d18.showChildren,
        containerID: d18.containerID,
        containerName: d18.containerName,
        containsMany: d18.containsMany,
        inSim: d18.inSim,
        loc: d18.loc,
        name: d18.name,
        nodetype: d18.nodetype,
        treeDepth: d18.treeDepth,
        gridXY: d18.gridXY,
        cluster: d18.cluster,
        focusX: d18.focusX,
        focusY: d18.focusY,
        r: d18.r,
        treeXY: notNull(treeXY),
        x: treeXY.x,
        y: treeXY.y * treeDepthMultiplier
      };
    };
    var partitioned = partition(isUsedModule)(nodes);
    return append9(partitioned.no)(map33(setXYtoTreeXY)(partitioned.yes));
  };
  var isPackageOrVisibleModule = function(id5) {
    return function(d18) {
      if (d18.nodetype instanceof IsModule) {
        return d18.containerID === id5;
      }
      ;
      if (d18.nodetype instanceof IsPackage) {
        return true;
      }
      ;
      throw new Error("Failed pattern match at D3.Viz.Spago.Model (line 81, column 33 - line 83, column 24): " + [d18.nodetype.constructor.name]);
    };
  };
  var isPackage = function(d18) {
    if (d18.nodetype instanceof IsModule) {
      return false;
    }
    ;
    if (d18.nodetype instanceof IsPackage) {
      return true;
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.Spago.Model (line 76, column 15 - line 78, column 24): " + [d18.nodetype.constructor.name]);
  };
  var moduleNodesToContainerXY = function(nodes) {
    var partitioned = partition(isPackage)(nodes);
    var packagesIndexMap = fromFoldable20(foldl2(function(b10) {
      return function(a2) {
        return cons(new Tuple(a2.id, a2.gridXY))(b10);
      };
    })([])(partitioned.yes));
    var setModuleGridXY = function(m) {
      var v = lookup7(m.containerID)(packagesIndexMap);
      if (v instanceof Nothing) {
        return m;
      }
      ;
      if (v instanceof Just) {
        var v1 = toMaybe(v.value0);
        if (v1 instanceof Nothing) {
          return {
            containerID: m.containerID,
            cluster: m.cluster,
            connected: m.connected,
            containerName: m.containerName,
            containsMany: m.containsMany,
            focusX: m.focusX,
            focusY: m.focusY,
            fx: m.fx,
            fy: m.fy,
            id: m.id,
            inSim: m.inSim,
            links: m.links,
            loc: m.loc,
            name: m.name,
            nodetype: m.nodetype,
            r: m.r,
            showChildren: m.showChildren,
            treeDepth: m.treeDepth,
            treeXY: m.treeXY,
            vx: m.vx,
            vy: m.vy,
            x: 0,
            y: 0,
            gridXY: v.value0
          };
        }
        ;
        if (v1 instanceof Just) {
          return {
            containerID: m.containerID,
            cluster: m.cluster,
            connected: m.connected,
            containerName: m.containerName,
            containsMany: m.containsMany,
            focusX: m.focusX,
            focusY: m.focusY,
            fx: m.fx,
            fy: m.fy,
            id: m.id,
            inSim: m.inSim,
            links: m.links,
            loc: m.loc,
            name: m.name,
            nodetype: m.nodetype,
            r: m.r,
            showChildren: m.showChildren,
            treeDepth: m.treeDepth,
            treeXY: m.treeXY,
            vx: m.vx,
            vy: m.vy,
            x: v1.value0.x,
            y: v1.value0.y,
            gridXY: v.value0
          };
        }
        ;
        throw new Error("Failed pattern match at D3.Viz.Spago.Model (line 184, column 11 - line 186, column 65): " + [v1.constructor.name]);
      }
      ;
      throw new Error("Failed pattern match at D3.Viz.Spago.Model (line 181, column 7 - line 186, column 65): " + [v.constructor.name]);
    };
    var modulesWithGrid = map33(setModuleGridXY)(partitioned.no);
    return append9(modulesWithGrid)(partitioned.yes);
  };
  var nodesToRevelationXY = function(step4) {
    return function(nodes) {
      var setToRadialTreeXY = function(node) {
        var treeXY = fromMaybe({
          x: node.x,
          y: node.y
        })(toMaybe(node.treeXY));
        var radius39 = treeXY.y * treeDepthMultiplier;
        var x47 = radius39 * cos(treeXY.x);
        var y48 = radius39 * sin(treeXY.x);
        return {
          vx: node.vx,
          vy: node.vy,
          id: node.id,
          links: node.links,
          connected: node.connected,
          showChildren: node.showChildren,
          containerID: node.containerID,
          containerName: node.containerName,
          containsMany: node.containsMany,
          inSim: node.inSim,
          loc: node.loc,
          name: node.name,
          nodetype: node.nodetype,
          treeXY: node.treeXY,
          treeDepth: node.treeDepth,
          gridXY: node.gridXY,
          cluster: node.cluster,
          focusX: node.focusX,
          focusY: node.focusY,
          r: node.r,
          x: x47,
          y: y48,
          fx: notNull(x47),
          fy: notNull(y48)
        };
      };
      var setToContainerXY = function(node) {
        var v = toMaybe(node.gridXY);
        if (v instanceof Just) {
          return {
            vx: node.vx,
            vy: node.vy,
            id: node.id,
            links: node.links,
            connected: node.connected,
            showChildren: node.showChildren,
            containerID: node.containerID,
            containerName: node.containerName,
            containsMany: node.containsMany,
            inSim: node.inSim,
            loc: node.loc,
            name: node.name,
            nodetype: node.nodetype,
            treeXY: node.treeXY,
            treeDepth: node.treeDepth,
            gridXY: node.gridXY,
            cluster: node.cluster,
            focusX: node.focusX,
            focusY: node.focusY,
            r: node.r,
            x: v.value0.x,
            y: v.value0.y,
            fx: notNull(v.value0.x),
            fy: notNull(v.value0.y)
          };
        }
        ;
        if (v instanceof Nothing) {
          return node;
        }
        ;
        throw new Error("Failed pattern match at D3.Viz.Spago.Model (line 323, column 7 - line 325, column 24): " + [v.constructor.name]);
      };
      var positionModule = function(node) {
        var nodeDepth = fromMaybe(0)(toMaybe(node.treeDepth));
        var $91 = node.name === "PSD3.Main";
        if ($91) {
          return {
            vx: node.vx,
            vy: node.vy,
            id: node.id,
            links: node.links,
            connected: node.connected,
            showChildren: node.showChildren,
            containerID: node.containerID,
            containerName: node.containerName,
            containsMany: node.containsMany,
            inSim: node.inSim,
            loc: node.loc,
            name: node.name,
            nodetype: node.nodetype,
            treeXY: node.treeXY,
            treeDepth: node.treeDepth,
            gridXY: node.gridXY,
            cluster: node.cluster,
            focusX: node.focusX,
            focusY: node.focusY,
            r: node.r,
            x: 0,
            y: 0,
            fx: notNull(0),
            fy: notNull(0)
          };
        }
        ;
        var $92 = nodeDepth === step4 && nodeDepth > 0;
        if ($92) {
          return setToRadialTreeXY(node);
        }
        ;
        return node;
      };
      var positionNode2 = function(node) {
        if (isPackage(node)) {
          return node;
        }
        ;
        if (otherwise) {
          return positionModule(node);
        }
        ;
        throw new Error("Failed pattern match at D3.Viz.Spago.Model (line 296, column 5 - line 296, column 49): " + [node.constructor.name]);
      };
      return map33(positionNode2)(nodes);
    };
  };
  var packageNodesToGridXY = function(nodes) {
    var partitioned = partition(isPackage)(nodes);
    var packageCount = length(partitioned.yes);
    var columns = floor2(ceil(sqrt(toNumber(packageCount))));
    var offset = -(toNumber(columns) / 2);
    var packagesWithGrid = (function() {
      var setGridXY = function(p2) {
        return function(i2) {
          var gridXY = scalePoint(200)(200)(offsetXY({
            x: offset,
            y: offset
          })(numberToGridPoint(columns)(i2)));
          return {
            cluster: p2.cluster,
            connected: p2.connected,
            containerID: p2.containerID,
            containerName: p2.containerName,
            containsMany: p2.containsMany,
            focusX: p2.focusX,
            focusY: p2.focusY,
            fx: p2.fx,
            fy: p2.fy,
            id: p2.id,
            inSim: p2.inSim,
            links: p2.links,
            loc: p2.loc,
            name: p2.name,
            nodetype: p2.nodetype,
            r: p2.r,
            showChildren: p2.showChildren,
            treeDepth: p2.treeDepth,
            treeXY: p2.treeXY,
            vx: p2.vx,
            vy: p2.vy,
            gridXY: notNull(gridXY),
            x: gridXY.x,
            y: gridXY.y
          };
        };
      };
      return foldlWithIndex2(function(i2) {
        return function(b10) {
          return function(a2) {
            return cons(setGridXY(a2)(i2))(b10);
          };
        };
      })([])(partitioned.yes);
    })();
    return append9(partitioned.no)(packagesWithGrid);
  };
  var isModule = function(d18) {
    if (d18.nodetype instanceof IsModule) {
      return true;
    }
    ;
    if (d18.nodetype instanceof IsPackage) {
      return false;
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.Spago.Model (line 86, column 14 - line 88, column 25): " + [d18.nodetype.constructor.name]);
  };
  var initialRadius = 10;
  var initialAngle = /* @__PURE__ */ (function() {
    return pi * (3 - sqrt(5));
  })();
  var pinnedPackagesToPhyllotaxis = function(nodes) {
    var setPinnedPhyllotaxis = function(index5) {
      return function(d18) {
        var i2 = toNumber(index5);
        var radius39 = 100 * sqrt(0.5 + i2);
        var angle = i2 * initialAngle;
        var x47 = radius39 * cos(angle);
        var y48 = radius39 * sin(angle);
        return {
          vx: d18.vx,
          vy: d18.vy,
          id: d18.id,
          links: d18.links,
          connected: d18.connected,
          showChildren: d18.showChildren,
          containerID: d18.containerID,
          containerName: d18.containerName,
          containsMany: d18.containsMany,
          inSim: d18.inSim,
          loc: d18.loc,
          name: d18.name,
          nodetype: d18.nodetype,
          treeXY: d18.treeXY,
          treeDepth: d18.treeDepth,
          cluster: d18.cluster,
          focusX: d18.focusX,
          focusY: d18.focusY,
          r: d18.r,
          x: x47,
          y: y48,
          fx: notNull(x47),
          fy: notNull(y48),
          gridXY: notNull({
            x: x47,
            y: y48
          })
        };
      };
    };
    var partitioned = partition(isPackage)(nodes);
    return append9(partitioned.no)(mapWithIndex2(setPinnedPhyllotaxis)(partitioned.yes));
  };
  var setForPhyllotaxis = function(index5) {
    return function(d18) {
      var i2 = toNumber(index5);
      var radius39 = initialRadius * sqrt(0.5 + i2);
      var angle = i2 * initialAngle;
      return {
        vx: d18.vx,
        vy: d18.vy,
        fx: d18.fx,
        fy: d18.fy,
        id: d18.id,
        links: d18.links,
        connected: d18.connected,
        showChildren: d18.showChildren,
        containerID: d18.containerID,
        containerName: d18.containerName,
        containsMany: d18.containsMany,
        inSim: d18.inSim,
        loc: d18.loc,
        name: d18.name,
        nodetype: d18.nodetype,
        treeXY: d18.treeXY,
        treeDepth: d18.treeDepth,
        gridXY: d18.gridXY,
        cluster: d18.cluster,
        focusX: d18.focusX,
        focusY: d18.focusY,
        r: d18.r,
        x: radius39 * cos(angle),
        y: radius39 * sin(angle)
      };
    };
  };
  var nodesToPhyllotaxis = function(predicate) {
    return function(nodes) {
      var partitioned = partition(predicate)(nodes);
      return append9(partitioned.no)(mapWithIndex2(setForPhyllotaxis)(partitioned.yes));
    };
  };
  var packagesNodesToPhyllotaxis = /* @__PURE__ */ nodesToPhyllotaxis(isPackage);
  var fixNamedNodeTo = function(label5) {
    return function(point) {
      return function(nodes) {
        var fixNamedNode$prime = function(d18) {
          var $97 = d18.name === label5;
          if ($97) {
            return {
              name: d18.name,
              cluster: d18.cluster,
              connected: d18.connected,
              containerID: d18.containerID,
              containerName: d18.containerName,
              containsMany: d18.containsMany,
              focusX: d18.focusX,
              focusY: d18.focusY,
              gridXY: d18.gridXY,
              id: d18.id,
              inSim: d18.inSim,
              links: d18.links,
              loc: d18.loc,
              nodetype: d18.nodetype,
              r: d18.r,
              showChildren: d18.showChildren,
              treeDepth: d18.treeDepth,
              treeXY: d18.treeXY,
              vx: d18.vx,
              vy: d18.vy,
              x: d18.x,
              y: d18.y,
              fx: notNull(point.x),
              fy: notNull(point.y)
            };
          }
          ;
          return d18;
        };
        return map33(fixNamedNode$prime)(nodes);
      };
    };
  };
  var buildSpagoGraph = function(nodes) {
    var links = bind7(nodes)(function(node) {
      return mapFlipped4(node.links.targets)(function(target7) {
        return {
          source: node.id,
          target: target7,
          linktype: M2M_Graph.value,
          inSim: true
        };
      });
    });
    var graphModel = buildGraphModel(spagoGraphConfig)(nodes)(links);
    var graph = toDataGraph(spagoGraphConfig)(graphModel);
    return {
      graph,
      graphModel
    };
  };
  var makeSpagoGraphModel = function(json2) {
    var v = getGraphJSONData(json2);
    var v1 = buildSpagoGraph(v.nodes);
    return {
      links: v.links,
      nodes: mapFlipped4(v.nodes)(upgradeSpagoNodeData(v.sourceLinksMap)),
      graph: v1.graph,
      graphModel: v1.graphModel,
      tree: Nothing.value,
      maps: {
        name2ID: v.name2ID,
        id2Name: v.id2Name,
        id2Package: v.id2Package,
        id2LOC: v.id2LOC,
        id2TreeData: empty3
      }
    };
  };
  var convertFilesToGraphModel = function(moduleJSON) {
    return function(packageJSON) {
      return function(lsdepJSON) {
        return function(locJSON) {
          return makeSpagoGraphModel(readSpago_Raw_JSON_(moduleJSON.body)(packageJSON.body)(lsdepJSON.body)(locJSON.body));
        };
      };
    };
  };
  var allNodes2 = /* @__PURE__ */ $$const(true);

  // output/D3.Viz.Spago.Highlight/foreign.js
  function highlightConnected_(node) {
    return function() {
      if (!node || !node.links) return;
      const connectedIds = /* @__PURE__ */ new Set();
      if (node.links.targets) {
        node.links.targets.forEach((id5) => connectedIds.add(id5));
      }
      if (node.links.sources) {
        node.links.sources.forEach((id5) => connectedIds.add(id5));
      }
      if (node.links.treeChildren) {
        node.links.treeChildren.forEach((id5) => connectedIds.add(id5));
      }
      const nodeGroups = d3.selectAll("svg.overlay g").filter(function(d18) {
        return d18 && d18.id !== void 0;
      });
      nodeGroups.classed("highlighted-connection", function(d18) {
        return d18 && connectedIds.has(d18.id);
      });
      nodeGroups.classed("highlighted-source", function(d18) {
        return d18 && d18.id === node.id;
      });
      nodeGroups.classed("dimmed", function(d18) {
        return d18 && d18.id !== node.id && !connectedIds.has(d18.id);
      });
    };
  }
  function clearHighlights_2() {
    d3.selectAll(".highlighted-connection").classed("highlighted-connection", false);
    d3.selectAll(".highlighted-source").classed("highlighted-source", false);
    d3.selectAll(".dimmed").classed("dimmed", false);
  }

  // output/D3.Viz.Spago.Tooltip/foreign.js
  function formatMetricsContent_(node) {
    return function(metricsData2) {
      const name16 = node.name || "Unknown";
      const nodeType = node.nodetype ? node.nodetype.tag === "IsPackage" ? "Package" : "Module" : "Node";
      const cluster2 = node.containerName || node.cluster || "";
      let html2 = `<div class="tooltip-header">${name16}</div>`;
      html2 += `<div class="tooltip-type">${nodeType}${cluster2 ? " in " + cluster2 : ""}</div>`;
      if (metricsData2 && metricsData2.modules) {
        let moduleMetrics = metricsData2.modules[name16];
        if (!moduleMetrics) {
          const prefixes = ["D3.Viz.", "PSD3.", "Component."];
          for (const prefix of prefixes) {
            if (name16.startsWith(prefix)) {
              moduleMetrics = metricsData2.modules[name16.slice(prefix.length)];
              if (moduleMetrics) break;
            }
          }
        }
        if (moduleMetrics) {
          html2 += '<div class="tooltip-metrics">';
          html2 += '<div class="tooltip-metrics-title">Git Metrics</div>';
          if (moduleMetrics.commitCount !== void 0) {
            html2 += `<div class="tooltip-metric"><span class="metric-label">Commits:</span> <span class="metric-value">${moduleMetrics.commitCount}</span></div>`;
          }
          if (moduleMetrics.daysSinceModified !== void 0) {
            html2 += `<div class="tooltip-metric"><span class="metric-label">Last modified:</span> <span class="metric-value">${moduleMetrics.daysSinceModified} days ago</span></div>`;
          }
          if (moduleMetrics.ageInDays !== void 0) {
            html2 += `<div class="tooltip-metric"><span class="metric-label">Age:</span> <span class="metric-value">${moduleMetrics.ageInDays} days</span></div>`;
          }
          if (moduleMetrics.authorCount !== void 0) {
            html2 += `<div class="tooltip-metric"><span class="metric-label">Authors:</span> <span class="metric-value">${moduleMetrics.authorCount}</span></div>`;
          }
          if (moduleMetrics.linesChanged !== void 0) {
            html2 += `<div class="tooltip-metric"><span class="metric-label">Churn:</span> <span class="metric-value">${moduleMetrics.linesChanged} lines</span></div>`;
          }
          if (moduleMetrics.lineCount !== void 0) {
            html2 += `<div class="tooltip-metric"><span class="metric-label">Size:</span> <span class="metric-value">${moduleMetrics.lineCount} lines</span></div>`;
          }
          html2 += "</div>";
        }
      }
      return html2;
    };
  }
  function getMetricsData_() {
    return window.__metricsData || null;
  }

  // output/PSD3v2.Tooltip/foreign.js
  var tooltip = null;
  var ensureTooltip = () => {
    if (!tooltip) {
      tooltip = document.createElement("div");
      tooltip.className = "psd3-tooltip";
      tooltip.style.cssText = `
      position: fixed;
      display: none;
      background: rgba(20, 20, 30, 0.95);
      color: #f0f0f0;
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 13px;
      max-width: 300px;
      pointer-events: none;
      z-index: 10000;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    `;
      document.body.appendChild(tooltip);
    }
    return tooltip;
  };
  var showTooltip_ = (content3) => (x47) => (y48) => () => {
    const el = ensureTooltip();
    el.innerHTML = content3;
    el.style.display = "block";
    const rect = el.getBoundingClientRect();
    const viewW = window.innerWidth;
    const viewH = window.innerHeight;
    let posX = x47 + 15;
    let posY = y48 + 10;
    if (posX + rect.width > viewW) posX = x47 - rect.width - 15;
    if (posY + rect.height > viewH) posY = y48 - rect.height - 10;
    el.style.left = posX + "px";
    el.style.top = posY + "px";
  };
  var hideTooltip_ = () => {
    ensureTooltip().style.display = "none";
  };

  // output/PSD3v2.Behavior.Types/index.js
  var ScaleExtent2 = /* @__PURE__ */ (function() {
    function ScaleExtent3(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    ScaleExtent3.create = function(value0) {
      return function(value1) {
        return new ScaleExtent3(value0, value1);
      };
    };
    return ScaleExtent3;
  })();
  var SimpleDrag = /* @__PURE__ */ (function() {
    function SimpleDrag2() {
    }
    ;
    SimpleDrag2.value = new SimpleDrag2();
    return SimpleDrag2;
  })();
  var SimulationDrag = /* @__PURE__ */ (function() {
    function SimulationDrag2(value0) {
      this.value0 = value0;
    }
    ;
    SimulationDrag2.create = function(value0) {
      return new SimulationDrag2(value0);
    };
    return SimulationDrag2;
  })();
  var Zoom2 = /* @__PURE__ */ (function() {
    function Zoom3(value0) {
      this.value0 = value0;
    }
    ;
    Zoom3.create = function(value0) {
      return new Zoom3(value0);
    };
    return Zoom3;
  })();
  var Drag2 = /* @__PURE__ */ (function() {
    function Drag3(value0) {
      this.value0 = value0;
    }
    ;
    Drag3.create = function(value0) {
      return new Drag3(value0);
    };
    return Drag3;
  })();
  var Click = /* @__PURE__ */ (function() {
    function Click2(value0) {
      this.value0 = value0;
    }
    ;
    Click2.create = function(value0) {
      return new Click2(value0);
    };
    return Click2;
  })();
  var ClickWithDatum = /* @__PURE__ */ (function() {
    function ClickWithDatum2(value0) {
      this.value0 = value0;
    }
    ;
    ClickWithDatum2.create = function(value0) {
      return new ClickWithDatum2(value0);
    };
    return ClickWithDatum2;
  })();
  var MouseEnter2 = /* @__PURE__ */ (function() {
    function MouseEnter3(value0) {
      this.value0 = value0;
    }
    ;
    MouseEnter3.create = function(value0) {
      return new MouseEnter3(value0);
    };
    return MouseEnter3;
  })();
  var MouseLeave2 = /* @__PURE__ */ (function() {
    function MouseLeave3(value0) {
      this.value0 = value0;
    }
    ;
    MouseLeave3.create = function(value0) {
      return new MouseLeave3(value0);
    };
    return MouseLeave3;
  })();
  var Highlight = /* @__PURE__ */ (function() {
    function Highlight2(value0) {
      this.value0 = value0;
    }
    ;
    Highlight2.create = function(value0) {
      return new Highlight2(value0);
    };
    return Highlight2;
  })();
  var MouseMoveWithInfo = /* @__PURE__ */ (function() {
    function MouseMoveWithInfo2(value0) {
      this.value0 = value0;
    }
    ;
    MouseMoveWithInfo2.create = function(value0) {
      return new MouseMoveWithInfo2(value0);
    };
    return MouseMoveWithInfo2;
  })();
  var MouseEnterWithInfo = /* @__PURE__ */ (function() {
    function MouseEnterWithInfo2(value0) {
      this.value0 = value0;
    }
    ;
    MouseEnterWithInfo2.create = function(value0) {
      return new MouseEnterWithInfo2(value0);
    };
    return MouseEnterWithInfo2;
  })();
  var MouseLeaveWithInfo = /* @__PURE__ */ (function() {
    function MouseLeaveWithInfo2(value0) {
      this.value0 = value0;
    }
    ;
    MouseLeaveWithInfo2.create = function(value0) {
      return new MouseLeaveWithInfo2(value0);
    };
    return MouseLeaveWithInfo2;
  })();
  var simulationDrag = /* @__PURE__ */ (function() {
    return SimulationDrag.create;
  })();
  var onMouseMoveWithInfo = /* @__PURE__ */ (function() {
    return MouseMoveWithInfo.create;
  })();
  var onMouseLeaveWithInfo = /* @__PURE__ */ (function() {
    return MouseLeaveWithInfo.create;
  })();
  var onMouseLeave = /* @__PURE__ */ (function() {
    return MouseLeave2.create;
  })();
  var onMouseEnterWithInfo = /* @__PURE__ */ (function() {
    return MouseEnterWithInfo.create;
  })();
  var onClickWithDatum = /* @__PURE__ */ (function() {
    return ClickWithDatum.create;
  })();
  var defaultZoom = function(scaleExtent) {
    return function(targetSelector) {
      return {
        scaleExtent,
        targetSelector
      };
    };
  };
  var defaultDrag = /* @__PURE__ */ (function() {
    return SimpleDrag.value;
  })();

  // output/PSD3v2.Tooltip/index.js
  var showTooltip = showTooltip_;
  var hideTooltip = hideTooltip_;

  // output/D3.Viz.Spago.Tooltip/index.js
  var showNodeTooltip = function(node) {
    return function(x47) {
      return function(y48) {
        return function __do3() {
          var metricsData2 = getMetricsData_();
          var content3 = formatMetricsContent_(node)(metricsData2);
          return showTooltip(content3)(x47)(y48)();
        };
      };
    };
  };
  var hideNodeTooltip = hideTooltip;

  // output/PSD3v2.Capabilities.Selection/index.js
  var setAttrsExit = function(dict) {
    return dict.setAttrsExit;
  };
  var setAttrs = function(dict) {
    return dict.setAttrs;
  };
  var select4 = function(dict) {
    return dict.select;
  };
  var renderTree = function(dict) {
    return dict.renderTree;
  };
  var remove3 = function(dict) {
    return dict.remove;
  };
  var on2 = function(dict) {
    return dict.on;
  };
  var merge = function(dict) {
    return dict.merge;
  };
  var joinDataWithKey = function(dict) {
    return dict.joinDataWithKey;
  };
  var joinData = function(dict) {
    return dict.joinData;
  };
  var appendChildInheriting = function(dict) {
    return dict.appendChildInheriting;
  };
  var appendChild = function(dict) {
    return dict.appendChild;
  };
  var append10 = function(dict) {
    return dict.append;
  };

  // output/PSD3v2.Selection.Types/index.js
  var EmptySelection = /* @__PURE__ */ (function() {
    function EmptySelection2(value0) {
      this.value0 = value0;
    }
    ;
    EmptySelection2.create = function(value0) {
      return new EmptySelection2(value0);
    };
    return EmptySelection2;
  })();
  var BoundSelection = /* @__PURE__ */ (function() {
    function BoundSelection2(value0) {
      this.value0 = value0;
    }
    ;
    BoundSelection2.create = function(value0) {
      return new BoundSelection2(value0);
    };
    return BoundSelection2;
  })();
  var PendingSelection = /* @__PURE__ */ (function() {
    function PendingSelection2(value0) {
      this.value0 = value0;
    }
    ;
    PendingSelection2.create = function(value0) {
      return new PendingSelection2(value0);
    };
    return PendingSelection2;
  })();
  var ExitingSelection = /* @__PURE__ */ (function() {
    function ExitingSelection2(value0) {
      this.value0 = value0;
    }
    ;
    ExitingSelection2.create = function(value0) {
      return new ExitingSelection2(value0);
    };
    return ExitingSelection2;
  })();
  var SVGContext = /* @__PURE__ */ (function() {
    function SVGContext2() {
    }
    ;
    SVGContext2.value = new SVGContext2();
    return SVGContext2;
  })();
  var HTMLContext = /* @__PURE__ */ (function() {
    function HTMLContext2() {
    }
    ;
    HTMLContext2.value = new HTMLContext2();
    return HTMLContext2;
  })();
  var JoinResult = /* @__PURE__ */ (function() {
    function JoinResult2(value0) {
      this.value0 = value0;
    }
    ;
    JoinResult2.create = function(value0) {
      return new JoinResult2(value0);
    };
    return JoinResult2;
  })();
  var Circle2 = /* @__PURE__ */ (function() {
    function Circle4() {
    }
    ;
    Circle4.value = new Circle4();
    return Circle4;
  })();
  var Rect2 = /* @__PURE__ */ (function() {
    function Rect3() {
    }
    ;
    Rect3.value = new Rect3();
    return Rect3;
  })();
  var Path3 = /* @__PURE__ */ (function() {
    function Path5() {
    }
    ;
    Path5.value = new Path5();
    return Path5;
  })();
  var Line2 = /* @__PURE__ */ (function() {
    function Line3() {
    }
    ;
    Line3.value = new Line3();
    return Line3;
  })();
  var Text3 = /* @__PURE__ */ (function() {
    function Text4() {
    }
    ;
    Text4.value = new Text4();
    return Text4;
  })();
  var Group2 = /* @__PURE__ */ (function() {
    function Group3() {
    }
    ;
    Group3.value = new Group3();
    return Group3;
  })();
  var SVG = /* @__PURE__ */ (function() {
    function SVG2() {
    }
    ;
    SVG2.value = new SVG2();
    return SVG2;
  })();
  var Div2 = /* @__PURE__ */ (function() {
    function Div3() {
    }
    ;
    Div3.value = new Div3();
    return Div3;
  })();
  var Span2 = /* @__PURE__ */ (function() {
    function Span3() {
    }
    ;
    Span3.value = new Span3();
    return Span3;
  })();
  var Table2 = /* @__PURE__ */ (function() {
    function Table3() {
    }
    ;
    Table3.value = new Table3();
    return Table3;
  })();
  var Tr2 = /* @__PURE__ */ (function() {
    function Tr3() {
    }
    ;
    Tr3.value = new Tr3();
    return Tr3;
  })();
  var Td2 = /* @__PURE__ */ (function() {
    function Td3() {
    }
    ;
    Td3.value = new Td3();
    return Td3;
  })();
  var Th = /* @__PURE__ */ (function() {
    function Th2() {
    }
    ;
    Th2.value = new Th2();
    return Th2;
  })();
  var Tbody = /* @__PURE__ */ (function() {
    function Tbody2() {
    }
    ;
    Tbody2.value = new Tbody2();
    return Tbody2;
  })();
  var Thead = /* @__PURE__ */ (function() {
    function Thead2() {
    }
    ;
    Thead2.value = new Thead2();
    return Thead2;
  })();
  var elementContext = function(v) {
    if (v instanceof Circle2) {
      return SVGContext.value;
    }
    ;
    if (v instanceof Rect2) {
      return SVGContext.value;
    }
    ;
    if (v instanceof Path3) {
      return SVGContext.value;
    }
    ;
    if (v instanceof Line2) {
      return SVGContext.value;
    }
    ;
    if (v instanceof Text3) {
      return SVGContext.value;
    }
    ;
    if (v instanceof Group2) {
      return SVGContext.value;
    }
    ;
    if (v instanceof SVG) {
      return SVGContext.value;
    }
    ;
    if (v instanceof Div2) {
      return HTMLContext.value;
    }
    ;
    if (v instanceof Span2) {
      return HTMLContext.value;
    }
    ;
    if (v instanceof Table2) {
      return HTMLContext.value;
    }
    ;
    if (v instanceof Tr2) {
      return HTMLContext.value;
    }
    ;
    if (v instanceof Td2) {
      return HTMLContext.value;
    }
    ;
    if (v instanceof Th) {
      return HTMLContext.value;
    }
    ;
    if (v instanceof Tbody) {
      return HTMLContext.value;
    }
    ;
    if (v instanceof Thead) {
      return HTMLContext.value;
    }
    ;
    throw new Error("Failed pattern match at PSD3v2.Selection.Types (line 188, column 1 - line 188, column 47): " + [v.constructor.name]);
  };

  // output/D3.Viz.Spago.Render/index.js
  var class_4 = /* @__PURE__ */ class_2(toAttrStringString);
  var class_1 = /* @__PURE__ */ class_2(toAttrStringFunctionStrin);
  var lookup8 = /* @__PURE__ */ lookup2(ordInt);
  var fromFoldable21 = /* @__PURE__ */ fromFoldable(foldableSet);
  var show11 = /* @__PURE__ */ show(showNumber);
  var show12 = /* @__PURE__ */ show(showLinkType);
  var transform3 = /* @__PURE__ */ transform2(toAttrStringFunctionStrin);
  var discard6 = /* @__PURE__ */ discard(discardUnit);
  var stroke3 = /* @__PURE__ */ stroke(toAttrStringFunctionStrin);
  var fill5 = /* @__PURE__ */ fill3(toAttrStringString);
  var d5 = /* @__PURE__ */ d4(toAttrStringFunctionStrin);
  var makeTagClassesAttr = function(v) {
    if (v instanceof Nothing) {
      return class_4("");
    }
    ;
    if (v instanceof Just) {
      return class_1(function(v1) {
        var tags = fromMaybe(empty8)(lookup8(v1.id)(v.value0));
        return joinWith(" ")(fromFoldable21(tags));
      });
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.Spago.Render (line 49, column 1 - line 49, column 88): " + [v.constructor.name]);
  };
  var linkDiagonal = function(x1$prime) {
    return function(y1$prime) {
      return function(x2$prime) {
        return function(y2$prime) {
          return "M" + (show11(x1$prime) + ("," + (show11(y1$prime) + ("L" + (show11(x2$prime) + ("," + show11(y2$prime)))))));
        };
      };
    };
  };
  var linkColor = function(l) {
    if (l.linktype instanceof P2P) {
      return "red";
    }
    ;
    if (l.linktype instanceof M2P) {
      return "blue";
    }
    ;
    if (l.linktype instanceof M2M_Graph) {
      return "green";
    }
    ;
    if (l.linktype instanceof M2M_Tree) {
      return "orange";
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.Spago.Render (line 35, column 15 - line 39, column 23): " + [l.linktype.constructor.name]);
  };
  var linkClass = function(l) {
    return show12(l.linktype);
  };
  var spagoRenderCallbacks = function(dictMonad) {
    var Bind1 = dictMonad.Bind1();
    var bind87 = bind(Bind1);
    var discard215 = discard6(Bind1);
    var $$void18 = $$void(Bind1.Apply0().Functor0());
    var pure91 = pure(dictMonad.Applicative0());
    return function(dictSelectionM) {
      var append127 = append10(dictSelectionM);
      var appendChildInheriting4 = appendChildInheriting(dictSelectionM);
      var on14 = on2(dictSelectionM);
      var setAttrs6 = setAttrs(dictSelectionM);
      var remove9 = remove3(dictSelectionM);
      return {
        onNodeEnter: function(enterSel) {
          return function(attrs) {
            var tagClassesAttr = makeTagClassesAttr(attrs.tagMap);
            var groupAttrs = cons(tagClassesAttr)(cons(transform3(translateNode))([]));
            return bind87(append127(Group2.value)(groupAttrs)(enterSel))(function(groupEnter) {
              return bind87(appendChildInheriting4(Circle2.value)(attrs.circles)(groupEnter))(function(circleEnter) {
                return bind87(appendChildInheriting4(Text3.value)(attrs.labels)(groupEnter))(function(labelEnter) {
                  return bind87(on14(new Drag2(simulationDrag("spago")))(groupEnter))(function() {
                    return discard215((function() {
                      if (attrs.nodeClick instanceof Just) {
                        return $$void18(on14(onClickWithDatum(attrs.nodeClick.value0))(groupEnter));
                      }
                      ;
                      if (attrs.nodeClick instanceof Nothing) {
                        return pure91(unit);
                      }
                      ;
                      throw new Error("Failed pattern match at D3.Viz.Spago.Render (line 89, column 5 - line 91, column 27): " + [attrs.nodeClick.constructor.name]);
                    })())(function() {
                      return bind87(on14(onMouseEnterWithInfo(function(info2) {
                        return function __do3() {
                          showNodeTooltip(info2.datum)(info2.pageX)(info2.pageY)();
                          return highlightConnected_(info2.datum)();
                        };
                      }))(groupEnter))(function() {
                        return bind87(on14(onMouseLeave(function(v) {
                          return function __do3() {
                            hideNodeTooltip();
                            return clearHighlights_2();
                          };
                        }))(groupEnter))(function() {
                          return pure91(groupEnter);
                        });
                      });
                    });
                  });
                });
              });
            });
          };
        },
        onNodeUpdate: function(updateSel) {
          return function(attrs) {
            var tagClassesAttr = makeTagClassesAttr(attrs.tagMap);
            var groupAttrs = cons(tagClassesAttr)(cons(transform3(translateNode))([]));
            return bind87(setAttrs6(groupAttrs)(updateSel))(function() {
              return pure91(unit);
            });
          };
        },
        onNodeExit: function(exitSel) {
          return remove9(exitSel);
        },
        onLinkEnter: function(enterSel) {
          return function(attrs) {
            return bind87(append127(Path3.value)([class_1(function(v) {
              return linkClass(v);
            }), stroke3(function(v) {
              return linkColor(v);
            }), fill5("none"), class_4("enter")])(enterSel))(function(linkEnter) {
              return pure91(linkEnter);
            });
          };
        },
        onLinkUpdate: function(updateSel) {
          return function(attrs) {
            return bind87(setAttrs6([class_4("update")])(updateSel))(function() {
              return pure91(unit);
            });
          };
        },
        onLinkExit: function(exitSel) {
          return remove9(exitSel);
        },
        nodeTickAttrs: function(_attrs) {
          return [transform3(function(v) {
            return translateNode(v);
          })];
        },
        linkTickAttrs: [d5(function(v) {
          return linkDiagonal(v.source.x)(v.source.y)(v.target.x)(v.target.y);
        })]
      };
    };
  };

  // output/PSD3v2.Capabilities.Simulation/index.js
  var Step4 = /* @__PURE__ */ (function() {
    function Step5(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Step5.create = function(value0) {
      return function(value1) {
        return new Step5(value0, value1);
      };
    };
    return Step5;
  })();
  var update3 = function(dict) {
    return dict.update;
  };
  var stop = function(dict) {
    return dict.stop;
  };
  var start3 = function(dict) {
    return dict.start;
  };
  var reheat = function(dict) {
    return dict.reheat;
  };
  var init4 = function(dict) {
    return dict.init;
  };
  var addTickFunction = function(dict) {
    return dict.addTickFunction;
  };

  // output/PSD3v2.Selection.Operations/foreign.js
  function getElementData_(element3) {
    return function() {
      return element3.__data__;
    };
  }
  function setElementData_(datum2) {
    return function(element3) {
      return function() {
        element3.__data__ = datum2;
      };
    };
  }
  function setTextContent_(text8) {
    return function(element3) {
      return function() {
        element3.textContent = text8;
      };
    };
  }
  function getSimulationHandle_(simState) {
    return simState.handle_ || null;
  }
  function offsetX(event) {
    return event.offsetX;
  }
  function offsetY(event) {
    return event.offsetY;
  }
  function clearElement_(selector) {
    return function() {
      const el = document.querySelector(selector);
      if (el) {
        el.innerHTML = "";
      }
    };
  }

  // output/PSD3v2.Behavior.FFI/foreign.js
  function attachZoom_(element3) {
    return (scaleMin) => (scaleMax) => (targetSelector) => () => {
      const selection2 = select_default2(element3);
      const target7 = selection2.select(targetSelector);
      function zoomed(event) {
        target7.attr("transform", event.transform);
      }
      const zoom = zoom_default2().scaleExtent([scaleMin, scaleMax]).on("zoom", zoomed);
      selection2.call(zoom);
      return element3;
    };
  }
  function attachSimpleDrag_(element3) {
    return () => () => {
      const selection2 = select_default2(element3);
      let transform20 = { x: 0, y: 0 };
      function dragstarted(event) {
        select_default2(this).raise();
      }
      function dragged(event) {
        transform20.x += event.dx;
        transform20.y += event.dy;
        select_default2(this).attr("transform", `translate(${transform20.x},${transform20.y})`);
      }
      const drag2 = drag_default().on("start", dragstarted).on("drag", dragged);
      selection2.call(drag2);
      return element3;
    };
  }
  function attachSimulationDrag_(element3) {
    return (simulation) => (label5) => () => {
      const selection2 = select_default2(element3);
      function dragstarted(event) {
        if (simulation) {
          if (!event.active || simulation.alpha() < 1e-3) {
            simulation.alphaTarget(0.3).restart();
          }
        }
        event.subject.fx = event.subject.x;
        event.subject.fy = event.subject.y;
      }
      function dragged(event) {
        event.subject.fx = event.x;
        event.subject.fy = event.y;
      }
      function dragended(event) {
        if (simulation && !event.active) {
          simulation.alphaTarget(0);
        }
        event.subject.fx = null;
        event.subject.fy = null;
      }
      const drag2 = drag_default().on("start." + label5, dragstarted).on("drag." + label5, dragged).on("end." + label5, dragended);
      selection2.call(drag2).style("cursor", "pointer");
      return element3;
    };
  }
  function attachClick_(element3) {
    return (handler3) => () => {
      const selection2 = select_default2(element3);
      selection2.on("click", function(event) {
        handler3();
      });
      selection2.style("cursor", "pointer");
      return element3;
    };
  }
  function attachClickWithDatum_(element3) {
    return (handler3) => () => {
      const selection2 = select_default2(element3);
      selection2.on("click", function(event, d18) {
        handler3(d18)();
      });
      selection2.style("cursor", "pointer");
      return element3;
    };
  }
  function attachMouseEnter_(element3) {
    return (handler3) => () => {
      const selection2 = select_default2(element3);
      selection2.on("mouseenter", function(event, d18) {
        handler3(d18)();
      });
      return element3;
    };
  }
  function attachMouseLeave_(element3) {
    return (handler3) => () => {
      const selection2 = select_default2(element3);
      selection2.on("mouseleave", function(event, d18) {
        handler3(d18)();
      });
      return element3;
    };
  }
  function attachHighlight_(element3) {
    return (enterStyles) => (leaveStyles) => () => {
      const selection2 = select_default2(element3);
      selection2.on("mouseenter", function(event) {
        const sel = select_default2(this);
        sel.raise();
        enterStyles.forEach((style3) => {
          sel.attr(style3.attr, style3.value);
        });
      });
      selection2.on("mouseleave", function(event) {
        const sel = select_default2(this);
        leaveStyles.forEach((style3) => {
          sel.attr(style3.attr, style3.value);
        });
      });
      return element3;
    };
  }
  function attachMouseMoveWithEvent_(element3) {
    return (handler3) => () => {
      element3.addEventListener("mousemove", function(event) {
        const datum2 = this.__data__;
        handler3(datum2, event);
      });
      return element3;
    };
  }
  function attachMouseEnterWithEvent_(element3) {
    return (handler3) => () => {
      element3.addEventListener("mouseenter", function(event) {
        const datum2 = this.__data__;
        handler3(datum2, event);
      });
      return element3;
    };
  }
  function attachMouseLeaveWithEvent_(element3) {
    return (handler3) => () => {
      element3.addEventListener("mouseleave", function(event) {
        const datum2 = this.__data__;
        handler3(datum2, event);
      });
      return element3;
    };
  }

  // output/PSD3v2.Selection.Join/index.js
  var unsafeIndex2 = /* @__PURE__ */ unsafeIndex();
  var foldlWithIndex3 = /* @__PURE__ */ foldlWithIndex(foldableWithIndexArray);
  var computeJoinWithKey = function(dictEq) {
    var eq20 = eq(dictEq);
    return function(newData) {
      return function(oldBindings) {
        return function(keyFn) {
          var processNewDatum = function(newIndex) {
            return function(state3) {
              return function(datum2) {
                var newKey = keyFn(datum2);
                var v = findIndex(function(v1) {
                  return eq20(keyFn(v1.datum))(newKey);
                })(state3.remainingOld);
                if (v instanceof Nothing) {
                  var enterBinding = {
                    datum: datum2,
                    newIndex
                  };
                  return {
                    remainingOld: state3.remainingOld,
                    matchedIndices: state3.matchedIndices,
                    update: state3.update,
                    enter: cons(enterBinding)(state3.enter)
                  };
                }
                ;
                if (v instanceof Just) {
                  var newRemaining = fromMaybe(state3.remainingOld)(deleteAt(v.value0)(state3.remainingOld));
                  var matched = unsafeIndex2(state3.remainingOld)(v.value0);
                  var updateBinding = {
                    element: matched.element,
                    oldDatum: datum2,
                    newDatum: datum2,
                    newIndex
                  };
                  return {
                    enter: state3.enter,
                    update: cons(updateBinding)(state3.update),
                    remainingOld: newRemaining,
                    matchedIndices: cons(v.value0)(state3.matchedIndices)
                  };
                }
                ;
                throw new Error("Failed pattern match at PSD3v2.Selection.Join (line 167, column 9 - line 189, column 18): " + [v.constructor.name]);
              };
            };
          };
          var matchResult = foldlWithIndex3(processNewDatum)({
            remainingOld: oldBindings,
            enter: [],
            update: [],
            matchedIndices: []
          })(newData);
          return {
            enter: reverse(matchResult.enter),
            update: reverse(matchResult.update),
            exit: matchResult.remainingOld
          };
        };
      };
    };
  };
  var computeJoin = function(dictEq) {
    var eq20 = eq(dictEq);
    return function(newData) {
      return function(oldBindings) {
        var processNewDatum = function(newIndex) {
          return function(state3) {
            return function(datum2) {
              var v = findIndex(function(v1) {
                return eq20(v1.datum)(datum2);
              })(state3.remainingOld);
              if (v instanceof Nothing) {
                var enterBinding = {
                  datum: datum2,
                  newIndex
                };
                return {
                  remainingOld: state3.remainingOld,
                  matchedIndices: state3.matchedIndices,
                  update: state3.update,
                  enter: cons(enterBinding)(state3.enter)
                };
              }
              ;
              if (v instanceof Just) {
                var newRemaining = fromMaybe(state3.remainingOld)(deleteAt(v.value0)(state3.remainingOld));
                var matched = unsafeIndex2(state3.remainingOld)(v.value0);
                var updateBinding = {
                  element: matched.element,
                  oldDatum: datum2,
                  newDatum: datum2,
                  newIndex
                };
                return {
                  enter: state3.enter,
                  update: cons(updateBinding)(state3.update),
                  remainingOld: newRemaining,
                  matchedIndices: cons(v.value0)(state3.matchedIndices)
                };
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Join (line 100, column 7 - line 122, column 16): " + [v.constructor.name]);
            };
          };
        };
        var matchResult = foldlWithIndex3(processNewDatum)({
          remainingOld: oldBindings,
          enter: [],
          update: [],
          matchedIndices: []
        })(newData);
        return {
          enter: reverse(matchResult.enter),
          update: reverse(matchResult.update),
          exit: matchResult.remainingOld
        };
      };
    };
  };

  // output/PSD3v2.VizTree.Tree/index.js
  var append11 = /* @__PURE__ */ append(semigroupArray);
  var Node3 = /* @__PURE__ */ (function() {
    function Node4(value0) {
      this.value0 = value0;
    }
    ;
    Node4.create = function(value0) {
      return new Node4(value0);
    };
    return Node4;
  })();
  var Join2 = /* @__PURE__ */ (function() {
    function Join3(value0) {
      this.value0 = value0;
    }
    ;
    Join3.create = function(value0) {
      return new Join3(value0);
    };
    return Join3;
  })();
  var NestedJoin = /* @__PURE__ */ (function() {
    function NestedJoin2(value0) {
      this.value0 = value0;
    }
    ;
    NestedJoin2.create = function(value0) {
      return new NestedJoin2(value0);
    };
    return NestedJoin2;
  })();
  var SceneJoin = /* @__PURE__ */ (function() {
    function SceneJoin2(value0) {
      this.value0 = value0;
    }
    ;
    SceneJoin2.create = function(value0) {
      return new SceneJoin2(value0);
    };
    return SceneJoin2;
  })();
  var SceneNestedJoin = /* @__PURE__ */ (function() {
    function SceneNestedJoin2(value0) {
      this.value0 = value0;
    }
    ;
    SceneNestedJoin2.create = function(value0) {
      return new SceneNestedJoin2(value0);
    };
    return SceneNestedJoin2;
  })();
  var withChildren = function(parent2) {
    return function(newChildren) {
      if (parent2 instanceof Node3) {
        return new Node3({
          name: parent2.value0.name,
          elemType: parent2.value0.elemType,
          attrs: parent2.value0.attrs,
          children: append11(parent2.value0.children)(newChildren)
        });
      }
      ;
      if (parent2 instanceof Join2) {
        return new Join2(parent2.value0);
      }
      ;
      if (parent2 instanceof NestedJoin) {
        return new NestedJoin(parent2.value0);
      }
      ;
      if (parent2 instanceof SceneJoin) {
        return new SceneJoin(parent2.value0);
      }
      ;
      if (parent2 instanceof SceneNestedJoin) {
        return new SceneNestedJoin(parent2.value0);
      }
      ;
      throw new Error("Failed pattern match at PSD3v2.VizTree.Tree (line 157, column 35 - line 162, column 45): " + [parent2.constructor.name]);
    };
  };
  var withChild = function(parent2) {
    return function(child) {
      if (parent2 instanceof Node3) {
        return new Node3({
          name: parent2.value0.name,
          elemType: parent2.value0.elemType,
          attrs: parent2.value0.attrs,
          children: append11(parent2.value0.children)([child])
        });
      }
      ;
      if (parent2 instanceof Join2) {
        return new Join2(parent2.value0);
      }
      ;
      if (parent2 instanceof NestedJoin) {
        return new NestedJoin(parent2.value0);
      }
      ;
      if (parent2 instanceof SceneJoin) {
        return new SceneJoin(parent2.value0);
      }
      ;
      if (parent2 instanceof SceneNestedJoin) {
        return new SceneNestedJoin(parent2.value0);
      }
      ;
      throw new Error("Failed pattern match at PSD3v2.VizTree.Tree (line 146, column 26 - line 151, column 45): " + [parent2.constructor.name]);
    };
  };
  var sceneNestedJoin = function(name16) {
    return function(key) {
      return function(data$prime) {
        return function(decomposeFn) {
          return function(templateFn) {
            return function(behaviors) {
              return new SceneNestedJoin({
                name: name16,
                key,
                joinData: data$prime,
                decompose: decomposeFn,
                template: templateFn,
                enterBehavior: behaviors.enterBehavior,
                updateBehavior: behaviors.updateBehavior,
                exitBehavior: behaviors.exitBehavior
              });
            };
          };
        };
      };
    };
  };
  var nestedJoin = function(name16) {
    return function(key) {
      return function(data$prime) {
        return function(decomposeFn) {
          return function(templateFn) {
            return new NestedJoin({
              name: name16,
              key,
              joinData: data$prime,
              decompose: decomposeFn,
              template: templateFn
            });
          };
        };
      };
    };
  };
  var named2 = function(elemType) {
    return function(name16) {
      return function(attrs) {
        return new Node3({
          name: new Just(name16),
          elemType,
          attrs,
          children: []
        });
      };
    };
  };
  var joinData2 = function(name16) {
    return function(key) {
      return function(data$prime) {
        return function(templateBuilder) {
          return new Join2({
            name: name16,
            key,
            joinData: data$prime,
            template: templateBuilder
          });
        };
      };
    };
  };
  var elem4 = function(elemType) {
    return function(attrs) {
      return new Node3({
        name: Nothing.value,
        elemType,
        attrs,
        children: []
      });
    };
  };

  // output/Web.DOM.Document/foreign.js
  var getEffProp2 = function(name16) {
    return function(doc) {
      return function() {
        return doc[name16];
      };
    };
  };
  var url = getEffProp2("URL");
  var documentURI = getEffProp2("documentURI");
  var origin2 = getEffProp2("origin");
  var compatMode = getEffProp2("compatMode");
  var characterSet = getEffProp2("characterSet");
  var contentType = getEffProp2("contentType");
  var _documentElement2 = getEffProp2("documentElement");
  function createElement2(localName2) {
    return function(doc) {
      return function() {
        return doc.createElement(localName2);
      };
    };
  }
  function _createElementNS(ns) {
    return function(qualifiedName) {
      return function(doc) {
        return function() {
          return doc.createElementNS(ns, qualifiedName);
        };
      };
    };
  }

  // output/Web.DOM.Document/index.js
  var createElementNS = function($6) {
    return _createElementNS(toNullable($6));
  };

  // output/Web.DOM.Node/foreign.js
  var getEffProp3 = function(name16) {
    return function(node) {
      return function() {
        return node[name16];
      };
    };
  };
  var baseURI = getEffProp3("baseURI");
  var _ownerDocument = getEffProp3("ownerDocument");
  var _parentNode = getEffProp3("parentNode");
  var _parentElement = getEffProp3("parentElement");
  var childNodes = getEffProp3("childNodes");
  var _firstChild = getEffProp3("firstChild");
  var _lastChild = getEffProp3("lastChild");
  var _previousSibling = getEffProp3("previousSibling");
  var _nextSibling = getEffProp3("nextSibling");
  var _nodeValue = getEffProp3("nodeValue");
  var textContent3 = getEffProp3("textContent");
  function insertBefore(node1) {
    return function(node2) {
      return function(parent2) {
        return function() {
          parent2.insertBefore(node1, node2);
        };
      };
    };
  }
  function appendChild2(node) {
    return function(parent2) {
      return function() {
        parent2.appendChild(node);
      };
    };
  }
  function removeChild2(node) {
    return function(parent2) {
      return function() {
        parent2.removeChild(node);
      };
    };
  }

  // output/Web.DOM.Node/index.js
  var map34 = /* @__PURE__ */ map(functorEffect);
  var parentNode2 = /* @__PURE__ */ (function() {
    var $6 = map34(toMaybe);
    return function($7) {
      return $6(_parentNode($7));
    };
  })();
  var nextSibling = /* @__PURE__ */ (function() {
    var $15 = map34(toMaybe);
    return function($16) {
      return $15(_nextSibling($16));
    };
  })();

  // output/Web.DOM.NodeList/foreign.js
  function toArray3(list) {
    return function() {
      return [].slice.call(list);
    };
  }

  // output/Web.UIEvent.MouseEvent/foreign.js
  function clientX(e) {
    return e.clientX;
  }
  function clientY(e) {
    return e.clientY;
  }
  function pageX(e) {
    return e.pageX;
  }
  function pageY(e) {
    return e.pageY;
  }

  // output/PSD3v2.Selection.Operations/index.js
  var bind8 = /* @__PURE__ */ bind(bindEffect);
  var pure9 = /* @__PURE__ */ pure(applicativeEffect);
  var mapFlipped5 = /* @__PURE__ */ mapFlipped(functorEffect);
  var lookup9 = /* @__PURE__ */ lookup2(ordString);
  var traverse_4 = /* @__PURE__ */ traverse_(applicativeEffect)(foldableArray);
  var traverse3 = /* @__PURE__ */ traverse(traversableArray)(applicativeEffect);
  var $$void7 = /* @__PURE__ */ $$void(functorEffect);
  var discard7 = /* @__PURE__ */ discard(discardUnit);
  var append14 = /* @__PURE__ */ append(semigroupArray);
  var liftEffect3 = /* @__PURE__ */ liftEffect(monadEffectEffect);
  var log4 = /* @__PURE__ */ log3(monadEffectEffect);
  var show13 = /* @__PURE__ */ show(showInt);
  var mapFlipped1 = /* @__PURE__ */ mapFlipped(functorMaybe);
  var compare7 = /* @__PURE__ */ compare(ordInt);
  var mapFlipped22 = /* @__PURE__ */ mapFlipped(functorArray);
  var show14 = /* @__PURE__ */ show(showNumber);
  var show22 = /* @__PURE__ */ show(showBoolean);
  var traverseWithIndex_2 = /* @__PURE__ */ traverseWithIndex_(applicativeEffect)(foldableWithIndexArray);
  var unsafeIndex3 = /* @__PURE__ */ unsafeIndex();
  var traverseWithIndex2 = /* @__PURE__ */ traverseWithIndex(traversableWithIndexArray)(applicativeEffect);
  var mod2 = /* @__PURE__ */ mod(euclideanRingInt);
  var union4 = /* @__PURE__ */ union2(ordString);
  var map35 = /* @__PURE__ */ map(functorArray);
  var insert7 = /* @__PURE__ */ insert(ordString);
  var join2 = /* @__PURE__ */ join(bindArray);
  var stringToElementType = function(v) {
    if (v === "circle") {
      return Circle2.value;
    }
    ;
    if (v === "rect") {
      return Rect2.value;
    }
    ;
    if (v === "path") {
      return Path3.value;
    }
    ;
    if (v === "line") {
      return Line2.value;
    }
    ;
    if (v === "text") {
      return Text3.value;
    }
    ;
    if (v === "g") {
      return Group2.value;
    }
    ;
    if (v === "svg") {
      return SVG.value;
    }
    ;
    if (v === "div") {
      return Div2.value;
    }
    ;
    if (v === "span") {
      return Span2.value;
    }
    ;
    if (v === "table") {
      return Table2.value;
    }
    ;
    if (v === "tr") {
      return Tr2.value;
    }
    ;
    if (v === "td") {
      return Td2.value;
    }
    ;
    if (v === "th") {
      return Th.value;
    }
    ;
    if (v === "tbody") {
      return Tbody.value;
    }
    ;
    if (v === "thead") {
      return Thead.value;
    }
    ;
    return Group2.value;
  };
  var select5 = function(dictMonadEffect) {
    var liftEffect121 = liftEffect(dictMonadEffect);
    return function(selector) {
      return liftEffect121(function __do3() {
        var htmlDoc = bind8(windowImpl)(document2)();
        var doc = toDocument(htmlDoc);
        var parentNode3 = toParentNode2(htmlDoc);
        var maybeElement = querySelector(selector)(parentNode3)();
        if (maybeElement instanceof Nothing) {
          return new EmptySelection({
            parentElements: [],
            document: doc
          });
        }
        ;
        if (maybeElement instanceof Just) {
          return new EmptySelection({
            parentElements: [maybeElement.value0],
            document: doc
          });
        }
        ;
        throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 88, column 3 - line 96, column 8): " + [maybeElement.constructor.name]);
      });
    };
  };
  var reselect = function(name16) {
    return function(selectionsMap) {
      return function __do3() {
        var doc = mapFlipped5(bind8(windowImpl)(document2))(toDocument)();
        var v = lookup9(name16)(selectionsMap);
        if (v instanceof Just) {
          var elements = (function() {
            if (v.value0 instanceof BoundSelection) {
              return v.value0.value0.elements;
            }
            ;
            if (v.value0 instanceof EmptySelection) {
              return v.value0.value0.parentElements;
            }
            ;
            throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1644, column 36 - line 1646, column 49): " + [v.value0.constructor.name]);
          })();
          return new EmptySelection({
            parentElements: elements,
            document: doc
          });
        }
        ;
        if (v instanceof Nothing) {
          return new EmptySelection({
            parentElements: [],
            document: doc
          });
        }
        ;
        throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1639, column 3 - line 1657, column 10): " + [v.constructor.name]);
      };
    };
  };
  var remove4 = function(dictMonadEffect) {
    var liftEffect121 = liftEffect(dictMonadEffect);
    return function(v) {
      return liftEffect121((function() {
        var v1 = (function() {
          if (v instanceof ExitingSelection) {
            return v.value0;
          }
          ;
          throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 268, column 36 - line 269, column 32): " + [v.constructor.name]);
        })();
        return traverse_4(function(element3) {
          var node = toNode(element3);
          return function __do3() {
            var maybeParent = parentNode2(node)();
            if (maybeParent instanceof Just) {
              return removeChild2(node)(maybeParent.value0)();
            }
            ;
            if (maybeParent instanceof Nothing) {
              return unit;
            }
            ;
            throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 273, column 5 - line 275, column 27): " + [maybeParent.constructor.name]);
          };
        })(v1.elements);
      })());
    };
  };
  var remove1 = /* @__PURE__ */ remove4(monadEffectEffect);
  var querySelectorAllElements = function(selector) {
    return function(parents) {
      return function __do3() {
        var nodeArrays = traverse3(function(parent2) {
          var parentNode3 = toParentNode(parent2);
          return function __do4() {
            var nodeList = querySelectorAll(selector)(parentNode3)();
            var nodes = toArray3(nodeList)();
            return mapMaybe(fromNode)(nodes);
          };
        })(parents)();
        return concat(nodeArrays);
      };
    };
  };
  var on3 = function(behavior) {
    return function(v) {
      var getElements = function(v1) {
        if (v1 instanceof EmptySelection) {
          return v1.value0.parentElements;
        }
        ;
        if (v1 instanceof BoundSelection) {
          return v1.value0.elements;
        }
        ;
        if (v1 instanceof PendingSelection) {
          return v1.value0.parentElements;
        }
        ;
        if (v1 instanceof ExitingSelection) {
          return v1.value0.elements;
        }
        ;
        throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 777, column 5 - line 777, column 61): " + [v1.constructor.name]);
      };
      var applyBehavior = function(v1) {
        return function(v2) {
          if (v1 instanceof Zoom2) {
            return $$void7(attachZoom_(v2)(v1.value0.scaleExtent.value0)(v1.value0.scaleExtent.value1)(v1.value0.targetSelector));
          }
          ;
          if (v1 instanceof Drag2 && v1.value0 instanceof SimpleDrag) {
            return $$void7(attachSimpleDrag_(v2)(unit));
          }
          ;
          if (v1 instanceof Drag2 && v1.value0 instanceof SimulationDrag) {
            return pure9(unit);
          }
          ;
          if (v1 instanceof Click) {
            return $$void7(attachClick_(v2)(v1.value0));
          }
          ;
          if (v1 instanceof ClickWithDatum) {
            return $$void7(attachClickWithDatum_(v2)(v1.value0));
          }
          ;
          if (v1 instanceof MouseEnter2) {
            return $$void7(attachMouseEnter_(v2)(v1.value0));
          }
          ;
          if (v1 instanceof MouseLeave2) {
            return $$void7(attachMouseLeave_(v2)(v1.value0));
          }
          ;
          if (v1 instanceof Highlight) {
            return $$void7(attachHighlight_(v2)(v1.value0.enter)(v1.value0.leave));
          }
          ;
          if (v1 instanceof MouseMoveWithInfo) {
            return $$void7(attachMouseMoveWithEvent_(v2)(function(d18, evt) {
              return v1.value0({
                datum: d18,
                clientX: toNumber(clientX(evt)),
                clientY: toNumber(clientY(evt)),
                pageX: toNumber(pageX(evt)),
                pageY: toNumber(pageY(evt)),
                offsetX: offsetX(evt),
                offsetY: offsetY(evt)
              })();
            }));
          }
          ;
          if (v1 instanceof MouseEnterWithInfo) {
            return $$void7(attachMouseEnterWithEvent_(v2)(function(d18, evt) {
              return v1.value0({
                datum: d18,
                clientX: toNumber(clientX(evt)),
                clientY: toNumber(clientY(evt)),
                pageX: toNumber(pageX(evt)),
                pageY: toNumber(pageY(evt)),
                offsetX: offsetX(evt),
                offsetY: offsetY(evt)
              })();
            }));
          }
          ;
          if (v1 instanceof MouseLeaveWithInfo) {
            return $$void7(attachMouseLeaveWithEvent_(v2)(function(d18, evt) {
              return v1.value0({
                datum: d18,
                clientX: toNumber(clientX(evt)),
                clientY: toNumber(clientY(evt)),
                pageX: toNumber(pageX(evt)),
                pageY: toNumber(pageY(evt)),
                offsetX: offsetX(evt),
                offsetY: offsetY(evt)
              })();
            }));
          }
          ;
          throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 784, column 5 - line 784, column 62): " + [v1.constructor.name, v2.constructor.name]);
        };
      };
      var elements = getElements(v);
      return function __do3() {
        traverse_4(applyBehavior(behavior))(elements)();
        return v;
      };
    };
  };
  var merge2 = function(dictMonadEffect) {
    var pure128 = pure(dictMonadEffect.Monad0().Applicative0());
    return function(v) {
      return function(v1) {
        var v2 = (function() {
          if (v instanceof BoundSelection) {
            return v.value0;
          }
          ;
          throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 421, column 70 - line 422, column 30): " + [v.constructor.name]);
        })();
        var v3 = (function() {
          if (v1 instanceof BoundSelection) {
            return v1.value0;
          }
          ;
          throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 423, column 55 - line 424, column 30): " + [v1.constructor.name]);
        })();
        return pure128(new BoundSelection({
          elements: append14(v2.elements)(v3.elements),
          data: append14(v2.data)(v3.data),
          indices: Nothing.value,
          document: v2.document
        }));
      };
    };
  };
  var joinDataWithKey2 = function(dictMonadEffect) {
    var liftEffect121 = liftEffect(dictMonadEffect);
    return function(dictFoldable) {
      var fromFoldable57 = fromFoldable(dictFoldable);
      return function(dictEq) {
        var computeJoinWithKey2 = computeJoinWithKey(dictEq);
        return function(foldableData) {
          return function(keyFn) {
            return function(selector) {
              return function(v) {
                return liftEffect121((function() {
                  var v1 = (function() {
                    if (v instanceof EmptySelection) {
                      return v.value0;
                    }
                    ;
                    throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 538, column 57 - line 539, column 30): " + [v.constructor.name]);
                  })();
                  return function __do3() {
                    var existingElements = querySelectorAllElements(selector)(v1.parentElements)();
                    var oldBindings = traverse3(function(element3) {
                      return function __do4() {
                        var nullableDatum = getElementData_(element3)();
                        var maybeDatum = toMaybe(nullableDatum);
                        return {
                          element: element3,
                          datum: maybeDatum
                        };
                      };
                    })(existingElements)();
                    liftEffect3(log4("joinDataWithKey: found " + (show13(length(existingElements)) + (" existing elements with selector '" + (selector + "'")))))();
                    liftEffect3(log4("joinDataWithKey: " + (show13(length(mapMaybe(function(v2) {
                      return v2.datum;
                    })(oldBindings))) + " of those have data bound")))();
                    var validOldBindings = mapMaybe(function(v2) {
                      return mapFlipped1(v2.datum)(function(d18) {
                        return {
                          element: v2.element,
                          datum: d18
                        };
                      });
                    })(oldBindings);
                    var newDataArray = fromFoldable57(foldableData);
                    var joinSets = computeJoinWithKey2(newDataArray)(validOldBindings)(keyFn);
                    var sortedEnter = sortBy(function(a2) {
                      return function(b10) {
                        return compare7(a2.newIndex)(b10.newIndex);
                      };
                    })(joinSets.enter);
                    var enterSelection = new PendingSelection({
                      parentElements: v1.parentElements,
                      pendingData: mapFlipped22(sortedEnter)(function(v2) {
                        return v2.datum;
                      }),
                      indices: new Just(mapFlipped22(sortedEnter)(function(v2) {
                        return v2.newIndex;
                      })),
                      document: v1.document
                    });
                    var sortedUpdate = sortBy(function(a2) {
                      return function(b10) {
                        return compare7(a2.newIndex)(b10.newIndex);
                      };
                    })(joinSets.update);
                    var updateSelection = new BoundSelection({
                      elements: mapFlipped22(sortedUpdate)(function(v2) {
                        return v2.element;
                      }),
                      data: mapFlipped22(sortedUpdate)(function(v2) {
                        return v2.newDatum;
                      }),
                      indices: new Just(mapFlipped22(sortedUpdate)(function(v2) {
                        return v2.newIndex;
                      })),
                      document: v1.document
                    });
                    var exitSelection = new ExitingSelection({
                      elements: mapFlipped22(joinSets.exit)(function(v2) {
                        return v2.element;
                      }),
                      data: mapFlipped22(joinSets.exit)(function(v2) {
                        return v2.datum;
                      }),
                      document: v1.document
                    });
                    return new JoinResult({
                      enter: enterSelection,
                      update: updateSelection,
                      exit: exitSelection
                    });
                  };
                })());
              };
            };
          };
        };
      };
    };
  };
  var joinData3 = function(dictMonadEffect) {
    var liftEffect121 = liftEffect(dictMonadEffect);
    return function(dictFoldable) {
      var fromFoldable57 = fromFoldable(dictFoldable);
      return function(dictOrd) {
        var computeJoin2 = computeJoin(dictOrd.Eq0());
        return function(foldableData) {
          return function(selector) {
            return function(v) {
              return liftEffect121((function() {
                var v1 = (function() {
                  if (v instanceof EmptySelection) {
                    return v.value0;
                  }
                  ;
                  throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 454, column 57 - line 455, column 30): " + [v.constructor.name]);
                })();
                return function __do3() {
                  var existingElements = querySelectorAllElements(selector)(v1.parentElements)();
                  var oldBindings = traverse3(function(element3) {
                    return function __do4() {
                      var nullableDatum = getElementData_(element3)();
                      var maybeDatum = toMaybe(nullableDatum);
                      return {
                        element: element3,
                        datum: maybeDatum
                      };
                    };
                  })(existingElements)();
                  liftEffect3(log4("joinData: found " + (show13(length(existingElements)) + (" existing elements with selector '" + (selector + "'")))))();
                  liftEffect3(log4("joinData: " + (show13(length(mapMaybe(function(v2) {
                    return v2.datum;
                  })(oldBindings))) + " of those have data bound")))();
                  var validOldBindings = mapMaybe(function(v2) {
                    return mapFlipped1(v2.datum)(function(d18) {
                      return {
                        element: v2.element,
                        datum: d18
                      };
                    });
                  })(oldBindings);
                  var newDataArray = fromFoldable57(foldableData);
                  var joinSets = computeJoin2(newDataArray)(validOldBindings);
                  var sortedEnter = sortBy(function(a2) {
                    return function(b10) {
                      return compare7(a2.newIndex)(b10.newIndex);
                    };
                  })(joinSets.enter);
                  var enterSelection = new PendingSelection({
                    parentElements: v1.parentElements,
                    pendingData: mapFlipped22(sortedEnter)(function(v2) {
                      return v2.datum;
                    }),
                    indices: new Just(mapFlipped22(sortedEnter)(function(v2) {
                      return v2.newIndex;
                    })),
                    document: v1.document
                  });
                  var sortedUpdate = sortBy(function(a2) {
                    return function(b10) {
                      return compare7(a2.newIndex)(b10.newIndex);
                    };
                  })(joinSets.update);
                  var updateSelection = new BoundSelection({
                    elements: mapFlipped22(sortedUpdate)(function(v2) {
                      return v2.element;
                    }),
                    data: mapFlipped22(sortedUpdate)(function(v2) {
                      return v2.newDatum;
                    }),
                    indices: new Just(mapFlipped22(sortedUpdate)(function(v2) {
                      return v2.newIndex;
                    })),
                    document: v1.document
                  });
                  var exitSelection = new ExitingSelection({
                    elements: mapFlipped22(joinSets.exit)(function(v2) {
                      return v2.element;
                    }),
                    data: mapFlipped22(joinSets.exit)(function(v2) {
                      return v2.datum;
                    }),
                    document: v1.document
                  });
                  return new JoinResult({
                    enter: enterSelection,
                    update: updateSelection,
                    exit: exitSelection
                  });
                };
              })());
            };
          };
        };
      };
    };
  };
  var joinData1 = /* @__PURE__ */ joinData3(monadEffectEffect)(foldableArray);
  var getSimulationHandle = function($624) {
    return toMaybe(getSimulationHandle_($624));
  };
  var onWithSimulation = function(behavior) {
    return function(simState) {
      return function(v) {
        var getElements = function(v1) {
          if (v1 instanceof EmptySelection) {
            return v1.value0.parentElements;
          }
          ;
          if (v1 instanceof BoundSelection) {
            return v1.value0.elements;
          }
          ;
          if (v1 instanceof PendingSelection) {
            return v1.value0.parentElements;
          }
          ;
          if (v1 instanceof ExitingSelection) {
            return v1.value0.elements;
          }
          ;
          throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 858, column 5 - line 858, column 61): " + [v1.constructor.name]);
        };
        var applyBehaviorWithSim = function(v1) {
          return function(v2) {
            return function(v3) {
              if (v1 instanceof Zoom2) {
                return $$void7(attachZoom_(v3)(v1.value0.scaleExtent.value0)(v1.value0.scaleExtent.value1)(v1.value0.targetSelector));
              }
              ;
              if (v1 instanceof Drag2 && v1.value0 instanceof SimpleDrag) {
                return $$void7(attachSimpleDrag_(v3)(unit));
              }
              ;
              if (v1 instanceof Drag2 && v1.value0 instanceof SimulationDrag) {
                var simHandle = getSimulationHandle(v2);
                return $$void7(attachSimulationDrag_(v3)(toNullable(simHandle))(v1.value0.value0));
              }
              ;
              if (v1 instanceof Click) {
                return $$void7(attachClick_(v3)(v1.value0));
              }
              ;
              if (v1 instanceof ClickWithDatum) {
                return $$void7(attachClickWithDatum_(v3)(v1.value0));
              }
              ;
              if (v1 instanceof MouseEnter2) {
                return $$void7(attachMouseEnter_(v3)(v1.value0));
              }
              ;
              if (v1 instanceof MouseLeave2) {
                return $$void7(attachMouseLeave_(v3)(v1.value0));
              }
              ;
              if (v1 instanceof Highlight) {
                return $$void7(attachHighlight_(v3)(v1.value0.enter)(v1.value0.leave));
              }
              ;
              if (v1 instanceof MouseMoveWithInfo) {
                return $$void7(attachMouseMoveWithEvent_(v3)(function(d18, evt) {
                  return v1.value0({
                    datum: d18,
                    clientX: toNumber(clientX(evt)),
                    clientY: toNumber(clientY(evt)),
                    pageX: toNumber(pageX(evt)),
                    pageY: toNumber(pageY(evt)),
                    offsetX: offsetX(evt),
                    offsetY: offsetY(evt)
                  })();
                }));
              }
              ;
              if (v1 instanceof MouseEnterWithInfo) {
                return $$void7(attachMouseEnterWithEvent_(v3)(function(d18, evt) {
                  return v1.value0({
                    datum: d18,
                    clientX: toNumber(clientX(evt)),
                    clientY: toNumber(clientY(evt)),
                    pageX: toNumber(pageX(evt)),
                    pageY: toNumber(pageY(evt)),
                    offsetX: offsetX(evt),
                    offsetY: offsetY(evt)
                  })();
                }));
              }
              ;
              if (v1 instanceof MouseLeaveWithInfo) {
                return $$void7(attachMouseLeaveWithEvent_(v3)(function(d18, evt) {
                  return v1.value0({
                    datum: d18,
                    clientX: toNumber(clientX(evt)),
                    clientY: toNumber(clientY(evt)),
                    pageX: toNumber(pageX(evt)),
                    pageY: toNumber(pageY(evt)),
                    offsetX: offsetX(evt),
                    offsetY: offsetY(evt)
                  })();
                }));
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 865, column 5 - line 865, column 93): " + [v1.constructor.name, v2.constructor.name, v3.constructor.name]);
            };
          };
        };
        var elements = getElements(v);
        return function __do3() {
          traverse_4(applyBehaviorWithSim(behavior)(simState))(elements)();
          return v;
        };
      };
    };
  };
  var getDocument = function(v) {
    if (v instanceof EmptySelection) {
      return pure9(v.value0.document);
    }
    ;
    if (v instanceof BoundSelection) {
      return pure9(v.value0.document);
    }
    ;
    if (v instanceof PendingSelection) {
      return pure9(v.value0.document);
    }
    ;
    if (v instanceof ExitingSelection) {
      return pure9(v.value0.document);
    }
    ;
    throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 721, column 1 - line 721, column 82): " + [v.constructor.name]);
  };
  var selectAll = function(dictMonadEffect) {
    var liftEffect121 = liftEffect(dictMonadEffect);
    return function(selector) {
      return function(v) {
        return liftEffect121(function __do3() {
          var doc = getDocument(v)();
          var elements = (function() {
            if (v instanceof EmptySelection) {
              return querySelectorAllElements(selector)(v.value0.parentElements)();
            }
            ;
            if (v instanceof BoundSelection) {
              return querySelectorAllElements(selector)(v.value0.elements)();
            }
            ;
            if (v instanceof PendingSelection) {
              return querySelectorAllElements(selector)(v.value0.parentElements)();
            }
            ;
            if (v instanceof ExitingSelection) {
              return querySelectorAllElements(selector)(v.value0.elements)();
            }
            ;
            throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 117, column 15 - line 125, column 50): " + [v.constructor.name]);
          })();
          return new EmptySelection({
            parentElements: elements,
            document: doc
          });
        });
      };
    };
  };
  var elementTypeToString = function(v) {
    if (v instanceof Circle2) {
      return "circle";
    }
    ;
    if (v instanceof Rect2) {
      return "rect";
    }
    ;
    if (v instanceof Path3) {
      return "path";
    }
    ;
    if (v instanceof Line2) {
      return "line";
    }
    ;
    if (v instanceof Text3) {
      return "text";
    }
    ;
    if (v instanceof Group2) {
      return "g";
    }
    ;
    if (v instanceof SVG) {
      return "svg";
    }
    ;
    if (v instanceof Div2) {
      return "div";
    }
    ;
    if (v instanceof Span2) {
      return "span";
    }
    ;
    if (v instanceof Table2) {
      return "table";
    }
    ;
    if (v instanceof Tr2) {
      return "tr";
    }
    ;
    if (v instanceof Td2) {
      return "td";
    }
    ;
    if (v instanceof Th) {
      return "th";
    }
    ;
    if (v instanceof Tbody) {
      return "tbody";
    }
    ;
    if (v instanceof Thead) {
      return "thead";
    }
    ;
    throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 949, column 1 - line 949, column 45): " + [v.constructor.name]);
  };
  var createElementWithNS = function(elemType) {
    return function(doc) {
      var v = elementContext(elemType);
      if (v instanceof SVGContext) {
        return createElementNS(new Just("http://www.w3.org/2000/svg"))(elementTypeToString(elemType))(doc);
      }
      ;
      if (v instanceof HTMLContext) {
        return createElement2(elementTypeToString(elemType))(doc);
      }
      ;
      throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 731, column 3 - line 737, column 64): " + [v.constructor.name]);
    };
  };
  var clear2 = function(dictMonadEffect) {
    var liftEffect121 = liftEffect(dictMonadEffect);
    return function(selector) {
      return liftEffect121(clearElement_(selector));
    };
  };
  var attributeValueToString = function(v) {
    if (v instanceof StringValue) {
      return v.value0;
    }
    ;
    if (v instanceof NumberValue) {
      return show14(v.value0);
    }
    ;
    if (v instanceof BooleanValue) {
      return show22(v.value0);
    }
    ;
    throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 944, column 1 - line 944, column 51): " + [v.constructor.name]);
  };
  var applyAttributes = function(element3) {
    return function(datum2) {
      return function(index5) {
        return function(attrs) {
          return traverse_4(function(attr3) {
            if (attr3 instanceof StaticAttr) {
              var $350 = attr3.value0 === "textContent";
              if ($350) {
                return setTextContent_(attributeValueToString(attr3.value1))(element3);
              }
              ;
              return setAttribute2(attr3.value0)(attributeValueToString(attr3.value1))(element3);
            }
            ;
            if (attr3 instanceof DataAttr) {
              var val = attributeValueToString(attr3.value1(datum2));
              var $353 = attr3.value0 === "textContent";
              if ($353) {
                return setTextContent_(val)(element3);
              }
              ;
              return setAttribute2(attr3.value0)(val)(element3);
            }
            ;
            if (attr3 instanceof IndexedAttr) {
              var val = attributeValueToString(attr3.value1(datum2)(index5));
              var $356 = attr3.value0 === "textContent";
              if ($356) {
                return setTextContent_(val)(element3);
              }
              ;
              return setAttribute2(attr3.value0)(val)(element3);
            }
            ;
            throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 926, column 30 - line 942, column 54): " + [attr3.constructor.name]);
          })(attrs);
        };
      };
    };
  };
  var applyPerDatumAttrs = function(dictMonadEffect) {
    var liftEffect121 = liftEffect(dictMonadEffect);
    return function(mkAttrs) {
      return function(v) {
        return liftEffect121((function() {
          if (v instanceof BoundSelection) {
            var paired = zipWith(Tuple.create)(v.value0.data)(v.value0.elements);
            return function __do3() {
              traverseWithIndex_2(function(index5) {
                return function(v1) {
                  var attrs = mkAttrs(v1.value0);
                  return applyAttributes(v1.value1)(v1.value0)(index5)(attrs);
                };
              })(paired)();
              return v;
            };
          }
          ;
          return pure9(v);
        })());
      };
    };
  };
  var setAttrs2 = function(dictMonadEffect) {
    var liftEffect121 = liftEffect(dictMonadEffect);
    return function(attrs) {
      return function(v) {
        return liftEffect121((function() {
          var v1 = (function() {
            if (v instanceof BoundSelection) {
              return v.value0;
            }
            ;
            throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 207, column 78 - line 208, column 30): " + [v.constructor.name]);
          })();
          var paired = zipWith(Tuple.create)(v1.data)(v1.elements);
          return function __do3() {
            traverseWithIndex_2(function(arrayIndex) {
              return function(v2) {
                var logicalIndex = (function() {
                  if (v1.indices instanceof Just) {
                    return unsafeIndex3(v1.indices.value0)(arrayIndex);
                  }
                  ;
                  if (v1.indices instanceof Nothing) {
                    return arrayIndex;
                  }
                  ;
                  throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 212, column 24 - line 214, column 32): " + [v1.indices.constructor.name]);
                })();
                return applyAttributes(v2.value1)(v2.value0)(logicalIndex)(attrs);
              };
            })(paired)();
            return new BoundSelection({
              elements: v1.elements,
              data: v1.data,
              indices: v1.indices,
              document: v1.document
            });
          };
        })());
      };
    };
  };
  var setAttrs1 = /* @__PURE__ */ setAttrs2(monadEffectEffect);
  var setAttrsExit2 = function(dictMonadEffect) {
    var liftEffect121 = liftEffect(dictMonadEffect);
    return function(attrs) {
      return function(v) {
        return liftEffect121((function() {
          var v1 = (function() {
            if (v instanceof ExitingSelection) {
              return v.value0;
            }
            ;
            throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 240, column 69 - line 241, column 32): " + [v.constructor.name]);
          })();
          var paired = zipWith(Tuple.create)(v1.data)(v1.elements);
          return function __do3() {
            traverseWithIndex_2(function(index5) {
              return function(v2) {
                return applyAttributes(v2.value1)(v2.value0)(index5)(attrs);
              };
            })(paired)();
            return new ExitingSelection({
              elements: v1.elements,
              data: v1.data,
              document: v1.document
            });
          };
        })());
      };
    };
  };
  var setAttrsExit1 = /* @__PURE__ */ setAttrsExit2(monadEffectEffect);
  var updateElementFromTree = function(element3) {
    return function(datum2) {
      return function(index5) {
        return function(tree3) {
          return function(doc) {
            return function __do3() {
              setElementData_(datum2)(element3)();
              if (tree3 instanceof Node3) {
                return applyAttributes(element3)(datum2)(index5)(tree3.value0.attrs)();
              }
              ;
              return unit;
            };
          };
        };
      };
    };
  };
  var renderTemplatesForBoundSelection = function(dictOrd) {
    return function(templateFn) {
      return function(boundSel) {
        var v = (function() {
          if (boundSel instanceof BoundSelection) {
            return boundSel.value0;
          }
          ;
          throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1466, column 68 - line 1467, column 34): " + [boundSel.constructor.name]);
        })();
        return traverseWithIndex2(function(idx) {
          return function(datum2) {
            var v1 = index(v.elements)(idx);
            if (v1 instanceof Nothing) {
              return unsafeCrashWith("renderTemplatesForBoundSelection: index out of bounds");
            }
            ;
            if (v1 instanceof Just) {
              var tree3 = templateFn(datum2);
              var elementSel = new BoundSelection({
                elements: [v1.value0],
                data: [datum2],
                indices: new Just([idx]),
                document: v.document
              });
              return function __do3() {
                updateElementFromTree(v1.value0)(datum2)(idx)(tree3)(v.document)();
                return new Tuple(v1.value0, empty3);
              };
            }
            ;
            throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1471, column 5 - line 1494, column 39): " + [v1.constructor.name]);
          };
        })(v.data);
      };
    };
  };
  var appendChildInheriting2 = function(dictMonadEffect) {
    var liftEffect121 = liftEffect(dictMonadEffect);
    return function(elemType) {
      return function(attrs) {
        return function(v) {
          return liftEffect121((function() {
            var v1 = (function() {
              if (v instanceof BoundSelection) {
                return v.value0;
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 375, column 84 - line 376, column 30): " + [v.constructor.name]);
            })();
            return function __do3() {
              var childElements = traverseWithIndex2(function(idx) {
                return function(v2) {
                  return function __do4() {
                    var child = createElementWithNS(elemType)(v1.document)();
                    setElementData_(v2.value1)(child)();
                    applyAttributes(child)(v2.value1)(idx)(attrs)();
                    var childNode = toNode(child);
                    var parentNode3 = toNode(v2.value0);
                    appendChild2(childNode)(parentNode3)();
                    return child;
                  };
                };
              })(zipWith(Tuple.create)(v1.elements)(v1.data))();
              return new BoundSelection({
                elements: childElements,
                data: v1.data,
                indices: Nothing.value,
                document: v1.document
              });
            };
          })());
        };
      };
    };
  };
  var appendChild3 = function(dictMonadEffect) {
    var liftEffect121 = liftEffect(dictMonadEffect);
    return function(elemType) {
      return function(attrs) {
        return function(v) {
          return liftEffect121((function() {
            var v1 = (function() {
              if (v instanceof EmptySelection) {
                return v.value0;
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 320, column 57 - line 321, column 30): " + [v.constructor.name]);
            })();
            return function __do3() {
              var elements = traverse3(function(parent2) {
                return function __do4() {
                  var element3 = createElementWithNS(elemType)(v1.document)();
                  applyAttributes(element3)(unit)(0)(attrs)();
                  var elementNode = toNode(element3);
                  var parentNode3 = toNode(parent2);
                  appendChild2(elementNode)(parentNode3)();
                  return element3;
                };
              })(v1.parentElements)();
              return new EmptySelection({
                parentElements: elements,
                document: v1.document
              });
            };
          })());
        };
      };
    };
  };
  var appendChild1 = /* @__PURE__ */ appendChild3(monadEffectEffect);
  var renderTemplatesForPendingSelection = function(dictOrd) {
    return function(templateFn) {
      return function(pendingSel) {
        var v = (function() {
          if (pendingSel instanceof PendingSelection) {
            return pendingSel.value0;
          }
          ;
          throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1421, column 70 - line 1422, column 36): " + [pendingSel.constructor.name]);
        })();
        return traverseWithIndex2(function(idx) {
          return function(datum2) {
            var parentIdx = mod2(idx)(length(v.parentElements));
            var v1 = index(v.parentElements)(parentIdx);
            if (v1 instanceof Nothing) {
              return unsafeCrashWith("renderTemplatesForPendingSelection: no parent elements");
            }
            ;
            if (v1 instanceof Just) {
              var tree3 = templateFn(datum2);
              var singleParentSel = new EmptySelection({
                parentElements: [v1.value0],
                document: v.document
              });
              return function __do3() {
                var v2 = renderNodeHelper(dictOrd)(singleParentSel)(tree3)();
                setElementData_(datum2)(v2.value0)();
                return new Tuple(v2.value0, v2.value1);
              };
            }
            ;
            throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1429, column 5 - line 1448, column 45): " + [v1.constructor.name]);
          };
        })(v.pendingData);
      };
    };
  };
  var renderNodeHelper = function(dictOrd) {
    var joinData23 = joinData1(dictOrd);
    var renderTemplatesForBoundSelection1 = renderTemplatesForBoundSelection(dictOrd);
    return function(v) {
      return function(v1) {
        if (v1 instanceof Node3) {
          return function __do3() {
            var childSel = appendChild1(v1.value0.elemType)(v1.value0.attrs)(v)();
            var element3 = (function() {
              if (childSel instanceof EmptySelection) {
                var v2 = head(childSel.value0.parentElements);
                if (v2 instanceof Just) {
                  return v2.value0;
                }
                ;
                if (v2 instanceof Nothing) {
                  return unsafeCrashWith("renderTree: appendChild returned empty selection");
                }
                ;
                throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1007, column 31 - line 1009, column 104): " + [v2.constructor.name]);
              }
              ;
              return unsafeCrashWith("renderTree: appendChild should return EmptySelection");
            })();
            var childMaps = traverse3(renderNodeHelper(dictOrd)(childSel))(v1.value0.children)();
            var combinedChildMap = foldl2(union4)(empty3)(map35(snd)(childMaps));
            var selectionsMap = (function() {
              if (v1.value0.name instanceof Just) {
                return insert7(v1.value0.name.value0)(childSel)(combinedChildMap);
              }
              ;
              if (v1.value0.name instanceof Nothing) {
                return combinedChildMap;
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1017, column 23 - line 1019, column 36): " + [v1.value0.name.constructor.name]);
            })();
            return new Tuple(element3, selectionsMap);
          };
        }
        ;
        if (v1 instanceof Join2) {
          return function __do3() {
            var v2 = joinData23(v1.value0.joinData)(v1.value0.key)(v)();
            liftEffect3((function() {
              var enterCount = (function() {
                if (v2.value0.enter instanceof PendingSelection) {
                  return length(v2.value0.enter.value0.pendingData);
                }
                ;
                return 0;
              })();
              var updateCount = (function() {
                if (v2.value0.update instanceof BoundSelection) {
                  return length(v2.value0.update.value0.data);
                }
                ;
                return 0;
              })();
              var exitCount = (function() {
                if (v2.value0.exit instanceof BoundSelection) {
                  return length(v2.value0.exit.value0.data);
                }
                ;
                if (v2.value0.exit instanceof ExitingSelection) {
                  return length(v2.value0.exit.value0.data);
                }
                ;
                return 0;
              })();
              return log4("Tree API Join '" + (v1.value0.name + ("': enter=" + (show13(enterCount) + (", update=" + (show13(updateCount) + (", exit=" + show13(exitCount))))))));
            })())();
            remove1(v2.value0.exit)();
            var enterElementsAndMaps = renderTemplatesForPendingSelection(dictOrd)(v1.value0.template)(v2.value0.enter)();
            var enterElements = map35(fst)(enterElementsAndMaps);
            var enterChildMaps = map35(snd)(enterElementsAndMaps);
            var updateElementsAndMaps = renderTemplatesForBoundSelection1(v1.value0.template)(v2.value0.update)();
            var updateElements = map35(fst)(updateElementsAndMaps);
            var updateChildMaps = map35(snd)(updateElementsAndMaps);
            var allElements = append14(enterElements)(updateElements);
            var allChildMaps = append14(enterChildMaps)(updateChildMaps);
            var combinedChildMap = foldl2(union4)(empty3)(allChildMaps);
            var doc = (function() {
              if (v2.value0.enter instanceof PendingSelection) {
                return v2.value0.enter.value0.document;
              }
              ;
              if (v2.value0.update instanceof BoundSelection) {
                return v2.value0.update.value0.document;
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1075, column 14 - line 1076, column 45): " + [v2.value0.update.constructor.name]);
            })();
            var allData = (function() {
              if (v2.value0.enter instanceof PendingSelection) {
                return v2.value0.enter.value0.pendingData;
              }
              ;
              return [];
            })();
            var updateData = (function() {
              if (v2.value0.update instanceof BoundSelection) {
                return v2.value0.update.value0.data;
              }
              ;
              return [];
            })();
            var boundSel = new BoundSelection({
              elements: allElements,
              data: append14(allData)(updateData),
              indices: new Just(range2(0)(length(allElements) - 1 | 0)),
              document: doc
            });
            var selectionsMap = insert7(v1.value0.name)(boundSel)(combinedChildMap);
            var firstElement = (function() {
              var v3 = head(allElements);
              if (v3 instanceof Just) {
                return v3.value0;
              }
              ;
              if (v3 instanceof Nothing) {
                return unsafeCrashWith("renderTree Join: no elements created");
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1098, column 22 - line 1100, column 90): " + [v3.constructor.name]);
            })();
            return new Tuple(firstElement, selectionsMap);
          };
        }
        ;
        if (v1 instanceof NestedJoin) {
          return function __do3() {
            var v2 = joinData23(v1.value0.joinData)(v1.value0.key)(v)();
            var elementsAndMaps = renderNestedTemplatesForPendingSelection(dictOrd)(v1.value0.decompose)(v1.value0.template)(stringToElementType(v1.value0.key))(v2.value0.enter)();
            var elements = map35(fst)(elementsAndMaps);
            var childMaps = map35(snd)(elementsAndMaps);
            var combinedChildMap = foldl2(union4)(empty3)(childMaps);
            var v3 = (function() {
              if (v2.value0.enter instanceof PendingSelection) {
                return v2.value0.enter.value0;
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1123, column 54 - line 1124, column 36): " + [v2.value0.enter.constructor.name]);
            })();
            var boundSel = new BoundSelection({
              elements,
              data: v3.pendingData,
              indices: new Just(range2(0)(length(elements) - 1 | 0)),
              document: v3.document
            });
            var selectionsMap = insert7(v1.value0.name)(boundSel)(combinedChildMap);
            var firstElement = (function() {
              var v4 = head(elements);
              if (v4 instanceof Just) {
                return v4.value0;
              }
              ;
              if (v4 instanceof Nothing) {
                return unsafeCrashWith("renderTree NestedJoin: no elements created");
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1138, column 22 - line 1140, column 96): " + [v4.constructor.name]);
            })();
            return new Tuple(firstElement, selectionsMap);
          };
        }
        ;
        if (v1 instanceof SceneJoin) {
          return function __do3() {
            var v2 = joinData23(v1.value0.joinData)(v1.value0.key)(v)();
            liftEffect3((function() {
              var enterCount = (function() {
                if (v2.value0.enter instanceof PendingSelection) {
                  return length(v2.value0.enter.value0.pendingData);
                }
                ;
                return 0;
              })();
              var updateCount = (function() {
                if (v2.value0.update instanceof BoundSelection) {
                  return length(v2.value0.update.value0.data);
                }
                ;
                return 0;
              })();
              var exitCount = (function() {
                if (v2.value0.exit instanceof BoundSelection) {
                  return length(v2.value0.exit.value0.data);
                }
                ;
                if (v2.value0.exit instanceof ExitingSelection) {
                  return length(v2.value0.exit.value0.data);
                }
                ;
                return 0;
              })();
              return log4("Tree API SceneJoin '" + (v1.value0.name + ("': enter=" + (show13(enterCount) + (", update=" + (show13(updateCount) + (", exit=" + show13(exitCount))))))));
            })())();
            (function() {
              if (v1.value0.exitBehavior instanceof Just) {
                setAttrsExit1(v1.value0.exitBehavior.value0.attrs)(v2.value0.exit)();
                remove1(v2.value0.exit)();
                return unit;
              }
              ;
              if (v1.value0.exitBehavior instanceof Nothing) {
                remove1(v2.value0.exit)();
                return unit;
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1168, column 3 - line 1179, column 16): " + [v1.value0.exitBehavior.constructor.name]);
            })();
            var enterElementsAndMaps = (function() {
              if (v1.value0.enterBehavior instanceof Just) {
                var modifiedTemplate = function(datum2) {
                  var v3 = v1.value0.template(datum2);
                  if (v3 instanceof Node3) {
                    return new Node3({
                      name: v3.value0.name,
                      elemType: v3.value0.elemType,
                      children: v3.value0.children,
                      attrs: append14(v1.value0.enterBehavior.value0.initialAttrs)(v3.value0.attrs)
                    });
                  }
                  ;
                  return v3;
                };
                var rendered = renderTemplatesForPendingSelection(dictOrd)(modifiedTemplate)(v2.value0.enter)();
                return rendered;
              }
              ;
              if (v1.value0.enterBehavior instanceof Nothing) {
                return renderTemplatesForPendingSelection(dictOrd)(v1.value0.template)(v2.value0.enter)();
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1182, column 27 - line 1199, column 68): " + [v1.value0.enterBehavior.constructor.name]);
            })();
            var enterElements = map35(fst)(enterElementsAndMaps);
            var enterChildMaps = map35(snd)(enterElementsAndMaps);
            var updateElementsAndMaps = (function() {
              if (v1.value0.updateBehavior instanceof Just) {
                setAttrs1(v1.value0.updateBehavior.value0.attrs)(v2.value0.update)();
                return renderTemplatesForBoundSelection1(v1.value0.template)(v2.value0.update)();
              }
              ;
              if (v1.value0.updateBehavior instanceof Nothing) {
                return renderTemplatesForBoundSelection1(v1.value0.template)(v2.value0.update)();
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1205, column 28 - line 1216, column 67): " + [v1.value0.updateBehavior.constructor.name]);
            })();
            var updateElements = map35(fst)(updateElementsAndMaps);
            var updateChildMaps = map35(snd)(updateElementsAndMaps);
            var allElements = append14(enterElements)(updateElements);
            var allChildMaps = append14(enterChildMaps)(updateChildMaps);
            var combinedChildMap = foldl2(union4)(empty3)(allChildMaps);
            var doc = (function() {
              if (v2.value0.enter instanceof PendingSelection) {
                return v2.value0.enter.value0.document;
              }
              ;
              if (v2.value0.update instanceof BoundSelection) {
                return v2.value0.update.value0.document;
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1232, column 14 - line 1233, column 45): " + [v2.value0.update.constructor.name]);
            })();
            var allData = (function() {
              if (v2.value0.enter instanceof PendingSelection) {
                return v2.value0.enter.value0.pendingData;
              }
              ;
              return [];
            })();
            var updateData = (function() {
              if (v2.value0.update instanceof BoundSelection) {
                return v2.value0.update.value0.data;
              }
              ;
              return [];
            })();
            var boundSel = new BoundSelection({
              elements: allElements,
              data: append14(allData)(updateData),
              indices: new Just(range2(0)(length(allElements) - 1 | 0)),
              document: doc
            });
            var selectionsMap = insert7(v1.value0.name)(boundSel)(combinedChildMap);
            var firstElement = (function() {
              var v3 = head(allElements);
              if (v3 instanceof Just) {
                return v3.value0;
              }
              ;
              if (v3 instanceof Nothing) {
                return unsafeCrashWith("renderTree SceneJoin: no elements created");
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1254, column 22 - line 1256, column 95): " + [v3.constructor.name]);
            })();
            return new Tuple(firstElement, selectionsMap);
          };
        }
        ;
        if (v1 instanceof SceneNestedJoin) {
          var innerData = join2(map35(v1.value0.decompose)(v1.value0.joinData));
          return function __do3() {
            var v2 = joinData23(innerData)(v1.value0.key)(v)();
            liftEffect3((function() {
              var enterCount = (function() {
                if (v2.value0.enter instanceof PendingSelection) {
                  return length(v2.value0.enter.value0.pendingData);
                }
                ;
                return 0;
              })();
              var updateCount = (function() {
                if (v2.value0.update instanceof BoundSelection) {
                  return length(v2.value0.update.value0.data);
                }
                ;
                return 0;
              })();
              var exitCount = (function() {
                if (v2.value0.exit instanceof BoundSelection) {
                  return length(v2.value0.exit.value0.data);
                }
                ;
                if (v2.value0.exit instanceof ExitingSelection) {
                  return length(v2.value0.exit.value0.data);
                }
                ;
                return 0;
              })();
              return log4("Tree API SceneNestedJoin '" + (v1.value0.name + ("': enter=" + (show13(enterCount) + (", update=" + (show13(updateCount) + (", exit=" + show13(exitCount))))))));
            })())();
            (function() {
              if (v1.value0.exitBehavior instanceof Just) {
                setAttrsExit1(v1.value0.exitBehavior.value0.attrs)(v2.value0.exit)();
                remove1(v2.value0.exit)();
                return unit;
              }
              ;
              if (v1.value0.exitBehavior instanceof Nothing) {
                remove1(v2.value0.exit)();
                return unit;
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1291, column 3 - line 1299, column 16): " + [v1.value0.exitBehavior.constructor.name]);
            })();
            var enterElementsAndMaps = (function() {
              if (v1.value0.enterBehavior instanceof Just) {
                var modifiedTemplate = function(datum2) {
                  var v3 = v1.value0.template(datum2);
                  if (v3 instanceof Node3) {
                    return new Node3({
                      name: v3.value0.name,
                      elemType: v3.value0.elemType,
                      children: v3.value0.children,
                      attrs: append14(v1.value0.enterBehavior.value0.initialAttrs)(v3.value0.attrs)
                    });
                  }
                  ;
                  return v3;
                };
                var rendered = renderTemplatesForPendingSelection(dictOrd)(modifiedTemplate)(v2.value0.enter)();
                return rendered;
              }
              ;
              if (v1.value0.enterBehavior instanceof Nothing) {
                return renderTemplatesForPendingSelection(dictOrd)(v1.value0.template)(v2.value0.enter)();
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1302, column 27 - line 1311, column 92): " + [v1.value0.enterBehavior.constructor.name]);
            })();
            var updateElementsAndMaps = (function() {
              if (v1.value0.updateBehavior instanceof Just) {
                setAttrs1(v1.value0.updateBehavior.value0.attrs)(v2.value0.update)();
                return renderTemplatesForBoundSelection1(v1.value0.template)(v2.value0.update)();
              }
              ;
              if (v1.value0.updateBehavior instanceof Nothing) {
                return renderTemplatesForBoundSelection1(v1.value0.template)(v2.value0.update)();
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1314, column 28 - line 1319, column 91): " + [v1.value0.updateBehavior.constructor.name]);
            })();
            var updateElements = map35(fst)(updateElementsAndMaps);
            var enterElements = map35(fst)(enterElementsAndMaps);
            var allElements = append14(enterElements)(updateElements);
            var updateChildMaps = map35(snd)(updateElementsAndMaps);
            var enterChildMaps = map35(snd)(enterElementsAndMaps);
            var allChildMaps = append14(enterChildMaps)(updateChildMaps);
            var combinedChildMap = foldl2(union4)(empty3)(allChildMaps);
            var doc = (function() {
              if (v2.value0.enter instanceof PendingSelection) {
                return v2.value0.enter.value0.document;
              }
              ;
              if (v2.value0.update instanceof BoundSelection) {
                return v2.value0.update.value0.document;
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1337, column 14 - line 1338, column 45): " + [v2.value0.update.constructor.name]);
            })();
            var boundSel = new BoundSelection({
              elements: allElements,
              data: innerData,
              indices: new Just(range2(0)(length(allElements) - 1 | 0)),
              document: doc
            });
            var selectionsMap = insert7(v1.value0.name)(boundSel)(combinedChildMap);
            var firstElement = (function() {
              var v5 = head(allElements);
              if (v5 instanceof Just) {
                return v5.value0;
              }
              ;
              if (v5 instanceof Nothing) {
                return unsafeCrashWith("renderTree SceneNestedJoin: no elements created");
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1350, column 22 - line 1352, column 101): " + [v5.constructor.name]);
            })();
            return new Tuple(firstElement, selectionsMap);
          };
        }
        ;
        throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 994, column 1 - line 999, column 74): " + [v.constructor.name, v1.constructor.name]);
      };
    };
  };
  var renderNestedTemplatesForPendingSelection = function(dictOrd) {
    return function(decomposer) {
      return function(templateFn) {
        return function(wrapperType) {
          return function(pendingSel) {
            var v = (function() {
              if (pendingSel instanceof PendingSelection) {
                return pendingSel.value0;
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1372, column 70 - line 1373, column 36): " + [pendingSel.constructor.name]);
            })();
            return traverseWithIndex2(function(idx) {
              return function(outerDatum) {
                var parentIdx = mod2(idx)(length(v.parentElements));
                var v1 = index(v.parentElements)(parentIdx);
                if (v1 instanceof Nothing) {
                  return unsafeCrashWith("renderNestedTemplatesForPendingSelection: no parent elements");
                }
                ;
                if (v1 instanceof Just) {
                  return function __do3() {
                    var wrapperElement = createElementWithNS(wrapperType)(v.document)();
                    var wrapperNode = toNode(wrapperElement);
                    var parentNode3 = toNode(v1.value0);
                    appendChild2(wrapperNode)(parentNode3)();
                    var innerDataArray = decomposer(outerDatum);
                    var innerMaps = traverse3(function(innerDatum) {
                      var tree3 = templateFn(innerDatum);
                      var singleParentSel = new EmptySelection({
                        parentElements: [wrapperElement],
                        document: v.document
                      });
                      return function __do4() {
                        var v2 = renderNodeHelper(dictOrd)(singleParentSel)(tree3)();
                        return v2.value1;
                      };
                    })(innerDataArray)();
                    var combinedInnerMap = foldl2(union4)(empty3)(innerMaps);
                    return new Tuple(wrapperElement, combinedInnerMap);
                  };
                }
                ;
                throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 1377, column 5 - line 1403, column 53): " + [v1.constructor.name]);
              };
            })(v.pendingData);
          };
        };
      };
    };
  };
  var renderTree2 = function(dictOrd) {
    var renderNodeHelper1 = renderNodeHelper(dictOrd);
    return function(parent2) {
      return function(tree3) {
        return function __do3() {
          var v = renderNodeHelper1(parent2)(tree3)();
          return v.value1;
        };
      };
    };
  };
  var append15 = function(dictMonadEffect) {
    var liftEffect121 = liftEffect(dictMonadEffect);
    return function(elemType) {
      return function(attrs) {
        return function(v) {
          return liftEffect121((function() {
            var v1 = (function() {
              if (v instanceof PendingSelection) {
                return v.value0;
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 154, column 79 - line 155, column 32): " + [v.constructor.name]);
            })();
            var parent2 = (function() {
              var v2 = head(v1.parentElements);
              if (v2 instanceof Just) {
                return v2.value0;
              }
              ;
              if (v2 instanceof Nothing) {
                return unsafeIndex3(v1.parentElements)(0);
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 159, column 16 - line 161, column 70): " + [v2.constructor.name]);
            })();
            return function __do3() {
              var elements = traverseWithIndex2(function(arrayIndex) {
                return function(datum2) {
                  var logicalIndex = (function() {
                    if (v1.indices instanceof Just) {
                      return unsafeIndex3(v1.indices.value0)(arrayIndex);
                    }
                    ;
                    if (v1.indices instanceof Nothing) {
                      return arrayIndex;
                    }
                    ;
                    throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 165, column 24 - line 167, column 32): " + [v1.indices.constructor.name]);
                  })();
                  return function __do4() {
                    var element3 = createElementWithNS(elemType)(v1.document)();
                    applyAttributes(element3)(datum2)(logicalIndex)(attrs)();
                    setElementData_(datum2)(element3)();
                    var elementNode = toNode(element3);
                    var parentNode3 = toNode(parent2);
                    appendChild2(elementNode)(parentNode3)();
                    return element3;
                  };
                };
              })(v1.pendingData)();
              return new BoundSelection({
                elements,
                data: v1.pendingData,
                indices: v1.indices,
                document: v1.document
              });
            };
          })());
        };
      };
    };
  };
  var append32 = /* @__PURE__ */ append15(monadEffectEffect);
  var appendData = function(dictMonadEffect) {
    var liftEffect121 = liftEffect(dictMonadEffect);
    return function(dictFoldable) {
      var fromFoldable57 = fromFoldable(dictFoldable);
      return function(elemType) {
        return function(foldableData) {
          return function(attrs) {
            return function(emptySelection) {
              return liftEffect121((function() {
                var v = (function() {
                  if (emptySelection instanceof EmptySelection) {
                    return emptySelection.value0;
                  }
                  ;
                  throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 678, column 57 - line 679, column 30): " + [emptySelection.constructor.name]);
                })();
                var dataArray = fromFoldable57(foldableData);
                var pendingSelection = new PendingSelection({
                  parentElements: v.parentElements,
                  pendingData: dataArray,
                  indices: new Just(range2(0)(length(dataArray) - 1 | 0)),
                  document: v.document
                });
                return append32(elemType)(attrs)(pendingSelection);
              })());
            };
          };
        };
      };
    };
  };
  var renderData = function(dictMonadEffect) {
    var Monad0 = dictMonadEffect.Monad0();
    var Bind1 = Monad0.Bind1();
    var bind139 = bind(Bind1);
    var joinData23 = joinData3(dictMonadEffect);
    var append42 = append15(dictMonadEffect);
    var pure128 = pure(Monad0.Applicative0());
    var applyPerDatumAttrs1 = applyPerDatumAttrs(dictMonadEffect);
    var discard215 = discard7(Bind1);
    var remove22 = remove4(dictMonadEffect);
    var merge1 = merge2(dictMonadEffect);
    return function(dictFoldable) {
      var joinData32 = joinData23(dictFoldable);
      return function(dictOrd) {
        var joinData42 = joinData32(dictOrd);
        return function(elemType) {
          return function(foldableData) {
            return function(selector) {
              return function(emptySelection) {
                return function(enterAttrs) {
                  return function(updateAttrs) {
                    return function(exitAttrs) {
                      return bind139(joinData42(foldableData)(selector)(emptySelection))(function(v) {
                        return bind139(bind139(append42(elemType)([])(v.value0.enter))(function(bound) {
                          if (enterAttrs instanceof Nothing) {
                            return pure128(bound);
                          }
                          ;
                          if (enterAttrs instanceof Just) {
                            return applyPerDatumAttrs1(enterAttrs.value0)(bound);
                          }
                          ;
                          throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 632, column 5 - line 634, column 55): " + [enterAttrs.constructor.name]);
                        }))(function(enterBound) {
                          return bind139((function() {
                            if (updateAttrs instanceof Nothing) {
                              return pure128(v.value0.update);
                            }
                            ;
                            if (updateAttrs instanceof Just) {
                              return applyPerDatumAttrs1(updateAttrs.value0)(v.value0.update);
                            }
                            ;
                            throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 637, column 18 - line 639, column 54): " + [updateAttrs.constructor.name]);
                          })())(function(updateBound) {
                            return discard215((function() {
                              if (exitAttrs instanceof Nothing) {
                                return remove22(v.value0.exit);
                              }
                              ;
                              if (exitAttrs instanceof Just) {
                                return bind139(applyPerDatumAttrs1(exitAttrs.value0)(v.value0.exit))(function() {
                                  return remove22(v.value0.exit);
                                });
                              }
                              ;
                              throw new Error("Failed pattern match at PSD3v2.Selection.Operations (line 642, column 3 - line 646, column 18): " + [exitAttrs.constructor.name]);
                            })())(function() {
                              return merge1(enterBound)(updateBound);
                            });
                          });
                        });
                      });
                    };
                  };
                };
              };
            };
          };
        };
      };
    };
  };

  // output/PSD3v2.Simulation.Update/index.js
  var foldl10 = /* @__PURE__ */ foldl(foldableArray);
  var log5 = /* @__PURE__ */ log3(monadEffectEffect);
  var show15 = /* @__PURE__ */ show(showInt);
  var discard8 = /* @__PURE__ */ discard(discardUnit);
  var show16 = /* @__PURE__ */ show(showBoolean);
  var getUpdateData = function(sel) {
    if (sel instanceof BoundSelection) {
      return sel.value0.data;
    }
    ;
    return [];
  };
  var getExitData = function(sel) {
    if (sel instanceof ExitingSelection) {
      return sel.value0.data;
    }
    ;
    return [];
  };
  var getEnterData = function(sel) {
    if (sel instanceof PendingSelection) {
      return sel.value0.pendingData;
    }
    ;
    return [];
  };
  var genericUpdateSimulation = function(dictMonadEffect) {
    var Monad0 = dictMonadEffect.Monad0();
    var Bind1 = Monad0.Bind1();
    var bind87 = bind(Bind1);
    var liftEffect51 = liftEffect(dictMonadEffect);
    var discard120 = discard8(Bind1);
    var pure91 = pure(Monad0.Applicative0());
    return function(dictSelectionM) {
      var joinData6 = joinData(dictSelectionM)(foldableArray);
      var merge6 = merge(dictSelectionM);
      var joinDataWithKey6 = joinDataWithKey(dictSelectionM)(foldableArray)(ordString);
      return function(dictSimulationM2) {
        var update7 = update3(dictSimulationM2);
        var addTickFunction9 = addTickFunction(dictSimulationM2.SimulationM1());
        return function(dictOrd) {
          var joinData13 = joinData6(dictOrd);
          return function(dictOrd1) {
            return function(dictEq) {
              var elem8 = elem2(dictEq);
              return function(dictShow) {
                var show213 = show(showArray(dictShow));
                var show310 = show(dictShow);
                return function(dictOrd2) {
                  return function(v) {
                    return function(nodeElement) {
                      return function(linkElement) {
                        return function(config) {
                          return function(nodeKeyFn) {
                            return function(linkKeyFn) {
                              return function(attrs) {
                                return function(callbacks) {
                                  var filteredNodes = filter(config.nodeFilter)(config.allNodes);
                                  var initializedNodes = foldl10(function(nodes) {
                                    return function(fn) {
                                      return fn(nodes);
                                    };
                                  })(filteredNodes)(config.nodeInitializers);
                                  var nodeIDs = getIDsFromNodes_(initializedNodes)(nodeKeyFn);
                                  return bind87(liftEffect51(log5("\u{1F517} DEBUG: initialized nodes count: " + show15(length(initializedNodes)))))(function() {
                                    return bind87(liftEffect51(log5("\u{1F517} DEBUG: nodeIDs array length: " + show15(length(nodeIDs)))))(function() {
                                      return bind87(liftEffect51(log5("\u{1F517} DEBUG: first 5 nodeIDs: " + show213(take(5)(nodeIDs)))))(function() {
                                        var firstLink = head(config.allLinks);
                                        return discard120((function() {
                                          if (firstLink instanceof Nothing) {
                                            return pure91(unit);
                                          }
                                          ;
                                          if (firstLink instanceof Just) {
                                            var linkIDs = getLinkIDs_(firstLink.value0);
                                            return bind87(liftEffect51(log5("\u{1F517} DEBUG: first link source: " + (show310(linkIDs.sourceID) + (", target: " + show310(linkIDs.targetID))))))(function() {
                                              return bind87(liftEffect51(log5("\u{1F517} DEBUG: source in nodeIDs: " + show16(elem8(linkIDs.sourceID)(nodeIDs)))))(function() {
                                                return bind87(liftEffect51(log5("\u{1F517} DEBUG: target in nodeIDs: " + show16(elem8(linkIDs.targetID)(nodeIDs)))))(function() {
                                                  return pure91(unit);
                                                });
                                              });
                                            });
                                          }
                                          ;
                                          throw new Error("Failed pattern match at PSD3v2.Simulation.Update (line 202, column 3 - line 209, column 16): " + [firstLink.constructor.name]);
                                        })())(function() {
                                          var validLink = function(link4) {
                                            var linkIDs = getLinkIDs_(link4);
                                            return elem8(linkIDs.sourceID)(nodeIDs) && elem8(linkIDs.targetID)(nodeIDs);
                                          };
                                          var structurallyFilteredLinks = filter(validLink)(config.allLinks);
                                          return bind87(liftEffect51(log5("\u{1F517} genericUpdateSimulation: " + (show15(length(config.allLinks)) + " total links"))))(function() {
                                            return bind87(liftEffect51(log5("\u{1F517} genericUpdateSimulation: " + (show15(length(structurallyFilteredLinks)) + " links after structural filter"))))(function() {
                                              var finalLinks = (function() {
                                                if (config.linkFilter instanceof Nothing) {
                                                  return structurallyFilteredLinks;
                                                }
                                                ;
                                                if (config.linkFilter instanceof Just) {
                                                  return filter(config.linkFilter.value0)(structurallyFilteredLinks);
                                                }
                                                ;
                                                throw new Error("Failed pattern match at PSD3v2.Simulation.Update (line 223, column 20 - line 225, column 75): " + [config.linkFilter.constructor.name]);
                                              })();
                                              return bind87(liftEffect51(log5("\u{1F517} genericUpdateSimulation: " + (show15(length(finalLinks)) + " links after visual filter"))))(function() {
                                                var internalUpdateConfig = {
                                                  nodes: new Just(initializedNodes),
                                                  links: new Just(finalLinks),
                                                  nodeFilter: Nothing.value,
                                                  linkFilter: Nothing.value,
                                                  activeForces: config.activeForces,
                                                  config: config.config,
                                                  keyFn: nodeKeyFn
                                                };
                                                return bind87(update7(internalUpdateConfig))(function(enhanced) {
                                                  var swizzledLinks = swizzleLinks_(finalLinks)(enhanced.nodes)(nodeKeyFn);
                                                  var nodeSelector = elementTypeToString(nodeElement);
                                                  return bind87(liftEffect51(log5("\u{1F50D} genericUpdateSimulation: joining nodes with selector '" + (nodeSelector + "'"))))(function() {
                                                    return bind87(liftEffect51(log5("\u{1F50D} genericUpdateSimulation: " + (show15(length(enhanced.nodes)) + " nodes in data"))))(function() {
                                                      return bind87(joinData13(enhanced.nodes)(nodeSelector)(v.nodes))(function(v1) {
                                                        return bind87(liftEffect51(log5("\u{1F50D} genericUpdateSimulation: join result - enter: " + (show15(length(getEnterData(v1.value0.enter))) + (", update: " + (show15(length(getUpdateData(v1.value0.update))) + (", exit: " + show15(length(getExitData(v1.value0.exit))))))))))(function() {
                                                          return bind87(callbacks.onNodeEnter(v1.value0.enter)(attrs))(function(nodeEnter) {
                                                            return discard120(callbacks.onNodeUpdate(v1.value0.update)(attrs))(function() {
                                                              return discard120(callbacks.onNodeExit(v1.value0.exit))(function() {
                                                                return bind87(merge6(nodeEnter)(v1.value0.update))(function(mergedNodes) {
                                                                  return bind87(liftEffect51(log5("\u{1F517} genericUpdateSimulation: " + (show15(length(swizzledLinks)) + " links to join"))))(function() {
                                                                    return bind87(joinDataWithKey6(swizzledLinks)(swizzledLinkKey_)(elementTypeToString(linkElement))(v.links))(function(v2) {
                                                                      return bind87(liftEffect51(log5("\u{1F517} genericUpdateSimulation: link join result - enter: " + (show15(length(getEnterData(v2.value0.enter))) + (", update: " + (show15(length(getUpdateData(v2.value0.update))) + (", exit: " + show15(length(getExitData(v2.value0.exit))))))))))(function() {
                                                                        return bind87(callbacks.onLinkEnter(v2.value0.enter)(attrs))(function(linkEnter) {
                                                                          return discard120(callbacks.onLinkUpdate(v2.value0.update)(attrs))(function() {
                                                                            return discard120(callbacks.onLinkExit(v2.value0.exit))(function() {
                                                                              return bind87(merge6(linkEnter)(v2.value0.update))(function(mergedLinks) {
                                                                                return discard120(addTickFunction9("nodes")(new Step4(mergedNodes, callbacks.nodeTickAttrs(attrs))))(function() {
                                                                                  return discard120(addTickFunction9("links")(new Step4(mergedLinks, callbacks.linkTickAttrs)))(function() {
                                                                                    return pure91(unit);
                                                                                  });
                                                                                });
                                                                              });
                                                                            });
                                                                          });
                                                                        });
                                                                      });
                                                                    });
                                                                  });
                                                                });
                                                              });
                                                            });
                                                          });
                                                        });
                                                      });
                                                    });
                                                  });
                                                });
                                              });
                                            });
                                          });
                                        });
                                      });
                                    });
                                  });
                                };
                              };
                            };
                          };
                        };
                      };
                    };
                  };
                };
              };
            };
          };
        };
      };
    };
  };

  // output/Component.CodeExplorerV2.Draw/index.js
  var map36 = /* @__PURE__ */ map(functorArray);
  var eq4 = /* @__PURE__ */ eq(eqLinkType);
  var fromFoldable25 = /* @__PURE__ */ fromFoldable8(foldableArray)(ordString);
  var discard9 = /* @__PURE__ */ discard(discardUnit);
  var show17 = /* @__PURE__ */ show(showInt);
  var show18 = /* @__PURE__ */ show(/* @__PURE__ */ showArray(showInt));
  var show23 = /* @__PURE__ */ show(/* @__PURE__ */ showArray(/* @__PURE__ */ showRecord()()(/* @__PURE__ */ showRecordFieldsCons({
    reflectSymbol: function() {
      return "s";
    }
  })(/* @__PURE__ */ showRecordFieldsConsNil({
    reflectSymbol: function() {
      return "t";
    }
  })(showInt))(showInt))));
  var class_5 = /* @__PURE__ */ class_2(toAttrStringString);
  var ordRecord2 = /* @__PURE__ */ ordRecord();
  var ordRecordCons2 = /* @__PURE__ */ ordRecordCons(ordRecordNil)();
  var ordRecordCons1 = /* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons2({
    reflectSymbol: function() {
      return "y";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "x";
    }
  })(ordNumber);
  var ordNullable2 = /* @__PURE__ */ ordNullable(/* @__PURE__ */ ordRecord2(ordRecordCons1));
  var ordArray2 = /* @__PURE__ */ ordArray(ordInt);
  var ordNullable1 = /* @__PURE__ */ ordNullable(ordNumber);
  var ordRecord1 = /* @__PURE__ */ ordRecord2(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordCons1)()({
    reflectSymbol: function() {
      return "vy";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "vx";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "treeXY";
    }
  })(ordNullable2))()({
    reflectSymbol: function() {
      return "treeDepth";
    }
  })(/* @__PURE__ */ ordNullable(ordInt)))()({
    reflectSymbol: function() {
      return "showChildren";
    }
  })(ordBoolean))()({
    reflectSymbol: function() {
      return "r";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "nodetype";
    }
  })(ordNodeType))()({
    reflectSymbol: function() {
      return "name";
    }
  })(ordString))()({
    reflectSymbol: function() {
      return "loc";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "links";
    }
  })(/* @__PURE__ */ ordRecord2(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons2({
    reflectSymbol: function() {
      return "treeChildren";
    }
  })(ordArray2))()({
    reflectSymbol: function() {
      return "targets";
    }
  })(ordArray2))()({
    reflectSymbol: function() {
      return "sources";
    }
  })(ordArray2))()({
    reflectSymbol: function() {
      return "outPackage";
    }
  })(ordArray2))()({
    reflectSymbol: function() {
      return "inPackage";
    }
  })(ordArray2))()({
    reflectSymbol: function() {
      return "contains";
    }
  })(ordArray2))))()({
    reflectSymbol: function() {
      return "inSim";
    }
  })(ordBoolean))()({
    reflectSymbol: function() {
      return "id";
    }
  })(ordInt))()({
    reflectSymbol: function() {
      return "gridXY";
    }
  })(ordNullable2))()({
    reflectSymbol: function() {
      return "fy";
    }
  })(ordNullable1))()({
    reflectSymbol: function() {
      return "fx";
    }
  })(ordNullable1))()({
    reflectSymbol: function() {
      return "focusY";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "focusX";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "containsMany";
    }
  })(ordBoolean))()({
    reflectSymbol: function() {
      return "containerName";
    }
  })(ordString))()({
    reflectSymbol: function() {
      return "containerID";
    }
  })(ordInt))()({
    reflectSymbol: function() {
      return "connected";
    }
  })(ordBoolean))()({
    reflectSymbol: function() {
      return "cluster";
    }
  })(ordInt));
  var treePositionInitializer = function(nodes) {
    var positionByTree = function(n) {
      var v = toMaybe(n.treeXY);
      if (v instanceof Nothing) {
        return n;
      }
      ;
      if (v instanceof Just) {
        return {
          treeXY: n.treeXY,
          cluster: n.cluster,
          connected: n.connected,
          containerID: n.containerID,
          containerName: n.containerName,
          containsMany: n.containsMany,
          focusX: n.focusX,
          focusY: n.focusY,
          gridXY: n.gridXY,
          id: n.id,
          inSim: n.inSim,
          links: n.links,
          loc: n.loc,
          name: n.name,
          nodetype: n.nodetype,
          r: n.r,
          showChildren: n.showChildren,
          treeDepth: n.treeDepth,
          vx: n.vx,
          vy: n.vy,
          x: v.value0.x,
          y: v.value0.y,
          fx: notNull(v.value0.x),
          fy: notNull(v.value0.y)
        };
      }
      ;
      throw new Error("Failed pattern match at Component.CodeExplorerV2.Draw (line 194, column 24 - line 196, column 103): " + [v.constructor.name]);
    };
    return map36(positionByTree)(nodes);
  };
  var getSceneConfig = function(model) {
    return function(unswizzledLinks) {
      return function(scene) {
        if (scene instanceof PackageGraph) {
          return {
            allNodes: model.nodes,
            allLinks: unswizzledLinks,
            nodeFilter: isPackage,
            linkFilter: new Just(function(l) {
              return eq4(l.linktype)(P2P.value);
            }),
            nodeInitializers: [packagesNodesToPhyllotaxis],
            activeForces: new Just(fromFoldable25(["charge", "collision", "center", "links"])),
            config: Nothing.value
          };
        }
        ;
        if (scene instanceof HorizontalTree) {
          return {
            allNodes: model.nodes,
            allLinks: unswizzledLinks,
            nodeFilter: isUsedModule,
            linkFilter: new Just(function(l) {
              return eq4(l.linktype)(M2M_Tree.value);
            }),
            nodeInitializers: [treePositionInitializer],
            activeForces: new Just(fromFoldable25(["collision"])),
            config: Nothing.value
          };
        }
        ;
        throw new Error("Failed pattern match at Component.CodeExplorerV2.Draw (line 169, column 46 - line 188, column 6): " + [scene.constructor.name]);
      };
    };
  };
  var initialize2 = function(dictBind) {
    var discard120 = discard9(dictBind);
    var bind87 = bind(dictBind);
    return function(dictMonadEffect) {
      var log9 = log3(dictMonadEffect);
      var liftEffect51 = liftEffect(dictMonadEffect);
      var genericUpdateSimulation3 = genericUpdateSimulation(dictMonadEffect);
      var spagoRenderCallbacks2 = spagoRenderCallbacks(dictMonadEffect.Monad0());
      return function(dictSelectionM) {
        var select44 = select4(dictSelectionM);
        var appendChild5 = appendChild(dictSelectionM);
        var on14 = on2(dictSelectionM);
        var genericUpdateSimulation1 = genericUpdateSimulation3(dictSelectionM);
        var spagoRenderCallbacks1 = spagoRenderCallbacks2(dictSelectionM);
        return function(dictSimulationM2) {
          var SimulationM1 = dictSimulationM2.SimulationM1();
          var init13 = init4(SimulationM1);
          var genericUpdateSimulation22 = genericUpdateSimulation1(dictSimulationM2)(ordRecord1)(ordInt)(eqInt)(showInt)(ordIndex_);
          var start13 = start3(SimulationM1);
          return function(forcesArray) {
            return function(activeForces2) {
              return function(model) {
                return function(unswizzledLinks) {
                  return function(selector) {
                    return function(initialScene2) {
                      return discard120(log9("CodeExplorerV2.Draw: Initializing"))(function() {
                        var packageNodes = filter(isPackage)(model.nodes);
                        var packageIDs = map36(function(v) {
                          return v.id;
                        })(packageNodes);
                        var allP2PLinks = filter(function(l) {
                          return eq4(l.linktype)(P2P.value);
                        })(unswizzledLinks);
                        return discard120(log9("DEBUG: Total links: " + show17(length(unswizzledLinks))))(function() {
                          return discard120(log9("DEBUG: P2P links: " + show17(length(allP2PLinks))))(function() {
                            return discard120(log9("DEBUG: Package nodes: " + show17(length(packageNodes))))(function() {
                              return discard120(log9("DEBUG: First 5 package IDs: " + show18(take(5)(packageIDs))))(function() {
                                return discard120(log9("DEBUG: First 5 P2P links (source->target): " + show23(map36(function(l) {
                                  return {
                                    s: l.source,
                                    t: l.target
                                  };
                                })(take(5)(allP2PLinks)))))(function() {
                                  return bind87(liftEffect51(getWindowWidthHeight))(function(v) {
                                    return bind87(select44(selector))(function(root3) {
                                      return bind87(appendChild5(SVG.value)(svgAttrs(v.value0)(v.value1))(root3))(function(svg2) {
                                        return bind87(appendChild5(Group2.value)([])(svg2))(function(inner) {
                                          return bind87(on14(new Drag2(defaultDrag))(inner))(function() {
                                            return bind87(on14(new Zoom2(defaultZoom(new ScaleExtent2(0.1, 4))("g")))(svg2))(function() {
                                              return bind87(appendChild5(Group2.value)([class_5("links")])(inner))(function(linksGroup) {
                                                return bind87(appendChild5(Group2.value)([class_5("nodes")])(inner))(function(nodesGroup) {
                                                  return bind87(init13({
                                                    nodes: model.nodes,
                                                    links: model.links,
                                                    forces: forcesArray,
                                                    activeForces: activeForces2,
                                                    config: {
                                                      alpha: 1,
                                                      alphaTarget: 0,
                                                      alphaMin: 1e-3,
                                                      alphaDecay: 0.0228,
                                                      velocityDecay: 0.4
                                                    },
                                                    keyFn: function(n) {
                                                      return n.id;
                                                    },
                                                    ticks: empty3
                                                  }))(function() {
                                                    var sceneConfig = getSceneConfig(model)(unswizzledLinks)(initialScene2);
                                                    return discard120(genericUpdateSimulation22({
                                                      nodes: nodesGroup,
                                                      links: linksGroup
                                                    })(Group2.value)(Path3.value)(sceneConfig)(function(n) {
                                                      return n.id;
                                                    })(keyIsID_)(graphSceneAttributes)(spagoRenderCallbacks1))(function() {
                                                      return discard120(start13)(function() {
                                                        return log9("CodeExplorerV2.Draw: Initialization complete");
                                                      });
                                                    });
                                                  });
                                                });
                                              });
                                            });
                                          });
                                        });
                                      });
                                    });
                                  });
                                });
                              });
                            });
                          });
                        });
                      });
                    };
                  };
                };
              };
            };
          };
        };
      };
    };
  };
  var updateScene = function(dictBind) {
    var discard120 = discard9(dictBind);
    var bind87 = bind(dictBind);
    return function(dictMonadEffect) {
      var log9 = log3(dictMonadEffect);
      var genericUpdateSimulation3 = genericUpdateSimulation(dictMonadEffect);
      var spagoRenderCallbacks2 = spagoRenderCallbacks(dictMonadEffect.Monad0());
      return function(dictSelectionM) {
        var select44 = select4(dictSelectionM);
        var genericUpdateSimulation1 = genericUpdateSimulation3(dictSelectionM);
        var spagoRenderCallbacks1 = spagoRenderCallbacks2(dictSelectionM);
        return function(dictSimulationM2) {
          var genericUpdateSimulation22 = genericUpdateSimulation1(dictSimulationM2)(ordRecord1)(ordInt)(eqInt)(showInt)(ordIndex_);
          var start13 = start3(dictSimulationM2.SimulationM1());
          return function(model) {
            return function(links) {
              return function(targetScene) {
                return function(_activeForces) {
                  return discard120(log9("CodeExplorerV2.Draw: Updating to scene"))(function() {
                    return bind87(select44("g.nodes"))(function(nodesGroup) {
                      return bind87(select44("g.links"))(function(linksGroup) {
                        var sceneConfig = getSceneConfig(model)(links)(targetScene);
                        var attrs = (function() {
                          if (targetScene instanceof PackageGraph) {
                            return graphSceneAttributes;
                          }
                          ;
                          if (targetScene instanceof HorizontalTree) {
                            return treeSceneAttributes;
                          }
                          ;
                          throw new Error("Failed pattern match at Component.CodeExplorerV2.Draw (line 146, column 15 - line 148, column 46): " + [targetScene.constructor.name]);
                        })();
                        return discard120(genericUpdateSimulation22({
                          nodes: nodesGroup,
                          links: linksGroup
                        })(Group2.value)(Path3.value)(sceneConfig)(function(n) {
                          return n.id;
                        })(keyIsID_)(attrs)(spagoRenderCallbacks1))(function() {
                          return start13;
                        });
                      });
                    });
                  });
                };
              };
            };
          };
        };
      };
    };
  };

  // output/PSD3.Data.Graph.Algorithms/index.js
  var bind9 = /* @__PURE__ */ bind(bindMaybe);
  var map37 = /* @__PURE__ */ map(functorArray);
  var member3 = /* @__PURE__ */ member2(ordInt);
  var mapFlipped6 = /* @__PURE__ */ mapFlipped(functorArray);
  var append16 = /* @__PURE__ */ append(semigroupArray);
  var append17 = /* @__PURE__ */ append(/* @__PURE__ */ semigroupSet(ordInt));
  var fromFoldable26 = /* @__PURE__ */ fromFoldable8(foldableArray)(ordInt);
  var getReachableNodes = function(config) {
    return function(rootId) {
      return function(graph) {
        var processNextPath = function(state3) {
          return bind9(uncons(state3.openPaths))(function(x47) {
            return bind9(head(x47.head))(function(currentId) {
              var links = getLinksFrom(currentId)(graph);
              var targetIds = map37(config.getLinkTarget)(links);
              var newTargets = partition(function(targetId) {
                return !member3(targetId)(state3.nodes);
              })(targetIds);
              var prunedEdges = mapFlipped6(newTargets.no)(function(targetId) {
                return new Tuple(currentId, targetId);
              });
              var newPaths = mapFlipped6(newTargets.yes)(function(targetId) {
                return cons(targetId)(x47.head);
              });
              var $29 = $$null(newPaths);
              if ($29) {
                return new Just({
                  nodes: state3.nodes,
                  spanningTree: state3.spanningTree,
                  openPaths: x47.tail,
                  paths: cons(x47.head)(state3.paths),
                  redundantEdges: append16(state3.redundantEdges)(prunedEdges)
                });
              }
              ;
              return new Just({
                paths: state3.paths,
                openPaths: append16(x47.tail)(newPaths),
                nodes: append17(state3.nodes)(fromFoldable26(newTargets.yes)),
                spanningTree: append16(state3.spanningTree)(map37(function(targetId) {
                  return new Tuple(currentId, targetId);
                })(newTargets.yes)),
                redundantEdges: append16(state3.redundantEdges)(prunedEdges)
              });
            });
          });
        };
        var go2 = function($copy_state) {
          var $tco_done = false;
          var $tco_result;
          function $tco_loop(state3) {
            if ($$null(state3.openPaths)) {
              $tco_done = true;
              return state3;
            }
            ;
            if (otherwise) {
              var v = processNextPath(state3);
              if (v instanceof Nothing) {
                $tco_done = true;
                return state3;
              }
              ;
              if (v instanceof Just) {
                $copy_state = v.value0;
                return;
              }
              ;
              throw new Error("Failed pattern match at PSD3.Data.Graph.Algorithms (line 69, column 21 - line 71, column 35): " + [v.constructor.name]);
            }
            ;
            throw new Error("Failed pattern match at PSD3.Data.Graph.Algorithms (line 67, column 5 - line 71, column 35): " + [state3.constructor.name]);
          }
          ;
          while (!$tco_done) {
            $tco_result = $tco_loop($copy_state);
          }
          ;
          return $tco_result;
        };
        var initialState4 = {
          nodes: empty8,
          spanningTree: [],
          redundantEdges: [],
          paths: [],
          openPaths: [[rootId]]
        };
        var finalState = go2(initialState4);
        return {
          nodes: finalState.nodes,
          spanningTree: finalState.spanningTree,
          redundantEdges: finalState.redundantEdges,
          paths: finalState.paths
        };
      };
    };
  };

  // output/D3.Viz.Spago.Tree/index.js
  var lookup10 = /* @__PURE__ */ lookup2(ordInt);
  var map38 = /* @__PURE__ */ map(functorArray);
  var map113 = /* @__PURE__ */ map(functorList);
  var fromFoldable27 = /* @__PURE__ */ fromFoldable(foldableList);
  var insert8 = /* @__PURE__ */ insert(ordInt);
  var foldl11 = /* @__PURE__ */ foldl(foldableList);
  var fromFoldable110 = /* @__PURE__ */ fromFoldable2(foldableArray);
  var fromFoldable28 = /* @__PURE__ */ fromFoldable(foldableSet);
  var elem5 = /* @__PURE__ */ elem2(eqInt);
  var fromFoldable32 = /* @__PURE__ */ fromFoldable6(ordInt)(foldableArray);
  var append18 = /* @__PURE__ */ append(semigroupArray);
  var updateNodeTreeXY = function(nodes) {
    return function(treeDerivedDataMap) {
      var updateNode = function(node) {
        var v = lookup10(node.id)(treeDerivedDataMap);
        if (v instanceof Nothing) {
          return node;
        }
        ;
        if (v instanceof Just) {
          return {
            x: node.x,
            y: node.y,
            vx: node.vx,
            vy: node.vy,
            fx: node.fx,
            fy: node.fy,
            id: node.id,
            links: node.links,
            showChildren: node.showChildren,
            containerID: node.containerID,
            containerName: node.containerName,
            containsMany: node.containsMany,
            inSim: node.inSim,
            loc: node.loc,
            name: node.name,
            nodetype: node.nodetype,
            gridXY: node.gridXY,
            cluster: node.cluster,
            focusX: node.focusX,
            focusY: node.focusY,
            r: node.r,
            treeXY: notNull({
              x: v.value0.x,
              y: v.value0.y
            }),
            treeDepth: notNull(v.value0.depth),
            connected: true
          };
        }
        ;
        throw new Error("Failed pattern match at D3.Viz.Spago.Tree (line 131, column 7 - line 137, column 17): " + [v.constructor.name]);
      };
      return map38(updateNode)(nodes);
    };
  };
  var tupleToLink = function(linktype) {
    return function(v) {
      return {
        source: v.value0,
        target: v.value1,
        linktype,
        inSim: true
      };
    };
  };
  var mapTree = function(f) {
    return function(v) {
      return new Node(f(v.value0), map113(mapTree(f))(v.value1));
    };
  };
  var flattenTreeToMap = function(tree3) {
    var go2 = function(v) {
      return function(acc) {
        var isLeaf = (function() {
          if (v.value1 instanceof Nil) {
            return true;
          }
          ;
          return false;
        })();
        var childIDs = fromFoldable27(map113(function(v1) {
          return v1.value0.id;
        })(v.value1));
        var treeFields = {
          x: v.value0.x,
          y: v.value0.y,
          isTreeLeaf: isLeaf,
          depth: v.value0.depth,
          childIDs
        };
        var accWithNode = insert8(v.value0.id)(treeFields)(acc);
        return foldl11(function(m) {
          return function(child) {
            return go2(child)(m);
          };
        })(accWithNode)(v.value1);
      };
    };
    return go2(tree3)(empty3);
  };
  var buildIDTree = function(rootID) {
    return function(links) {
      var getChildren4 = function(nodeId) {
        var matchingLinks = filter(function(link4) {
          return link4.source === nodeId;
        })(links);
        return map38(function(v) {
          return v.target;
        })(matchingLinks);
      };
      var go2 = function(nodeId) {
        var children3 = getChildren4(nodeId);
        var childTrees = map38(go2)(children3);
        return new Node(nodeId, fromFoldable110(childTrees));
      };
      return go2(rootID);
    };
  };
  var treeReduction = function(rootID) {
    return function(model) {
      var reachable = getReachableNodes(spagoGraphConfig)(rootID)(model.graphModel);
      var reachableNodes = fromFoldable28(reachable.nodes);
      var treenodes = partition(function(n) {
        return elem5(n.id)(reachableNodes) || n.id === rootID;
      })(model.nodes);
      var treelinks = map38(tupleToLink(M2M_Tree.value))(reachable.spanningTree);
      var prunedTreeLinks = map38(tupleToLink(M2M_Graph.value))(reachable.redundantEdges);
      var onlyPackageLinks = filter(isP2P_Link)(model.links);
      var nodeMap = fromFoldable32(map38(function(n) {
        return new Tuple(n.id, n);
      })(model.nodes));
      var links = append18(treelinks)(append18(prunedTreeLinks)(onlyPackageLinks));
      var idTree = buildIDTree(rootID)(treelinks);
      var dataTree = mapTree(function(nodeId) {
        var v = lookup10(nodeId)(nodeMap);
        if (v instanceof Just) {
          return {
            id: nodeId,
            x: v.value0.x,
            y: v.value0.y,
            depth: 0
          };
        }
        ;
        if (v instanceof Nothing) {
          return {
            id: nodeId,
            x: 0,
            y: 0,
            depth: 0
          };
        }
        ;
        throw new Error("Failed pattern match at D3.Viz.Spago.Tree (line 95, column 9 - line 97, column 62): " + [v.constructor.name]);
      })(idTree);
      var config = {
        size: {
          width: 4e3,
          height: 800
        },
        minSeparation: 8,
        separation: Nothing.value,
        layerScale: Nothing.value
      };
      var laidOutTree = tree2(config)(dataTree);
      var treeDerivedDataMap = flattenTreeToMap(laidOutTree);
      var positionedNodes = updateNodeTreeXY(treenodes.yes)(treeDerivedDataMap);
      return {
        graph: model.graph,
        graphModel: model.graphModel,
        links,
        nodes: append18(positionedNodes)(treenodes.no),
        tree: model.tree,
        maps: {
          name2ID: model.maps.name2ID,
          id2Name: model.maps.id2Name,
          id2Package: model.maps.id2Package,
          id2LOC: model.maps.id2LOC,
          id2TreeData: treeDerivedDataMap
        }
      };
    };
  };

  // output/PSD3.CodeExplorer.Data/index.js
  var bind10 = /* @__PURE__ */ bind(bindMaybe);
  var lookup11 = /* @__PURE__ */ lookup2(ordString);
  var pure10 = /* @__PURE__ */ pure(applicativeMaybe);
  var bind12 = /* @__PURE__ */ bind(bindAff);
  var apply3 = /* @__PURE__ */ apply(applyEither);
  var map39 = /* @__PURE__ */ map(functorEither);
  var pure12 = /* @__PURE__ */ pure(applicativeAff);
  var addTreeToModel = function(rootName) {
    return function(maybeModel) {
      return bind10(maybeModel)(function(model) {
        return bind10(lookup11(rootName)(model.maps.name2ID))(function(rootID) {
          return pure10(treeReduction(rootID)(model));
        });
      });
    };
  };
  var readModelData = /* @__PURE__ */ (function() {
    return bind12(get3(string)("./data/spago-data/modules.json"))(function(moduleJSON) {
      return bind12(get3(string)("./data/spago-data/packages.json"))(function(packageJSON) {
        return bind12(get3(string)("./data/spago-data/lsdeps.jsonlines"))(function(lsdepJSON) {
          return bind12(get3(string)("./data/spago-data/LOC.json"))(function(locJSON) {
            var model = hush(apply3(apply3(apply3(map39(convertFilesToGraphModel)(moduleJSON))(packageJSON))(lsdepJSON))(locJSON));
            return pure12(addTreeToModel("PSD3.Main")(model));
          });
        });
      });
    });
  })();

  // output/PSD3.Internal.Simulation.Config/index.js
  var yVal = function(n) {
    return new AttributeSetter("y", new NumberAttr(new Static(n)));
  };
  var yFn = function(fn) {
    return new AttributeSetter("y", new NumberAttr(new FnI(fn)));
  };
  var xVal = function(n) {
    return new AttributeSetter("x", new NumberAttr(new Static(n)));
  };
  var xFn = function(fn) {
    return new AttributeSetter("x", new NumberAttr(new FnI(fn)));
  };
  var thetaVal = function(n) {
    return new AttributeSetter("theta", new NumberAttr(new Static(n)));
  };
  var strengthVal = function(n) {
    return new AttributeSetter("strength", new NumberAttr(new Static(n)));
  };
  var radiusVal = function(n) {
    return new AttributeSetter("radius", new NumberAttr(new Static(n)));
  };
  var radiusFn = function(fn) {
    return new AttributeSetter("radius", new NumberAttr(new FnI(fn)));
  };
  var numKey = function(fn) {
    return new AttributeSetter("keyFn", new NumberAttr(new Fn(fn)));
  };
  var distanceVal = function(n) {
    return new AttributeSetter("distance", new NumberAttr(new Static(n)));
  };
  var distanceMinVal = function(n) {
    return new AttributeSetter("distanceMin", new NumberAttr(new Static(n)));
  };
  var distanceMaxVal = function(n) {
    return new AttributeSetter("distanceMax", new NumberAttr(new Static(n)));
  };

  // output/PSD3v2.Interpreter.D3v2/foreign.js
  var setAttributeSync_ = (name16) => (value18) => (element3) => {
    if (name16 === "textContent") {
      element3.textContent = value18;
    } else {
      element3.setAttribute(name16, value18);
    }
  };
  var getElementData_2 = (element3) => element3.__data__;

  // output/PSD3v2.Transition.FFI/foreign.js
  function createTransition_(duration2) {
    return function(delay2) {
      return function(easingName) {
        return function(element3) {
          return function() {
            console.log("createTransition_: Creating transition", { duration: duration2, delay: delay2, easingName, element: element3 });
            let transition2 = select_default2(element3).transition();
            transition2 = transition2.duration(duration2);
            if (delay2 != null) {
              transition2 = transition2.delay(delay2);
            }
            if (easingName != null) {
              const easingFn = getD3EasingFunction(easingName);
              if (easingFn) {
                transition2 = transition2.ease(easingFn);
              }
              console.log("createTransition_: Applied easing", easingName);
            }
            console.log("createTransition_: Transition created", transition2);
            return transition2;
          };
        };
      };
    };
  }
  function transitionSetAttribute_(name16) {
    return function(value18) {
      return function(transition2) {
        return function() {
          console.log("transitionSetAttribute_: Setting attribute", { name: name16, value: value18, transition: transition2 });
          transition2.attr(name16, value18);
        };
      };
    };
  }
  function transitionRemove_(transition2) {
    return function() {
      console.log("transitionRemove_: Scheduling removal after transition");
      transition2.remove();
    };
  }
  function getD3EasingFunction(name16) {
    const easingMap = {
      // Linear
      "linear": linear2,
      // Polynomial (Quad, Cubic)
      "quad": quadInOut,
      "quadIn": quadIn,
      "quadOut": quadOut,
      "quadInOut": quadInOut,
      "cubic": cubicInOut,
      "cubicIn": cubicIn,
      "cubicOut": cubicOut,
      "cubicInOut": cubicInOut,
      // Sinusoidal
      "sin": sinInOut,
      "sinIn": sinIn,
      "sinOut": sinOut,
      "sinInOut": sinInOut,
      // Exponential
      "exp": expInOut,
      "expIn": expIn,
      "expOut": expOut,
      "expInOut": expInOut,
      // Circular
      "circle": circleInOut,
      "circleIn": circleIn,
      "circleOut": circleOut,
      "circleInOut": circleInOut,
      // Elastic
      "elastic": elasticOut,
      "elasticIn": elasticIn,
      "elasticOut": elasticOut,
      "elasticInOut": elasticInOut,
      // Back
      "back": backInOut,
      "backIn": backIn,
      "backOut": backOut,
      "backInOut": backInOut,
      // Bounce
      "bounce": bounceOut,
      "bounceIn": bounceIn,
      "bounceOut": bounceOut,
      "bounceInOut": bounceInOut
    };
    return easingMap[name16];
  }

  // output/PSD3v2.Transition.Types/index.js
  var Linear = /* @__PURE__ */ (function() {
    function Linear3() {
    }
    ;
    Linear3.value = new Linear3();
    return Linear3;
  })();
  var Cubic = /* @__PURE__ */ (function() {
    function Cubic2() {
    }
    ;
    Cubic2.value = new Cubic2();
    return Cubic2;
  })();
  var CubicIn = /* @__PURE__ */ (function() {
    function CubicIn2() {
    }
    ;
    CubicIn2.value = new CubicIn2();
    return CubicIn2;
  })();
  var CubicOut = /* @__PURE__ */ (function() {
    function CubicOut2() {
    }
    ;
    CubicOut2.value = new CubicOut2();
    return CubicOut2;
  })();
  var CubicInOut = /* @__PURE__ */ (function() {
    function CubicInOut2() {
    }
    ;
    CubicInOut2.value = new CubicInOut2();
    return CubicInOut2;
  })();
  var Quad = /* @__PURE__ */ (function() {
    function Quad2() {
    }
    ;
    Quad2.value = new Quad2();
    return Quad2;
  })();
  var QuadIn = /* @__PURE__ */ (function() {
    function QuadIn2() {
    }
    ;
    QuadIn2.value = new QuadIn2();
    return QuadIn2;
  })();
  var QuadOut = /* @__PURE__ */ (function() {
    function QuadOut2() {
    }
    ;
    QuadOut2.value = new QuadOut2();
    return QuadOut2;
  })();
  var QuadInOut = /* @__PURE__ */ (function() {
    function QuadInOut2() {
    }
    ;
    QuadInOut2.value = new QuadInOut2();
    return QuadInOut2;
  })();
  var Sin = /* @__PURE__ */ (function() {
    function Sin2() {
    }
    ;
    Sin2.value = new Sin2();
    return Sin2;
  })();
  var SinIn = /* @__PURE__ */ (function() {
    function SinIn2() {
    }
    ;
    SinIn2.value = new SinIn2();
    return SinIn2;
  })();
  var SinOut = /* @__PURE__ */ (function() {
    function SinOut2() {
    }
    ;
    SinOut2.value = new SinOut2();
    return SinOut2;
  })();
  var SinInOut = /* @__PURE__ */ (function() {
    function SinInOut2() {
    }
    ;
    SinInOut2.value = new SinInOut2();
    return SinInOut2;
  })();
  var Exp = /* @__PURE__ */ (function() {
    function Exp2() {
    }
    ;
    Exp2.value = new Exp2();
    return Exp2;
  })();
  var ExpIn = /* @__PURE__ */ (function() {
    function ExpIn2() {
    }
    ;
    ExpIn2.value = new ExpIn2();
    return ExpIn2;
  })();
  var ExpOut = /* @__PURE__ */ (function() {
    function ExpOut2() {
    }
    ;
    ExpOut2.value = new ExpOut2();
    return ExpOut2;
  })();
  var ExpInOut = /* @__PURE__ */ (function() {
    function ExpInOut2() {
    }
    ;
    ExpInOut2.value = new ExpInOut2();
    return ExpInOut2;
  })();
  var Circle3 = /* @__PURE__ */ (function() {
    function Circle4() {
    }
    ;
    Circle4.value = new Circle4();
    return Circle4;
  })();
  var CircleIn = /* @__PURE__ */ (function() {
    function CircleIn2() {
    }
    ;
    CircleIn2.value = new CircleIn2();
    return CircleIn2;
  })();
  var CircleOut = /* @__PURE__ */ (function() {
    function CircleOut2() {
    }
    ;
    CircleOut2.value = new CircleOut2();
    return CircleOut2;
  })();
  var CircleInOut = /* @__PURE__ */ (function() {
    function CircleInOut2() {
    }
    ;
    CircleInOut2.value = new CircleInOut2();
    return CircleInOut2;
  })();
  var Elastic = /* @__PURE__ */ (function() {
    function Elastic2() {
    }
    ;
    Elastic2.value = new Elastic2();
    return Elastic2;
  })();
  var ElasticIn = /* @__PURE__ */ (function() {
    function ElasticIn2() {
    }
    ;
    ElasticIn2.value = new ElasticIn2();
    return ElasticIn2;
  })();
  var ElasticOut = /* @__PURE__ */ (function() {
    function ElasticOut2() {
    }
    ;
    ElasticOut2.value = new ElasticOut2();
    return ElasticOut2;
  })();
  var ElasticInOut = /* @__PURE__ */ (function() {
    function ElasticInOut2() {
    }
    ;
    ElasticInOut2.value = new ElasticInOut2();
    return ElasticInOut2;
  })();
  var Back = /* @__PURE__ */ (function() {
    function Back2() {
    }
    ;
    Back2.value = new Back2();
    return Back2;
  })();
  var BackIn = /* @__PURE__ */ (function() {
    function BackIn2() {
    }
    ;
    BackIn2.value = new BackIn2();
    return BackIn2;
  })();
  var BackOut = /* @__PURE__ */ (function() {
    function BackOut2() {
    }
    ;
    BackOut2.value = new BackOut2();
    return BackOut2;
  })();
  var BackInOut = /* @__PURE__ */ (function() {
    function BackInOut2() {
    }
    ;
    BackInOut2.value = new BackInOut2();
    return BackInOut2;
  })();
  var Bounce = /* @__PURE__ */ (function() {
    function Bounce2() {
    }
    ;
    Bounce2.value = new Bounce2();
    return Bounce2;
  })();
  var BounceIn = /* @__PURE__ */ (function() {
    function BounceIn2() {
    }
    ;
    BounceIn2.value = new BounceIn2();
    return BounceIn2;
  })();
  var BounceOut = /* @__PURE__ */ (function() {
    function BounceOut2() {
    }
    ;
    BounceOut2.value = new BounceOut2();
    return BounceOut2;
  })();
  var BounceInOut = /* @__PURE__ */ (function() {
    function BounceInOut2() {
    }
    ;
    BounceInOut2.value = new BounceInOut2();
    return BounceInOut2;
  })();
  var showEasing = {
    show: function(v) {
      if (v instanceof Linear) {
        return "linear";
      }
      ;
      if (v instanceof Cubic) {
        return "cubic";
      }
      ;
      if (v instanceof CubicIn) {
        return "cubicIn";
      }
      ;
      if (v instanceof CubicOut) {
        return "cubicOut";
      }
      ;
      if (v instanceof CubicInOut) {
        return "cubicInOut";
      }
      ;
      if (v instanceof Quad) {
        return "quad";
      }
      ;
      if (v instanceof QuadIn) {
        return "quadIn";
      }
      ;
      if (v instanceof QuadOut) {
        return "quadOut";
      }
      ;
      if (v instanceof QuadInOut) {
        return "quadInOut";
      }
      ;
      if (v instanceof Sin) {
        return "sin";
      }
      ;
      if (v instanceof SinIn) {
        return "sinIn";
      }
      ;
      if (v instanceof SinOut) {
        return "sinOut";
      }
      ;
      if (v instanceof SinInOut) {
        return "sinInOut";
      }
      ;
      if (v instanceof Exp) {
        return "exp";
      }
      ;
      if (v instanceof ExpIn) {
        return "expIn";
      }
      ;
      if (v instanceof ExpOut) {
        return "expOut";
      }
      ;
      if (v instanceof ExpInOut) {
        return "expInOut";
      }
      ;
      if (v instanceof Circle3) {
        return "circle";
      }
      ;
      if (v instanceof CircleIn) {
        return "circleIn";
      }
      ;
      if (v instanceof CircleOut) {
        return "circleOut";
      }
      ;
      if (v instanceof CircleInOut) {
        return "circleInOut";
      }
      ;
      if (v instanceof Elastic) {
        return "elastic";
      }
      ;
      if (v instanceof ElasticIn) {
        return "elasticIn";
      }
      ;
      if (v instanceof ElasticOut) {
        return "elasticOut";
      }
      ;
      if (v instanceof ElasticInOut) {
        return "elasticInOut";
      }
      ;
      if (v instanceof Back) {
        return "back";
      }
      ;
      if (v instanceof BackIn) {
        return "backIn";
      }
      ;
      if (v instanceof BackOut) {
        return "backOut";
      }
      ;
      if (v instanceof BackInOut) {
        return "backInOut";
      }
      ;
      if (v instanceof Bounce) {
        return "bounce";
      }
      ;
      if (v instanceof BounceIn) {
        return "bounceIn";
      }
      ;
      if (v instanceof BounceOut) {
        return "bounceOut";
      }
      ;
      if (v instanceof BounceInOut) {
        return "bounceInOut";
      }
      ;
      throw new Error("Failed pattern match at PSD3v2.Transition.Types (line 79, column 1 - line 112, column 35): " + [v.constructor.name]);
    }
  };
  var transitionWith = /* @__PURE__ */ identity(categoryFn);

  // output/PSD3v2.Transition.FFI/index.js
  var show19 = /* @__PURE__ */ show(showEasing);
  var maybeMillisecondsToNullable = function(v) {
    if (v instanceof Nothing) {
      return toNullable(Nothing.value);
    }
    ;
    if (v instanceof Just) {
      return toNullable(new Just(v.value0));
    }
    ;
    throw new Error("Failed pattern match at PSD3v2.Transition.FFI (line 53, column 1 - line 53, column 69): " + [v.constructor.name]);
  };
  var easingToD3Name = function(easing) {
    return show19(easing);
  };
  var maybeEasingToNullable = function(v) {
    if (v instanceof Nothing) {
      return toNullable(Nothing.value);
    }
    ;
    if (v instanceof Just) {
      return toNullable(new Just(easingToD3Name(v.value0)));
    }
    ;
    throw new Error("Failed pattern match at PSD3v2.Transition.FFI (line 58, column 1 - line 58, column 57): " + [v.constructor.name]);
  };

  // output/PSD3v2.Interpreter.D3v2/index.js
  var select6 = /* @__PURE__ */ select5(monadEffectEffect);
  var selectAll2 = /* @__PURE__ */ selectAll(monadEffectEffect);
  var renderData2 = /* @__PURE__ */ renderData(monadEffectEffect);
  var appendData2 = /* @__PURE__ */ appendData(monadEffectEffect);
  var joinData4 = /* @__PURE__ */ joinData3(monadEffectEffect);
  var joinDataWithKey3 = /* @__PURE__ */ joinDataWithKey2(monadEffectEffect);
  var append19 = /* @__PURE__ */ append15(monadEffectEffect);
  var setAttrs3 = /* @__PURE__ */ setAttrs2(monadEffectEffect);
  var setAttrsExit3 = /* @__PURE__ */ setAttrsExit2(monadEffectEffect);
  var remove6 = /* @__PURE__ */ remove4(monadEffectEffect);
  var clear3 = /* @__PURE__ */ clear2(monadEffectEffect);
  var merge3 = /* @__PURE__ */ merge2(monadEffectEffect);
  var appendChild4 = /* @__PURE__ */ appendChild3(monadEffectEffect);
  var appendChildInheriting3 = /* @__PURE__ */ appendChildInheriting2(monadEffectEffect);
  var map40 = /* @__PURE__ */ map(functorMap);
  var map114 = /* @__PURE__ */ map(functorAff);
  var show20 = /* @__PURE__ */ show(showNumber);
  var show110 = /* @__PURE__ */ show(showBoolean);
  var traverseWithIndex_3 = /* @__PURE__ */ traverseWithIndex_(applicativeEffect)(foldableWithIndexArray);
  var unsafeIndex4 = /* @__PURE__ */ unsafeIndex();
  var traverse_5 = /* @__PURE__ */ traverse_(applicativeEffect)(foldableArray);
  var discard10 = /* @__PURE__ */ discard(discardUnit);
  var fromFoldable29 = /* @__PURE__ */ fromFoldable6(ordString)(foldableArray);
  var mapFlipped7 = /* @__PURE__ */ mapFlipped(functorArray);
  var _name3 = /* @__PURE__ */ _name(strongForget);
  var _Newtype3 = /* @__PURE__ */ _Newtype()()(profunctorFn);
  var prop6 = /* @__PURE__ */ prop3({
    reflectSymbol: function() {
      return "forceLibrary";
    }
  })()();
  var _handle3 = /* @__PURE__ */ _handle(strongForget);
  var toUnfoldable5 = /* @__PURE__ */ toUnfoldable3(unfoldableArray);
  var log6 = /* @__PURE__ */ log3(monadEffectEffect);
  var D3v2Selection_ = function(x47) {
    return x47;
  };
  var monadStateRecordD3v2SimM = /* @__PURE__ */ monadStateStateT(monadAff);
  var get8 = /* @__PURE__ */ get(monadStateRecordD3v2SimM);
  var modify_4 = /* @__PURE__ */ modify_2(monadStateRecordD3v2SimM);
  var simulationActualizeForces2 = /* @__PURE__ */ simulationActualizeForces(monadStateRecordD3v2SimM);
  var simulationSetVariable2 = /* @__PURE__ */ simulationSetVariable(monadStateRecordD3v2SimM);
  var use2 = /* @__PURE__ */ use(monadStateRecordD3v2SimM);
  var monadEffectD3v2SimM = /* @__PURE__ */ monadEffectState(monadEffectAff);
  var liftEffect4 = /* @__PURE__ */ liftEffect(monadEffectD3v2SimM);
  var monadEffectD3v2M = monadEffectEffect;
  var monadD3v2SimM = /* @__PURE__ */ monadStateT(monadAff);
  var monadD3v2M = monadEffect;
  var selectionMD3v2Selection_D = {
    select: function(selector) {
      return function __do3() {
        var sel = select6(selector)();
        return sel;
      };
    },
    selectAll: function(selector) {
      return function(v) {
        return function __do3() {
          var result = selectAll2(selector)(v)();
          return result;
        };
      };
    },
    openSelection: function(v) {
      return function(selector) {
        return function __do3() {
          var result = selectAll2(selector)(v)();
          return result;
        };
      };
    },
    renderData: function(dictFoldable) {
      var renderData1 = renderData2(dictFoldable);
      return function(dictOrd) {
        var renderData22 = renderData1(dictOrd);
        return function(elemType) {
          return function(foldableData) {
            return function(selector) {
              return function(v) {
                return function(enterAttrs) {
                  return function(updateAttrs) {
                    return function(exitAttrs) {
                      return function __do3() {
                        var result = renderData22(elemType)(foldableData)(selector)(v)(enterAttrs)(updateAttrs)(exitAttrs)();
                        return result;
                      };
                    };
                  };
                };
              };
            };
          };
        };
      };
    },
    appendData: function(dictFoldable) {
      var appendData1 = appendData2(dictFoldable);
      return function(elemType) {
        return function(foldableData) {
          return function(attrs) {
            return function(v) {
              return function __do3() {
                var result = appendData1(elemType)(foldableData)(attrs)(v)();
                return result;
              };
            };
          };
        };
      };
    },
    joinData: function(dictFoldable) {
      var joinData13 = joinData4(dictFoldable);
      return function(dictOrd) {
        var joinData23 = joinData13(dictOrd);
        return function(foldableData) {
          return function(selector) {
            return function(v) {
              return function __do3() {
                var v1 = joinData23(foldableData)(selector)(v)();
                return new JoinResult({
                  enter: v1.value0.enter,
                  update: v1.value0.update,
                  exit: v1.value0.exit
                });
              };
            };
          };
        };
      };
    },
    joinDataWithKey: function(dictFoldable) {
      var joinDataWithKey1 = joinDataWithKey3(dictFoldable);
      return function(dictOrd) {
        var joinDataWithKey22 = joinDataWithKey1(dictOrd.Eq0());
        return function(foldableData) {
          return function(keyFn) {
            return function(selector) {
              return function(v) {
                return function __do3() {
                  var v1 = joinDataWithKey22(foldableData)(keyFn)(selector)(v)();
                  return new JoinResult({
                    enter: v1.value0.enter,
                    update: v1.value0.update,
                    exit: v1.value0.exit
                  });
                };
              };
            };
          };
        };
      };
    },
    updateJoin: function(dictFoldable) {
      var joinDataWithKey1 = joinDataWithKey3(dictFoldable);
      return function(dictOrd) {
        var joinDataWithKey22 = joinDataWithKey1(dictOrd.Eq0());
        return function(v) {
          return function(_elemType) {
            return function(foldableData) {
              return function(keyFn) {
                return function(selector) {
                  return function __do3() {
                    var v1 = joinDataWithKey22(foldableData)(keyFn)(selector)(v)();
                    return new JoinResult({
                      enter: v1.value0.enter,
                      update: v1.value0.update,
                      exit: v1.value0.exit
                    });
                  };
                };
              };
            };
          };
        };
      };
    },
    append: function(elemType) {
      return function(attrs) {
        return function(v) {
          return function __do3() {
            var result = append19(elemType)(attrs)(v)();
            return result;
          };
        };
      };
    },
    setAttrs: function(attrs) {
      return function(v) {
        return function __do3() {
          var result = setAttrs3(attrs)(v)();
          return result;
        };
      };
    },
    setAttrsExit: function(attrs) {
      return function(v) {
        return function __do3() {
          var result = setAttrsExit3(attrs)(v)();
          return result;
        };
      };
    },
    remove: function(v) {
      return remove6(v);
    },
    clear: function(selector) {
      return clear3(selector);
    },
    merge: function(v) {
      return function(v1) {
        return function __do3() {
          var result = merge3(v)(v1)();
          return result;
        };
      };
    },
    appendChild: function(elemType) {
      return function(attrs) {
        return function(v) {
          return function __do3() {
            var result = appendChild4(elemType)(attrs)(v)();
            return result;
          };
        };
      };
    },
    appendChildInheriting: function(elemType) {
      return function(attrs) {
        return function(v) {
          return function __do3() {
            var result = appendChildInheriting3(elemType)(attrs)(v)();
            return result;
          };
        };
      };
    },
    on: function(behavior) {
      return function(v) {
        return function __do3() {
          var result = on3(behavior)(v)();
          return result;
        };
      };
    },
    renderTree: function(dictOrd) {
      var renderTree62 = renderTree2(dictOrd);
      return function(v) {
        return function(tree3) {
          return function __do3() {
            var selectionsMap = renderTree62(v)(tree3)();
            return map40(D3v2Selection_)(selectionsMap);
          };
        };
      };
    },
    Monad0: function() {
      return monadD3v2M;
    }
  };
  var monadAffD3v2SimM = /* @__PURE__ */ monadAffState(monadAffAff);
  var bindD3v2SimM = /* @__PURE__ */ bindStateT(monadAff);
  var bind13 = /* @__PURE__ */ bind(bindD3v2SimM);
  var discard22 = /* @__PURE__ */ discard10(bindD3v2SimM);
  var simulationSetNodes2 = /* @__PURE__ */ simulationSetNodes(bindD3v2SimM)(monadStateRecordD3v2SimM);
  var simulationSetLinks2 = /* @__PURE__ */ simulationSetLinks(bindD3v2SimM)(monadStateRecordD3v2SimM);
  var bindD3v2M = bindEffect;
  var applicativeD3v2SimM = /* @__PURE__ */ applicativeStateT(monadAff);
  var pure13 = /* @__PURE__ */ pure(applicativeD3v2SimM);
  var traverse_12 = /* @__PURE__ */ traverse_(applicativeD3v2SimM)(foldableArray);
  var selectionMD3v2Selection_D1 = {
    select: function(selector) {
      return liftEffect4(function __do3() {
        var sel = select6(selector)();
        return sel;
      });
    },
    appendChild: function(elemType) {
      return function(attrs) {
        return function(v) {
          return liftEffect4(function __do3() {
            var child = appendChild4(elemType)(attrs)(v)();
            return child;
          });
        };
      };
    },
    appendChildInheriting: function(elemType) {
      return function(attrs) {
        return function(v) {
          return liftEffect4(function __do3() {
            var child = appendChildInheriting3(elemType)(attrs)(v)();
            return child;
          });
        };
      };
    },
    joinData: function(dictFoldable) {
      var joinData13 = joinData4(dictFoldable);
      return function(dictOrd) {
        var joinData23 = joinData13(dictOrd);
        return function(foldable) {
          return function(tag) {
            return function(v) {
              return liftEffect4(function __do3() {
                var v1 = joinData23(foldable)(tag)(v)();
                return new JoinResult({
                  enter: v1.value0.enter,
                  update: v1.value0.update,
                  exit: v1.value0.exit
                });
              });
            };
          };
        };
      };
    },
    joinDataWithKey: function(dictFoldable) {
      var joinDataWithKey1 = joinDataWithKey3(dictFoldable);
      return function(dictOrd) {
        var joinDataWithKey22 = joinDataWithKey1(dictOrd.Eq0());
        return function(foldableData) {
          return function(keyFn) {
            return function(selector) {
              return function(v) {
                return liftEffect4(function __do3() {
                  var v1 = joinDataWithKey22(foldableData)(keyFn)(selector)(v)();
                  return new JoinResult({
                    enter: v1.value0.enter,
                    update: v1.value0.update,
                    exit: v1.value0.exit
                  });
                });
              };
            };
          };
        };
      };
    },
    append: function(elemType) {
      return function(attrs) {
        return function(v) {
          return liftEffect4(function __do3() {
            var bound = append19(elemType)(attrs)(v)();
            return bound;
          });
        };
      };
    },
    setAttrs: function(attrs) {
      return function(v) {
        return liftEffect4(function __do3() {
          var bound$prime = setAttrs3(attrs)(v)();
          return bound$prime;
        });
      };
    },
    setAttrsExit: function(attrs) {
      return function(v) {
        return liftEffect4(function __do3() {
          var exiting$prime = setAttrsExit3(attrs)(v)();
          return exiting$prime;
        });
      };
    },
    remove: function(v) {
      return liftEffect4(remove6(v));
    },
    clear: function(selector) {
      return liftEffect4(clear3(selector));
    },
    selectAll: function(tag) {
      return function(v) {
        return liftEffect4(function __do3() {
          var selection2 = selectAll2(tag)(v)();
          return selection2;
        });
      };
    },
    openSelection: function(v) {
      return function(tag) {
        return liftEffect4(function __do3() {
          var selection2 = selectAll2(tag)(v)();
          return selection2;
        });
      };
    },
    updateJoin: function(dictFoldable) {
      var joinDataWithKey1 = joinDataWithKey3(dictFoldable);
      return function(dictOrd) {
        var joinDataWithKey22 = joinDataWithKey1(dictOrd.Eq0());
        return function(v) {
          return function(_elemType) {
            return function(foldableData) {
              return function(keyFn) {
                return function(selector) {
                  return liftEffect4(function __do3() {
                    var v1 = joinDataWithKey22(foldableData)(keyFn)(selector)(v)();
                    return new JoinResult({
                      enter: v1.value0.enter,
                      update: v1.value0.update,
                      exit: v1.value0.exit
                    });
                  });
                };
              };
            };
          };
        };
      };
    },
    renderData: function(dictFoldable) {
      var renderData1 = renderData2(dictFoldable);
      return function(dictOrd) {
        var renderData22 = renderData1(dictOrd);
        return function(elemType) {
          return function(foldable) {
            return function(tag) {
              return function(v) {
                return function(enterFn) {
                  return function(updateFn) {
                    return function(exitFn) {
                      return liftEffect4(function __do3() {
                        var bound = renderData22(elemType)(foldable)(tag)(v)(enterFn)(updateFn)(exitFn)();
                        return bound;
                      });
                    };
                  };
                };
              };
            };
          };
        };
      };
    },
    appendData: function(dictFoldable) {
      var appendData1 = appendData2(dictFoldable);
      return function(elemType) {
        return function(foldableData) {
          return function(attrs) {
            return function(v) {
              return liftEffect4(function __do3() {
                var bound = appendData1(elemType)(foldableData)(attrs)(v)();
                return bound;
              });
            };
          };
        };
      };
    },
    merge: function(v) {
      return function(v1) {
        return liftEffect4(function __do3() {
          var merged = merge3(v)(v1)();
          return merged;
        });
      };
    },
    on: function(behavior) {
      return function(v) {
        return bind13(get8)(function(state3) {
          return bind13(liftEffect4(onWithSimulation(behavior)(state3.simulation)(v)))(function(result) {
            return pure13(result);
          });
        });
      };
    },
    renderTree: function(dictOrd) {
      var renderTree62 = renderTree2(dictOrd);
      return function(v) {
        return function(tree3) {
          return liftEffect4(function __do3() {
            var selectionsMap = renderTree62(v)(tree3)();
            return map40(D3v2Selection_)(selectionsMap);
          });
        };
      };
    },
    Monad0: function() {
      return monadD3v2SimM;
    }
  };
  var applicativeD3v2M = applicativeEffect;
  var runD3v2SimM = function(state3) {
    return function(v) {
      return runStateT(v)(state3);
    };
  };
  var runD3v2M = function(v) {
    return v;
  };
  var reselectD3v2 = function(name16) {
    return function(selectionsMap) {
      var unwrappedMap = map40(function(v) {
        return v;
      })(selectionsMap);
      return function __do3() {
        var result = reselect(name16)(unwrappedMap)();
        return result;
      };
    };
  };
  var execD3v2SimM = function(state3) {
    return function(v) {
      return map114(snd)(runStateT(v)(state3));
    };
  };
  var evalD3v2SimM = function(state3) {
    return function(v) {
      return map114(fst)(runStateT(v)(state3));
    };
  };
  var attributeValueToString2 = function(v) {
    if (v instanceof StringValue) {
      return v.value0;
    }
    ;
    if (v instanceof NumberValue) {
      return show20(v.value0);
    }
    ;
    if (v instanceof BooleanValue) {
      return show110(v.value0);
    }
    ;
    throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 335, column 1 - line 335, column 51): " + [v.constructor.name]);
  };
  var transitionMD3v2Selection_ = {
    withTransition: function(config) {
      return function(v) {
        return function(attrs) {
          var v1 = (function() {
            if (v instanceof BoundSelection) {
              return v.value0;
            }
            ;
            throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 198, column 65 - line 199, column 44): " + [v.constructor.name]);
          })();
          var paired = zipWith(function(d18) {
            return function(e) {
              return {
                datum: d18,
                element: e
              };
            };
          })(v1.data)(v1.elements);
          return traverseWithIndex_3(function(arrayIndex) {
            return function(v2) {
              var logicalIndex = (function() {
                if (v1.indices instanceof Just) {
                  return unsafeIndex4(v1.indices.value0)(arrayIndex);
                }
                ;
                if (v1.indices instanceof Nothing) {
                  return arrayIndex;
                }
                ;
                throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 208, column 26 - line 210, column 34): " + [v1.indices.constructor.name]);
              })();
              return function __do3() {
                var transition2 = createTransition_(config.duration)(maybeMillisecondsToNullable(config.delay))(maybeEasingToNullable(config.easing))(v2.element)();
                return traverse_5(function(attr3) {
                  if (attr3 instanceof StaticAttr) {
                    return transitionSetAttribute_(attr3.value0)(attributeValueToString2(attr3.value1))(transition2);
                  }
                  ;
                  if (attr3 instanceof DataAttr) {
                    return transitionSetAttribute_(attr3.value0)(attributeValueToString2(attr3.value1(v2.datum)))(transition2);
                  }
                  ;
                  if (attr3 instanceof IndexedAttr) {
                    return transitionSetAttribute_(attr3.value0)(attributeValueToString2(attr3.value1(v2.datum)(logicalIndex)))(transition2);
                  }
                  ;
                  throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 220, column 34 - line 228, column 112): " + [attr3.constructor.name]);
                })(attrs)();
              };
            };
          })(paired);
        };
      };
    },
    withTransitionExit: function(config) {
      return function(v) {
        return function(attrs) {
          var v1 = (function() {
            if (v instanceof ExitingSelection) {
              return v.value0;
            }
            ;
            throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 232, column 56 - line 233, column 46): " + [v.constructor.name]);
          })();
          var paired = zipWith(function(d18) {
            return function(e) {
              return {
                datum: d18,
                element: e
              };
            };
          })(v1.data)(v1.elements);
          return traverseWithIndex_3(function(index5) {
            return function(v2) {
              return function __do3() {
                var transition2 = createTransition_(config.duration)(maybeMillisecondsToNullable(config.delay))(maybeEasingToNullable(config.easing))(v2.element)();
                traverse_5(function(attr3) {
                  if (attr3 instanceof StaticAttr) {
                    return transitionSetAttribute_(attr3.value0)(attributeValueToString2(attr3.value1))(transition2);
                  }
                  ;
                  if (attr3 instanceof DataAttr) {
                    return transitionSetAttribute_(attr3.value0)(attributeValueToString2(attr3.value1(v2.datum)))(transition2);
                  }
                  ;
                  if (attr3 instanceof IndexedAttr) {
                    return transitionSetAttribute_(attr3.value0)(attributeValueToString2(attr3.value1(v2.datum)(index5)))(transition2);
                  }
                  ;
                  throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 249, column 34 - line 257, column 105): " + [attr3.constructor.name]);
                })(attrs)();
                return transitionRemove_(transition2)();
              };
            };
          })(paired);
        };
      };
    },
    withTransitionStaggered: function(config) {
      return function(delayFn) {
        return function(v) {
          return function(attrs) {
            var v1 = (function() {
              if (v instanceof BoundSelection) {
                return v.value0;
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 264, column 65 - line 265, column 44): " + [v.constructor.name]);
            })();
            var paired = zipWith(function(d18) {
              return function(e) {
                return {
                  datum: d18,
                  element: e
                };
              };
            })(v1.data)(v1.elements);
            return traverseWithIndex_3(function(arrayIndex) {
              return function(v2) {
                var logicalIndex = (function() {
                  if (v1.indices instanceof Just) {
                    return unsafeIndex4(v1.indices.value0)(arrayIndex);
                  }
                  ;
                  if (v1.indices instanceof Nothing) {
                    return arrayIndex;
                  }
                  ;
                  throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 274, column 26 - line 276, column 34): " + [v1.indices.constructor.name]);
                })();
                var v3 = delayFn(v2.datum)(logicalIndex);
                return function __do3() {
                  var transition2 = createTransition_(config.duration)(toNullable(new Just(v3)))(maybeEasingToNullable(config.easing))(v2.element)();
                  return traverse_5(function(attr3) {
                    if (attr3 instanceof StaticAttr) {
                      return transitionSetAttribute_(attr3.value0)(attributeValueToString2(attr3.value1))(transition2);
                    }
                    ;
                    if (attr3 instanceof DataAttr) {
                      return transitionSetAttribute_(attr3.value0)(attributeValueToString2(attr3.value1(v2.datum)))(transition2);
                    }
                    ;
                    if (attr3 instanceof IndexedAttr) {
                      return transitionSetAttribute_(attr3.value0)(attributeValueToString2(attr3.value1(v2.datum)(logicalIndex)))(transition2);
                    }
                    ;
                    throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 289, column 34 - line 297, column 112): " + [attr3.constructor.name]);
                  })(attrs)();
                };
              };
            })(paired);
          };
        };
      };
    },
    withTransitionExitStaggered: function(config) {
      return function(delayFn) {
        return function(v) {
          return function(attrs) {
            var v1 = (function() {
              if (v instanceof ExitingSelection) {
                return v.value0;
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 301, column 56 - line 302, column 46): " + [v.constructor.name]);
            })();
            var paired = zipWith(function(d18) {
              return function(e) {
                return {
                  datum: d18,
                  element: e
                };
              };
            })(v1.data)(v1.elements);
            return traverseWithIndex_3(function(index5) {
              return function(v2) {
                var v3 = delayFn(v2.datum)(index5);
                return function __do3() {
                  var transition2 = createTransition_(config.duration)(toNullable(new Just(v3)))(maybeEasingToNullable(config.easing))(v2.element)();
                  traverse_5(function(attr3) {
                    if (attr3 instanceof StaticAttr) {
                      return transitionSetAttribute_(attr3.value0)(attributeValueToString2(attr3.value1))(transition2);
                    }
                    ;
                    if (attr3 instanceof DataAttr) {
                      return transitionSetAttribute_(attr3.value0)(attributeValueToString2(attr3.value1(v2.datum)))(transition2);
                    }
                    ;
                    if (attr3 instanceof IndexedAttr) {
                      return transitionSetAttribute_(attr3.value0)(attributeValueToString2(attr3.value1(v2.datum)(index5)))(transition2);
                    }
                    ;
                    throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 321, column 34 - line 329, column 105): " + [attr3.constructor.name]);
                  })(attrs)();
                  return transitionRemove_(transition2)();
                };
              };
            })(paired);
          };
        };
      };
    },
    Monad0: function() {
      return monadD3v2M;
    }
  };
  var applyAttributeSync = function(element3) {
    return function(datum2) {
      return function(index5) {
        return function(attr3) {
          if (attr3 instanceof StaticAttr) {
            return setAttributeSync_(attr3.value0)(attributeValueToString2(attr3.value1))(element3);
          }
          ;
          if (attr3 instanceof DataAttr) {
            return setAttributeSync_(attr3.value0)(attributeValueToString2(attr3.value1(datum2)))(element3);
          }
          ;
          if (attr3 instanceof IndexedAttr) {
            return setAttributeSync_(attr3.value0)(attributeValueToString2(attr3.value1(datum2)(index5)))(element3);
          }
          ;
          throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 558, column 47 - line 566, column 76): " + [attr3.constructor.name]);
        };
      };
    };
  };
  var simulationMD3v2Selection_ = {
    init: function(config) {
      var forcesMap = fromFoldable29(mapFlipped7(config.forces)(function(f) {
        return new Tuple(view(_name3)(f), f);
      }));
      return discard22(modify_4(function(state3) {
        var $528 = {};
        for (var $529 in state3) {
          if ({}.hasOwnProperty.call(state3, $529)) {
            $528[$529] = state3[$529];
          }
          ;
        }
        ;
        $528.simulation = set2((function() {
          var $575 = prop6($$Proxy.value)(strongFn);
          return function($576) {
            return _Newtype3($575($576));
          };
        })())(forcesMap)(state3.simulation);
        return $528;
      }))(function() {
        return bind13(simulationSetNodes2(config.nodes))(function(nodesInSim) {
          return discard22(simulationActualizeForces2(config.activeForces))(function() {
            return bind13(simulationSetLinks2(config.links)(config.nodes)(config.keyFn))(function(linksInSim) {
              return discard22(simulationSetVariable2(new AlphaTarget(config.config.alphaTarget)))(function() {
                return discard22(simulationSetVariable2(new AlphaMin(config.config.alphaMin)))(function() {
                  return discard22(simulationSetVariable2(new AlphaDecay(config.config.alphaDecay)))(function() {
                    return discard22(simulationSetVariable2(new VelocityDecay(config.config.velocityDecay)))(function() {
                      return bind13(use2(_handle3))(function(handle) {
                        return bind13(traverse_12(function(v) {
                          var v1 = (function() {
                            if (v.value1.value0 instanceof BoundSelection) {
                              return v.value1.value0.value0;
                            }
                            ;
                            throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 617, column 71 - line 618, column 50): " + [v.value1.value0.constructor.name]);
                          })();
                          var makeTick = function(v2) {
                            var paired = zipWith(function(d18) {
                              return function(e) {
                                return {
                                  datum: d18,
                                  element: e
                                };
                              };
                            })(v1.data)(v1.elements);
                            var v3 = mapWithIndex2(function(arrayIndex) {
                              return function(v4) {
                                var logicalIndex = (function() {
                                  if (v1.indices instanceof Just) {
                                    return unsafeIndex4(v1.indices.value0)(arrayIndex);
                                  }
                                  ;
                                  if (v1.indices instanceof Nothing) {
                                    return arrayIndex;
                                  }
                                  ;
                                  throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 624, column 46 - line 626, column 54): " + [v1.indices.constructor.name]);
                                })();
                                var v5 = mapFlipped7(v.value1.value1)(function(attr3) {
                                  return applyAttributeSync(v4.element)(v4.datum)(logicalIndex)(attr3);
                                });
                                return unit;
                              };
                            })(paired);
                            return unit;
                          };
                          return pure13(onTick_(handle)(v.value0)(makeTick));
                        })(toUnfoldable5(config.ticks)))(function() {
                          return pure13({
                            nodes: nodesInSim,
                            links: linksInSim
                          });
                        });
                      });
                    });
                  });
                });
              });
            });
          });
        });
      });
    },
    addTickFunction: function(label5) {
      return function(v) {
        return bind13(use2(_handle3))(function(handle) {
          var v1 = (function() {
            if (v.value0 instanceof BoundSelection) {
              return v.value0.value0;
            }
            ;
            throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 644, column 47 - line 645, column 44): " + [v.value0.constructor.name]);
          })();
          var makeTick = function(v2) {
            var v3 = mapWithIndex2(function(arrayIndex) {
              return function(element3) {
                var logicalIndex = (function() {
                  if (v1.indices instanceof Just) {
                    return unsafeIndex4(v1.indices.value0)(arrayIndex);
                  }
                  ;
                  if (v1.indices instanceof Nothing) {
                    return arrayIndex;
                  }
                  ;
                  throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 650, column 40 - line 652, column 48): " + [v1.indices.constructor.name]);
                })();
                var datum2 = getElementData_2(element3);
                var v4 = mapFlipped7(v.value1)(function(attr3) {
                  return applyAttributeSync(element3)(datum2)(logicalIndex)(attr3);
                });
                return unit;
              };
            })(v1.elements);
            return unit;
          };
          return pure13(onTick_(handle)(label5)(makeTick));
        });
      };
    },
    removeTickFunction: function(label5) {
      return bind13(use2(_handle3))(function(handle) {
        return pure13(onTick_(handle)(label5)($$const(unit)));
      });
    },
    start: /* @__PURE__ */ simulationStart(monadStateRecordD3v2SimM),
    stop: /* @__PURE__ */ simulationStop(monadStateRecordD3v2SimM),
    Monad0: function() {
      return monadD3v2SimM;
    }
  };
  var simulationM2D3v2Selection = {
    update: function(config) {
      return bind13((function() {
        if (config.nodes instanceof Just) {
          return simulationSetNodes2(config.nodes.value0);
        }
        ;
        if (config.nodes instanceof Nothing) {
          return bind13(use2(_handle3))(function(handle) {
            var opaqueNodes = getNodes_(handle);
            return pure13(opaqueNodes);
          });
        }
        ;
        throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 677, column 26 - line 682, column 40): " + [config.nodes.constructor.name]);
      })())(function(nodesBeforeFilter) {
        var nodesInSim = (function() {
          if (config.nodeFilter instanceof Just) {
            return filter(config.nodeFilter.value0)(nodesBeforeFilter);
          }
          ;
          if (config.nodeFilter instanceof Nothing) {
            return nodesBeforeFilter;
          }
          ;
          throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 685, column 22 - line 687, column 39): " + [config.nodeFilter.constructor.name]);
        })();
        return bind13((function() {
          if (config.nodeFilter instanceof Just) {
            return simulationSetNodes2(nodesInSim);
          }
          ;
          if (config.nodeFilter instanceof Nothing) {
            return pure13(nodesInSim);
          }
          ;
          throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 690, column 10 - line 692, column 33): " + [config.nodeFilter.constructor.name]);
        })())(function() {
          return bind13((function() {
            if (config.activeForces instanceof Just) {
              return simulationActualizeForces2(config.activeForces.value0);
            }
            ;
            if (config.activeForces instanceof Nothing) {
              return pure13(unit);
            }
            ;
            throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 695, column 10 - line 697, column 27): " + [config.activeForces.constructor.name]);
          })())(function() {
            return bind13((function() {
              if (config.config instanceof Just) {
                return discard22(simulationSetVariable2(new AlphaTarget(config.config.value0.alphaTarget)))(function() {
                  return discard22(simulationSetVariable2(new AlphaMin(config.config.value0.alphaMin)))(function() {
                    return discard22(simulationSetVariable2(new AlphaDecay(config.config.value0.alphaDecay)))(function() {
                      return simulationSetVariable2(new VelocityDecay(config.config.value0.velocityDecay));
                    });
                  });
                });
              }
              ;
              if (config.config instanceof Nothing) {
                return pure13(unit);
              }
              ;
              throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 700, column 10 - line 706, column 27): " + [config.config.constructor.name]);
            })())(function() {
              return bind13((function() {
                if (config.links instanceof Just && config.linkFilter instanceof Just) {
                  var filteredLinks = filter(config.linkFilter.value0)(config.links.value0);
                  return simulationSetLinks2(filteredLinks)(nodesInSim)(config.keyFn);
                }
                ;
                if (config.links instanceof Just && config.linkFilter instanceof Nothing) {
                  return simulationSetLinks2(config.links.value0)(nodesInSim)(config.keyFn);
                }
                ;
                if (config.links instanceof Nothing && config.linkFilter instanceof Just) {
                  return bind13(use2(_handle3))(function(handle) {
                    var swizzledLinks = getLinksFromSimulation_(handle);
                    return discard22(liftEffect4(log6("Warning: linkFilter ignored - can't filter already-swizzled links. Provide 'links' to apply filter.")))(function() {
                      return pure13(swizzledLinks);
                    });
                  });
                }
                ;
                if (config.links instanceof Nothing && config.linkFilter instanceof Nothing) {
                  return bind13(use2(_handle3))(function(handle) {
                    var swizzledLinks = getLinksFromSimulation_(handle);
                    return pure13(swizzledLinks);
                  });
                }
                ;
                throw new Error("Failed pattern match at PSD3v2.Interpreter.D3v2 (line 709, column 19 - line 731, column 27): " + [config.links.constructor.name, config.linkFilter.constructor.name]);
              })())(function(linksInSim) {
                return pure13({
                  nodes: nodesInSim,
                  links: linksInSim
                });
              });
            });
          });
        });
      });
    },
    reheat: function(alpha) {
      return simulationSetVariable2(new Alpha(alpha));
    },
    Monad0: function() {
      return monadD3v2SimM;
    },
    SimulationM1: function() {
      return simulationMD3v2Selection_;
    }
  };

  // output/Component.CodeExplorerV2/index.js
  var eq5 = /* @__PURE__ */ eq(eqScene);
  var discard11 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var bind11 = /* @__PURE__ */ bind(bindHalogenM);
  var modify_5 = /* @__PURE__ */ modify_2(monadStateHalogenM);
  var fromFoldable30 = /* @__PURE__ */ fromFoldable8(foldableArray)(ordString);
  var get9 = /* @__PURE__ */ get(monadStateHalogenM);
  var initialize3 = /* @__PURE__ */ initialize2(bindD3v2SimM)(monadEffectD3v2SimM)(selectionMD3v2Selection_D1)(simulationM2D3v2Selection);
  var show21 = /* @__PURE__ */ show(showInt);
  var pure11 = /* @__PURE__ */ pure(applicativeHalogenM);
  var show111 = /* @__PURE__ */ show(showScene);
  var updateScene2 = /* @__PURE__ */ updateScene(bindD3v2SimM)(monadEffectD3v2SimM)(selectionMD3v2Selection_D1)(simulationM2D3v2Selection);
  var Initialize3 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var SwitchScene = /* @__PURE__ */ (function() {
    function SwitchScene2(value0) {
      this.value0 = value0;
    }
    ;
    SwitchScene2.create = function(value0) {
      return new SwitchScene2(value0);
    };
    return SwitchScene2;
  })();
  var render4 = function(state3) {
    return div2([class_("code-explorer-v2-page")])([div2([class_("page-header")])([h1_([text2("Code Explorer V2")]), p([class_("page-description")])([text2("Clean rebuild of Code Explorer using LesMisGUP patterns.")])]), div2([class_("controls-panel")])([div2([class_("control-section")])([h3_([text2("Scenes")]), div2([class_("button-group")])([button([class_("control-button" + (function() {
      var $39 = eq5(state3.currentScene)(PackageGraph.value);
      if ($39) {
        return " active";
      }
      ;
      return "";
    })()), onClick(function(v) {
      return new SwitchScene(PackageGraph.value);
    })])([text2("Package Graph")]), button([class_("control-button" + (function() {
      var $40 = eq5(state3.currentScene)(HorizontalTree.value);
      if ($40) {
        return " active";
      }
      ;
      return "";
    })()), onClick(function(v) {
      return new SwitchScene(HorizontalTree.value);
    })])([text2("Horizontal Tree")])])])]), div2([id3("code-explorer-v2-viz"), class_("viz-container svg-container")])([]), div2([class_("info-panel")])([h3_([text2("About This Demo")]), p_([text2("This is a clean rebuild of Code Explorer following the patterns established in LesMisGUP.")]), ul_([li_([text2("Consistent Int IDs for nodes and links")]), li_([text2("Simple scene switching with proper GUP")]), li_([text2("Uses genericUpdateSimulation correctly")])])])]);
  };
  var forces = /* @__PURE__ */ (function() {
    return {
      charge: createForce("charge")(new RegularForce(ForceManyBody.value))(allNodes)([strengthVal(-300)]),
      collision: createForce("collision")(new RegularForce(ForceCollide.value))(allNodes)([radiusVal(20)]),
      center: createForce("center")(new RegularForce(ForceCenter.value))(allNodes)([xVal(0), yVal(0), strengthVal(0.1)]),
      links: createLinkForce(allNodes)([distanceVal(50)])
    };
  })();
  var handleAction2 = function(dictMonadAff) {
    var log9 = log3(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    var liftAff3 = liftAff(monadAffHalogenM(dictMonadAff));
    return function(v) {
      if (v instanceof Initialize3) {
        return discard11(log9("CodeExplorerV2: Initializing"))(function() {
          return discard11(liftAff3(delay(100)))(function() {
            return bind11(liftAff3(readModelData))(function(maybeModel) {
              return discard11((function() {
                if (maybeModel instanceof Nothing) {
                  return log9("Failed to load Spago model data");
                }
                ;
                if (maybeModel instanceof Just) {
                  return discard11(modify_5(function(v1) {
                    var $43 = {};
                    for (var $44 in v1) {
                      if ({}.hasOwnProperty.call(v1, $44)) {
                        $43[$44] = v1[$44];
                      }
                      ;
                    }
                    ;
                    $43.model = new Just(maybeModel.value0);
                    return $43;
                  }))(function() {
                    var forcesArray = [forces.charge, forces.collision, forces.center, forces.links];
                    var activeForces2 = fromFoldable30(["charge", "collision", "center", linksForceName_]);
                    return bind11(get9)(function(state3) {
                      return bind11(liftAff3(execD3v2SimM({
                        simulation: state3.simulation
                      })(initialize3(forcesArray)(activeForces2)(maybeModel.value0)(maybeModel.value0.links)("#code-explorer-v2-viz")(PackageGraph.value))))(function(newState) {
                        return discard11(modify_5(function(s) {
                          var $46 = {};
                          for (var $47 in s) {
                            if ({}.hasOwnProperty.call(s, $47)) {
                              $46[$47] = s[$47];
                            }
                            ;
                          }
                          ;
                          $46.simulation = newState.simulation;
                          return $46;
                        }))(function() {
                          return log9("CodeExplorerV2: Initialized with " + (show21(length(maybeModel.value0.nodes)) + " nodes"));
                        });
                      });
                    });
                  });
                }
                ;
                throw new Error("Failed pattern match at Component.CodeExplorerV2 (line 137, column 5 - line 150, column 97): " + [maybeModel.constructor.name]);
              })())(function() {
                return pure11(unit);
              });
            });
          });
        });
      }
      ;
      if (v instanceof SwitchScene) {
        return discard11(log9("CodeExplorerV2: Switching to " + show111(v.value0)))(function() {
          return bind11(get9)(function(state3) {
            return discard11((function() {
              if (state3.model instanceof Nothing) {
                return log9("Error: Model not loaded");
              }
              ;
              if (state3.model instanceof Just) {
                var activeForces2 = (function() {
                  if (v.value0 instanceof PackageGraph) {
                    return fromFoldable30(["charge", "collision", "center", linksForceName_]);
                  }
                  ;
                  if (v.value0 instanceof HorizontalTree) {
                    return fromFoldable30(["collision"]);
                  }
                  ;
                  throw new Error("Failed pattern match at Component.CodeExplorerV2 (line 161, column 28 - line 163, column 63): " + [v.value0.constructor.name]);
                })();
                return bind11(liftAff3(execD3v2SimM({
                  simulation: state3.simulation
                })(updateScene2(state3.model.value0)(state3.model.value0.links)(v.value0)(activeForces2))))(function(newState) {
                  return modify_5(function(s) {
                    var $52 = {};
                    for (var $53 in s) {
                      if ({}.hasOwnProperty.call(s, $53)) {
                        $52[$53] = s[$53];
                      }
                      ;
                    }
                    ;
                    $52.simulation = newState.simulation;
                    $52.currentScene = v.value0;
                    return $52;
                  });
                });
              }
              ;
              throw new Error("Failed pattern match at Component.CodeExplorerV2 (line 157, column 5 - line 171, column 12): " + [state3.model.constructor.name]);
            })())(function() {
              return pure11(unit);
            });
          });
        });
      }
      ;
      throw new Error("Failed pattern match at Component.CodeExplorerV2 (line 130, column 16 - line 173, column 14): " + [v.constructor.name]);
    };
  };
  var forceLibrary = /* @__PURE__ */ (function() {
    return initialize(foldableArray)(functorArray)([forces.charge, forces.collision, forces.center, forces.links]);
  })();
  var component2 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return {
          simulation: initialSimulationState(forceLibrary),
          model: Nothing.value,
          currentScene: PackageGraph.value
        };
      },
      render: render4,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction2(dictMonadAff),
        initialize: new Just(Initialize3.value)
      })
    });
  };

  // output/CodeSnippets/index.js
  var snippet_treeViz_content = 'drawTree :: String -> Tree HierNode -> Effect Unit\ndrawTree selector flareTree = runD3v2M do\n  container <- select selector :: _ (D3v2Selection_ SEmpty Element Unit)\n\n  let chartWidth = 800.0\n  let chartHeight = 600.0\n  let padding = 40.0\n\n  -- Apply Tree4 layout\n  let config = defaultTreeConfig\n        { size = { width: chartWidth - (2.0 * padding)\n                 , height: chartHeight - (2.0 * padding) } }\n  let positioned = tree config flareTree\n\n  -- Flatten to arrays\n  let nodes = Array.fromFoldable positioned\n  let links = makeLinks positioned\n\n  liftEffect $ Console.log $ "Rendering " <> show (Array.length nodes) <> " nodes, " <> show (Array.length links) <> " links"\n\n  -- First tree: SVG container with links (datum type: link data)\n  let linksTree :: T.Tree LinkDatum\n      linksTree =\n        T.named SVG "svg"\n          [ width chartWidth\n          , height chartHeight\n          , viewBox ("0 0 " <> show chartWidth <> " " <> show chartHeight)\n          , class_ "simple-hierarchy-tree"\n          ]\n          `T.withChild`\n            (T.named Group "chartGroup"\n              [ class_ "tree-content" ]\n              `T.withChild`\n                (T.named Group "linksGroup"\n                  [ class_ "links" ]\n                  `T.withChild`\n                    (T.joinData "links" "path" links $ \\link ->\n                      T.elem Path\n                        [ d (linkPath\n                            (link.source.x + padding)\n                            (link.source.y + padding)\n                            (link.target.x + padding)\n                            (link.target.y + padding))\n                        , fill "none"\n                        , stroke "#999"\n                        , strokeWidth 1.5\n                        , class_ "link"\n                        ]\n                    )\n                )\n            )\n\n  -- Render links first (underlaying)\n  linksSelections <- renderTree container linksTree\n\n  -- Second tree: Nodes on top (datum type: HierNode)\n  -- Reselect the chartGroup from rendered selections (not global CSS selector!)\n  chartGroupSel <- liftEffect $ reselectD3v2 "chartGroup" linksSelections\n\n  let nodesTree :: T.Tree HierNode\n      nodesTree =\n        T.named Group "nodesGroup"\n          [ class_ "nodes" ]\n          `T.withChild`\n            (T.joinData "nodeGroups" "g" nodes $ \\node ->\n              T.named Group ("node-" <> node.name)\n                [ class_ "node" ]\n                `T.withChildren`\n                  [ T.elem Circle\n                      [ cx (node.x + padding)\n                      , cy (node.y + padding)\n                      , radius 6.0\n                      , fill "#69b3a2"\n                      , stroke "#fff"\n                      , strokeWidth 2.0\n                      ]\n                  , T.elem Text\n                      [ x (node.x + padding + 10.0)\n                      , y (node.y + padding + 4.0)\n                      , textContent node.name\n                      , fontSize 12.0\n                      , textAnchor "start"\n                      ]\n                  ]\n            )\n\n  -- Render nodes on top (overlaying)\n  nodesSelections <- renderTree chartGroupSel nodesTree';
  var snippet_threeLittleDimensions_content = 'threeLittleDimensions :: Effect Unit\nthreeLittleDimensions = runD3v2M do\n  container <- select "#viz" :: _ (D3v2Selection_ SEmpty Element Unit)\n\n  -- The challenge: how to represent nested decomposition in a tree?\n  -- Outer datum type: Array Int (a row)\n  -- Inner datum type: Int (a cell value)\n\n  -- Approach: Use nestedJoin to handle datum type decomposition\n  -- Outer type: Array Int (a row)\n  -- Inner type: Int (a cell value)\n  let tree :: T.Tree (Array Int)\n      tree =\n        T.named Table "table"\n          [ class_ "nested-data-table" ]\n          `T.withChild`\n            -- nestedJoin handles the type change from Array Int \u2192 Int\n            -- identity is the decomposer: it just returns the row data as-is\n            (T.nestedJoin "rows" "tr" matrixData identity $ \\cellValue ->\n              -- cellValue :: Int (decomposed from Array Int)\n              T.elem Td\n                [ class_ "table-cell"\n                , textContent (show cellValue)\n                ]\n            )\n\n  -- Render the tree\n  selections <- renderTree container tree';
  var snippet_threeLittleCircles_content = 'type CircleData =\n  { x :: Number\n  , y :: Number\n  , r :: Number\n  , color :: String\n  }\n\ncircleData :: Array CircleData\ncircleData =\n  [ { x: 100.0, y: 100.0, r: 40.0, color: "red" }\n  , { x: 200.0, y: 100.0, r: 30.0, color: "green" }\n  , { x: 300.0, y: 100.0, r: 50.0, color: "blue" }\n  ]\n\nthreeLittleCircles :: Effect Unit\nthreeLittleCircles = runD3v2M do\n  container <- select "#viz" :: _ (D3v2Selection_ SEmpty Element Unit)\n\n  -- Define the tree with a DATA JOIN\n  -- Note: The datum type is CircleData because we\'re using joinData with CircleData\n  let tree :: Tree CircleData\n      tree =\n        T.named SVG "svg"\n          [ width 400.0\n          , height 200.0\n          , viewBox "0 0 400 200"\n          , id_ "three-circles-svg"\n          , class_ "tree-api-example"\n          ]\n          `T.withChild`\n            -- Here\'s the magic: joinData creates N copies of the template\n            (joinData "circles" "circle" circleData $ \\d ->\n              T.elem Circle\n                [ cx d.x\n                , cy d.y\n                , radius d.r\n                , fill d.color\n                ])';
  var snippet_threeLittleCirclesTransition_content = 'threeLittleCirclesTransition :: String -> Effect { stateRef :: Ref.Ref CircleState, circlesSel :: D3v2Selection_ SBoundOwns Element CircleData }\nthreeLittleCirclesTransition selector = do\n  -- Create state ref - start with green circles\n  stateRef <- Ref.new StateGreen\n\n  runD3v2M do\n    container <- select selector :: _ (D3v2Selection_ SEmpty Element Unit)\n\n    -- Initial tree: three green circles in a row\n    let initialTree :: T.Tree CircleData\n        initialTree =\n          T.named SVG "svg"\n            [ width 400.0\n            , height 250.0\n            , viewBox "0 0 400 250"\n            , id_ "three-circles-transition-tree"\n            ]\n            `T.withChild`\n              (T.joinData "circles" "circle" [0, 1, 2] $ \\d ->\n                T.elem Circle\n                  [ fill "#00ff00"  -- Start green\n                  , cx (100.0 + toNumber d * 100.0)  -- Three in a row\n                  , cy 125.0\n                  , radius 40.0\n                  , fillOpacity 1.0\n                  ]\n              )\n\n    -- Render initial state\n    selections <- renderTree container initialTree\n\n    -- Extract the circles selection for transitions\n    let circlesSel = case Map.lookup "circles" selections of\n          Just sel -> sel\n          Nothing -> unsafePartial $ unsafeCrashWith "circles selection not found"\n\n    -- Return the state ref and selection so external button can trigger transition\n    pure { stateRef, circlesSel }';
  var snippet_simpleTree_content = 'testSimpleTree :: Effect Unit\ntestSimpleTree = runD3v2M do\n  -- Select the container\n  container <- select "#viz" :: _  (D3v2Selection_ SEmpty Element Unit)\n\n  -- Define the tree structure using the declarative API\n  let tree :: Tree Unit\n      tree =\n        T.named SVG "svg" [width 800.0, height 600.0, viewBox "0 0 800 600", id_ "simple-tree-svg"]\n          `T.withChild`\n            (T.named Group "container" [class_ "container"]\n              `T.withChildren`\n                [ T.named Circle "circle" [cx 100.0, cy 100.0, radius 20.0, fill "steelblue"]\n                , T.named Text "text" [x 100.0, y 130.0, textContent "Hello Tree API!", textAnchor "middle"]\n                ])\n\n  -- Render the tree\n  selections <- renderTree container tree';
  var snippet_scatterPlot_content = 'scatterPlot :: Effect Unit\nscatterPlot = runD3v2M do\n  container <- select "#viz" :: _ (D3v2Selection_ SEmpty Element Unit)\n\n  let dims = defaultDims\n  let iWidth = innerWidth dims\n  let iHeight = innerHeight dims\n\n  -- Calculate data extents\n  let xValues = map _.x scatterData\n  let yValues = map _.y scatterData\n  let minX = fromMaybe 0.0 $ minimum xValues\n  let maxX = fromMaybe 100.0 $ maximum xValues\n  let minY = fromMaybe 0.0 $ minimum yValues\n  let maxY = fromMaybe 100.0 $ maximum yValues\n\n  -- Simple linear scale functions\n  let xScale val = ((val - minX) / (maxX - minX)) * iWidth\n  let yScale val = iHeight - ((val - minY) / (maxY - minY)) * iHeight\n\n  -- Define the tree structure\n  let tree :: Tree Point\n      tree =\n        T.named SVG "svg"\n          [ width dims.width\n          , height dims.height\n          , viewBox ("0 0 " <> show dims.width <> " " <> show dims.height)\n          , class_ "scatter-plot-tree"\n          ]\n          `T.withChild`\n            (T.named Group "chartGroup"\n              [ class_ "chart-content"\n              , transform ("translate(" <> show dims.marginLeft <> "," <> show dims.marginTop <> ")")\n              ]\n              `T.withChild`\n                -- Data join for points\n                (joinData "points" "circle" scatterData $ \\point ->\n                  T.elem Circle\n                    [ cx (xScale point.x)\n                    , cy (yScale point.y)\n                    , radius 6.0\n                    , fill "#e74c3c"\n                    , opacity 0.7\n                    , class_ "point"\n                    ]\n                ))\n\n  -- Render the tree\n  selections <- renderTree container tree';
  var snippet_nestedElements_content = 'testNestedElements :: Effect Unit\ntestNestedElements = runD3v2M do\n  container <- select "#viz" :: _ (D3v2Selection_ SEmpty Element Unit)\n\n  -- Define a tree with MULTI-LEVEL NESTING\n  -- This is the pattern: Group \u2192 (Circle + Text)\n  let tree :: Tree Unit\n      tree =\n        T.named SVG "svg"\n          [ width 600.0\n          , height 400.0\n          , viewBox "0 0 600 400"\n          , id_ "nested-example-svg"\n          ]\n          `T.withChild`\n            (T.named Group "mainGroup" [class_ "main-group"]\n              `T.withChildren`\n                -- Multiple node groups, each with Circle + Text\n                [ -- Node 1\n                  T.named Group "node1"\n                    [ class_ "node"\n                    , transform "translate(100, 100)"\n                    ]\n                    `T.withChildren`\n                      [ T.named Circle "node1Circle"\n                          [ cx 0.0, cy 0.0\n                          , radius 25.0\n                          , fill "steelblue"\n                          , stroke "white"\n                          , strokeWidth 2.0\n                          ]\n                      , T.named Text "node1Label"\n                          [ x 0.0, y 40.0\n                          , textContent "Node A"\n                          , textAnchor "middle"\n                          , fontSize 14.0\n                          ]\n                      ]\n\n                , -- Node 2\n                  T.named Group "node2"\n                    [ class_ "node"\n                    , transform "translate(300, 150)"\n                    ]\n                    `T.withChildren`\n                      [ T.named Circle "node2Circle"\n                          [ cx 0.0, cy 0.0\n                          , radius 20.0\n                          , fill "orange"\n                          , stroke "white"\n                          , strokeWidth 2.0\n                          ]\n                      , T.named Text "node2Label"\n                          [ x 0.0, y 35.0\n                          , textContent "Node B"\n                          , textAnchor "middle"\n                          , fontSize 14.0\n                          ]\n                      ]\n\n                , -- Node 3\n                  T.named Group "node3"\n                    [ class_ "node"\n                    , transform "translate(500, 100)"\n                    ]\n                    `T.withChildren`\n                      [ T.named Circle "node3Circle"\n                          [ cx 0.0, cy 0.0\n                          , radius 30.0\n                          , fill "green"\n                          , stroke "white"\n                          , strokeWidth 2.0\n                          ]\n                      , T.named Text "node3Label"\n                          [ x 0.0, y 45.0\n                          , textContent "Node C"\n                          , textAnchor "middle"\n                          , fontSize 14.0\n                          ]\n                      ]\n                ])';
  var snippet_lineChart_content = 'lineChart :: Effect Unit\nlineChart = runD3v2M do\n  container <- select "#viz" :: _ (D3v2Selection_ SEmpty Element Unit)\n\n  let dims = defaultDims\n\n  -- Calculate data extents\n  let xValues = map _.x lineData\n  let yValues = map _.y lineData\n  let minX = fromMaybe 0.0 $ minimum xValues\n  let maxX = fromMaybe 10.0 $ maximum xValues\n  let minY = fromMaybe 0.0 $ minimum yValues\n  let maxY = fromMaybe 100.0 $ maximum yValues\n\n  -- Generate path data\n  let pathData = pointsToPath dims lineData minX maxX minY maxY\n\n  -- Define the tree structure\n  let tree :: Tree Unit\n      tree =\n        T.named SVG "svg"\n          [ width dims.width\n          , height dims.height\n          , viewBox ("0 0 " <> show dims.width <> " " <> show dims.height)\n          , class_ "line-chart-tree"\n          ]\n          `T.withChild`\n            (T.named Group "chartGroup"\n              [ class_ "chart-content"\n              , transform ("translate(" <> show dims.marginLeft <> "," <> show dims.marginTop <> ")")\n              ]\n              `T.withChild`\n                -- Single path element for the line\n                (T.named Path "line"\n                  [ d pathData\n                  , fill "none"\n                  , stroke "#2ecc71"\n                  , strokeWidth 2.0\n                  , class_ "line"\n                  ]\n                ))\n\n  -- Render the tree\n  selections <- renderTree container tree';
  var snippet_lesMisTree_content = '  -- Run with simulation state management\n  void $ liftAff $ runD3v2SimM initialState do\n    drawLesMisTree forcesArray activeForces model "#viz"\n\ndrawLesMisTree :: forall row.\n  Array (Force LesMisSimNode) ->\n  Set.Set String ->\n  LesMisRawModel ->\n  String ->\n  D3v2SimM row LesMisSimNode Unit\ndrawLesMisTree forcesArray activeForces model containerSelector = do\n  liftEffect $ Console.log $ "=== Drawing LesMis with Tree API ==="\n  liftEffect $ Console.log $ "Model has " <> show (Array.length model.nodes) <> " nodes, " <> show (Array.length model.links) <> " links"\n\n  -- Get window dimensions\n  (Tuple w h) <- liftEffect getWindowWidthHeight\n  liftEffect $ Console.log $ "Window dimensions: " <> show w <> " x " <> show h\n\n  -- Select container\n  container <- select containerSelector :: _ (D3v2Selection_ SEmpty Element Unit)\n\n  -- Apply phylotaxis initial positions\n  let nodesWithPositions = setPhyllotaxisPositions model.nodes\n\n  -- Initialize simulation first (so we have node/link data with positions)\n  liftEffect $ Console.log "Initializing simulation..."\n  { nodes: nodesInSim, links: linksInSim } <- init\n    { nodes: nodesWithPositions\n    , links: model.links\n    , forces: forcesArray\n    , activeForces: activeForces\n    , config:\n        { alpha: 1.0\n        , alphaTarget: 0.0\n        , alphaMin: 0.001\n        , alphaDecay: 0.0228\n        , velocityDecay: 0.4\n        }\n    , keyFn: keyIsID_\n    , ticks: Map.empty\n    }\n\n  liftEffect $ Console.log $ "Simulation initialized with " <> show (Array.length nodesInSim) <> " nodes, " <> show (Array.length linksInSim) <> " links"\n\n  -- Wrap links with indices for data join\n  let indexedLinks = Array.mapWithIndex (\\i link -> IndexedLink { index: i, link }) linksInSim\n  liftEffect $ Console.log $ "Created " <> show (Array.length indexedLinks) <> " indexed links"\n\n  -- Declarative tree structure for force graph\n  let forceGraphTree :: T.Tree Unit\n      forceGraphTree =\n        T.named SVG "svg"\n          [ width w\n          , height h\n          , viewBox (show ((-w) / 2.0) <> " " <> show ((-h) / 2.0) <> " " <> show w <> " " <> show h)\n          , id_ "lesmis-tree-svg"\n          , class_ "lesmis-tree"\n          ]\n          `T.withChild`\n            (T.named Group "zoomGroup"\n              [ id_ "zoom-group"\n              , class_ "zoom-group"\n              ]\n              `T.withChildren`\n                [ -- Links group (structural, no data)\n                  T.named Group "linksGroup"\n                    [ id_ "links"\n                    , class_ "links"\n                    ]\n                , -- Nodes group (structural, no data)\n                  T.named Group "nodesGroup"\n                    [ id_ "nodes"\n                    , class_ "nodes"\n                    ]\n                ])\n\n  -- Render the structure tree\n  liftEffect $ Console.log "Rendering structure tree..."\n  selections <- renderTree container forceGraphTree\n  liftEffect $ Console.log $ "Structure rendered, selections: " <> show (Map.keys selections)\n\n  -- Extract the linksGroup and nodesGroup for rendering data\n  -- Use reselectD3v2 to convert from SBoundOwns Unit to SEmpty datumOut\n  linksGroupSel <- liftEffect $ reselectD3v2 "linksGroup" selections\n  nodesGroupSel <- liftEffect $ reselectD3v2 "nodesGroup" selections\n  liftEffect $ Console.log "Extracted linksGroup and nodesGroup selections"\n\n  -- Render links tree into linksGroup\n  let linksTree :: T.Tree IndexedLink\n      linksTree =\n        T.joinData "linkElements" "line" indexedLinks $ \\(IndexedLink il) ->\n          let link = unsafeCoerce il.link\n          in T.elem Line\n            [ x1 ((\\(_ :: IndexedLink) -> link.source.x) :: IndexedLink -> Number)\n            , y1 ((\\(_ :: IndexedLink) -> link.source.y) :: IndexedLink -> Number)\n            , x2 ((\\(_ :: IndexedLink) -> link.target.x) :: IndexedLink -> Number)\n            , y2 ((\\(_ :: IndexedLink) -> link.target.y) :: IndexedLink -> Number)\n            , strokeWidth ((\\(_ :: IndexedLink) -> sqrt link.value) :: IndexedLink -> Number)\n            , stroke ((\\(_ :: IndexedLink) -> d3SchemeCategory10N_ (toNumber link.target.group)) :: IndexedLink -> String)\n            ]\n\n  liftEffect $ Console.log $ "Rendering " <> show (Array.length indexedLinks) <> " links into linksGroup..."\n  linksSelections <- renderTree linksGroupSel linksTree\n  liftEffect $ Console.log $ "Links rendered, selections: " <> show (Map.keys linksSelections)\n\n  -- Render nodes tree into nodesGroup\n  let nodesTree :: T.Tree LesMisSimNode\n      nodesTree =\n        T.joinData "nodeElements" "circle" nodesInSim $ \\(d :: LesMisSimNode) ->\n          T.elem Circle\n            [ cx d.x\n            , cy d.y\n            , radius 5.0\n            , fill (d3SchemeCategory10N_ (toNumber d.group))\n            , stroke "#fff"\n            , strokeWidth 2.0\n            ]\n\n  liftEffect $ Console.log $ "Rendering " <> show (Array.length nodesInSim) <> " nodes into nodesGroup..."\n  nodesSelections <- renderTree nodesGroupSel nodesTree\n  liftEffect $ Console.log $ "Nodes rendered, selections: " <> show (Map.keys nodesSelections)\n\n  -- Extract final selections for behaviors\n  zoomGroupSel <- liftEffect $ reselectD3v2 "zoomGroup" selections\n  svgSel <- liftEffect $ reselectD3v2 "svg" selections\n\n  -- Extract bound selections for drag and tick\n  -- IMPORTANT: Must use `case` pattern matching, NOT `fromMaybe`, when default might throw!\n  --\n  -- ROOT CAUSE: PureScript is strict, so `fromMaybe (unsafeCrashWith "error") maybe_value`\n  -- evaluates unsafeCrashWith BEFORE calling fromMaybe (JavaScript evaluates all arguments\n  -- before calling functions). The crash happens even if maybe_value is Just!\n  --\n  -- Pattern matching with `case` is lazy in unevaluated branches, so the Nothing branch\n  -- only executes if we actually match Nothing. This is the correct pattern when the\n  -- default might throw an exception or have side effects.\n  let nodesSel :: D3v2Selection_ SBoundOwns Element LesMisSimNode\n      nodesSel = case Map.lookup "nodeElements" nodesSelections of\n        Just sel -> sel\n        Nothing -> unsafePartial $ unsafeCrashWith "nodeElements not found"\n\n  let linksSel :: D3v2Selection_ SBoundOwns Element IndexedLink\n      linksSel = case Map.lookup "linkElements" linksSelections of\n        Just sel -> sel\n        Nothing -> unsafePartial $ unsafeCrashWith "linkElements not found"\n\n  -- Attach behaviors\n  _ <- on (Drag defaultDrag) zoomGroupSel\n  _ <- on (Zoom $ defaultZoom (ScaleExtent 0.5 4.0) "#zoom-group") svgSel\n  _ <- on (Drag $ simulationDrag "lesmis-tree") nodesSel\n\n  -- Add tick functions to update positions\n  addTickFunction "nodes" $ Step nodesSel\n    [ cx (\\(d :: LesMisSimNode) -> d.x)\n    , cy (\\(d :: LesMisSimNode) -> d.y)\n    ]\n\n  addTickFunction "links" $ Step linksSel\n    [ x1 (\\(IndexedLink il) -> (unsafeCoerce il.link).source.x :: Number)\n    , y1 (\\(IndexedLink il) -> (unsafeCoerce il.link).source.y :: Number)\n    , x2 (\\(IndexedLink il) -> (unsafeCoerce il.link).target.x :: Number)\n    , y2 (\\(IndexedLink il) -> (unsafeCoerce il.link).target.y :: Number)\n    ]';
  var snippet_groupedBarChart_content = 'drawGroupedBarChart :: String -> Array GroupedBarData -> Effect Unit\ndrawGroupedBarChart selector populationData = runD3v2M do\n  container <- select selector :: _ (D3v2Selection_ SEmpty Element Unit)\n\n  let dims = defaultDims\n  let iWidth = innerWidth dims\n  let iHeight = innerHeight dims\n\n  -- Group data by state\n  let stateGroups = groupByState populationData\n  let ages = getAges populationData\n  let numStates = Array.length stateGroups\n  let numAges = Array.length ages\n\n  -- Calculate bar dimensions\n  let groupWidth = iWidth / Int.toNumber numStates\n  let barWidth = groupWidth / Int.toNumber numAges * 0.9\n\n  -- Calculate scales\n  let populationValues = map _.population populationData\n  let maxPop = fromMaybe 6000000.0 $ maximum populationValues\n\n  -- X scale maps state index to position\n  let xScale :: Scale\n      xScale =\n        { domain: { min: 0.0, max: Int.toNumber numStates }\n        , range: { min: 0.0, max: iWidth }\n        }\n\n  -- Y scale maps population to height\n  let yScale :: Scale\n      yScale =\n        { domain: { min: 0.0, max: maxPop }\n        , range: { min: iHeight, max: 0.0 }\n        }\n\n  -- Create axes\n  let xAxis = axisBottom xScale\n  let yAxis = axisLeft yScale\n\n  -- First tree: SVG container with axes\n  let axesTree :: T.Tree Unit\n      axesTree =\n        T.named SVG "svg"\n          [ width dims.width\n          , height dims.height\n          , viewBox ("0 0 " <> show dims.width <> " " <> show dims.height)\n          , class_ "grouped-bar-chart"\n          ]\n          `T.withChild`\n            (T.named Group "chartGroup"\n              [ class_ "chart-content"\n              , transform ("translate(" <> show dims.marginLeft <> "," <> show dims.marginTop <> ")")\n              ]\n              `T.withChildren`\n                [ -- X axis\n                  T.named Group "xAxis"\n                    [ transform ("translate(0," <> show iHeight <> ")")\n                    , class_ "x-axis"\n                    ]\n                    `T.withChild`\n                      renderAxis xAxis\n                , -- Y axis\n                  T.named Group "yAxis"\n                    [ class_ "y-axis"\n                    ]\n                    `T.withChild`\n                      renderAxis yAxis\n                ])\n\n  -- Render axes\n  axesSelections <- renderTree container axesTree\n\n  -- Second tree: Grouped bars\n  -- Extract the chartGroup selection for the second render\n  chartGroupSel <- liftEffect $ reselectD3v2 "chartGroup" axesSelections\n\n  -- Use nestedJoin to create state groups \u2192 bars\n  let barsTree :: T.Tree StateGroup\n      barsTree =\n        T.nestedJoin "stateGroups" "g" stateGroups (_.bars) $ \\bar ->\n          -- bar :: GroupedBarData\n          -- Calculate position for this bar\n          let\n            -- Find which state this bar belongs to\n            stateIdx = fromMaybe 0 $ findIndex (\\g -> g.state == bar.state) stateGroups\n            -- Find which age group this is\n            ageIdx = fromMaybe 0 $ findIndex (\\a -> a == bar.age) ages\n\n            -- X position: state position + age offset\n            xPos = Int.toNumber stateIdx * groupWidth + Int.toNumber ageIdx * barWidth\n\n            -- Y position and height from population\n            yPos = iHeight - ((bar.population / maxPop) * iHeight)\n            barHeight = (bar.population / maxPop) * iHeight\n          in\n            T.elem Rect\n              [ x xPos\n              , y yPos\n              , width barWidth\n              , height barHeight\n              , fill (colorForAge bar.age)\n              , class_ "bar"\n              ]\n\n  -- Render bars\n  barsSelections <- renderTree chartGroupSel barsTree';
  var snippet_barChart_content = 'barChart :: Effect Unit\nbarChart = runD3v2M do\n  container <- select "#viz" :: _ (D3v2Selection_ SEmpty Element Unit)\n\n  let dims = defaultDims\n  let iWidth = innerWidth dims\n  let iHeight = innerHeight dims\n\n  -- Calculate data extents\n  let yValues = map _.y sampleData\n  let minY = 0.0  -- Start bars from zero\n  let maxY = fromMaybe 100.0 $ maximum yValues\n\n  -- Calculate bar width (80% of available space per bar)\n  let numBars = length sampleData\n  let barWidth = if numBars > 0 then (iWidth / (Int.toNumber numBars)) * 0.8 else 0.0\n\n  -- KEY: Create scales to map data values \u2192 pixel positions\n  -- Scales are the bridge between data space and visual space\n  let xScale :: Scale\n      xScale =\n        { domain: { min: 1.0, max: Int.toNumber numBars }  -- Data range\n        , range: { min: 0.0, max: iWidth }                  -- Pixel range\n        }\n\n  let yScale :: Scale\n      yScale =\n        { domain: { min: minY, max: maxY }    -- Data range (0 to max value)\n        , range: { min: iHeight, max: 0.0 }   -- Pixel range (inverted for SVG coords)\n        }\n\n  -- Create axes\n  let xAxis = axisBottom xScale\n  let yAxis = axisLeft yScale\n\n  -- First, render the SVG container with axes (datum type: Unit)\n  let axesTree :: Tree Unit\n      axesTree =\n        T.named SVG "svg"\n          [ width dims.width\n          , height dims.height\n          , viewBox ("0 0 " <> show dims.width <> " " <> show dims.height)\n          , class_ "bar-chart-tree"\n          ]\n          `T.withChild`\n            (T.named Group "chartGroup"\n              [ class_ "chart-content"\n              , transform ("translate(" <> show dims.marginLeft <> "," <> show dims.marginTop <> ")")\n              ]\n              `T.withChildren`\n                [ -- X axis\n                  T.named Group "xAxis"\n                    [ transform ("translate(0," <> show iHeight <> ")")\n                    , class_ "x-axis"\n                    ]\n                    `T.withChild`\n                      renderAxis xAxis\n                , -- Y axis\n                  T.named Group "yAxis"\n                    [ class_ "y-axis"\n                    ]\n                    `T.withChild`\n                      renderAxis yAxis\n                ])\n\n  -- Render axes first (underlaying)\n  axesSelections <- renderTree container axesTree\n\n  -- KEY: Reselect the chartGroup for layered rendering\n  -- This allows us to render bars on top of axes\n  chartGroupSel <- liftEffect $ reselectD3v2 "chartGroup" axesSelections\n\n  -- KEY: Data join creates one rect per data point\n  let barsTree :: Tree DataPoint\n      barsTree =\n        T.joinData "bars" "rect" sampleData $ \\point ->\n          -- Calculate bar position and dimensions from data\n          let xPos = (point.x - 1.0) * (iWidth / (Int.toNumber numBars)) + ((iWidth / (Int.toNumber numBars)) - barWidth) / 2.0\n              yPos = iHeight - ((point.y - minY) / (maxY - minY) * iHeight)  -- Manual scale calculation\n              barHeight = iHeight - yPos  -- Bar grows from baseline\n          in T.elem Rect\n            [ x xPos          -- Horizontal position\n            , y yPos          -- Top of bar (SVG coords from top-left)\n            , width barWidth  -- Bar width\n            , height barHeight  -- Bar height (grows downward in SVG)\n            , fill "#4a90e2"\n            , stroke "#357abd"\n            , strokeWidth 1.0\n            , class_ "bar"\n            ]\n\n  -- Render bars into the chart group (overlaying)\n  barsSelections <- renderTree chartGroupSel barsTree';
  var getSnippet = function(name16) {
    if (name16 === "barChart") {
      return snippet_barChart_content;
    }
    ;
    if (name16 === "groupedBarChart") {
      return snippet_groupedBarChart_content;
    }
    ;
    if (name16 === "lesMisTree") {
      return snippet_lesMisTree_content;
    }
    ;
    if (name16 === "lineChart") {
      return snippet_lineChart_content;
    }
    ;
    if (name16 === "nestedElements") {
      return snippet_nestedElements_content;
    }
    ;
    if (name16 === "scatterPlot") {
      return snippet_scatterPlot_content;
    }
    ;
    if (name16 === "simpleTree") {
      return snippet_simpleTree_content;
    }
    ;
    if (name16 === "threeLittleCircles") {
      return snippet_threeLittleCircles_content;
    }
    ;
    if (name16 === "threeLittleCirclesTransition") {
      return snippet_threeLittleCirclesTransition_content;
    }
    ;
    if (name16 === "threeLittleDimensions") {
      return snippet_threeLittleDimensions_content;
    }
    ;
    if (name16 === "treeViz") {
      return snippet_treeViz_content;
    }
    ;
    return "Snippet not found: " + name16;
  };

  // output/Data.Number.Format/foreign.js
  function wrap3(method2) {
    return function(d18) {
      return function(num) {
        return method2.apply(num, [d18]);
      };
    };
  }
  var toPrecisionNative = wrap3(Number.prototype.toPrecision);
  var toFixedNative = wrap3(Number.prototype.toFixed);
  var toExponentialNative = wrap3(Number.prototype.toExponential);
  function toString(num) {
    return num.toString();
  }

  // output/Data.Number.Format/index.js
  var clamp2 = /* @__PURE__ */ clamp(ordInt);
  var Precision = /* @__PURE__ */ (function() {
    function Precision2(value0) {
      this.value0 = value0;
    }
    ;
    Precision2.create = function(value0) {
      return new Precision2(value0);
    };
    return Precision2;
  })();
  var Fixed = /* @__PURE__ */ (function() {
    function Fixed2(value0) {
      this.value0 = value0;
    }
    ;
    Fixed2.create = function(value0) {
      return new Fixed2(value0);
    };
    return Fixed2;
  })();
  var Exponential = /* @__PURE__ */ (function() {
    function Exponential3(value0) {
      this.value0 = value0;
    }
    ;
    Exponential3.create = function(value0) {
      return new Exponential3(value0);
    };
    return Exponential3;
  })();
  var toStringWith = function(v) {
    if (v instanceof Precision) {
      return toPrecisionNative(v.value0);
    }
    ;
    if (v instanceof Fixed) {
      return toFixedNative(v.value0);
    }
    ;
    if (v instanceof Exponential) {
      return toExponentialNative(v.value0);
    }
    ;
    throw new Error("Failed pattern match at Data.Number.Format (line 59, column 1 - line 59, column 43): " + [v.constructor.name]);
  };
  var fixed = /* @__PURE__ */ (function() {
    var $9 = clamp2(0)(20);
    return function($10) {
      return Fixed.create($9($10));
    };
  })();

  // output/PSD3v2.Axis.Axis/index.js
  var map41 = /* @__PURE__ */ map(functorArray);
  var show24 = /* @__PURE__ */ show(showNumber);
  var class_6 = /* @__PURE__ */ class_2(toAttrStringString);
  var transform4 = /* @__PURE__ */ transform2(toAttrStringString);
  var x12 = /* @__PURE__ */ x1(toAttrNumberNumber);
  var y12 = /* @__PURE__ */ y1(toAttrNumberNumber);
  var x23 = /* @__PURE__ */ x22(toAttrNumberNumber);
  var y23 = /* @__PURE__ */ y22(toAttrNumberNumber);
  var stroke4 = /* @__PURE__ */ stroke(toAttrStringString);
  var x5 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y5 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var textAnchor3 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var dy2 = /* @__PURE__ */ dy(toAttrNumberNumber);
  var fill6 = /* @__PURE__ */ fill3(toAttrStringString);
  var fontSize3 = /* @__PURE__ */ fontSize2(toAttrNumberNumber);
  var textContent4 = /* @__PURE__ */ textContent(toAttrStringString);
  var append110 = /* @__PURE__ */ append(semigroupArray);
  var d6 = /* @__PURE__ */ d4(toAttrStringString);
  var Top = /* @__PURE__ */ (function() {
    function Top2() {
    }
    ;
    Top2.value = new Top2();
    return Top2;
  })();
  var Right2 = /* @__PURE__ */ (function() {
    function Right4() {
    }
    ;
    Right4.value = new Right4();
    return Right4;
  })();
  var Bottom = /* @__PURE__ */ (function() {
    function Bottom2() {
    }
    ;
    Bottom2.value = new Bottom2();
    return Bottom2;
  })();
  var Left2 = /* @__PURE__ */ (function() {
    function Left4() {
    }
    ;
    Left4.value = new Left4();
    return Left4;
  })();
  var generateTicks = function(scale) {
    return function(count) {
      var step4 = (scale.domain.max - scale.domain.min) / toNumber(count);
      return map41(function(i2) {
        return scale.domain.min + toNumber(i2) * step4;
      })(range2(0)(count));
    };
  };
  var defaultTickFormat = function(n) {
    var $30 = n === 0;
    if ($30) {
      return "0";
    }
    ;
    return toStringWith(fixed(1))(n);
  };
  var defaultAxisConfig = /* @__PURE__ */ (function() {
    return {
      tickSize: 6,
      tickPadding: 3,
      tickCount: 10,
      tickFormat: Nothing.value
    };
  })();
  var axisLeft = function(scale) {
    return {
      orientation: Left2.value,
      scale,
      config: defaultAxisConfig
    };
  };
  var axisBottom = function(scale) {
    return {
      orientation: Bottom.value,
      scale,
      config: defaultAxisConfig
    };
  };
  var applyScale = function(scale) {
    return function(value18) {
      var rangeSpan = scale.range.max - scale.range.min;
      var domainSpan = scale.domain.max - scale.domain.min;
      var normalized = (value18 - scale.domain.min) / domainSpan;
      return scale.range.min + normalized * rangeSpan;
    };
  };
  var renderAxis = function(ax) {
    var ticks = generateTicks(ax.scale)(ax.config.tickCount);
    var formatter = fromMaybe(defaultTickFormat)(ax.config.tickFormat);
    var v = (function() {
      if (ax.orientation instanceof Bottom) {
        return {
          domainPath: "M" + (show24(ax.scale.range.min) + (",0H" + show24(ax.scale.range.max))),
          tickTransform: function(pos) {
            return "translate(" + (show24(pos) + ",0)");
          },
          tickLine: {
            x1: 0,
            y1: 0,
            x2: 0,
            y2: ax.config.tickSize
          },
          tickText: {
            x: 0,
            y: ax.config.tickSize + ax.config.tickPadding,
            anchor: "middle",
            dyVal: 7
          }
        };
      }
      ;
      if (ax.orientation instanceof Left2) {
        return {
          domainPath: "M0," + (show24(ax.scale.range.min) + ("V" + show24(ax.scale.range.max))),
          tickTransform: function(pos) {
            return "translate(0," + (show24(pos) + ")");
          },
          tickLine: {
            x1: -ax.config.tickSize,
            y1: 0,
            x2: 0,
            y2: 0
          },
          tickText: {
            x: -(ax.config.tickSize + ax.config.tickPadding),
            y: 0,
            anchor: "end",
            dyVal: 3
          }
        };
      }
      ;
      if (ax.orientation instanceof Top) {
        return {
          domainPath: "M" + (show24(ax.scale.range.min) + (",0H" + show24(ax.scale.range.max))),
          tickTransform: function(pos) {
            return "translate(" + (show24(pos) + ",0)");
          },
          tickLine: {
            x1: 0,
            y1: -ax.config.tickSize,
            x2: 0,
            y2: 0
          },
          tickText: {
            x: 0,
            y: -(ax.config.tickSize + ax.config.tickPadding),
            anchor: "middle",
            dyVal: 0
          }
        };
      }
      ;
      if (ax.orientation instanceof Right2) {
        return {
          domainPath: "M0," + (show24(ax.scale.range.min) + ("V" + show24(ax.scale.range.max))),
          tickTransform: function(pos) {
            return "translate(0," + (show24(pos) + ")");
          },
          tickLine: {
            x1: 0,
            y1: 0,
            x2: ax.config.tickSize,
            y2: 0
          },
          tickText: {
            x: ax.config.tickSize + ax.config.tickPadding,
            y: 0,
            anchor: "start",
            dyVal: 3
          }
        };
      }
      ;
      throw new Error("Failed pattern match at PSD3v2.Axis.Axis (line 118, column 57 - line 142, column 10): " + [ax.orientation.constructor.name]);
    })();
    var tickElements = map41(function(tickValue) {
      var pos = applyScale(ax.scale)(tickValue);
      return withChildren(elem4(Group2.value)([class_6("tick"), transform4(v.tickTransform(pos))]))([elem4(Line2.value)([x12(v.tickLine.x1), y12(v.tickLine.y1), x23(v.tickLine.x2), y23(v.tickLine.y2), stroke4("currentColor")]), elem4(Text3.value)([x5(v.tickText.x), y5(v.tickText.y), textAnchor3(v.tickText.anchor), dy2(v.tickText.dyVal), fill6("currentColor"), fontSize3(10), textContent4(formatter(tickValue))])]);
    })(ticks);
    return withChildren(elem4(Group2.value)([class_6("axis"), fill6("none"), fontSize3(10), stroke4("currentColor")]))(append110([elem4(Path3.value)([class_6("domain"), stroke4("currentColor"), d6(v.domainPath)])])(tickElements));
  };

  // output/D3.Viz.TreeAPI.BarChartExample/index.js
  var bind14 = /* @__PURE__ */ bind(bindD3v2M);
  var map42 = /* @__PURE__ */ map(functorArray);
  var maximum4 = /* @__PURE__ */ maximum(ordNumber)(foldableArray);
  var width10 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height10 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox4 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var show25 = /* @__PURE__ */ show(showNumber);
  var class_7 = /* @__PURE__ */ class_2(toAttrStringString);
  var transform5 = /* @__PURE__ */ transform2(toAttrStringString);
  var renderTree3 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D);
  var renderTree1 = /* @__PURE__ */ renderTree3(ordUnit);
  var liftEffect5 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var x6 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y6 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var fill7 = /* @__PURE__ */ fill3(toAttrStringString);
  var stroke5 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth5 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var renderTree22 = /* @__PURE__ */ renderTree3(/* @__PURE__ */ ordRecord()(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordNil)()({
    reflectSymbol: function() {
      return "y";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "x";
    }
  })(ordNumber)));
  var show112 = /* @__PURE__ */ show(showInt);
  var lookup12 = /* @__PURE__ */ lookup2(ordString);
  var sampleData = [{
    x: 1,
    y: 30
  }, {
    x: 2,
    y: 80
  }, {
    x: 3,
    y: 45
  }, {
    x: 4,
    y: 60
  }, {
    x: 5,
    y: 20
  }, {
    x: 6,
    y: 90
  }, {
    x: 7,
    y: 55
  }];
  var innerWidth2 = function(dims) {
    return dims.width - dims.marginLeft - dims.marginRight;
  };
  var innerHeight2 = function(dims) {
    return dims.height - dims.marginTop - dims.marginBottom;
  };
  var defaultDims = {
    width: 600,
    height: 400,
    marginTop: 20,
    marginRight: 20,
    marginBottom: 40,
    marginLeft: 50
  };
  var barChart = /* @__PURE__ */ runD3v2M(/* @__PURE__ */ bind14(/* @__PURE__ */ select4(selectionMD3v2Selection_D)("#viz"))(function(container) {
    var iWidth = innerWidth2(defaultDims);
    var iHeight = innerHeight2(defaultDims);
    var yValues = map42(function(v) {
      return v.y;
    })(sampleData);
    var maxY = fromMaybe(100)(maximum4(yValues));
    var numBars = length(sampleData);
    var barWidth = (function() {
      var $48 = numBars > 0;
      if ($48) {
        return iWidth / toNumber(numBars) * 0.8;
      }
      ;
      return 0;
    })();
    var xScale = {
      domain: {
        min: 1,
        max: toNumber(numBars)
      },
      range: {
        min: 0,
        max: iWidth
      }
    };
    var yScale = {
      domain: {
        min: 0,
        max: maxY
      },
      range: {
        min: iHeight,
        max: 0
      }
    };
    var xAxis = axisBottom(xScale);
    var yAxis = axisLeft(yScale);
    var axesTree = withChild(named2(SVG.value)("svg")([width10(defaultDims.width), height10(defaultDims.height), viewBox4("0 0 " + (show25(defaultDims.width) + (" " + show25(defaultDims.height)))), class_7("bar-chart-tree")]))(withChildren(named2(Group2.value)("chartGroup")([class_7("chart-content"), transform5("translate(" + (show25(defaultDims.marginLeft) + ("," + (show25(defaultDims.marginTop) + ")"))))]))([withChild(named2(Group2.value)("xAxis")([transform5("translate(0," + (show25(iHeight) + ")")), class_7("x-axis")]))(renderAxis(xAxis)), withChild(named2(Group2.value)("yAxis")([class_7("y-axis")]))(renderAxis(yAxis))]));
    return bind14(renderTree1(container)(axesTree))(function(axesSelections) {
      return bind14(liftEffect5(reselectD3v2("chartGroup")(axesSelections)))(function(chartGroupSel) {
        var barsTree = joinData2("bars")("rect")(sampleData)(function(point) {
          var yPos = iHeight - (point.y - 0) / (maxY - 0) * iHeight;
          var xPos = (point.x - 1) * (iWidth / toNumber(numBars)) + (iWidth / toNumber(numBars) - barWidth) / 2;
          var barHeight = iHeight - yPos;
          return elem4(Rect2.value)([x6(xPos), y6(yPos), width10(barWidth), height10(barHeight), fill7("#4a90e2"), stroke5("#357abd"), strokeWidth5(1), class_7("bar")]);
        });
        return bind14(renderTree22(chartGroupSel)(barsTree))(function(barsSelections) {
          return liftEffect5(function __do3() {
            log2("=== Bar Chart (Tree API) ===")();
            log2("")();
            log2("Rendered " + (show112(length(sampleData)) + " bars with axes"))();
            (function() {
              var v = lookup12("svg")(axesSelections);
              if (v instanceof Just) {
                return log2("\u2713 SVG created")();
              }
              ;
              if (v instanceof Nothing) {
                return log2("\u2717 Missing SVG")();
              }
              ;
              throw new Error("Failed pattern match at D3.Viz.TreeAPI.BarChartExample (line 164, column 5 - line 166, column 45): " + [v.constructor.name]);
            })();
            (function() {
              var v = lookup12("chartGroup")(axesSelections);
              if (v instanceof Just) {
                return log2("\u2713 Chart group created")();
              }
              ;
              if (v instanceof Nothing) {
                return log2("\u2717 Missing chart group")();
              }
              ;
              throw new Error("Failed pattern match at D3.Viz.TreeAPI.BarChartExample (line 168, column 5 - line 170, column 53): " + [v.constructor.name]);
            })();
            (function() {
              var v = lookup12("xAxis")(axesSelections);
              if (v instanceof Just) {
                return log2("\u2713 X axis created")();
              }
              ;
              if (v instanceof Nothing) {
                return log2("\u2717 Missing X axis")();
              }
              ;
              throw new Error("Failed pattern match at D3.Viz.TreeAPI.BarChartExample (line 172, column 5 - line 174, column 48): " + [v.constructor.name]);
            })();
            (function() {
              var v = lookup12("yAxis")(axesSelections);
              if (v instanceof Just) {
                return log2("\u2713 Y axis created")();
              }
              ;
              if (v instanceof Nothing) {
                return log2("\u2717 Missing Y axis")();
              }
              ;
              throw new Error("Failed pattern match at D3.Viz.TreeAPI.BarChartExample (line 176, column 5 - line 178, column 48): " + [v.constructor.name]);
            })();
            (function() {
              var v = lookup12("bars")(barsSelections);
              if (v instanceof Just) {
                return log2("\u2713 Bars collection created")();
              }
              ;
              if (v instanceof Nothing) {
                return log2("\u2717 Missing bars collection")();
              }
              ;
              throw new Error("Failed pattern match at D3.Viz.TreeAPI.BarChartExample (line 180, column 5 - line 182, column 57): " + [v.constructor.name]);
            })();
            log2("")();
            return log2("Expected: 7 blue bars of varying heights with X and Y axes")();
          });
        });
      });
    });
  }));

  // output/PSD3.Shared.Data/foreign.js
  function parseFlareJson(jsonString) {
    return JSON.parse(jsonString);
  }
  var getName2 = (node) => node.name || "";
  var getValue2 = (node) => node.value || 0;
  var getChildren_2 = (node) => {
    if (node.children && Array.isArray(node.children) && node.children.length > 0) {
      return node.children;
    }
    return null;
  };

  // output/PSD3.Shared.Data/index.js
  var bind15 = /* @__PURE__ */ bind(bindMaybe);
  var pure14 = /* @__PURE__ */ pure(applicativeMaybe);
  var apply4 = /* @__PURE__ */ apply(applyMaybe);
  var map43 = /* @__PURE__ */ map(functorMaybe);
  var lookup13 = /* @__PURE__ */ lookup2(ordString);
  var nub3 = /* @__PURE__ */ nub(ordString);
  var bind16 = /* @__PURE__ */ bind(bindArray);
  var sort2 = /* @__PURE__ */ sort(ordString);
  var fromFoldable31 = /* @__PURE__ */ fromFoldable6(ordString)(foldableArray);
  var pure15 = /* @__PURE__ */ pure(applicativeEither);
  var fromFoldable111 = /* @__PURE__ */ fromFoldable2(foldableArray);
  var map115 = /* @__PURE__ */ map(functorArray);
  var discard12 = /* @__PURE__ */ discard(discardUnit)(bindAff);
  var log7 = /* @__PURE__ */ log3(monadEffectAff);
  var bind22 = /* @__PURE__ */ bind(bindAff);
  var pure23 = /* @__PURE__ */ pure(applicativeAff);
  var show26 = /* @__PURE__ */ show(showInt);
  var show113 = /* @__PURE__ */ show(/* @__PURE__ */ showArray(showString));
  var traverse_6 = /* @__PURE__ */ traverse_(applicativeAff)(foldableArray);
  var show27 = /* @__PURE__ */ show(/* @__PURE__ */ showArray(showNumber));
  var EnergyCSV = /* @__PURE__ */ (function() {
    function EnergyCSV2() {
    }
    ;
    EnergyCSV2.value = new EnergyCSV2();
    return EnergyCSV2;
  })();
  var FlareJSON = /* @__PURE__ */ (function() {
    function FlareJSON2() {
    }
    ;
    FlareJSON2.value = new FlareJSON2();
    return FlareJSON2;
  })();
  var MiserablesJSON = /* @__PURE__ */ (function() {
    function MiserablesJSON2() {
    }
    ;
    MiserablesJSON2.value = new MiserablesJSON2();
    return MiserablesJSON2;
  })();
  var NationsJSON = /* @__PURE__ */ (function() {
    function NationsJSON2() {
    }
    ;
    NationsJSON2.value = new NationsJSON2();
    return NationsJSON2;
  })();
  var MetroUnemploymentCSV = /* @__PURE__ */ (function() {
    function MetroUnemploymentCSV2() {
    }
    ;
    MetroUnemploymentCSV2.value = new MetroUnemploymentCSV2();
    return MetroUnemploymentCSV2;
  })();
  var USPopulationStateAgeCSV = /* @__PURE__ */ (function() {
    function USPopulationStateAgeCSV2() {
    }
    ;
    USPopulationStateAgeCSV2.value = new USPopulationStateAgeCSV2();
    return USPopulationStateAgeCSV2;
  })();
  var BridgesCSV = /* @__PURE__ */ (function() {
    function BridgesCSV2() {
    }
    ;
    BridgesCSV2.value = new BridgesCSV2();
    return BridgesCSV2;
  })();
  var parseCSVRowSemicolon = function(line) {
    var readUntilSemicolon = function(chars2) {
      var v = findIndex(function(c) {
        return c === ";";
      })(chars2);
      if (v instanceof Just) {
        return {
          field: fromCharArray(slice(0)(v.value0)(chars2)),
          rest: drop(v.value0 + 1 | 0)(chars2)
        };
      }
      ;
      if (v instanceof Nothing) {
        return {
          field: fromCharArray(chars2),
          rest: []
        };
      }
      ;
      throw new Error("Failed pattern match at PSD3.Shared.Data (line 210, column 7 - line 218, column 12): " + [v.constructor.name]);
    };
    var findClosingQuote = function($copy_chars) {
      return function($copy_idx) {
        var $tco_var_chars = $copy_chars;
        var $tco_done = false;
        var $tco_result;
        function $tco_loop(chars2, idx) {
          var v = index(chars2)(idx);
          if (v instanceof Just && v.value0 === '"') {
            $tco_done = true;
            return {
              field: fromCharArray(slice(0)(idx)(chars2)),
              rest: drop(idx + 1 | 0)(chars2)
            };
          }
          ;
          if (v instanceof Just) {
            $tco_var_chars = chars2;
            $copy_idx = idx + 1 | 0;
            return;
          }
          ;
          if (v instanceof Nothing) {
            $tco_done = true;
            return {
              field: fromCharArray(chars2),
              rest: []
            };
          }
          ;
          throw new Error("Failed pattern match at PSD3.Shared.Data (line 196, column 7 - line 206, column 12): " + [v.constructor.name]);
        }
        ;
        while (!$tco_done) {
          $tco_result = $tco_loop($tco_var_chars, $copy_idx);
        }
        ;
        return $tco_result;
      };
    };
    var parseFields = function($copy_chars) {
      return function($copy_acc) {
        var $tco_var_chars = $copy_chars;
        var $tco_done1 = false;
        var $tco_result;
        function $tco_loop(chars2, acc) {
          if ($$null(chars2)) {
            $tco_done1 = true;
            return acc;
          }
          ;
          if (otherwise) {
            var v = head(chars2);
            if (v instanceof Just && v.value0 === '"') {
              var v1 = findClosingQuote(drop(1)(chars2))(0);
              var nextFields = (function() {
                var $64 = $$null(v1.rest);
                if ($64) {
                  return [];
                }
                ;
                return drop(1)(v1.rest);
              })();
              $tco_var_chars = nextFields;
              $copy_acc = snoc(acc)(v1.field);
              return;
            }
            ;
            var v1 = readUntilSemicolon(chars2);
            $tco_var_chars = v1.rest;
            $copy_acc = snoc(acc)(v1.field);
            return;
          }
          ;
          throw new Error("Failed pattern match at PSD3.Shared.Data (line 176, column 5 - line 176, column 62): " + [chars2.constructor.name, acc.constructor.name]);
        }
        ;
        while (!$tco_done1) {
          $tco_result = $tco_loop($tco_var_chars, $copy_acc);
        }
        ;
        return $tco_result;
      };
    };
    var chars = toCharArray(line);
    return parseFields(chars)([]);
  };
  var parseCSVRow = function(line) {
    var readUntilComma = function(chars2) {
      var v = findIndex(function(c) {
        return c === ",";
      })(chars2);
      if (v instanceof Just) {
        return {
          field: fromCharArray(slice(0)(v.value0)(chars2)),
          rest: drop(v.value0 + 1 | 0)(chars2)
        };
      }
      ;
      if (v instanceof Nothing) {
        return {
          field: fromCharArray(chars2),
          rest: []
        };
      }
      ;
      throw new Error("Failed pattern match at PSD3.Shared.Data (line 111, column 7 - line 119, column 12): " + [v.constructor.name]);
    };
    var findClosingQuote = function($copy_chars) {
      return function($copy_idx) {
        var $tco_var_chars = $copy_chars;
        var $tco_done = false;
        var $tco_result;
        function $tco_loop(chars2, idx) {
          var v = index(chars2)(idx);
          if (v instanceof Just && v.value0 === '"') {
            $tco_done = true;
            return {
              field: fromCharArray(slice(0)(idx)(chars2)),
              rest: drop(idx + 1 | 0)(chars2)
            };
          }
          ;
          if (v instanceof Just) {
            $tco_var_chars = chars2;
            $copy_idx = idx + 1 | 0;
            return;
          }
          ;
          if (v instanceof Nothing) {
            $tco_done = true;
            return {
              field: fromCharArray(chars2),
              rest: []
            };
          }
          ;
          throw new Error("Failed pattern match at PSD3.Shared.Data (line 97, column 7 - line 107, column 12): " + [v.constructor.name]);
        }
        ;
        while (!$tco_done) {
          $tco_result = $tco_loop($tco_var_chars, $copy_idx);
        }
        ;
        return $tco_result;
      };
    };
    var parseFields = function($copy_chars) {
      return function($copy_acc) {
        var $tco_var_chars = $copy_chars;
        var $tco_done1 = false;
        var $tco_result;
        function $tco_loop(chars2, acc) {
          if ($$null(chars2)) {
            $tco_done1 = true;
            return acc;
          }
          ;
          if (otherwise) {
            var v = head(chars2);
            if (v instanceof Just && v.value0 === '"') {
              var v1 = findClosingQuote(drop(1)(chars2))(0);
              var nextFields = (function() {
                var $80 = $$null(v1.rest);
                if ($80) {
                  return [];
                }
                ;
                return drop(1)(v1.rest);
              })();
              $tco_var_chars = nextFields;
              $copy_acc = snoc(acc)(v1.field);
              return;
            }
            ;
            var v1 = readUntilComma(chars2);
            $tco_var_chars = v1.rest;
            $copy_acc = snoc(acc)(v1.field);
            return;
          }
          ;
          throw new Error("Failed pattern match at PSD3.Shared.Data (line 77, column 5 - line 77, column 62): " + [chars2.constructor.name, acc.constructor.name]);
        }
        ;
        while (!$tco_done1) {
          $tco_result = $tco_loop($tco_var_chars, $copy_acc);
        }
        ;
        return $tco_result;
      };
    };
    var chars = toCharArray(line);
    return parseFields(chars)([]);
  };
  var parseBridgesCSV = function(csvContent) {
    var parseRow = function(line) {
      var fields = parseCSVRowSemicolon(trim(line));
      return bind15(index(fields)(0))(function(origin3) {
        return bind15(index(fields)(1))(function(destination) {
          return bind15(index(fields)(2))(function(valueStr) {
            return bind15(fromString(trim(valueStr)))(function(value18) {
              return pure14({
                origin: trim(origin3),
                destination: trim(destination),
                value: value18
              });
            });
          });
        });
      });
    };
    var fillMatrixCell = function(labelMap) {
      return function(matrix2) {
        return function(row) {
          var v = apply4(map43(Tuple.create)(lookup13(row.origin)(labelMap)))(lookup13(row.destination)(labelMap));
          if (v instanceof Just) {
            var v1 = index(matrix2)(v.value0.value0);
            if (v1 instanceof Just) {
              var updatedRow = updateAt(v.value0.value1)(row.value)(v1.value0);
              if (updatedRow instanceof Just) {
                var v2 = updateAt(v.value0.value0)(updatedRow.value0)(matrix2);
                if (v2 instanceof Just) {
                  return v2.value0;
                }
                ;
                if (v2 instanceof Nothing) {
                  return matrix2;
                }
                ;
                throw new Error("Failed pattern match at PSD3.Shared.Data (line 276, column 35 - line 278, column 54): " + [v2.constructor.name]);
              }
              ;
              if (updatedRow instanceof Nothing) {
                return matrix2;
              }
              ;
              throw new Error("Failed pattern match at PSD3.Shared.Data (line 275, column 18 - line 279, column 37): " + [updatedRow.constructor.name]);
            }
            ;
            if (v1 instanceof Nothing) {
              return matrix2;
            }
            ;
            throw new Error("Failed pattern match at PSD3.Shared.Data (line 272, column 11 - line 280, column 30): " + [v1.constructor.name]);
          }
          ;
          if (v instanceof Nothing) {
            return matrix2;
          }
          ;
          throw new Error("Failed pattern match at PSD3.Shared.Data (line 270, column 7 - line 281, column 26): " + [v.constructor.name]);
        };
      };
    };
    var lines = split("\n")(csvContent);
    var nonEmptyLines = filter(function(line) {
      return trim(line) !== "";
    })(lines);
    var dataLines = (function() {
      var v = head(nonEmptyLines);
      if (v instanceof Just) {
        var lowerFirst = trim(v.value0);
        var $98 = lowerFirst === "From;To;Value" || (lowerFirst === "from;to;value" || lowerFirst === "Origin;Destination;Value");
        if ($98) {
          return drop(1)(nonEmptyLines);
        }
        ;
        return nonEmptyLines;
      }
      ;
      if (v instanceof Nothing) {
        return nonEmptyLines;
      }
      ;
      throw new Error("Failed pattern match at PSD3.Shared.Data (line 228, column 19 - line 234, column 33): " + [v.constructor.name]);
    })();
    var parsedRows = mapMaybe(parseRow)(dataLines);
    var allRegions2 = nub3(bind16(parsedRows)(function(row) {
      return [row.origin, row.destination];
    }));
    var labels9 = sort2(allRegions2);
    var n = length(labels9);
    var labelIndexMap = fromFoldable31(mapWithIndex2(function(i2) {
      return function(label5) {
        return new Tuple(label5, i2);
      };
    })(labels9));
    var emptyMatrix = replicate(n)(replicate(n)(0));
    var matrix = foldl2(fillMatrixCell(labelIndexMap))(emptyMatrix)(parsedRows);
    return pure15({
      matrix,
      labels: labels9
    });
  };
  var getChildren2 = function($122) {
    return toMaybe(getChildren_2($122));
  };
  var hierDataToTree2 = function(hierData) {
    var value18 = getValue2(hierData);
    var name16 = getName2(hierData);
    var childrenMaybe = getChildren2(hierData);
    var childrenList = (function() {
      if (childrenMaybe instanceof Nothing) {
        return Nil.value;
      }
      ;
      if (childrenMaybe instanceof Just) {
        return fromFoldable111(map115(hierDataToTree2)(childrenMaybe.value0));
      }
      ;
      throw new Error("Failed pattern match at PSD3.Shared.Data (line 144, column 20 - line 146, column 76): " + [childrenMaybe.constructor.name]);
    })();
    return new Node({
      name: name16,
      value: value18,
      x: 0,
      y: 0,
      depth: 0,
      height: 0
    }, childrenList);
  };
  var dataFilePath = function(v) {
    if (v instanceof EnergyCSV) {
      return "./data/energy.csv";
    }
    ;
    if (v instanceof FlareJSON) {
      return "./data/flare-2.json";
    }
    ;
    if (v instanceof MiserablesJSON) {
      return "./data/miserables.json";
    }
    ;
    if (v instanceof NationsJSON) {
      return "./data/nations.json";
    }
    ;
    if (v instanceof MetroUnemploymentCSV) {
      return "./data/bls-metro-unemployment.csv";
    }
    ;
    if (v instanceof USPopulationStateAgeCSV) {
      return "./data/us-population-state-age.csv";
    }
    ;
    if (v instanceof BridgesCSV) {
      return "./data/bridges.csv";
    }
    ;
    throw new Error("Failed pattern match at PSD3.Shared.Data (line 36, column 1 - line 36, column 35): " + [v.constructor.name]);
  };
  var loadDataFile = function(dataFile) {
    var path2 = dataFilePath(dataFile);
    return discard12(log7("Loading data file: " + path2))(function() {
      return bind22(get3(string)(path2))(function(response) {
        if (response instanceof Left) {
          return discard12(log7("Failed to load " + (path2 + (": " + printError(response.value0)))))(function() {
            return pure23(new Left("Failed to load data file: " + printError(response.value0)));
          });
        }
        ;
        if (response instanceof Right) {
          return discard12(log7("Successfully loaded " + path2))(function() {
            return pure23(new Right(response.value0.body));
          });
        }
        ;
        throw new Error("Failed pattern match at PSD3.Shared.Data (line 62, column 3 - line 68, column 24): " + [response.constructor.name]);
      });
    });
  };
  var loadBridgesData = /* @__PURE__ */ (function() {
    return bind22(loadDataFile(BridgesCSV.value))(function(result) {
      if (result instanceof Left) {
        return pure23(new Left(result.value0));
      }
      ;
      if (result instanceof Right) {
        var parsed = parseBridgesCSV(result.value0);
        if (parsed instanceof Right) {
          return discard12(log7("=== Bridges CSV Parsed Data ==="))(function() {
            return discard12(log7("Labels (" + (show26(length(parsed.value0.labels)) + " regions):")))(function() {
              return discard12(log7(show113(parsed.value0.labels)))(function() {
                return discard12(log7("\nMatrix (rows = from, cols = to):"))(function() {
                  var indexedRows = mapWithIndex2(function(i2) {
                    return function(row) {
                      return {
                        i: i2,
                        row
                      };
                    };
                  })(parsed.value0.matrix);
                  return discard12(traverse_6(function(v) {
                    var label5 = (function() {
                      var v1 = index(parsed.value0.labels)(v.i);
                      if (v1 instanceof Just) {
                        return v1.value0;
                      }
                      ;
                      if (v1 instanceof Nothing) {
                        return "?";
                      }
                      ;
                      throw new Error("Failed pattern match at PSD3.Shared.Data (line 300, column 25 - line 302, column 40): " + [v1.constructor.name]);
                    })();
                    return log7(label5 + (": " + show27(v.row)));
                  })(indexedRows))(function() {
                    return discard12(log7("=== End Bridges Data ==="))(function() {
                      return pure23(new Right(parsed.value0));
                    });
                  });
                });
              });
            });
          });
        }
        ;
        if (parsed instanceof Left) {
          return pure23(new Left(parsed.value0));
        }
        ;
        throw new Error("Failed pattern match at PSD3.Shared.Data (line 291, column 7 - line 307, column 36): " + [parsed.constructor.name]);
      }
      ;
      throw new Error("Failed pattern match at PSD3.Shared.Data (line 287, column 3 - line 307, column 36): " + [result.constructor.name]);
    });
  })();
  var loadFlareData = /* @__PURE__ */ (function() {
    return bind22(loadDataFile(FlareJSON.value))(function(result) {
      if (result instanceof Left) {
        return pure23(new Left(result.value0));
      }
      ;
      if (result instanceof Right) {
        var hierData = parseFlareJson(result.value0);
        var tree3 = hierDataToTree2(hierData);
        return pure23(new Right(tree3));
      }
      ;
      throw new Error("Failed pattern match at PSD3.Shared.Data (line 154, column 3 - line 159, column 24): " + [result.constructor.name]);
    });
  })();

  // output/D3.Viz.TreeAPI.GroupedBarChartExample/index.js
  var bind17 = /* @__PURE__ */ bind(bindAff);
  var discard13 = /* @__PURE__ */ discard(discardUnit);
  var discard1 = /* @__PURE__ */ discard13(bindAff);
  var liftEffect6 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var pure16 = /* @__PURE__ */ pure(applicativeAff);
  var show28 = /* @__PURE__ */ show(showInt);
  var nub4 = /* @__PURE__ */ nub(ordString);
  var map44 = /* @__PURE__ */ map(functorArray);
  var bind18 = /* @__PURE__ */ bind(bindD3v2M);
  var select7 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var maximum5 = /* @__PURE__ */ maximum(ordNumber)(foldableArray);
  var width11 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height11 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox5 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var show114 = /* @__PURE__ */ show(showNumber);
  var class_8 = /* @__PURE__ */ class_2(toAttrStringString);
  var transform6 = /* @__PURE__ */ transform2(toAttrStringString);
  var renderTree4 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D);
  var renderTree12 = /* @__PURE__ */ renderTree4(ordUnit);
  var liftEffect1 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var x7 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y7 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var fill8 = /* @__PURE__ */ fill3(toAttrStringString);
  var ordRecord3 = /* @__PURE__ */ ordRecord();
  var ordRecordCons3 = /* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordNil)()({
    reflectSymbol: function() {
      return "state";
    }
  })(ordString))();
  var renderTree23 = /* @__PURE__ */ renderTree4(/* @__PURE__ */ ordRecord3(/* @__PURE__ */ ordRecordCons3({
    reflectSymbol: function() {
      return "bars";
    }
  })(/* @__PURE__ */ ordArray(/* @__PURE__ */ ordRecord3(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons3({
    reflectSymbol: function() {
      return "population";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "age";
    }
  })(ordString))))));
  var lookup14 = /* @__PURE__ */ lookup2(ordString);
  var parsePopulationRow = function(line) {
    var v = parseCSVRow(line);
    if (v.length === 8) {
      var under5 = fromMaybe(0)(fromString(trim(v[1])));
      var age65plus = fromMaybe(0)(fromString(trim(v[7])));
      var age5to13 = fromMaybe(0)(fromString(trim(v[2])));
      var age45to64 = fromMaybe(0)(fromString(trim(v[6])));
      var age25to44 = fromMaybe(0)(fromString(trim(v[5])));
      var age18to24 = fromMaybe(0)(fromString(trim(v[4])));
      var age14to17 = fromMaybe(0)(fromString(trim(v[3])));
      return [{
        state: trim(v[0]),
        age: "<10",
        population: under5 + age5to13 * 0.5
      }, {
        state: trim(v[0]),
        age: "10-19",
        population: age5to13 * 0.5 + age14to17
      }, {
        state: trim(v[0]),
        age: "20-29",
        population: age18to24 + age25to44 * 0.25
      }, {
        state: trim(v[0]),
        age: "30-39",
        population: age25to44 * 0.5
      }, {
        state: trim(v[0]),
        age: "40-49",
        population: age25to44 * 0.25
      }, {
        state: trim(v[0]),
        age: "50-59",
        population: age45to64 * 0.6
      }, {
        state: trim(v[0]),
        age: "60-69",
        population: age45to64 * 0.4
      }, {
        state: trim(v[0]),
        age: "70-79",
        population: age65plus * 0.6
      }, {
        state: trim(v[0]),
        age: "\u226580",
        population: age65plus * 0.4
      }];
    }
    ;
    return [];
  };
  var loadPopulationData = /* @__PURE__ */ (function() {
    return bind17(loadDataFile(USPopulationStateAgeCSV.value))(function(result) {
      if (result instanceof Left) {
        return discard1(liftEffect6(log2("Failed to load population data: " + result.value0)))(function() {
          return pure16([]);
        });
      }
      ;
      if (result instanceof Right) {
        var lines = split("\n")(result.value0);
        var dataLines = drop(1)(lines);
        var parsed = concatMap(parsePopulationRow)(dataLines);
        return discard1(liftEffect6(log2("Loaded " + (show28(length(parsed)) + " population data points"))))(function() {
          return pure16(parsed);
        });
      }
      ;
      throw new Error("Failed pattern match at D3.Viz.TreeAPI.GroupedBarChartExample (line 64, column 3 - line 73, column 18): " + [result.constructor.name]);
    });
  })();
  var innerWidth3 = function(dims) {
    return dims.width - dims.marginLeft - dims.marginRight;
  };
  var innerHeight3 = function(dims) {
    return dims.height - dims.marginTop - dims.marginBottom;
  };
  var groupByState = function(data$prime) {
    var states = nub4(map44(function(v) {
      return v.state;
    })(data$prime));
    var getStateData = function(st) {
      return filter(function(d18) {
        return d18.state === st;
      })(data$prime);
    };
    return map44(function(st) {
      return {
        state: st,
        bars: getStateData(st)
      };
    })(states);
  };
  var getAges = /* @__PURE__ */ (function() {
    var $78 = map44(function(v) {
      return v.age;
    });
    return function($79) {
      return nub4($78($79));
    };
  })();
  var defaultDims2 = {
    width: 800,
    height: 500,
    marginTop: 20,
    marginRight: 20,
    marginBottom: 60,
    marginLeft: 60
  };
  var colorForAge = function(v) {
    if (v === "<10") {
      return "#e8384f";
    }
    ;
    if (v === "10-19") {
      return "#fd612c";
    }
    ;
    if (v === "20-29") {
      return "#fd8d3c";
    }
    ;
    if (v === "30-39") {
      return "#feb078";
    }
    ;
    if (v === "40-49") {
      return "#ffe0b3";
    }
    ;
    if (v === "50-59") {
      return "#d7eaf3";
    }
    ;
    if (v === "60-69") {
      return "#abd9e9";
    }
    ;
    if (v === "70-79") {
      return "#74add1";
    }
    ;
    if (v === "\u226580") {
      return "#4575b4";
    }
    ;
    return "#999";
  };
  var drawGroupedBarChart = function(selector) {
    return function(populationData) {
      return runD3v2M(bind18(select7(selector))(function(container) {
        var iWidth = innerWidth3(defaultDims2);
        var iHeight = innerHeight3(defaultDims2);
        var stateGroups = groupByState(populationData);
        var ages = getAges(populationData);
        var numStates = length(stateGroups);
        var numAges = length(ages);
        var groupWidth = iWidth / toNumber(numStates);
        var barWidth = groupWidth / toNumber(numAges) * 0.9;
        var populationValues = map44(function(v) {
          return v.population;
        })(populationData);
        var maxPop = fromMaybe(6e6)(maximum5(populationValues));
        var xScale = {
          domain: {
            min: 0,
            max: toNumber(numStates)
          },
          range: {
            min: 0,
            max: iWidth
          }
        };
        var yScale = {
          domain: {
            min: 0,
            max: maxPop
          },
          range: {
            min: iHeight,
            max: 0
          }
        };
        var xAxis = axisBottom(xScale);
        var yAxis = axisLeft(yScale);
        var axesTree = withChild(named2(SVG.value)("svg")([width11(defaultDims2.width), height11(defaultDims2.height), viewBox5("0 0 " + (show114(defaultDims2.width) + (" " + show114(defaultDims2.height)))), class_8("grouped-bar-chart")]))(withChildren(named2(Group2.value)("chartGroup")([class_8("chart-content"), transform6("translate(" + (show114(defaultDims2.marginLeft) + ("," + (show114(defaultDims2.marginTop) + ")"))))]))([withChild(named2(Group2.value)("xAxis")([transform6("translate(0," + (show114(iHeight) + ")")), class_8("x-axis")]))(renderAxis(xAxis)), withChild(named2(Group2.value)("yAxis")([class_8("y-axis")]))(renderAxis(yAxis))]));
        return bind18(renderTree12(container)(axesTree))(function(axesSelections) {
          return bind18(liftEffect1(reselectD3v2("chartGroup")(axesSelections)))(function(chartGroupSel) {
            var barsTree = nestedJoin("stateGroups")("g")(stateGroups)(function(v) {
              return v.bars;
            })(function(bar) {
              var yPos = iHeight - bar.population / maxPop * iHeight;
              var stateIdx = fromMaybe(0)(findIndex(function(g) {
                return g.state === bar.state;
              })(stateGroups));
              var barHeight = bar.population / maxPop * iHeight;
              var ageIdx = fromMaybe(0)(findIndex(function(a2) {
                return a2 === bar.age;
              })(ages));
              var xPos = toNumber(stateIdx) * groupWidth + toNumber(ageIdx) * barWidth;
              return elem4(Rect2.value)([x7(xPos), y7(yPos), width11(barWidth), height11(barHeight), fill8(colorForAge(bar.age)), class_8("bar")]);
            });
            return bind18(renderTree23(chartGroupSel)(barsTree))(function(barsSelections) {
              return liftEffect1(function __do3() {
                log2("=== Grouped Bar Chart (Tree API) ===")();
                log2("")();
                log2("Rendered " + (show28(length(populationData)) + (" bars in " + (show28(numStates) + " groups"))))();
                var v = lookup14("svg")(axesSelections);
                if (v instanceof Just) {
                  return log2("\u2713 SVG created")();
                }
                ;
                if (v instanceof Nothing) {
                  return log2("\u2717 Missing SVG")();
                }
                ;
                throw new Error("Failed pattern match at D3.Viz.TreeAPI.GroupedBarChartExample (line 248, column 5 - line 250, column 45): " + [v.constructor.name]);
              });
            });
          });
        });
      }));
    };
  };
  var groupedBarChart = function(selector) {
    return launchAff_(bind17(loadPopulationData)(function(populationData) {
      return liftEffect6(drawGroupedBarChart(selector)(populationData));
    }));
  };

  // output/D3.Viz.LesMiserables.File/foreign.js
  function readJSONJS_(filecontents) {
    return decodeFile(filecontents);
  }
  var decodeFile = function(filecontents) {
    const json2 = JSON.parse(filecontents);
    const links = json2.links.map((d18) => Object.create(d18));
    const nodes = json2.nodes.map((d18) => ({
      id: d18.id,
      group: d18.group,
      x: 0,
      y: 0,
      vx: 0,
      vy: 0,
      fx: null,
      fy: null,
      sx: null,
      // Cached simulation x for smooth transitions
      sy: null
      // Cached simulation y for smooth transitions
    }));
    return { links, nodes };
  };

  // output/D3.Viz.LesMiserables.File/index.js
  var readGraphFromFileContents = function(v) {
    if (v instanceof Right) {
      return readJSONJS_(v.value0.body);
    }
    ;
    if (v instanceof Left) {
      return {
        links: [],
        nodes: []
      };
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.LesMiserables.File (line 10, column 1 - line 10, column 92): " + [v.constructor.name]);
  };

  // output/D3.Viz.TreeAPI.LesMisTreeExample/index.js
  var compare8 = /* @__PURE__ */ compare(ordInt);
  var discard14 = /* @__PURE__ */ discard(discardUnit);
  var discard15 = /* @__PURE__ */ discard14(bindD3v2SimM);
  var liftEffect7 = /* @__PURE__ */ liftEffect(monadEffectD3v2SimM);
  var show29 = /* @__PURE__ */ show(showInt);
  var bind19 = /* @__PURE__ */ bind(bindD3v2SimM);
  var show115 = /* @__PURE__ */ show(showNumber);
  var select8 = /* @__PURE__ */ select4(selectionMD3v2Selection_D1);
  var init5 = /* @__PURE__ */ init4(simulationMD3v2Selection_);
  var width12 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height12 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox6 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var id_2 = /* @__PURE__ */ id_(toAttrStringString);
  var class_9 = /* @__PURE__ */ class_2(toAttrStringString);
  var renderTree5 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D1);
  var renderTree13 = /* @__PURE__ */ renderTree5(ordUnit);
  var show210 = /* @__PURE__ */ show(/* @__PURE__ */ showSet(showString));
  var x13 = /* @__PURE__ */ x1(toAttrNumberFunctionNumbe);
  var y13 = /* @__PURE__ */ y1(toAttrNumberFunctionNumbe);
  var x24 = /* @__PURE__ */ x22(toAttrNumberFunctionNumbe);
  var y24 = /* @__PURE__ */ y22(toAttrNumberFunctionNumbe);
  var strokeWidth6 = /* @__PURE__ */ strokeWidth3(toAttrNumberFunctionNumbe);
  var stroke6 = /* @__PURE__ */ stroke(toAttrStringFunctionStrin);
  var cx4 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy4 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius5 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill9 = /* @__PURE__ */ fill3(toAttrStringString);
  var stroke1 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth1 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var ordNullable3 = /* @__PURE__ */ ordNullable(ordNumber);
  var renderTree24 = /* @__PURE__ */ renderTree5(/* @__PURE__ */ ordRecord()(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordNil)()({
    reflectSymbol: function() {
      return "y";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "x";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "vy";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "vx";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "sy";
    }
  })(ordNullable3))()({
    reflectSymbol: function() {
      return "sx";
    }
  })(ordNullable3))()({
    reflectSymbol: function() {
      return "id";
    }
  })(ordString))()({
    reflectSymbol: function() {
      return "group";
    }
  })(ordInt))()({
    reflectSymbol: function() {
      return "fy";
    }
  })(ordNullable3))()({
    reflectSymbol: function() {
      return "fx";
    }
  })(ordNullable3)));
  var lookup15 = /* @__PURE__ */ lookup2(ordString);
  var on4 = /* @__PURE__ */ on2(selectionMD3v2Selection_D1);
  var addTickFunction2 = /* @__PURE__ */ addTickFunction(simulationMD3v2Selection_);
  var cx1 = /* @__PURE__ */ cx3(toAttrNumberFunctionNumbe);
  var cy1 = /* @__PURE__ */ cy3(toAttrNumberFunctionNumbe);
  var start4 = /* @__PURE__ */ start3(simulationMD3v2Selection_);
  var pure17 = /* @__PURE__ */ pure(applicativeD3v2SimM);
  var discard23 = /* @__PURE__ */ discard14(bindAff);
  var liftEffect12 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var bind110 = /* @__PURE__ */ bind(bindAff);
  var initialize4 = /* @__PURE__ */ initialize(foldableArray)(functorArray);
  var fromFoldable33 = /* @__PURE__ */ fromFoldable8(foldableArray)(ordString);
  var $$void8 = /* @__PURE__ */ $$void(functorAff);
  var liftAff2 = /* @__PURE__ */ liftAff(monadAffAff);
  var eqIndexedLink = {
    eq: function(v) {
      return function(v1) {
        return v.index === v1.index;
      };
    }
  };
  var ordIndexedLink = {
    compare: function(v) {
      return function(v1) {
        return compare8(v.index)(v1.index);
      };
    },
    Eq0: function() {
      return eqIndexedLink;
    }
  };
  var renderTree32 = /* @__PURE__ */ renderTree5(ordIndexedLink);
  var initialRadius2 = 10;
  var initialAngle2 = /* @__PURE__ */ (function() {
    return pi * (3 - sqrt(5));
  })();
  var setPhyllotaxisPositions = function(nodes) {
    var setPosition = function(index5) {
      return function(node) {
        var i2 = toNumber(index5);
        var radius1 = initialRadius2 * sqrt(0.5 + i2);
        var angle = i2 * initialAngle2;
        var $137 = {};
        for (var $138 in node) {
          if ({}.hasOwnProperty.call(node, $138)) {
            $137[$138] = node[$138];
          }
          ;
        }
        ;
        $137.x = radius1 * cos(angle);
        $137.y = radius1 * sin(angle);
        return $137;
      };
    };
    return mapWithIndex2(setPosition)(nodes);
  };
  var drawLesMisTree = function(forcesArray) {
    return function(activeForces2) {
      return function(model) {
        return function(containerSelector) {
          return discard15(liftEffect7(log2("=== Drawing LesMis with Tree API ===")))(function() {
            return discard15(liftEffect7(log2("Model has " + (show29(length(model.nodes)) + (" nodes, " + (show29(length(model.links)) + " links"))))))(function() {
              return bind19(liftEffect7(getWindowWidthHeight))(function(v) {
                return discard15(liftEffect7(log2("Window dimensions: " + (show115(v.value0) + (" x " + show115(v.value1))))))(function() {
                  return bind19(select8(containerSelector))(function(container) {
                    var nodesWithPositions = setPhyllotaxisPositions(model.nodes);
                    return discard15(liftEffect7(log2("Initializing simulation...")))(function() {
                      return bind19(init5({
                        nodes: nodesWithPositions,
                        links: model.links,
                        forces: forcesArray,
                        activeForces: activeForces2,
                        config: {
                          alpha: 1,
                          alphaTarget: 0,
                          alphaMin: 1e-3,
                          alphaDecay: 0.0228,
                          velocityDecay: 0.4
                        },
                        keyFn: keyIsID_,
                        ticks: empty3
                      }))(function(v1) {
                        return discard15(liftEffect7(log2("Simulation initialized with " + (show29(length(v1.nodes)) + (" nodes, " + (show29(length(v1.links)) + " links"))))))(function() {
                          var indexedLinks = mapWithIndex2(function(i2) {
                            return function(link4) {
                              return {
                                index: i2,
                                link: link4
                              };
                            };
                          })(v1.links);
                          return discard15(liftEffect7(log2("Created " + (show29(length(indexedLinks)) + " indexed links"))))(function() {
                            var forceGraphTree = withChild(named2(SVG.value)("svg")([width12(v.value0), height12(v.value1), viewBox6(show115(-v.value0 / 2) + (" " + (show115(-v.value1 / 2) + (" " + (show115(v.value0) + (" " + show115(v.value1))))))), id_2("lesmis-tree-svg"), class_9("lesmis-tree")]))(withChildren(named2(Group2.value)("zoomGroup")([id_2("zoom-group"), class_9("zoom-group")]))([named2(Group2.value)("linksGroup")([id_2("links"), class_9("links")]), named2(Group2.value)("nodesGroup")([id_2("nodes"), class_9("nodes")])]));
                            return discard15(liftEffect7(log2("Rendering structure tree...")))(function() {
                              return bind19(renderTree13(container)(forceGraphTree))(function(selections) {
                                return discard15(liftEffect7(log2("Structure rendered, selections: " + show210(keys3(selections)))))(function() {
                                  return bind19(liftEffect7(reselectD3v2("linksGroup")(selections)))(function(linksGroupSel) {
                                    return bind19(liftEffect7(reselectD3v2("nodesGroup")(selections)))(function(nodesGroupSel) {
                                      return discard15(liftEffect7(log2("Extracted linksGroup and nodesGroup selections")))(function() {
                                        var linksTree = joinData2("linkElements")("line")(indexedLinks)(function(v2) {
                                          return elem4(Line2.value)([x13(function(v3) {
                                            return v2.link.source.x;
                                          }), y13(function(v3) {
                                            return v2.link.source.y;
                                          }), x24(function(v3) {
                                            return v2.link.target.x;
                                          }), y24(function(v3) {
                                            return v2.link.target.y;
                                          }), strokeWidth6(function(v3) {
                                            return sqrt(v2.link.value);
                                          }), stroke6(function(v3) {
                                            return d3SchemeCategory10N_(toNumber(v2.link.target.group));
                                          })]);
                                        });
                                        return discard15(liftEffect7(log2("Rendering " + (show29(length(indexedLinks)) + " links into linksGroup..."))))(function() {
                                          return bind19(renderTree32(linksGroupSel)(linksTree))(function(linksSelections) {
                                            return discard15(liftEffect7(log2("Links rendered, selections: " + show210(keys3(linksSelections)))))(function() {
                                              var nodesTree = joinData2("nodeElements")("circle")(v1.nodes)(function(v2) {
                                                return elem4(Circle2.value)([cx4(v2.x), cy4(v2.y), radius5(5), fill9(d3SchemeCategory10N_(toNumber(v2.group))), stroke1("#fff"), strokeWidth1(2)]);
                                              });
                                              return discard15(liftEffect7(log2("Rendering " + (show29(length(v1.nodes)) + " nodes into nodesGroup..."))))(function() {
                                                return bind19(renderTree24(nodesGroupSel)(nodesTree))(function(nodesSelections) {
                                                  return discard15(liftEffect7(log2("Nodes rendered, selections: " + show210(keys3(nodesSelections)))))(function() {
                                                    return bind19(liftEffect7(reselectD3v2("zoomGroup")(selections)))(function(zoomGroupSel) {
                                                      return bind19(liftEffect7(reselectD3v2("svg")(selections)))(function(svgSel) {
                                                        var nodesSel = (function() {
                                                          var v2 = lookup15("nodeElements")(nodesSelections);
                                                          if (v2 instanceof Just) {
                                                            return v2.value0;
                                                          }
                                                          ;
                                                          if (v2 instanceof Nothing) {
                                                            return unsafeCrashWith("nodeElements not found");
                                                          }
                                                          ;
                                                          throw new Error("Failed pattern match at D3.Viz.TreeAPI.LesMisTreeExample (line 242, column 18 - line 244, column 76): " + [v2.constructor.name]);
                                                        })();
                                                        var linksSel = (function() {
                                                          var v2 = lookup15("linkElements")(linksSelections);
                                                          if (v2 instanceof Just) {
                                                            return v2.value0;
                                                          }
                                                          ;
                                                          if (v2 instanceof Nothing) {
                                                            return unsafeCrashWith("linkElements not found");
                                                          }
                                                          ;
                                                          throw new Error("Failed pattern match at D3.Viz.TreeAPI.LesMisTreeExample (line 247, column 18 - line 249, column 76): " + [v2.constructor.name]);
                                                        })();
                                                        return bind19(on4(new Drag2(defaultDrag))(zoomGroupSel))(function() {
                                                          return bind19(on4(new Zoom2(defaultZoom(new ScaleExtent2(0.5, 4))("#zoom-group")))(svgSel))(function() {
                                                            return bind19(on4(new Drag2(simulationDrag("lesmis-tree")))(nodesSel))(function() {
                                                              return discard15(addTickFunction2("nodes")(new Step4(nodesSel, [cx1(function(v2) {
                                                                return v2.x;
                                                              }), cy1(function(v2) {
                                                                return v2.y;
                                                              })])))(function() {
                                                                return discard15(addTickFunction2("links")(new Step4(linksSel, [x13(function(v2) {
                                                                  return v2.link.source.x;
                                                                }), y13(function(v2) {
                                                                  return v2.link.source.y;
                                                                }), x24(function(v2) {
                                                                  return v2.link.target.x;
                                                                }), y24(function(v2) {
                                                                  return v2.link.target.y;
                                                                })])))(function() {
                                                                  return discard15(start4)(function() {
                                                                    return pure17(unit);
                                                                  });
                                                                });
                                                              });
                                                            });
                                                          });
                                                        });
                                                      });
                                                    });
                                                  });
                                                });
                                              });
                                            });
                                          });
                                        });
                                      });
                                    });
                                  });
                                });
                              });
                            });
                          });
                        });
                      });
                    });
                  });
                });
              });
            });
          });
        };
      };
    };
  };
  var testLesMisTree = /* @__PURE__ */ launchAff_(/* @__PURE__ */ discard23(/* @__PURE__ */ liftEffect12(/* @__PURE__ */ log2("Loading Les Mis\xE9rables data...")))(function() {
    return bind110(get3(string)("./data/miserables.json"))(function(response) {
      var model = readGraphFromFileContents(response);
      return discard23(liftEffect12(log2("Loaded " + (show29(length(model.nodes)) + (" nodes and " + (show29(length(model.links)) + " links"))))))(function() {
        var manyBodyForce = createForce("many body negative")(new RegularForce(ForceManyBody.value))(allNodes)([strengthVal(-100)]);
        var centerForce = createForce("center")(new RegularForce(ForceCenter.value))(allNodes)([xVal(0), yVal(0), strengthVal(0.1)]);
        var linksForce2 = createLinkForce(allNodes)([]);
        var collisionForce = createForce("collision")(new RegularForce(ForceCollide.value))(allNodes)([radiusVal(6)]);
        var forceLibrary10 = initialize4([manyBodyForce, centerForce, linksForce2, collisionForce]);
        var forcesArray = [manyBodyForce, centerForce, linksForce2, collisionForce];
        var activeForces2 = fromFoldable33(["many body negative", "center", linksForceName_, "collision"]);
        var initialState4 = {
          simulation: initialSimulationState(forceLibrary10)
        };
        return $$void8(liftAff2(runD3v2SimM(initialState4)(drawLesMisTree(forcesArray)(activeForces2)(model)("#viz"))));
      });
    });
  }));

  // output/D3.Viz.TreeAPI.LineChartExample/foreign.js
  var sin2 = Math.sin;
  var pi4 = Math.PI;

  // output/D3.Viz.TreeAPI.LineChartExample/index.js
  var show30 = /* @__PURE__ */ show(showNumber);
  var bind20 = /* @__PURE__ */ bind(bindD3v2M);
  var map45 = /* @__PURE__ */ map(functorArray);
  var minimum4 = /* @__PURE__ */ minimum(ordNumber)(foldableArray);
  var maximum6 = /* @__PURE__ */ maximum(ordNumber)(foldableArray);
  var width13 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height13 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox7 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var class_10 = /* @__PURE__ */ class_2(toAttrStringString);
  var transform7 = /* @__PURE__ */ transform2(toAttrStringString);
  var d7 = /* @__PURE__ */ d4(toAttrStringString);
  var fill10 = /* @__PURE__ */ fill3(toAttrStringString);
  var stroke7 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth7 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var renderTree6 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(ordUnit);
  var liftEffect8 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var show116 = /* @__PURE__ */ show(showInt);
  var lookup16 = /* @__PURE__ */ lookup2(ordString);
  var lineData = /* @__PURE__ */ mapWithIndex2(function(i2) {
    return function(v) {
      var x47 = toNumber(i2) * 0.1;
      var y48 = sin2(x47 * pi4) * 50 + 50;
      return {
        x: x47,
        y: y48
      };
    };
  })(/* @__PURE__ */ range2(0)(62));
  var innerWidth4 = function(dims) {
    return dims.width - dims.marginLeft - dims.marginRight;
  };
  var innerHeight4 = function(dims) {
    return dims.height - dims.marginTop - dims.marginBottom;
  };
  var pointsToPath = function(dims) {
    return function(points) {
      return function(minX) {
        return function(maxX) {
          return function(minY) {
            return function(maxY) {
              var iWidth = innerWidth4(dims);
              var xScale = function(val) {
                return (val - minX) / (maxX - minX) * iWidth;
              };
              var iHeight = innerHeight4(dims);
              var yScale = function(val) {
                return iHeight - (val - minY) / (maxY - minY) * iHeight;
              };
              var toCommand = function(v) {
                return function(v1) {
                  if (v === 0) {
                    return "M " + (show30(xScale(v1.x)) + (" " + show30(yScale(v1.y))));
                  }
                  ;
                  return "L " + (show30(xScale(v1.x)) + (" " + show30(yScale(v1.y))));
                };
              };
              return joinWith(" ")(mapWithIndex2(toCommand)(points));
            };
          };
        };
      };
    };
  };
  var defaultDims3 = {
    width: 600,
    height: 300,
    marginTop: 20,
    marginRight: 20,
    marginBottom: 40,
    marginLeft: 50
  };
  var lineChart = /* @__PURE__ */ runD3v2M(/* @__PURE__ */ bind20(/* @__PURE__ */ select4(selectionMD3v2Selection_D)("#viz"))(function(container) {
    var xValues = map45(function(v) {
      return v.x;
    })(lineData);
    var yValues = map45(function(v) {
      return v.y;
    })(lineData);
    var minX = fromMaybe(0)(minimum4(xValues));
    var maxX = fromMaybe(10)(maximum6(xValues));
    var minY = fromMaybe(0)(minimum4(yValues));
    var maxY = fromMaybe(100)(maximum6(yValues));
    var pathData = pointsToPath(defaultDims3)(lineData)(minX)(maxX)(minY)(maxY);
    var tree3 = withChild(named2(SVG.value)("svg")([width13(defaultDims3.width), height13(defaultDims3.height), viewBox7("0 0 " + (show30(defaultDims3.width) + (" " + show30(defaultDims3.height)))), class_10("line-chart-tree")]))(withChild(named2(Group2.value)("chartGroup")([class_10("chart-content"), transform7("translate(" + (show30(defaultDims3.marginLeft) + ("," + (show30(defaultDims3.marginTop) + ")"))))]))(named2(Path3.value)("line")([d7(pathData), fill10("none"), stroke7("#2ecc71"), strokeWidth7(2), class_10("line")])));
    return bind20(renderTree6(container)(tree3))(function(selections) {
      return liftEffect8(function __do3() {
        log2("=== Line Chart (Tree API) ===")();
        log2("")();
        log2("Rendered line with " + (show116(length(lineData)) + " points"))();
        (function() {
          var v = lookup16("svg")(selections);
          if (v instanceof Just) {
            return log2("\u2713 SVG created")();
          }
          ;
          if (v instanceof Nothing) {
            return log2("\u2717 Missing SVG")();
          }
          ;
          throw new Error("Failed pattern match at D3.Viz.TreeAPI.LineChartExample (line 128, column 5 - line 130, column 45): " + [v.constructor.name]);
        })();
        (function() {
          var v = lookup16("chartGroup")(selections);
          if (v instanceof Just) {
            return log2("\u2713 Chart group created")();
          }
          ;
          if (v instanceof Nothing) {
            return log2("\u2717 Missing chart group")();
          }
          ;
          throw new Error("Failed pattern match at D3.Viz.TreeAPI.LineChartExample (line 132, column 5 - line 134, column 53): " + [v.constructor.name]);
        })();
        (function() {
          var v = lookup16("line")(selections);
          if (v instanceof Just) {
            return log2("\u2713 Line path created")();
          }
          ;
          if (v instanceof Nothing) {
            return log2("\u2717 Missing line path")();
          }
          ;
          throw new Error("Failed pattern match at D3.Viz.TreeAPI.LineChartExample (line 136, column 5 - line 138, column 51): " + [v.constructor.name]);
        })();
        log2("")();
        return log2("Expected: Green sine wave curve")();
      });
    });
  }));

  // output/D3.Viz.TreeAPI.NestedElementsExample/index.js
  var bind21 = /* @__PURE__ */ bind(bindD3v2M);
  var width14 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height14 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox8 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var id_3 = /* @__PURE__ */ id_(toAttrStringString);
  var class_11 = /* @__PURE__ */ class_2(toAttrStringString);
  var transform8 = /* @__PURE__ */ transform2(toAttrStringString);
  var cx5 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy5 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius6 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill11 = /* @__PURE__ */ fill3(toAttrStringString);
  var stroke8 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth8 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var x8 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y8 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var textContent5 = /* @__PURE__ */ textContent(toAttrStringString);
  var textAnchor4 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var fontSize4 = /* @__PURE__ */ fontSize2(toAttrNumberNumber);
  var renderTree7 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(ordUnit);
  var liftEffect9 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var lookup17 = /* @__PURE__ */ lookup2(ordString);
  var show31 = /* @__PURE__ */ show(showInt);
  var testNestedElements = /* @__PURE__ */ runD3v2M(/* @__PURE__ */ bind21(/* @__PURE__ */ select4(selectionMD3v2Selection_D)("#viz"))(function(container) {
    var tree3 = withChild(named2(SVG.value)("svg")([width14(600), height14(400), viewBox8("0 0 600 400"), id_3("nested-example-svg")]))(withChildren(named2(Group2.value)("mainGroup")([class_11("main-group")]))([withChildren(named2(Group2.value)("node1")([class_11("node"), transform8("translate(100, 100)")]))([named2(Circle2.value)("node1Circle")([cx5(0), cy5(0), radius6(25), fill11("steelblue"), stroke8("white"), strokeWidth8(2)]), named2(Text3.value)("node1Label")([x8(0), y8(40), textContent5("Node A"), textAnchor4("middle"), fontSize4(14)])]), withChildren(named2(Group2.value)("node2")([class_11("node"), transform8("translate(300, 150)")]))([named2(Circle2.value)("node2Circle")([cx5(0), cy5(0), radius6(20), fill11("orange"), stroke8("white"), strokeWidth8(2)]), named2(Text3.value)("node2Label")([x8(0), y8(35), textContent5("Node B"), textAnchor4("middle"), fontSize4(14)])]), withChildren(named2(Group2.value)("node3")([class_11("node"), transform8("translate(500, 100)")]))([named2(Circle2.value)("node3Circle")([cx5(0), cy5(0), radius6(30), fill11("green"), stroke8("white"), strokeWidth8(2)]), named2(Text3.value)("node3Label")([x8(0), y8(45), textContent5("Node C"), textAnchor4("middle"), fontSize4(14)])])]));
    return bind21(renderTree7(container)(tree3))(function(selections) {
      return liftEffect9(function __do3() {
        log2("=== Nested Elements Test ===")();
        log2("")();
        log2("Structure: SVG \u2192 Group \u2192 (Node1, Node2, Node3)")();
        log2("           Each Node \u2192 (Circle + Text)")();
        log2("")();
        var checkSelection = function(name16) {
          var v = lookup17(name16)(selections);
          if (v instanceof Just) {
            return log2("\u2713 " + name16);
          }
          ;
          if (v instanceof Nothing) {
            return log2("\u2717 Missing: " + name16);
          }
          ;
          throw new Error("Failed pattern match at D3.Viz.TreeAPI.NestedElementsExample (line 118, column 31 - line 120, column 57): " + [v.constructor.name]);
        };
        log2("Top-level:")();
        checkSelection("svg")();
        checkSelection("mainGroup")();
        log2("\nNode 1 (steelblue at 100, 100):")();
        checkSelection("node1")();
        checkSelection("node1Circle")();
        checkSelection("node1Label")();
        log2("\nNode 2 (orange at 300, 150):")();
        checkSelection("node2")();
        checkSelection("node2Circle")();
        checkSelection("node2Label")();
        log2("\nNode 3 (green at 500, 100):")();
        checkSelection("node3")();
        checkSelection("node3Circle")();
        checkSelection("node3Label")();
        log2("\n" + (show31(size2(selections)) + " total selections in map"))();
        log2("\n=== SUCCESS CRITERIA ===")();
        log2("\u2713 Multi-level nesting works (Group \u2192 Circle + Text)")();
        log2("\u2713 withChildren handles arrays of subtrees")();
        log2("\u2713 All named nodes are accessible via Map")();
        log2("")();
        log2("NEXT: Need data joins to generate this structure from Array data")();
        return log2("      instead of manually creating each node.")();
      });
    });
  }));

  // output/D3.Viz.TreeAPI.ScatterPlotExample/index.js
  var bind23 = /* @__PURE__ */ bind(bindD3v2M);
  var map46 = /* @__PURE__ */ map(functorArray);
  var minimum5 = /* @__PURE__ */ minimum(ordNumber)(foldableArray);
  var maximum7 = /* @__PURE__ */ maximum(ordNumber)(foldableArray);
  var width15 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height15 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox9 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var show32 = /* @__PURE__ */ show(showNumber);
  var class_12 = /* @__PURE__ */ class_2(toAttrStringString);
  var transform9 = /* @__PURE__ */ transform2(toAttrStringString);
  var cx6 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy6 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius7 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill12 = /* @__PURE__ */ fill3(toAttrStringString);
  var opacity3 = /* @__PURE__ */ opacity(toAttrNumberNumber);
  var renderTree8 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(/* @__PURE__ */ ordRecord()(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordNil)()({
    reflectSymbol: function() {
      return "y";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "x";
    }
  })(ordNumber)));
  var liftEffect10 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var show117 = /* @__PURE__ */ show(showInt);
  var lookup18 = /* @__PURE__ */ lookup2(ordString);
  var scatterData = [{
    x: 10,
    y: 20
  }, {
    x: 25,
    y: 45
  }, {
    x: 40,
    y: 30
  }, {
    x: 55,
    y: 70
  }, {
    x: 70,
    y: 50
  }, {
    x: 85,
    y: 85
  }, {
    x: 100,
    y: 65
  }, {
    x: 115,
    y: 90
  }, {
    x: 130,
    y: 75
  }, {
    x: 145,
    y: 95
  }];
  var innerWidth5 = function(dims) {
    return dims.width - dims.marginLeft - dims.marginRight;
  };
  var innerHeight5 = function(dims) {
    return dims.height - dims.marginTop - dims.marginBottom;
  };
  var defaultDims4 = {
    width: 600,
    height: 400,
    marginTop: 20,
    marginRight: 20,
    marginBottom: 40,
    marginLeft: 50
  };
  var scatterPlot = /* @__PURE__ */ runD3v2M(/* @__PURE__ */ bind23(/* @__PURE__ */ select4(selectionMD3v2Selection_D)("#viz"))(function(container) {
    var iWidth = innerWidth5(defaultDims4);
    var iHeight = innerHeight5(defaultDims4);
    var xValues = map46(function(v) {
      return v.x;
    })(scatterData);
    var yValues = map46(function(v) {
      return v.y;
    })(scatterData);
    var minX = fromMaybe(0)(minimum5(xValues));
    var maxX = fromMaybe(100)(maximum7(xValues));
    var minY = fromMaybe(0)(minimum5(yValues));
    var maxY = fromMaybe(100)(maximum7(yValues));
    var xScale = function(val) {
      return (val - minX) / (maxX - minX) * iWidth;
    };
    var yScale = function(val) {
      return iHeight - (val - minY) / (maxY - minY) * iHeight;
    };
    var tree3 = withChild(named2(SVG.value)("svg")([width15(defaultDims4.width), height15(defaultDims4.height), viewBox9("0 0 " + (show32(defaultDims4.width) + (" " + show32(defaultDims4.height)))), class_12("scatter-plot-tree")]))(withChild(named2(Group2.value)("chartGroup")([class_12("chart-content"), transform9("translate(" + (show32(defaultDims4.marginLeft) + ("," + (show32(defaultDims4.marginTop) + ")"))))]))(joinData2("points")("circle")(scatterData)(function(point) {
      return elem4(Circle2.value)([cx6(xScale(point.x)), cy6(yScale(point.y)), radius7(6), fill12("#e74c3c"), opacity3(0.7), class_12("point")]);
    })));
    return bind23(renderTree8(container)(tree3))(function(selections) {
      return liftEffect10(function __do3() {
        log2("=== Scatter Plot (Tree API) ===")();
        log2("")();
        log2("Rendered " + (show117(length(scatterData)) + " points"))();
        (function() {
          var v = lookup18("svg")(selections);
          if (v instanceof Just) {
            return log2("\u2713 SVG created")();
          }
          ;
          if (v instanceof Nothing) {
            return log2("\u2717 Missing SVG")();
          }
          ;
          throw new Error("Failed pattern match at D3.Viz.TreeAPI.ScatterPlotExample (line 120, column 5 - line 122, column 45): " + [v.constructor.name]);
        })();
        (function() {
          var v = lookup18("chartGroup")(selections);
          if (v instanceof Just) {
            return log2("\u2713 Chart group created")();
          }
          ;
          if (v instanceof Nothing) {
            return log2("\u2717 Missing chart group")();
          }
          ;
          throw new Error("Failed pattern match at D3.Viz.TreeAPI.ScatterPlotExample (line 124, column 5 - line 126, column 53): " + [v.constructor.name]);
        })();
        (function() {
          var v = lookup18("points")(selections);
          if (v instanceof Just) {
            return log2("\u2713 Points collection created")();
          }
          ;
          if (v instanceof Nothing) {
            return log2("\u2717 Missing points collection")();
          }
          ;
          throw new Error("Failed pattern match at D3.Viz.TreeAPI.ScatterPlotExample (line 128, column 5 - line 130, column 59): " + [v.constructor.name]);
        })();
        log2("")();
        return log2("Expected: 10 red circles showing scatter pattern")();
      });
    });
  }));

  // output/D3.Viz.TreeAPI.SimpleTreeExample/index.js
  var bind24 = /* @__PURE__ */ bind(bindD3v2M);
  var width16 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height16 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox10 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var id_4 = /* @__PURE__ */ id_(toAttrStringString);
  var class_13 = /* @__PURE__ */ class_2(toAttrStringString);
  var cx7 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy7 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius8 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill13 = /* @__PURE__ */ fill3(toAttrStringString);
  var x9 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y9 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var textContent6 = /* @__PURE__ */ textContent(toAttrStringString);
  var textAnchor5 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var renderTree9 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(ordUnit);
  var liftEffect11 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var lookup19 = /* @__PURE__ */ lookup2(ordString);
  var testSimpleTree = /* @__PURE__ */ runD3v2M(/* @__PURE__ */ bind24(/* @__PURE__ */ select4(selectionMD3v2Selection_D)("#viz"))(function(container) {
    var tree3 = withChild(named2(SVG.value)("svg")([width16(800), height16(600), viewBox10("0 0 800 600"), id_4("simple-tree-svg")]))(withChildren(named2(Group2.value)("container")([class_13("container")]))([named2(Circle2.value)("circle")([cx7(100), cy7(100), radius8(20), fill13("steelblue")]), named2(Text3.value)("text")([x9(100), y9(130), textContent6("Hello Tree API!"), textAnchor5("middle")])]));
    return bind24(renderTree9(container)(tree3))(function(selections) {
      return liftEffect11(function __do3() {
        (function() {
          var v = lookup19("svg")(selections);
          if (v instanceof Just) {
            return log2("\u2713 Found svg selection")();
          }
          ;
          if (v instanceof Nothing) {
            return log2("\u2717 Missing svg selection")();
          }
          ;
          throw new Error("Failed pattern match at D3.Viz.TreeAPI.SimpleTreeExample (line 49, column 5 - line 51, column 55): " + [v.constructor.name]);
        })();
        (function() {
          var v = lookup19("container")(selections);
          if (v instanceof Just) {
            return log2("\u2713 Found container selection")();
          }
          ;
          if (v instanceof Nothing) {
            return log2("\u2717 Missing container selection")();
          }
          ;
          throw new Error("Failed pattern match at D3.Viz.TreeAPI.SimpleTreeExample (line 53, column 5 - line 55, column 61): " + [v.constructor.name]);
        })();
        (function() {
          var v = lookup19("circle")(selections);
          if (v instanceof Just) {
            return log2("\u2713 Found circle selection")();
          }
          ;
          if (v instanceof Nothing) {
            return log2("\u2717 Missing circle selection")();
          }
          ;
          throw new Error("Failed pattern match at D3.Viz.TreeAPI.SimpleTreeExample (line 57, column 5 - line 59, column 58): " + [v.constructor.name]);
        })();
        (function() {
          var v = lookup19("text")(selections);
          if (v instanceof Just) {
            return log2("\u2713 Found text selection")();
          }
          ;
          if (v instanceof Nothing) {
            return log2("\u2717 Missing text selection")();
          }
          ;
          throw new Error("Failed pattern match at D3.Viz.TreeAPI.SimpleTreeExample (line 61, column 5 - line 63, column 56): " + [v.constructor.name]);
        })();
        return log2("Simple tree rendering complete!")();
      });
    });
  }));

  // output/D3.Viz.TreeAPI.ThreeLittleCircles/index.js
  var bind25 = /* @__PURE__ */ bind(bindD3v2M);
  var width17 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height17 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox11 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var id_5 = /* @__PURE__ */ id_(toAttrStringString);
  var class_14 = /* @__PURE__ */ class_2(toAttrStringString);
  var cx8 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy8 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius9 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill14 = /* @__PURE__ */ fill3(toAttrStringString);
  var renderTree10 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(/* @__PURE__ */ ordRecord()(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordNil)()({
    reflectSymbol: function() {
      return "y";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "x";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "r";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "color";
    }
  })(ordString)));
  var liftEffect13 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var lookup20 = /* @__PURE__ */ lookup2(ordString);
  var circleData = [{
    x: 100,
    y: 100,
    r: 40,
    color: "red"
  }, {
    x: 200,
    y: 100,
    r: 30,
    color: "green"
  }, {
    x: 300,
    y: 100,
    r: 50,
    color: "blue"
  }];
  var threeLittleCircles = /* @__PURE__ */ runD3v2M(/* @__PURE__ */ bind25(/* @__PURE__ */ select4(selectionMD3v2Selection_D)("#viz"))(function(container) {
    var tree3 = withChild(named2(SVG.value)("svg")([width17(400), height17(200), viewBox11("0 0 400 200"), id_5("three-circles-svg"), class_14("tree-api-example")]))(joinData2("circles")("circle")(circleData)(function(d18) {
      return elem4(Circle2.value)([cx8(d18.x), cy8(d18.y), radius9(d18.r), fill14(d18.color)]);
    }));
    return bind25(renderTree10(container)(tree3))(function(selections) {
      return liftEffect13(function __do3() {
        log2("=== Three Little Circles (Declarative API) ===")();
        log2("")();
        log2("Structure: SVG \u2192 [Circle \xD7 3] (via joinData)")();
        log2("")();
        (function() {
          var v = lookup20("svg")(selections);
          if (v instanceof Just) {
            return log2("\u2713 SVG created")();
          }
          ;
          if (v instanceof Nothing) {
            return log2("\u2717 Missing SVG")();
          }
          ;
          throw new Error("Failed pattern match at D3.Viz.TreeAPI.ThreeLittleCircles (line 73, column 5 - line 75, column 45): " + [v.constructor.name]);
        })();
        (function() {
          var v = lookup20("circles")(selections);
          if (v instanceof Just) {
            return log2("\u2713 Circles collection created (3 circles via data join)")();
          }
          ;
          if (v instanceof Nothing) {
            return log2("\u2717 Missing circles collection")();
          }
          ;
          throw new Error("Failed pattern match at D3.Viz.TreeAPI.ThreeLittleCircles (line 77, column 5 - line 79, column 60): " + [v.constructor.name]);
        })();
        log2("")();
        log2("Expected result:")();
        log2("  - Red circle (r=40) at (100, 100)")();
        log2("  - Green circle (r=30) at (200, 100)")();
        log2("  - Blue circle (r=50) at (300, 100)")();
        log2("")();
        return log2("Check the browser to verify!")();
      });
    });
  }));

  // output/PSD3v2.Capabilities.Transition/index.js
  var withTransitionStaggered = function(dict) {
    return dict.withTransitionStaggered;
  };
  var withTransition = function(dict) {
    return dict.withTransition;
  };
  var staggerByIndex = function(msPerElement) {
    return function(v) {
      return function(i2) {
        return toNumber(i2) * msPerElement;
      };
    };
  };

  // output/D3.Viz.TreeAPI.ThreeLittleCirclesTransition/index.js
  var discard16 = /* @__PURE__ */ discard(discardUnit);
  var discard17 = /* @__PURE__ */ discard16(bindD3v2M);
  var withTransition2 = /* @__PURE__ */ withTransition(transitionMD3v2Selection_);
  var fill15 = /* @__PURE__ */ fill3(toAttrStringFunctionStrin);
  var cx9 = /* @__PURE__ */ cx3(toAttrNumberFunctionNumbe);
  var cy9 = /* @__PURE__ */ cy3(toAttrNumberFunctionNumbe);
  var radius10 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fillOpacity2 = /* @__PURE__ */ fillOpacity(toAttrNumberNumber);
  var pure18 = /* @__PURE__ */ pure(applicativeD3v2M);
  var bind111 = /* @__PURE__ */ bind(bindD3v2M);
  var select9 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var width18 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height18 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox12 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var id_6 = /* @__PURE__ */ id_(toAttrStringString);
  var fill1 = /* @__PURE__ */ fill3(toAttrStringString);
  var cx12 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy12 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var renderTree11 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(ordInt);
  var lookup21 = /* @__PURE__ */ lookup2(ordString);
  var StateGreen = /* @__PURE__ */ (function() {
    function StateGreen2() {
    }
    ;
    StateGreen2.value = new StateGreen2();
    return StateGreen2;
  })();
  var StateRGB = /* @__PURE__ */ (function() {
    function StateRGB2() {
    }
    ;
    StateRGB2.value = new StateRGB2();
    return StateRGB2;
  })();
  var showCircleState = {
    show: function(v) {
      if (v instanceof StateGreen) {
        return "StateGreen";
      }
      ;
      if (v instanceof StateRGB) {
        return "StateRGB";
      }
      ;
      throw new Error("Failed pattern match at D3.Viz.TreeAPI.ThreeLittleCirclesTransition (line 42, column 1 - line 44, column 29): " + [v.constructor.name]);
    }
  };
  var show33 = /* @__PURE__ */ show(showCircleState);
  var transitionToState = function(circlesSel) {
    return function(state3) {
      var cyFnRGB = function(d18) {
        if (d18 === 0) {
          return 130;
        }
        ;
        if (d18 === 1) {
          return 130;
        }
        ;
        return 70;
      };
      var cyFnGreen = function(v) {
        return 125;
      };
      var cxFnRGB = function(d18) {
        if (d18 === 0) {
          return 150;
        }
        ;
        if (d18 === 1) {
          return 250;
        }
        ;
        return 200;
      };
      var cxFnGreen = function(d18) {
        return 100 + toNumber(d18) * 100;
      };
      var colorFnRGB = function(d18) {
        if (d18 === 0) {
          return "#ff0000";
        }
        ;
        if (d18 === 1) {
          return "#00ff00";
        }
        ;
        return "#0000ff";
      };
      var colorFnGreen = function(v) {
        return "#00ff00";
      };
      return runD3v2M((function() {
        var transitionConfig = transitionWith({
          duration: 1e3,
          delay: Nothing.value,
          easing: Nothing.value
        });
        return discard17((function() {
          if (state3 instanceof StateGreen) {
            return withTransition2(transitionConfig)(circlesSel)([fill15(colorFnGreen), cx9(cxFnGreen), cy9(cyFnGreen), radius10(40), fillOpacity2(1)]);
          }
          ;
          if (state3 instanceof StateRGB) {
            return withTransition2(transitionConfig)(circlesSel)([fill15(colorFnRGB), cx9(cxFnRGB), cy9(cyFnRGB), radius10(60), fillOpacity2(0.5)]);
          }
          ;
          throw new Error("Failed pattern match at D3.Viz.TreeAPI.ThreeLittleCirclesTransition (line 60, column 3 - line 77, column 10): " + [state3.constructor.name]);
        })())(function() {
          return pure18(unit);
        });
      })());
    };
  };
  var toggleState = function(v) {
    if (v instanceof StateGreen) {
      return StateRGB.value;
    }
    ;
    if (v instanceof StateRGB) {
      return StateRGB.value;
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.TreeAPI.ThreeLittleCirclesTransition (line 47, column 1 - line 47, column 42): " + [v.constructor.name]);
  };
  var threeLittleCirclesTransition = function(selector) {
    return function __do3() {
      var stateRef = $$new(StateGreen.value)();
      return runD3v2M(bind111(select9(selector))(function(container) {
        var initialTree = withChild(named2(SVG.value)("svg")([width18(400), height18(250), viewBox12("0 0 400 250"), id_6("three-circles-transition-tree")]))(joinData2("circles")("circle")([0, 1, 2])(function(d18) {
          return elem4(Circle2.value)([fill1("#00ff00"), cx12(100 + toNumber(d18) * 100), cy12(125), radius10(40), fillOpacity2(1)]);
        }));
        return bind111(renderTree11(container)(initialTree))(function(selections) {
          var circlesSel = (function() {
            var v = lookup21("circles")(selections);
            if (v instanceof Just) {
              return v.value0;
            }
            ;
            if (v instanceof Nothing) {
              return unsafeCrashWith("circles selection not found");
            }
            ;
            throw new Error("Failed pattern match at D3.Viz.TreeAPI.ThreeLittleCirclesTransition (line 145, column 22 - line 147, column 83): " + [v.constructor.name]);
          })();
          return pure18({
            stateRef,
            circlesSel
          });
        });
      }))();
    };
  };
  var createTransitionTrigger = function(v) {
    return function __do3() {
      var currentState = read(v.stateRef)();
      var newState = toggleState(currentState);
      write(newState)(v.stateRef)();
      log2("Transitioning to: " + show33(newState))();
      return transitionToState(v.circlesSel)(newState)();
    };
  };

  // output/D3.Viz.TreeAPI.ThreeLittleDimensionsExample/index.js
  var bind26 = /* @__PURE__ */ bind(bindD3v2M);
  var class_15 = /* @__PURE__ */ class_2(toAttrStringString);
  var identity15 = /* @__PURE__ */ identity(categoryFn);
  var textContent7 = /* @__PURE__ */ textContent(toAttrStringString);
  var show34 = /* @__PURE__ */ show(showInt);
  var renderTree14 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(/* @__PURE__ */ ordArray(ordInt));
  var liftEffect14 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var lookup22 = /* @__PURE__ */ lookup2(ordString);
  var matrixData = [[1, 2, 3], [4, 5, 6], [7, 8, 9]];
  var threeLittleDimensions = /* @__PURE__ */ runD3v2M(/* @__PURE__ */ bind26(/* @__PURE__ */ select4(selectionMD3v2Selection_D)("#viz"))(function(container) {
    var tree3 = withChild(named2(Table2.value)("table")([class_15("nested-data-table")]))(nestedJoin("rows")("tr")(matrixData)(identity15)(function(cellValue) {
      return elem4(Td2.value)([class_15("table-cell"), textContent7(show34(cellValue))]);
    }));
    return bind26(renderTree14(container)(tree3))(function(selections) {
      return liftEffect14(function __do3() {
        log2("=== Three Little Dimensions (Tree API) ===")();
        log2("")();
        (function() {
          var v = lookup22("table")(selections);
          if (v instanceof Just) {
            return log2("\u2713 Table created")();
          }
          ;
          if (v instanceof Nothing) {
            return log2("\u2717 Missing table")();
          }
          ;
          throw new Error("Failed pattern match at D3.Viz.TreeAPI.ThreeLittleDimensionsExample (line 60, column 5 - line 62, column 47): " + [v.constructor.name]);
        })();
        (function() {
          var v = lookup22("rows")(selections);
          if (v instanceof Just) {
            return log2("\u2713 Rows created (" + (show34(length(matrixData)) + ")"))();
          }
          ;
          if (v instanceof Nothing) {
            return log2("\u2717 Missing rows")();
          }
          ;
          throw new Error("Failed pattern match at D3.Viz.TreeAPI.ThreeLittleDimensionsExample (line 64, column 5 - line 66, column 46): " + [v.constructor.name]);
        })();
        (function() {
          var v = lookup22("cells")(selections);
          if (v instanceof Just) {
            var totalCells = foldl2(function(acc) {
              return function(row) {
                return acc + length(row) | 0;
              };
            })(0)(matrixData);
            return log2("\u2713 Cells created (" + (show34(totalCells) + " total)"))();
          }
          ;
          if (v instanceof Nothing) {
            return log2("\u2717 Missing cells")();
          }
          ;
          throw new Error("Failed pattern match at D3.Viz.TreeAPI.ThreeLittleDimensionsExample (line 68, column 5 - line 72, column 47): " + [v.constructor.name]);
        })();
        log2("")();
        return log2("Expected: 3x3 table with numbers 1-9")();
      });
    });
  }));

  // output/D3.Viz.TreeAPI.TreeViz/index.js
  var bind27 = /* @__PURE__ */ bind(bindList);
  var append20 = /* @__PURE__ */ append(semigroupList);
  var fromFoldable34 = /* @__PURE__ */ fromFoldable(foldableList);
  var show35 = /* @__PURE__ */ show(showNumber);
  var bind112 = /* @__PURE__ */ bind(bindD3v2M);
  var select10 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var fromFoldable112 = /* @__PURE__ */ fromFoldable(foldableTree);
  var discard18 = /* @__PURE__ */ discard(discardUnit);
  var discard19 = /* @__PURE__ */ discard18(bindD3v2M);
  var liftEffect15 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var show118 = /* @__PURE__ */ show(showInt);
  var width19 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height19 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox13 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var class_16 = /* @__PURE__ */ class_2(toAttrStringString);
  var d8 = /* @__PURE__ */ d4(toAttrStringString);
  var fill16 = /* @__PURE__ */ fill3(toAttrStringString);
  var stroke9 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth9 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var renderTree15 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D);
  var ordRecord4 = /* @__PURE__ */ ordRecord();
  var ordRecordCons4 = /* @__PURE__ */ ordRecordCons(ordRecordNil)();
  var ordRecordCons12 = /* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons4({
    reflectSymbol: function() {
      return "y";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "x";
    }
  })(ordNumber);
  var ordRecord12 = /* @__PURE__ */ ordRecord4(ordRecordCons12);
  var renderTree16 = /* @__PURE__ */ renderTree15(/* @__PURE__ */ ordRecord4(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons4({
    reflectSymbol: function() {
      return "target";
    }
  })(ordRecord12))()({
    reflectSymbol: function() {
      return "source";
    }
  })(ordRecord12)));
  var cx10 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy10 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius11 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var x10 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y10 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var textContent8 = /* @__PURE__ */ textContent(toAttrStringString);
  var fontSize5 = /* @__PURE__ */ fontSize2(toAttrNumberNumber);
  var textAnchor6 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var renderTree25 = /* @__PURE__ */ renderTree15(/* @__PURE__ */ ordRecord4(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordCons12)()({
    reflectSymbol: function() {
      return "value";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "name";
    }
  })(ordString))()({
    reflectSymbol: function() {
      return "height";
    }
  })(ordInt))()({
    reflectSymbol: function() {
      return "depth";
    }
  })(ordInt)));
  var bind28 = /* @__PURE__ */ bind(bindAff);
  var liftEffect16 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var makeLinks2 = function(tree$prime) {
    var makeLinksList = function(v) {
      var grandchildLinks = bind27(v.value1)(makeLinksList);
      var childLinks = bind27(v.value1)(function(v1) {
        return new Cons({
          source: {
            x: v.value0.x,
            y: v.value0.y
          },
          target: {
            x: v1.value0.x,
            y: v1.value0.y
          }
        }, Nil.value);
      });
      return append20(childLinks)(grandchildLinks);
    };
    return fromFoldable34(makeLinksList(tree$prime));
  };
  var linkPath = function(x1$prime) {
    return function(y1$prime) {
      return function(x2$prime) {
        return function(y2$prime) {
          return "M" + (show35(x1$prime) + ("," + (show35(y1$prime) + ("C" + (show35(x1$prime) + ("," + (show35((y1$prime + y2$prime) / 2) + (" " + (show35(x2$prime) + ("," + (show35((y1$prime + y2$prime) / 2) + (" " + (show35(x2$prime) + ("," + show35(y2$prime)))))))))))))));
        };
      };
    };
  };
  var drawTree = function(selector) {
    return function(flareTree) {
      return runD3v2M(bind112(select10(selector))(function(container) {
        var config = {
          layerScale: defaultTreeConfig.layerScale,
          minSeparation: defaultTreeConfig.minSeparation,
          separation: defaultTreeConfig.separation,
          size: {
            width: 800 - 2 * 40,
            height: 600 - 2 * 40
          }
        };
        var positioned = tree2(config)(flareTree);
        var nodes = fromFoldable112(positioned);
        var links = makeLinks2(positioned);
        return discard19(liftEffect15(log2("Rendering " + (show118(length(nodes)) + (" nodes, " + (show118(length(links)) + " links"))))))(function() {
          var linksTree = withChild(named2(SVG.value)("svg")([width19(800), height19(600), viewBox13("0 0 " + (show35(800) + (" " + show35(600)))), class_16("simple-hierarchy-tree")]))(withChild(named2(Group2.value)("chartGroup")([class_16("tree-content")]))(withChild(named2(Group2.value)("linksGroup")([class_16("links")]))(joinData2("links")("path")(links)(function(link4) {
            return elem4(Path3.value)([d8(linkPath(link4.source.x + 40)(link4.source.y + 40)(link4.target.x + 40)(link4.target.y + 40)), fill16("none"), stroke9("#999"), strokeWidth9(1.5), class_16("link")]);
          }))));
          return bind112(renderTree16(container)(linksTree))(function(linksSelections) {
            return bind112(liftEffect15(reselectD3v2("chartGroup")(linksSelections)))(function(chartGroupSel) {
              var nodesTree = withChild(named2(Group2.value)("nodesGroup")([class_16("nodes")]))(joinData2("nodeGroups")("g")(nodes)(function(node) {
                return withChildren(named2(Group2.value)("node-" + node.name)([class_16("node")]))([elem4(Circle2.value)([cx10(node.x + 40), cy10(node.y + 40), radius11(6), fill16("#69b3a2"), stroke9("#fff"), strokeWidth9(2)]), elem4(Text3.value)([x10(node.x + 40 + 10), y10(node.y + 40 + 4), textContent8(node.name), fontSize5(12), textAnchor6("start")])]);
              }));
              return bind112(renderTree25(chartGroupSel)(nodesTree))(function(nodesSelections) {
                return liftEffect15(function __do3() {
                  log2("=== Tree Layout (Tree API) ===")();
                  log2("")();
                  log2("Rendered " + (show118(length(nodes)) + (" nodes, " + (show118(length(links)) + " links"))))();
                  log2("Flare visualization toolkit hierarchy")();
                  return log2("")();
                });
              });
            });
          });
        });
      }));
    };
  };
  var treeViz = function(selector) {
    return launchAff_(bind28(loadFlareData)(function(result) {
      if (result instanceof Left) {
        return liftEffect16(log2("Failed to load Flare data: " + result.value0));
      }
      ;
      if (result instanceof Right) {
        return liftEffect16(drawTree(selector)(result.value0));
      }
      ;
      throw new Error("Failed pattern match at D3.Viz.TreeAPI.TreeViz (line 154, column 3 - line 156, column 64): " + [result.constructor.name]);
    }));
  };

  // output/PSD3.PrismJS/foreign.js
  function highlightAll() {
    if (window.Prism) {
      window.Prism.highlightAll();
    }
  }

  // output/PSD3.Website.Types/index.js
  var Home = /* @__PURE__ */ (function() {
    function Home2() {
    }
    ;
    Home2.value = new Home2();
    return Home2;
  })();
  var GettingStarted = /* @__PURE__ */ (function() {
    function GettingStarted2() {
    }
    ;
    GettingStarted2.value = new GettingStarted2();
    return GettingStarted2;
  })();
  var Wizard = /* @__PURE__ */ (function() {
    function Wizard2() {
    }
    ;
    Wizard2.value = new Wizard2();
    return Wizard2;
  })();
  var HowtoIndex = /* @__PURE__ */ (function() {
    function HowtoIndex2() {
    }
    ;
    HowtoIndex2.value = new HowtoIndex2();
    return HowtoIndex2;
  })();
  var HowtoTransitions = /* @__PURE__ */ (function() {
    function HowtoTransitions2() {
    }
    ;
    HowtoTransitions2.value = new HowtoTransitions2();
    return HowtoTransitions2;
  })();
  var HowtoForceGraphs = /* @__PURE__ */ (function() {
    function HowtoForceGraphs2() {
    }
    ;
    HowtoForceGraphs2.value = new HowtoForceGraphs2();
    return HowtoForceGraphs2;
  })();
  var HowtoHierarchical = /* @__PURE__ */ (function() {
    function HowtoHierarchical2() {
    }
    ;
    HowtoHierarchical2.value = new HowtoHierarchical2();
    return HowtoHierarchical2;
  })();
  var HowtoEvents = /* @__PURE__ */ (function() {
    function HowtoEvents2() {
    }
    ;
    HowtoEvents2.value = new HowtoEvents2();
    return HowtoEvents2;
  })();
  var HowtoTreeAPI = /* @__PURE__ */ (function() {
    function HowtoTreeAPI2() {
    }
    ;
    HowtoTreeAPI2.value = new HowtoTreeAPI2();
    return HowtoTreeAPI2;
  })();
  var HowtoLoadingData = /* @__PURE__ */ (function() {
    function HowtoLoadingData2() {
    }
    ;
    HowtoLoadingData2.value = new HowtoLoadingData2();
    return HowtoLoadingData2;
  })();
  var HowtoAxesScales = /* @__PURE__ */ (function() {
    function HowtoAxesScales2() {
    }
    ;
    HowtoAxesScales2.value = new HowtoAxesScales2();
    return HowtoAxesScales2;
  })();
  var HowtoTooltips = /* @__PURE__ */ (function() {
    function HowtoTooltips2() {
    }
    ;
    HowtoTooltips2.value = new HowtoTooltips2();
    return HowtoTooltips2;
  })();
  var HowtoDebugging = /* @__PURE__ */ (function() {
    function HowtoDebugging2() {
    }
    ;
    HowtoDebugging2.value = new HowtoDebugging2();
    return HowtoDebugging2;
  })();
  var HowtoPerformance = /* @__PURE__ */ (function() {
    function HowtoPerformance2() {
    }
    ;
    HowtoPerformance2.value = new HowtoPerformance2();
    return HowtoPerformance2;
  })();
  var HowtoTreeExplorer = /* @__PURE__ */ (function() {
    function HowtoTreeExplorer2() {
    }
    ;
    HowtoTreeExplorer2.value = new HowtoTreeExplorer2();
    return HowtoTreeExplorer2;
  })();
  var Understanding = /* @__PURE__ */ (function() {
    function Understanding2() {
    }
    ;
    Understanding2.value = new Understanding2();
    return Understanding2;
  })();
  var UnderstandingGrammar = /* @__PURE__ */ (function() {
    function UnderstandingGrammar2() {
    }
    ;
    UnderstandingGrammar2.value = new UnderstandingGrammar2();
    return UnderstandingGrammar2;
  })();
  var UnderstandingAttributes = /* @__PURE__ */ (function() {
    function UnderstandingAttributes2() {
    }
    ;
    UnderstandingAttributes2.value = new UnderstandingAttributes2();
    return UnderstandingAttributes2;
  })();
  var UnderstandingSelections = /* @__PURE__ */ (function() {
    function UnderstandingSelections2() {
    }
    ;
    UnderstandingSelections2.value = new UnderstandingSelections2();
    return UnderstandingSelections2;
  })();
  var UnderstandingTreeAPI = /* @__PURE__ */ (function() {
    function UnderstandingTreeAPI2() {
    }
    ;
    UnderstandingTreeAPI2.value = new UnderstandingTreeAPI2();
    return UnderstandingTreeAPI2;
  })();
  var UnderstandingScenes = /* @__PURE__ */ (function() {
    function UnderstandingScenes2() {
    }
    ;
    UnderstandingScenes2.value = new UnderstandingScenes2();
    return UnderstandingScenes2;
  })();
  var Reference = /* @__PURE__ */ (function() {
    function Reference2() {
    }
    ;
    Reference2.value = new Reference2();
    return Reference2;
  })();
  var ReferenceModule = /* @__PURE__ */ (function() {
    function ReferenceModule2(value0) {
      this.value0 = value0;
    }
    ;
    ReferenceModule2.create = function(value0) {
      return new ReferenceModule2(value0);
    };
    return ReferenceModule2;
  })();
  var TourIndex = /* @__PURE__ */ (function() {
    function TourIndex2() {
    }
    ;
    TourIndex2.value = new TourIndex2();
    return TourIndex2;
  })();
  var TourFoundations = /* @__PURE__ */ (function() {
    function TourFoundations2() {
    }
    ;
    TourFoundations2.value = new TourFoundations2();
    return TourFoundations2;
  })();
  var TourProfessional = /* @__PURE__ */ (function() {
    function TourProfessional2() {
    }
    ;
    TourProfessional2.value = new TourProfessional2();
    return TourProfessional2;
  })();
  var TourFlow = /* @__PURE__ */ (function() {
    function TourFlow2() {
    }
    ;
    TourFlow2.value = new TourFlow2();
    return TourFlow2;
  })();
  var TourHierarchies = /* @__PURE__ */ (function() {
    function TourHierarchies2() {
    }
    ;
    TourHierarchies2.value = new TourHierarchies2();
    return TourHierarchies2;
  })();
  var TourMotion = /* @__PURE__ */ (function() {
    function TourMotion2() {
    }
    ;
    TourMotion2.value = new TourMotion2();
    return TourMotion2;
  })();
  var TourWealthHealth = /* @__PURE__ */ (function() {
    function TourWealthHealth2() {
    }
    ;
    TourWealthHealth2.value = new TourWealthHealth2();
    return TourWealthHealth2;
  })();
  var TourInterpreters = /* @__PURE__ */ (function() {
    function TourInterpreters2() {
    }
    ;
    TourInterpreters2.value = new TourInterpreters2();
    return TourInterpreters2;
  })();
  var TourFPFTW = /* @__PURE__ */ (function() {
    function TourFPFTW2() {
    }
    ;
    TourFPFTW2.value = new TourFPFTW2();
    return TourFPFTW2;
  })();
  var TourGraphAlgorithms = /* @__PURE__ */ (function() {
    function TourGraphAlgorithms2() {
    }
    ;
    TourGraphAlgorithms2.value = new TourGraphAlgorithms2();
    return TourGraphAlgorithms2;
  })();
  var TourLesMisGUP = /* @__PURE__ */ (function() {
    function TourLesMisGUP2() {
    }
    ;
    TourLesMisGUP2.value = new TourLesMisGUP2();
    return TourLesMisGUP2;
  })();
  var TourShowcase = /* @__PURE__ */ (function() {
    function TourShowcase2() {
    }
    ;
    TourShowcase2.value = new TourShowcase2();
    return TourShowcase2;
  })();
  var Showcase = /* @__PURE__ */ (function() {
    function Showcase2() {
    }
    ;
    Showcase2.value = new Showcase2();
    return Showcase2;
  })();
  var Gallery = /* @__PURE__ */ (function() {
    function Gallery2() {
    }
    ;
    Gallery2.value = new Gallery2();
    return Gallery2;
  })();
  var Example = /* @__PURE__ */ (function() {
    function Example2(value0) {
      this.value0 = value0;
    }
    ;
    Example2.create = function(value0) {
      return new Example2(value0);
    };
    return Example2;
  })();
  var TreeAPI = /* @__PURE__ */ (function() {
    function TreeAPI2() {
    }
    ;
    TreeAPI2.value = new TreeAPI2();
    return TreeAPI2;
  })();
  var AnimatedTreeCluster = /* @__PURE__ */ (function() {
    function AnimatedTreeCluster2() {
    }
    ;
    AnimatedTreeCluster2.value = new AnimatedTreeCluster2();
    return AnimatedTreeCluster2;
  })();
  var GeneralUpdatePattern = /* @__PURE__ */ (function() {
    function GeneralUpdatePattern2() {
    }
    ;
    GeneralUpdatePattern2.value = new GeneralUpdatePattern2();
    return GeneralUpdatePattern2;
  })();
  var LesMisGUPTree = /* @__PURE__ */ (function() {
    function LesMisGUPTree2() {
    }
    ;
    LesMisGUPTree2.value = new LesMisGUPTree2();
    return LesMisGUPTree2;
  })();
  var LesMisGUP = /* @__PURE__ */ (function() {
    function LesMisGUP2() {
    }
    ;
    LesMisGUP2.value = new LesMisGUP2();
    return LesMisGUP2;
  })();
  var LesMisGUPSimple = /* @__PURE__ */ (function() {
    function LesMisGUPSimple2() {
    }
    ;
    LesMisGUPSimple2.value = new LesMisGUPSimple2();
    return LesMisGUPSimple2;
  })();
  var LesMisGUPClean = /* @__PURE__ */ (function() {
    function LesMisGUPClean2() {
    }
    ;
    LesMisGUPClean2.value = new LesMisGUPClean2();
    return LesMisGUPClean2;
  })();
  var LesMisQueryDemo = /* @__PURE__ */ (function() {
    function LesMisQueryDemo2() {
    }
    ;
    LesMisQueryDemo2.value = new LesMisQueryDemo2();
    return LesMisQueryDemo2;
  })();
  var ModuleGraph = /* @__PURE__ */ (function() {
    function ModuleGraph2() {
    }
    ;
    ModuleGraph2.value = new ModuleGraph2();
    return ModuleGraph2;
  })();
  var MermaidTreeDemo = /* @__PURE__ */ (function() {
    function MermaidTreeDemo2() {
    }
    ;
    MermaidTreeDemo2.value = new MermaidTreeDemo2();
    return MermaidTreeDemo2;
  })();
  var SceneJoinDemo = /* @__PURE__ */ (function() {
    function SceneJoinDemo2() {
    }
    ;
    SceneJoinDemo2.value = new SceneJoinDemo2();
    return SceneJoinDemo2;
  })();
  var CodeExplorer = /* @__PURE__ */ (function() {
    function CodeExplorer2() {
    }
    ;
    CodeExplorer2.value = new CodeExplorer2();
    return CodeExplorer2;
  })();
  var CodeExplorerV2 = /* @__PURE__ */ (function() {
    function CodeExplorerV22() {
    }
    ;
    CodeExplorerV22.value = new CodeExplorerV22();
    return CodeExplorerV22;
  })();
  var Acknowledgements = /* @__PURE__ */ (function() {
    function Acknowledgements2() {
    }
    ;
    Acknowledgements2.value = new Acknowledgements2();
    return Acknowledgements2;
  })();
  var NotFound = /* @__PURE__ */ (function() {
    function NotFound2() {
    }
    ;
    NotFound2.value = new NotFound2();
    return NotFound2;
  })();
  var showRoute = {
    show: function(v) {
      if (v instanceof Home) {
        return "Home";
      }
      ;
      if (v instanceof GettingStarted) {
        return "Getting Started";
      }
      ;
      if (v instanceof Wizard) {
        return "Wizard";
      }
      ;
      if (v instanceof HowtoIndex) {
        return "How-to Guides";
      }
      ;
      if (v instanceof HowtoTransitions) {
        return "How-to: Transitions";
      }
      ;
      if (v instanceof HowtoForceGraphs) {
        return "How-to: Force Graphs";
      }
      ;
      if (v instanceof HowtoHierarchical) {
        return "How-to: Hierarchical Data";
      }
      ;
      if (v instanceof HowtoEvents) {
        return "How-to: Events";
      }
      ;
      if (v instanceof HowtoTreeAPI) {
        return "How-to: TreeAPI";
      }
      ;
      if (v instanceof HowtoLoadingData) {
        return "How-to: Loading Data";
      }
      ;
      if (v instanceof HowtoAxesScales) {
        return "How-to: Axes & Scales";
      }
      ;
      if (v instanceof HowtoTooltips) {
        return "How-to: Tooltips";
      }
      ;
      if (v instanceof HowtoDebugging) {
        return "How-to: Debugging";
      }
      ;
      if (v instanceof HowtoPerformance) {
        return "How-to: Performance";
      }
      ;
      if (v instanceof HowtoTreeExplorer) {
        return "How-to: Tree Explorer";
      }
      ;
      if (v instanceof Understanding) {
        return "Understanding";
      }
      ;
      if (v instanceof UnderstandingGrammar) {
        return "Understanding: Grammar";
      }
      ;
      if (v instanceof UnderstandingAttributes) {
        return "Understanding: Attributes";
      }
      ;
      if (v instanceof UnderstandingSelections) {
        return "Understanding: Selections";
      }
      ;
      if (v instanceof UnderstandingTreeAPI) {
        return "Understanding: TreeAPI";
      }
      ;
      if (v instanceof UnderstandingScenes) {
        return "Understanding: Scenes";
      }
      ;
      if (v instanceof Reference) {
        return "API Reference";
      }
      ;
      if (v instanceof ReferenceModule) {
        return "Module: " + v.value0;
      }
      ;
      if (v instanceof TourIndex) {
        return "Tour";
      }
      ;
      if (v instanceof TourFoundations) {
        return "Tour: Foundations";
      }
      ;
      if (v instanceof TourProfessional) {
        return "Tour: Typical Charts";
      }
      ;
      if (v instanceof TourFlow) {
        return "Tour: Data Flow";
      }
      ;
      if (v instanceof TourHierarchies) {
        return "Tour: Hierarchies";
      }
      ;
      if (v instanceof TourMotion) {
        return "Tour: Motion & Transitions";
      }
      ;
      if (v instanceof TourWealthHealth) {
        return "Tour: Wealth & Health";
      }
      ;
      if (v instanceof TourInterpreters) {
        return "Tour: Alternative Interpreters";
      }
      ;
      if (v instanceof TourFPFTW) {
        return "Tour: FP For The Win";
      }
      ;
      if (v instanceof TourGraphAlgorithms) {
        return "Tour: Graph Algorithms";
      }
      ;
      if (v instanceof TourLesMisGUP) {
        return "Tour: General Update Pattern";
      }
      ;
      if (v instanceof TourShowcase) {
        return "Tour: Showcase";
      }
      ;
      if (v instanceof Showcase) {
        return "Showcase";
      }
      ;
      if (v instanceof Gallery) {
        return "Examples Gallery";
      }
      ;
      if (v instanceof Example) {
        return "Example: " + v.value0;
      }
      ;
      if (v instanceof TreeAPI) {
        return "Tree API Examples";
      }
      ;
      if (v instanceof AnimatedTreeCluster) {
        return "Animated Tree \u2194 Cluster";
      }
      ;
      if (v instanceof GeneralUpdatePattern) {
        return "General Update Pattern (Letters)";
      }
      ;
      if (v instanceof LesMisGUPTree) {
        return "Les Mis\xE9rables GUP (Tree API)";
      }
      ;
      if (v instanceof LesMisGUP) {
        return "Les Mis\xE9rables GUP (PSD3v2)";
      }
      ;
      if (v instanceof LesMisGUPSimple) {
        return "Les Mis\xE9rables GUP (Simple)";
      }
      ;
      if (v instanceof LesMisGUPClean) {
        return "Les Mis\xE9rables GUP (Clean)";
      }
      ;
      if (v instanceof LesMisQueryDemo) {
        return "Query Language Demo";
      }
      ;
      if (v instanceof ModuleGraph) {
        return "Module Graph";
      }
      ;
      if (v instanceof MermaidTreeDemo) {
        return "Mermaid Tree Visualizer";
      }
      ;
      if (v instanceof SceneJoinDemo) {
        return "SceneNestedJoin Demo";
      }
      ;
      if (v instanceof CodeExplorer) {
        return "Code Explorer";
      }
      ;
      if (v instanceof CodeExplorerV2) {
        return "Code Explorer V2";
      }
      ;
      if (v instanceof Acknowledgements) {
        return "Acknowledgements";
      }
      ;
      if (v instanceof NotFound) {
        return "Not Found";
      }
      ;
      throw new Error("Failed pattern match at PSD3.Website.Types (line 145, column 1 - line 198, column 30): " + [v.constructor.name]);
    }
  };
  var eqRoute = {
    eq: function(x47) {
      return function(y48) {
        if (x47 instanceof Home && y48 instanceof Home) {
          return true;
        }
        ;
        if (x47 instanceof GettingStarted && y48 instanceof GettingStarted) {
          return true;
        }
        ;
        if (x47 instanceof Wizard && y48 instanceof Wizard) {
          return true;
        }
        ;
        if (x47 instanceof HowtoIndex && y48 instanceof HowtoIndex) {
          return true;
        }
        ;
        if (x47 instanceof HowtoTransitions && y48 instanceof HowtoTransitions) {
          return true;
        }
        ;
        if (x47 instanceof HowtoForceGraphs && y48 instanceof HowtoForceGraphs) {
          return true;
        }
        ;
        if (x47 instanceof HowtoHierarchical && y48 instanceof HowtoHierarchical) {
          return true;
        }
        ;
        if (x47 instanceof HowtoEvents && y48 instanceof HowtoEvents) {
          return true;
        }
        ;
        if (x47 instanceof HowtoTreeAPI && y48 instanceof HowtoTreeAPI) {
          return true;
        }
        ;
        if (x47 instanceof HowtoLoadingData && y48 instanceof HowtoLoadingData) {
          return true;
        }
        ;
        if (x47 instanceof HowtoAxesScales && y48 instanceof HowtoAxesScales) {
          return true;
        }
        ;
        if (x47 instanceof HowtoTooltips && y48 instanceof HowtoTooltips) {
          return true;
        }
        ;
        if (x47 instanceof HowtoDebugging && y48 instanceof HowtoDebugging) {
          return true;
        }
        ;
        if (x47 instanceof HowtoPerformance && y48 instanceof HowtoPerformance) {
          return true;
        }
        ;
        if (x47 instanceof HowtoTreeExplorer && y48 instanceof HowtoTreeExplorer) {
          return true;
        }
        ;
        if (x47 instanceof Understanding && y48 instanceof Understanding) {
          return true;
        }
        ;
        if (x47 instanceof UnderstandingGrammar && y48 instanceof UnderstandingGrammar) {
          return true;
        }
        ;
        if (x47 instanceof UnderstandingAttributes && y48 instanceof UnderstandingAttributes) {
          return true;
        }
        ;
        if (x47 instanceof UnderstandingSelections && y48 instanceof UnderstandingSelections) {
          return true;
        }
        ;
        if (x47 instanceof UnderstandingTreeAPI && y48 instanceof UnderstandingTreeAPI) {
          return true;
        }
        ;
        if (x47 instanceof UnderstandingScenes && y48 instanceof UnderstandingScenes) {
          return true;
        }
        ;
        if (x47 instanceof Reference && y48 instanceof Reference) {
          return true;
        }
        ;
        if (x47 instanceof ReferenceModule && y48 instanceof ReferenceModule) {
          return x47.value0 === y48.value0;
        }
        ;
        if (x47 instanceof TourIndex && y48 instanceof TourIndex) {
          return true;
        }
        ;
        if (x47 instanceof TourFoundations && y48 instanceof TourFoundations) {
          return true;
        }
        ;
        if (x47 instanceof TourProfessional && y48 instanceof TourProfessional) {
          return true;
        }
        ;
        if (x47 instanceof TourFlow && y48 instanceof TourFlow) {
          return true;
        }
        ;
        if (x47 instanceof TourHierarchies && y48 instanceof TourHierarchies) {
          return true;
        }
        ;
        if (x47 instanceof TourMotion && y48 instanceof TourMotion) {
          return true;
        }
        ;
        if (x47 instanceof TourWealthHealth && y48 instanceof TourWealthHealth) {
          return true;
        }
        ;
        if (x47 instanceof TourInterpreters && y48 instanceof TourInterpreters) {
          return true;
        }
        ;
        if (x47 instanceof TourFPFTW && y48 instanceof TourFPFTW) {
          return true;
        }
        ;
        if (x47 instanceof TourGraphAlgorithms && y48 instanceof TourGraphAlgorithms) {
          return true;
        }
        ;
        if (x47 instanceof TourLesMisGUP && y48 instanceof TourLesMisGUP) {
          return true;
        }
        ;
        if (x47 instanceof TourShowcase && y48 instanceof TourShowcase) {
          return true;
        }
        ;
        if (x47 instanceof Showcase && y48 instanceof Showcase) {
          return true;
        }
        ;
        if (x47 instanceof Gallery && y48 instanceof Gallery) {
          return true;
        }
        ;
        if (x47 instanceof Example && y48 instanceof Example) {
          return x47.value0 === y48.value0;
        }
        ;
        if (x47 instanceof TreeAPI && y48 instanceof TreeAPI) {
          return true;
        }
        ;
        if (x47 instanceof AnimatedTreeCluster && y48 instanceof AnimatedTreeCluster) {
          return true;
        }
        ;
        if (x47 instanceof GeneralUpdatePattern && y48 instanceof GeneralUpdatePattern) {
          return true;
        }
        ;
        if (x47 instanceof LesMisGUPTree && y48 instanceof LesMisGUPTree) {
          return true;
        }
        ;
        if (x47 instanceof LesMisGUP && y48 instanceof LesMisGUP) {
          return true;
        }
        ;
        if (x47 instanceof LesMisGUPSimple && y48 instanceof LesMisGUPSimple) {
          return true;
        }
        ;
        if (x47 instanceof LesMisGUPClean && y48 instanceof LesMisGUPClean) {
          return true;
        }
        ;
        if (x47 instanceof LesMisQueryDemo && y48 instanceof LesMisQueryDemo) {
          return true;
        }
        ;
        if (x47 instanceof ModuleGraph && y48 instanceof ModuleGraph) {
          return true;
        }
        ;
        if (x47 instanceof MermaidTreeDemo && y48 instanceof MermaidTreeDemo) {
          return true;
        }
        ;
        if (x47 instanceof SceneJoinDemo && y48 instanceof SceneJoinDemo) {
          return true;
        }
        ;
        if (x47 instanceof CodeExplorer && y48 instanceof CodeExplorer) {
          return true;
        }
        ;
        if (x47 instanceof CodeExplorerV2 && y48 instanceof CodeExplorerV2) {
          return true;
        }
        ;
        if (x47 instanceof Acknowledgements && y48 instanceof Acknowledgements) {
          return true;
        }
        ;
        if (x47 instanceof NotFound && y48 instanceof NotFound) {
          return true;
        }
        ;
        return false;
      };
    }
  };

  // output/Data.Semiring.Free/index.js
  var append111 = /* @__PURE__ */ append(semigroupList);
  var bind29 = /* @__PURE__ */ bind(bindList);
  var pure19 = /* @__PURE__ */ pure(applicativeList);
  var semiringFree = /* @__PURE__ */ (function() {
    return {
      add: function(v) {
        return function(v1) {
          return append111(v)(v1);
        };
      },
      zero: Nil.value,
      mul: function(v) {
        return function(v1) {
          return bind29(v)(function(xs) {
            return bind29(v1)(function(ys) {
              return pure19(append111(xs)(ys));
            });
          });
        };
      },
      one: singleton5(Nil.value)
    };
  })();
  var free = function(a2) {
    return singleton5(singleton5(a2));
  };

  // output/Data.Validation.Semiring/index.js
  var V = function(x47) {
    return x47;
  };
  var validation = function(v) {
    return function(v1) {
      return function(v2) {
        if (v2 instanceof Left) {
          return v(v2.value0);
        }
        ;
        if (v2 instanceof Right) {
          return v1(v2.value0);
        }
        ;
        throw new Error("Failed pattern match at Data.Validation.Semiring (line 49, column 1 - line 49, column 84): " + [v.constructor.name, v1.constructor.name, v2.constructor.name]);
      };
    };
  };
  var invalid2 = function($113) {
    return V(Left.create($113));
  };
  var functorV = functorEither;
  var applyV = function(dictSemiring) {
    var mul3 = mul(dictSemiring);
    return {
      apply: function(v) {
        return function(v1) {
          if (v instanceof Left && v1 instanceof Left) {
            return new Left(mul3(v.value0)(v1.value0));
          }
          ;
          if (v instanceof Left) {
            return new Left(v.value0);
          }
          ;
          if (v1 instanceof Left) {
            return new Left(v1.value0);
          }
          ;
          if (v instanceof Right && v1 instanceof Right) {
            return new Right(v.value0(v1.value0));
          }
          ;
          throw new Error("Failed pattern match at Data.Validation.Semiring (line 90, column 1 - line 94, column 54): " + [v.constructor.name, v1.constructor.name]);
        };
      },
      Functor0: function() {
        return functorV;
      }
    };
  };
  var applicativeV = function(dictSemiring) {
    var applyV1 = applyV(dictSemiring);
    return {
      pure: function($121) {
        return V(Right.create($121));
      },
      Apply0: function() {
        return applyV1;
      }
    };
  };
  var altV = function(dictSemiring) {
    var add6 = add(dictSemiring);
    return {
      alt: function(v) {
        return function(v1) {
          if (v instanceof Left && v1 instanceof Left) {
            return new Left(add6(v.value0)(v1.value0));
          }
          ;
          if (v instanceof Left) {
            return v1;
          }
          ;
          if (v instanceof Right) {
            return new Right(v.value0);
          }
          ;
          throw new Error("Failed pattern match at Data.Validation.Semiring (line 105, column 1 - line 108, column 36): " + [v.constructor.name, v1.constructor.name]);
        };
      },
      Functor0: function() {
        return functorV;
      }
    };
  };

  // output/Routing.Match.Error/index.js
  var UnexpectedPath = /* @__PURE__ */ (function() {
    function UnexpectedPath2(value0) {
      this.value0 = value0;
    }
    ;
    UnexpectedPath2.create = function(value0) {
      return new UnexpectedPath2(value0);
    };
    return UnexpectedPath2;
  })();
  var ExpectedBoolean = /* @__PURE__ */ (function() {
    function ExpectedBoolean2() {
    }
    ;
    ExpectedBoolean2.value = new ExpectedBoolean2();
    return ExpectedBoolean2;
  })();
  var ExpectedEnd = /* @__PURE__ */ (function() {
    function ExpectedEnd2() {
    }
    ;
    ExpectedEnd2.value = new ExpectedEnd2();
    return ExpectedEnd2;
  })();
  var ExpectedNumber = /* @__PURE__ */ (function() {
    function ExpectedNumber2() {
    }
    ;
    ExpectedNumber2.value = new ExpectedNumber2();
    return ExpectedNumber2;
  })();
  var ExpectedInt = /* @__PURE__ */ (function() {
    function ExpectedInt2() {
    }
    ;
    ExpectedInt2.value = new ExpectedInt2();
    return ExpectedInt2;
  })();
  var ExpectedString = /* @__PURE__ */ (function() {
    function ExpectedString2() {
    }
    ;
    ExpectedString2.value = new ExpectedString2();
    return ExpectedString2;
  })();
  var ExpectedQuery = /* @__PURE__ */ (function() {
    function ExpectedQuery2() {
    }
    ;
    ExpectedQuery2.value = new ExpectedQuery2();
    return ExpectedQuery2;
  })();
  var ExpectedPathPart = /* @__PURE__ */ (function() {
    function ExpectedPathPart2() {
    }
    ;
    ExpectedPathPart2.value = new ExpectedPathPart2();
    return ExpectedPathPart2;
  })();
  var KeyNotFound = /* @__PURE__ */ (function() {
    function KeyNotFound2(value0) {
      this.value0 = value0;
    }
    ;
    KeyNotFound2.create = function(value0) {
      return new KeyNotFound2(value0);
    };
    return KeyNotFound2;
  })();
  var Fail = /* @__PURE__ */ (function() {
    function Fail2(value0) {
      this.value0 = value0;
    }
    ;
    Fail2.create = function(value0) {
      return new Fail2(value0);
    };
    return Fail2;
  })();
  var showMatchError = function(err) {
    if (err instanceof UnexpectedPath) {
      return "expected path part: " + err.value0;
    }
    ;
    if (err instanceof KeyNotFound) {
      return "key: " + (err.value0 + " has not found in query part");
    }
    ;
    if (err instanceof ExpectedQuery) {
      return "expected query - found path";
    }
    ;
    if (err instanceof ExpectedNumber) {
      return "expected number";
    }
    ;
    if (err instanceof ExpectedInt) {
      return "expected int";
    }
    ;
    if (err instanceof ExpectedBoolean) {
      return "expected boolean";
    }
    ;
    if (err instanceof ExpectedEnd) {
      return "expected end";
    }
    ;
    if (err instanceof ExpectedString) {
      return "expected string var";
    }
    ;
    if (err instanceof ExpectedPathPart) {
      return "expected path part, found query";
    }
    ;
    if (err instanceof Fail) {
      return "match error: " + err.value0;
    }
    ;
    throw new Error("Failed pattern match at Routing.Match.Error (line 19, column 3 - line 29, column 39): " + [err.constructor.name]);
  };

  // output/Routing.Types/index.js
  var Path4 = /* @__PURE__ */ (function() {
    function Path5(value0) {
      this.value0 = value0;
    }
    ;
    Path5.create = function(value0) {
      return new Path5(value0);
    };
    return Path5;
  })();
  var Query2 = /* @__PURE__ */ (function() {
    function Query3(value0) {
      this.value0 = value0;
    }
    ;
    Query3.create = function(value0) {
      return new Query3(value0);
    };
    return Query3;
  })();

  // output/Routing.Match/index.js
  var pure20 = /* @__PURE__ */ pure(/* @__PURE__ */ applicativeV(semiringFree));
  var foldl12 = /* @__PURE__ */ foldl(foldableList);
  var bind30 = /* @__PURE__ */ bind(bindList);
  var map47 = /* @__PURE__ */ map(functorList);
  var unwrap7 = /* @__PURE__ */ unwrap();
  var pure110 = /* @__PURE__ */ pure(applicativeList);
  var mul2 = /* @__PURE__ */ mul(semiringFree);
  var identity16 = /* @__PURE__ */ identity(categoryFn);
  var one3 = /* @__PURE__ */ one(semiringFree);
  var alt7 = /* @__PURE__ */ alt(/* @__PURE__ */ altV(semiringFree));
  var str = function(route) {
    if (route instanceof Cons && route.value0 instanceof Path4) {
      return pure20(new Tuple(route.value1, route.value0.value0));
    }
    ;
    return invalid2(free(ExpectedString.value));
  };
  var runMatch = function(v) {
    return function(route) {
      var foldErrors = function(errs) {
        return new Left(foldl12(function(b10) {
          return function(a2) {
            return a2 + ("\n" + b10);
          };
        })("")(bind30(map47(reverse2)(unwrap7(errs)))(function(es) {
          return pure110(foldl12(function(b10) {
            return function(a2) {
              return a2 + (";" + b10);
            };
          })("")(map47(showMatchError)(es)));
        })));
      };
      return validation(foldErrors)(function($109) {
        return Right.create(snd($109));
      })(v(route));
    };
  };
  var matchFunctor = {
    map: function(fn) {
      return function(v) {
        return function(r) {
          return validation(invalid2)(function(v1) {
            return pure20(new Tuple(v1.value0, fn(v1.value1)));
          })(v(r));
        };
      };
    }
  };
  var matchApply = {
    apply: function(v) {
      return function(v1) {
        var processFnRes = function(v2) {
          return validation(invalid2)(function(v3) {
            return pure20(new Tuple(v3.value0, v2.value1(v3.value1)));
          })(v1(v2.value0));
        };
        var processFnErr = function(r) {
          return function(err) {
            return invalid2(mul2(err)(validation(identity16)($$const(one3))(v1(r))));
          };
        };
        return function(r) {
          return validation(processFnErr(r))(processFnRes)(v(r));
        };
      };
    },
    Functor0: function() {
      return matchFunctor;
    }
  };
  var matchApplicative = {
    pure: function(a2) {
      return function(r) {
        return pure20(new Tuple(r, a2));
      };
    },
    Apply0: function() {
      return matchApply;
    }
  };
  var matchAlt = {
    alt: function(v) {
      return function(v1) {
        return function(r) {
          return alt7(v(r))(v1(r));
        };
      };
    },
    Functor0: function() {
      return matchFunctor;
    }
  };
  var lit = function(input3) {
    return function(route) {
      if (route instanceof Cons && (route.value0 instanceof Path4 && route.value0.value0 === input3)) {
        return pure20(new Tuple(route.value1, unit));
      }
      ;
      if (route instanceof Cons && route.value0 instanceof Path4) {
        return invalid2(free(new UnexpectedPath(input3)));
      }
      ;
      return invalid2(free(ExpectedPathPart.value));
    };
  };
  var root2 = /* @__PURE__ */ lit("");
  var end = function(route) {
    if (route instanceof Nil) {
      return pure20(new Tuple(Nil.value, unit));
    }
    ;
    return invalid2(free(ExpectedEnd.value));
  };

  // output/PSD3.RoutingDSL/index.js
  var applyFirst2 = /* @__PURE__ */ applyFirst(matchApply);
  var voidRight2 = /* @__PURE__ */ voidRight(matchFunctor);
  var map48 = /* @__PURE__ */ map(matchFunctor);
  var applySecond2 = /* @__PURE__ */ applySecond(matchApply);
  var alt8 = /* @__PURE__ */ alt(matchAlt);
  var wizard = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(Wizard.value)(lit("wizard")))(end);
  })();
  var understandingTreeAPI = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(UnderstandingTreeAPI.value)(lit("understanding")))(lit("tree-api")))(end);
  })();
  var understandingSelections = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(UnderstandingSelections.value)(lit("understanding")))(lit("selections")))(end);
  })();
  var understandingScenes = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(UnderstandingScenes.value)(lit("understanding")))(lit("scenes")))(end);
  })();
  var understandingGrammar = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(UnderstandingGrammar.value)(lit("understanding")))(lit("grammar")))(end);
  })();
  var understandingAttributes = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(UnderstandingAttributes.value)(lit("understanding")))(lit("attributes")))(end);
  })();
  var understanding = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(Understanding.value)(lit("understanding")))(end);
  })();
  var treeAPI = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(TreeAPI.value)(lit("tree-api")))(end);
  })();
  var tourWealthHealth = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(TourWealthHealth.value)(lit("tour")))(lit("wealth-health")))(end);
  })();
  var tourShowcase = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(TourShowcase.value)(lit("tour")))(lit("showcase")))(end);
  })();
  var tourProfessional = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(TourProfessional.value)(lit("tour")))(lit("professional")))(end);
  })();
  var tourMotion = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(TourMotion.value)(lit("tour")))(lit("motion")))(end);
  })();
  var tourLesMisGUP = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(TourLesMisGUP.value)(lit("tour")))(lit("lesmis-gup")))(end);
  })();
  var tourInterpreters = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(TourInterpreters.value)(lit("tour")))(lit("interpreters")))(end);
  })();
  var tourIndex = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(TourIndex.value)(lit("tour")))(end);
  })();
  var tourHierarchies = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(TourHierarchies.value)(lit("tour")))(lit("hierarchies")))(end);
  })();
  var tourGraphAlgorithms = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(TourGraphAlgorithms.value)(lit("tour")))(lit("graph-algorithms")))(end);
  })();
  var tourFoundations = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(TourFoundations.value)(lit("tour")))(lit("foundations")))(end);
  })();
  var tourFlow = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(TourFlow.value)(lit("tour")))(lit("flow")))(end);
  })();
  var tourFPFTW = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(TourFPFTW.value)(lit("tour")))(lit("fpftw")))(end);
  })();
  var showcase = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(Showcase.value)(lit("showcase")))(end);
  })();
  var sceneJoinDemo = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(SceneJoinDemo.value)(lit("scene-join-demo")))(end);
  })();
  var routeToPath = function(v) {
    if (v instanceof Home) {
      return "/home";
    }
    ;
    if (v instanceof GettingStarted) {
      return "/getting-started";
    }
    ;
    if (v instanceof Wizard) {
      return "/wizard";
    }
    ;
    if (v instanceof HowtoIndex) {
      return "/howto";
    }
    ;
    if (v instanceof HowtoTransitions) {
      return "/howto/transitions";
    }
    ;
    if (v instanceof HowtoForceGraphs) {
      return "/howto/force-graphs";
    }
    ;
    if (v instanceof HowtoHierarchical) {
      return "/howto/hierarchical";
    }
    ;
    if (v instanceof HowtoEvents) {
      return "/howto/events";
    }
    ;
    if (v instanceof HowtoTreeAPI) {
      return "/howto/tree-api";
    }
    ;
    if (v instanceof HowtoLoadingData) {
      return "/howto/loading-data";
    }
    ;
    if (v instanceof HowtoAxesScales) {
      return "/howto/axes-scales";
    }
    ;
    if (v instanceof HowtoTooltips) {
      return "/howto/tooltips";
    }
    ;
    if (v instanceof HowtoDebugging) {
      return "/howto/debugging";
    }
    ;
    if (v instanceof HowtoPerformance) {
      return "/howto/performance";
    }
    ;
    if (v instanceof HowtoTreeExplorer) {
      return "/howto/tree-explorer";
    }
    ;
    if (v instanceof Understanding) {
      return "/understanding";
    }
    ;
    if (v instanceof UnderstandingGrammar) {
      return "/understanding/grammar";
    }
    ;
    if (v instanceof UnderstandingAttributes) {
      return "/understanding/attributes";
    }
    ;
    if (v instanceof UnderstandingSelections) {
      return "/understanding/selections";
    }
    ;
    if (v instanceof UnderstandingTreeAPI) {
      return "/understanding/tree-api";
    }
    ;
    if (v instanceof UnderstandingScenes) {
      return "/understanding/scenes";
    }
    ;
    if (v instanceof Reference) {
      return "/reference";
    }
    ;
    if (v instanceof ReferenceModule) {
      return "/reference/" + v.value0;
    }
    ;
    if (v instanceof TourIndex) {
      return "/tour";
    }
    ;
    if (v instanceof TourFoundations) {
      return "/tour/foundations";
    }
    ;
    if (v instanceof TourProfessional) {
      return "/tour/professional";
    }
    ;
    if (v instanceof TourFlow) {
      return "/tour/flow";
    }
    ;
    if (v instanceof TourHierarchies) {
      return "/tour/hierarchies";
    }
    ;
    if (v instanceof TourMotion) {
      return "/tour/motion";
    }
    ;
    if (v instanceof TourWealthHealth) {
      return "/tour/wealth-health";
    }
    ;
    if (v instanceof TourInterpreters) {
      return "/tour/interpreters";
    }
    ;
    if (v instanceof TourFPFTW) {
      return "/tour/fpftw";
    }
    ;
    if (v instanceof TourGraphAlgorithms) {
      return "/tour/graph-algorithms";
    }
    ;
    if (v instanceof TourLesMisGUP) {
      return "/tour/lesmis-gup";
    }
    ;
    if (v instanceof TourShowcase) {
      return "/tour/showcase";
    }
    ;
    if (v instanceof Showcase) {
      return "/showcase";
    }
    ;
    if (v instanceof Gallery) {
      return "/gallery";
    }
    ;
    if (v instanceof Example) {
      return "/example/" + v.value0;
    }
    ;
    if (v instanceof TreeAPI) {
      return "/tree-api";
    }
    ;
    if (v instanceof AnimatedTreeCluster) {
      return "/animated-tree-cluster";
    }
    ;
    if (v instanceof GeneralUpdatePattern) {
      return "/general-update-pattern";
    }
    ;
    if (v instanceof LesMisGUPTree) {
      return "/lesmis-gup-tree";
    }
    ;
    if (v instanceof LesMisGUP) {
      return "/lesmis-gup";
    }
    ;
    if (v instanceof LesMisGUPSimple) {
      return "/lesmis-gup-simple";
    }
    ;
    if (v instanceof LesMisGUPClean) {
      return "/lesmis-gup-clean";
    }
    ;
    if (v instanceof LesMisQueryDemo) {
      return "/lesmis-query-demo";
    }
    ;
    if (v instanceof ModuleGraph) {
      return "/module-graph";
    }
    ;
    if (v instanceof MermaidTreeDemo) {
      return "/mermaid-tree-demo";
    }
    ;
    if (v instanceof SceneJoinDemo) {
      return "/scene-join-demo";
    }
    ;
    if (v instanceof CodeExplorer) {
      return "/code-explorer";
    }
    ;
    if (v instanceof CodeExplorerV2) {
      return "/code-explorer-v2";
    }
    ;
    if (v instanceof Acknowledgements) {
      return "/acknowledgements";
    }
    ;
    if (v instanceof NotFound) {
      return "/not-found";
    }
    ;
    throw new Error("Failed pattern match at PSD3.RoutingDSL (line 294, column 1 - line 294, column 31): " + [v.constructor.name]);
  };
  var rootRedirect = /* @__PURE__ */ (function() {
    return voidRight2(Home.value)(end);
  })();
  var referenceModule = /* @__PURE__ */ (function() {
    return applyFirst2(map48(ReferenceModule.create)(applySecond2(lit("reference"))(str)))(end);
  })();
  var reference = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(Reference.value)(lit("reference")))(end);
  })();
  var notFound = /* @__PURE__ */ (function() {
    return pure(matchApplicative)(NotFound.value);
  })();
  var moduleGraph = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(ModuleGraph.value)(lit("module-graph")))(end);
  })();
  var mermaidTreeDemo = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(MermaidTreeDemo.value)(lit("mermaid-tree-demo")))(end);
  })();
  var lesMisQueryDemo = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(LesMisQueryDemo.value)(lit("lesmis-query-demo")))(end);
  })();
  var lesMisGUPTree = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(LesMisGUPTree.value)(lit("lesmis-gup-tree")))(end);
  })();
  var lesMisGUPSimple = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(LesMisGUPSimple.value)(lit("lesmis-gup-simple")))(end);
  })();
  var lesMisGUPClean = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(LesMisGUPClean.value)(lit("lesmis-gup-clean")))(end);
  })();
  var lesMisGUP = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(LesMisGUP.value)(lit("lesmis-gup")))(end);
  })();
  var howtoTreeExplorer = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(HowtoTreeExplorer.value)(lit("howto")))(lit("tree-explorer")))(end);
  })();
  var howtoTreeAPI = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(HowtoTreeAPI.value)(lit("howto")))(lit("tree-api")))(end);
  })();
  var howtoTransitions = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(HowtoTransitions.value)(lit("howto")))(lit("transitions")))(end);
  })();
  var howtoTooltips = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(HowtoTooltips.value)(lit("howto")))(lit("tooltips")))(end);
  })();
  var howtoPerformance = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(HowtoPerformance.value)(lit("howto")))(lit("performance")))(end);
  })();
  var howtoLoadingData = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(HowtoLoadingData.value)(lit("howto")))(lit("loading-data")))(end);
  })();
  var howtoIndex = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(HowtoIndex.value)(lit("howto")))(end);
  })();
  var howtoHierarchical = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(HowtoHierarchical.value)(lit("howto")))(lit("hierarchical")))(end);
  })();
  var howtoForceGraphs = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(HowtoForceGraphs.value)(lit("howto")))(lit("force-graphs")))(end);
  })();
  var howtoEvents = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(HowtoEvents.value)(lit("howto")))(lit("events")))(end);
  })();
  var howtoDebugging = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(HowtoDebugging.value)(lit("howto")))(lit("debugging")))(end);
  })();
  var howtoAxesScales = /* @__PURE__ */ (function() {
    return applyFirst2(applyFirst2(voidRight2(HowtoAxesScales.value)(lit("howto")))(lit("axes-scales")))(end);
  })();
  var home = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(Home.value)(lit("home")))(end);
  })();
  var gettingStarted = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(GettingStarted.value)(lit("getting-started")))(end);
  })();
  var generalUpdatePattern = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(GeneralUpdatePattern.value)(lit("general-update-pattern")))(end);
  })();
  var gallery = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(Gallery.value)(lit("gallery")))(end);
  })();
  var examplePage = /* @__PURE__ */ (function() {
    return applyFirst2(map48(Example.create)(applySecond2(lit("example"))(str)))(end);
  })();
  var codeExplorerV2 = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(CodeExplorerV2.value)(lit("code-explorer-v2")))(end);
  })();
  var codeExplorer = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(CodeExplorer.value)(lit("code-explorer")))(end);
  })();
  var animatedTreeCluster = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(AnimatedTreeCluster.value)(lit("animated-tree-cluster")))(end);
  })();
  var acknowledgements = /* @__PURE__ */ (function() {
    return applyFirst2(voidRight2(Acknowledgements.value)(lit("acknowledgements")))(end);
  })();
  var routes = /* @__PURE__ */ alt8(home)(/* @__PURE__ */ alt8(gettingStarted)(/* @__PURE__ */ alt8(wizard)(/* @__PURE__ */ alt8(howtoIndex)(/* @__PURE__ */ alt8(howtoTransitions)(/* @__PURE__ */ alt8(howtoForceGraphs)(/* @__PURE__ */ alt8(howtoHierarchical)(/* @__PURE__ */ alt8(howtoEvents)(/* @__PURE__ */ alt8(howtoTreeAPI)(/* @__PURE__ */ alt8(howtoLoadingData)(/* @__PURE__ */ alt8(howtoAxesScales)(/* @__PURE__ */ alt8(howtoTooltips)(/* @__PURE__ */ alt8(howtoDebugging)(/* @__PURE__ */ alt8(howtoPerformance)(/* @__PURE__ */ alt8(howtoTreeExplorer)(/* @__PURE__ */ alt8(understandingGrammar)(/* @__PURE__ */ alt8(understandingAttributes)(/* @__PURE__ */ alt8(understandingSelections)(/* @__PURE__ */ alt8(understandingTreeAPI)(/* @__PURE__ */ alt8(understandingScenes)(/* @__PURE__ */ alt8(understanding)(/* @__PURE__ */ alt8(referenceModule)(/* @__PURE__ */ alt8(reference)(/* @__PURE__ */ alt8(tourFoundations)(/* @__PURE__ */ alt8(tourProfessional)(/* @__PURE__ */ alt8(tourFlow)(/* @__PURE__ */ alt8(tourHierarchies)(/* @__PURE__ */ alt8(tourMotion)(/* @__PURE__ */ alt8(tourWealthHealth)(/* @__PURE__ */ alt8(tourInterpreters)(/* @__PURE__ */ alt8(tourFPFTW)(/* @__PURE__ */ alt8(tourGraphAlgorithms)(/* @__PURE__ */ alt8(tourLesMisGUP)(/* @__PURE__ */ alt8(tourShowcase)(/* @__PURE__ */ alt8(tourIndex)(/* @__PURE__ */ alt8(showcase)(/* @__PURE__ */ alt8(gallery)(/* @__PURE__ */ alt8(examplePage)(/* @__PURE__ */ alt8(treeAPI)(/* @__PURE__ */ alt8(animatedTreeCluster)(/* @__PURE__ */ alt8(generalUpdatePattern)(/* @__PURE__ */ alt8(lesMisGUPTree)(/* @__PURE__ */ alt8(lesMisGUP)(/* @__PURE__ */ alt8(lesMisGUPSimple)(/* @__PURE__ */ alt8(lesMisGUPClean)(/* @__PURE__ */ alt8(lesMisQueryDemo)(/* @__PURE__ */ alt8(moduleGraph)(/* @__PURE__ */ alt8(mermaidTreeDemo)(/* @__PURE__ */ alt8(sceneJoinDemo)(/* @__PURE__ */ alt8(codeExplorer)(/* @__PURE__ */ alt8(codeExplorerV2)(/* @__PURE__ */ alt8(acknowledgements)(/* @__PURE__ */ alt8(rootRedirect)(notFound)))))))))))))))))))))))))))))))))))))))))))))))))))));
  var routing = /* @__PURE__ */ applySecond2(root2)(routes);

  // output/PSD3.Shared.SiteNav/index.js
  var show36 = /* @__PURE__ */ show(showRoute);
  var NoQuadrant = /* @__PURE__ */ (function() {
    function NoQuadrant2() {
    }
    ;
    NoQuadrant2.value = new NoQuadrant2();
    return NoQuadrant2;
  })();
  var QuadGettingStarted = /* @__PURE__ */ (function() {
    function QuadGettingStarted2() {
    }
    ;
    QuadGettingStarted2.value = new QuadGettingStarted2();
    return QuadGettingStarted2;
  })();
  var QuadHowTo = /* @__PURE__ */ (function() {
    function QuadHowTo2() {
    }
    ;
    QuadHowTo2.value = new QuadHowTo2();
    return QuadHowTo2;
  })();
  var QuadReference = /* @__PURE__ */ (function() {
    function QuadReference2() {
    }
    ;
    QuadReference2.value = new QuadReference2();
    return QuadReference2;
  })();
  var QuadUnderstanding = /* @__PURE__ */ (function() {
    function QuadUnderstanding2() {
    }
    ;
    QuadUnderstanding2.value = new QuadUnderstanding2();
    return QuadUnderstanding2;
  })();
  var Large = /* @__PURE__ */ (function() {
    function Large2() {
    }
    ;
    Large2.value = new Large2();
    return Large2;
  })();
  var Normal = /* @__PURE__ */ (function() {
    function Normal2() {
    }
    ;
    Normal2.value = new Normal2();
    return Normal2;
  })();
  var quadrantTitle = function(v) {
    if (v instanceof NoQuadrant) {
      return "";
    }
    ;
    if (v instanceof QuadGettingStarted) {
      return "Docs: Getting Started";
    }
    ;
    if (v instanceof QuadHowTo) {
      return "Docs: How-To";
    }
    ;
    if (v instanceof QuadReference) {
      return "Docs: Reference";
    }
    ;
    if (v instanceof QuadUnderstanding) {
      return "Docs: Understanding";
    }
    ;
    throw new Error("Failed pattern match at PSD3.Shared.SiteNav (line 189, column 17 - line 194, column 45): " + [v.constructor.name]);
  };
  var quadrantRoute = function(v) {
    if (v instanceof NoQuadrant) {
      return "#";
    }
    ;
    if (v instanceof QuadGettingStarted) {
      return "#" + routeToPath(GettingStarted.value);
    }
    ;
    if (v instanceof QuadHowTo) {
      return "#" + routeToPath(HowtoIndex.value);
    }
    ;
    if (v instanceof QuadReference) {
      return "#" + routeToPath(Reference.value);
    }
    ;
    if (v instanceof QuadUnderstanding) {
      return "#" + routeToPath(Understanding.value);
    }
    ;
    throw new Error("Failed pattern match at PSD3.Shared.SiteNav (line 180, column 17 - line 185, column 56): " + [v.constructor.name]);
  };
  var eqQuadrant = {
    eq: function(x47) {
      return function(y48) {
        if (x47 instanceof NoQuadrant && y48 instanceof NoQuadrant) {
          return true;
        }
        ;
        if (x47 instanceof QuadGettingStarted && y48 instanceof QuadGettingStarted) {
          return true;
        }
        ;
        if (x47 instanceof QuadHowTo && y48 instanceof QuadHowTo) {
          return true;
        }
        ;
        if (x47 instanceof QuadReference && y48 instanceof QuadReference) {
          return true;
        }
        ;
        if (x47 instanceof QuadUnderstanding && y48 instanceof QuadUnderstanding) {
          return true;
        }
        ;
        return false;
      };
    }
  };
  var eq6 = /* @__PURE__ */ eq(eqQuadrant);
  var renderQuadrantBox = function(target7) {
    return function(current) {
      return a([href(quadrantRoute(target7)), classes(["site-nav-quadrant-box", (function() {
        var $14 = eq6(target7)(current);
        if ($14) {
          return "site-nav-quadrant-box--active";
        }
        ;
        return "site-nav-quadrant-box--inactive";
      })()]), attr2("data-tooltip")(quadrantTitle(target7))])([]);
    };
  };
  var render5 = function(config) {
    return header([classes(["site-nav"])])([div2([classes(["site-nav-content"])])([div2([classes(["site-nav-left"])])([a([href("#" + routeToPath(Home.value)), classes(["site-nav-logo-link"])])([img([src2("assets/psd3-logo-color.svg"), alt4("PSD3 Logo"), classes(["site-nav-logo", (function() {
      if (config.logoSize instanceof Large) {
        return "site-nav-logo--large";
      }
      ;
      if (config.logoSize instanceof Normal) {
        return "site-nav-logo--normal";
      }
      ;
      throw new Error("Failed pattern match at PSD3.Shared.SiteNav (line 77, column 42 - line 79, column 62): " + [config.logoSize.constructor.name]);
    })()])])]), (function() {
      if (config.pageTitle instanceof Nothing) {
        return text2("");
      }
      ;
      if (config.pageTitle instanceof Just) {
        return div2([classes(["site-nav-title-container"])])([h1([classes(["site-nav-title"])])([text2(config.pageTitle.value0)])]);
      }
      ;
      throw new Error("Failed pattern match at PSD3.Shared.SiteNav (line 83, column 15 - line 91, column 22): " + [config.pageTitle.constructor.name]);
    })()]), div2([classes(["site-nav-center"])])([div2([classes(["site-nav-quadrant"])])([renderQuadrantBox(QuadGettingStarted.value)(config.quadrant), renderQuadrantBox(QuadHowTo.value)(config.quadrant), renderQuadrantBox(QuadReference.value)(config.quadrant), renderQuadrantBox(QuadUnderstanding.value)(config.quadrant)])]), div2([classes(["site-nav-right"])])([nav([classes(["site-nav-links"])])([a([href("#" + routeToPath(TourIndex.value)), classes(["site-nav-link"])])([text2("Tour")]), a([href("#" + routeToPath(Gallery.value)), classes(["site-nav-link"])])([text2("Examples")]), a([href("#" + routeToPath(Showcase.value)), classes(["site-nav-link"])])([text2("Showcase")])]), (function() {
      if (config.prevNext instanceof Nothing) {
        return text2("");
      }
      ;
      if (config.prevNext instanceof Just) {
        return div2([classes(["site-nav-prevnext"])])([(function() {
          if (config.prevNext.value0.prev instanceof Nothing) {
            return span2([classes(["site-nav-button", "site-nav-button--disabled"])])([text2("\u261C")]);
          }
          ;
          if (config.prevNext.value0.prev instanceof Just) {
            return a([href("#" + routeToPath(config.prevNext.value0.prev.value0)), classes(["site-nav-button"]), title(show36(config.prevNext.value0.prev.value0))])([text2("\u261C")]);
          }
          ;
          throw new Error("Failed pattern match at PSD3.Shared.SiteNav (line 134, column 23 - line 145, column 44): " + [config.prevNext.value0.prev.constructor.name]);
        })(), (function() {
          if (config.prevNext.value0.next instanceof Nothing) {
            return span2([classes(["site-nav-button", "site-nav-button--disabled"])])([text2("\u261E")]);
          }
          ;
          if (config.prevNext.value0.next instanceof Just) {
            return a([href("#" + routeToPath(config.prevNext.value0.next.value0)), classes(["site-nav-button"]), title(show36(config.prevNext.value0.next.value0))])([text2("\u261E")]);
          }
          ;
          throw new Error("Failed pattern match at PSD3.Shared.SiteNav (line 146, column 23 - line 157, column 44): " + [config.prevNext.value0.next.constructor.name]);
        })()]);
      }
      ;
      throw new Error("Failed pattern match at PSD3.Shared.SiteNav (line 129, column 15 - line 158, column 22): " + [config.prevNext.constructor.name]);
    })()])])]);
  };

  // output/PSD3.Shared.Utilities/foreign.js
  function highlightString_(codetext) {
    const highlightedCode = Prism.highlight(codetext, Prism.languages.haskell, "haskell");
    return highlightedCode;
  }

  // output/Html.Parser/foreign.js
  function getAttributes(node) {
    var entries = [];
    for (var i2 = 0; i2 < node.attributes.length; i2++) {
      let { name: name16, value: value18 } = node.attributes.item(i2);
      entries.push([name16, value18]);
    }
    return entries;
  }
  function walk(treeWalker) {
    var nodes = [];
    function handleNode(node) {
      if (["#comment", "#text"].includes(node.nodeName)) {
        var text8 = node.textContent;
        if (text8) {
          nodes.push({
            type: node.nodeName.slice(1),
            text: text8
          });
        }
      } else {
        var children3 = walk(treeWalker);
        treeWalker.currentNode = node;
        nodes.push({
          type: "element",
          name: node.localName,
          attributes: getAttributes(node),
          children: children3
        });
      }
    }
    var currentNode = treeWalker.currentNode;
    var firstChild = treeWalker.firstChild();
    if (firstChild) {
      handleNode(firstChild);
    } else {
      return nodes;
    }
    var nextSibling2 = treeWalker.nextSibling();
    while (nextSibling2) {
      handleNode(nextSibling2);
      treeWalker.currentNode = nextSibling2;
      nextSibling2 = treeWalker.nextSibling();
    }
    return nodes;
  }
  function parseFromString(elementCtor) {
    return (attributeCtor) => (textCtor) => (commentCtor) => (input3) => {
      function mapNode(node) {
        if (node.type == "element") {
          return elementCtor({
            name: node.name,
            attributes: node.attributes.map(([k, v]) => attributeCtor(k)(v)),
            children: node.children.map(mapNode)
          });
        } else {
          var ctor = node.type == "text" ? textCtor : commentCtor;
          return ctor(node.text);
        }
      }
      var doc = new DOMParser().parseFromString(input3, "text/html");
      var headNodes = walk(
        doc.createTreeWalker(doc.documentElement.querySelector("head"))
      );
      var bodyNodes = walk(
        doc.createTreeWalker(doc.documentElement.querySelector("body"))
      );
      return [...headNodes, ...bodyNodes].map((node) => {
        if (node.type == "element") {
          return mapNode(node);
        } else {
          var ctor = node.type == "text" ? textCtor : commentCtor;
          return ctor(node.text);
        }
      });
    };
  }

  // output/Html.Parser/index.js
  var HtmlAttribute = /* @__PURE__ */ (function() {
    function HtmlAttribute2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    HtmlAttribute2.create = function(value0) {
      return function(value1) {
        return new HtmlAttribute2(value0, value1);
      };
    };
    return HtmlAttribute2;
  })();
  var HtmlElement = /* @__PURE__ */ (function() {
    function HtmlElement2(value0) {
      this.value0 = value0;
    }
    ;
    HtmlElement2.create = function(value0) {
      return new HtmlElement2(value0);
    };
    return HtmlElement2;
  })();
  var HtmlText = /* @__PURE__ */ (function() {
    function HtmlText2(value0) {
      this.value0 = value0;
    }
    ;
    HtmlText2.create = function(value0) {
      return new HtmlText2(value0);
    };
    return HtmlText2;
  })();
  var HtmlComment = /* @__PURE__ */ (function() {
    function HtmlComment2(value0) {
      this.value0 = value0;
    }
    ;
    HtmlComment2.create = function(value0) {
      return new HtmlComment2(value0);
    };
    return HtmlComment2;
  })();
  var parse7 = function(input3) {
    return parseFromString(HtmlElement.create)(HtmlAttribute.create)(HtmlText.create)(HtmlComment.create)(input3);
  };

  // output/Html.Renderer.Halogen/index.js
  var mapFlipped8 = /* @__PURE__ */ mapFlipped(functorMaybe);
  var alt9 = /* @__PURE__ */ alt(altMaybe);
  var mapFlipped12 = /* @__PURE__ */ mapFlipped(functorArray);
  var fromFoldable35 = /* @__PURE__ */ fromFoldable(foldableArray);
  var map49 = /* @__PURE__ */ map(functorArray);
  var htmlAttributeToProp = function(v) {
    return attr2(v.value0)(v.value1);
  };
  var nodeToHtml = function(v) {
    return function(v1) {
      if (v1 instanceof HtmlElement) {
        return elementToHtml(v)(v1.value0);
      }
      ;
      if (v1 instanceof HtmlText) {
        return text2(v1.value0);
      }
      ;
      if (v1 instanceof HtmlComment) {
        return text2("");
      }
      ;
      throw new Error("Failed pattern match at Html.Renderer.Halogen (line 38, column 1 - line 38, column 72): " + [v.constructor.name, v1.constructor.name]);
    };
  };
  var elementToHtml = function(mParentNs) {
    return function(ele) {
      var mCurNs = mapFlipped8(find2(function(v) {
        return v.value0 === "xmlns";
      })(ele.attributes))(function(v) {
        return v.value1;
      });
      var mNs = alt9(mCurNs)(mParentNs);
      var ctor = (function() {
        if (mNs instanceof Just) {
          return elementNS(mNs.value0);
        }
        ;
        if (mNs instanceof Nothing) {
          return element2;
        }
        ;
        throw new Error("Failed pattern match at Html.Renderer.Halogen (line 34, column 12 - line 36, column 28): " + [mNs.constructor.name]);
      })();
      var children3 = mapFlipped12(ele.children)(nodeToHtml(mNs));
      return ctor(ele.name)(fromFoldable35(map49(htmlAttributeToProp)(ele.attributes)))(children3);
    };
  };
  var renderToArray = function(raw) {
    return map49(nodeToHtml(Nothing.value))(parse7(raw));
  };
  var render6 = function(props) {
    var $28 = div2(props);
    return function($29) {
      return $28(renderToArray($29));
    };
  };
  var render_ = /* @__PURE__ */ render6([]);

  // output/PSD3.Shared.Utilities/index.js
  var syntaxHighlightedCode = function(codetext) {
    return [pre([class_("language-haskell")])([code_([render_(highlightString_(codetext))])])];
  };

  // output/Component.Example/index.js
  var map50 = /* @__PURE__ */ map(functorMaybe);
  var discard20 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var bind31 = /* @__PURE__ */ bind(bindHalogenM);
  var get10 = /* @__PURE__ */ get(monadStateHalogenM);
  var $$void9 = /* @__PURE__ */ $$void(functorEffect);
  var pure21 = /* @__PURE__ */ pure(applicativeHalogenM);
  var when3 = /* @__PURE__ */ when(applicativeHalogenM);
  var modify_6 = /* @__PURE__ */ modify_2(monadStateHalogenM);
  var Initialize4 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var Receive2 = /* @__PURE__ */ (function() {
    function Receive3(value0) {
      this.value0 = value0;
    }
    ;
    Receive3.create = function(value0) {
      return new Receive3(value0);
    };
    return Receive3;
  })();
  var getPrevExampleId = function(currentId) {
    if (currentId === "three-little-circles") {
      return Nothing.value;
    }
    ;
    if (currentId === "three-circles-transition") {
      return new Just("three-little-circles");
    }
    ;
    if (currentId === "simple-tree") {
      return new Just("three-circles-transition");
    }
    ;
    if (currentId === "nested-elements") {
      return new Just("simple-tree");
    }
    ;
    if (currentId === "three-little-dimensions") {
      return new Just("nested-elements");
    }
    ;
    if (currentId === "bar-chart") {
      return new Just("three-little-dimensions");
    }
    ;
    if (currentId === "scatter-plot") {
      return new Just("bar-chart");
    }
    ;
    if (currentId === "line-chart") {
      return new Just("scatter-plot");
    }
    ;
    if (currentId === "grouped-bar-chart") {
      return new Just("line-chart");
    }
    ;
    if (currentId === "simple-hierarchy") {
      return new Just("grouped-bar-chart");
    }
    ;
    if (currentId === "lesmis-force") {
      return new Just("simple-hierarchy");
    }
    ;
    return Nothing.value;
  };
  var getNextExampleId = function(currentId) {
    if (currentId === "three-little-circles") {
      return new Just("three-circles-transition");
    }
    ;
    if (currentId === "three-circles-transition") {
      return new Just("simple-tree");
    }
    ;
    if (currentId === "simple-tree") {
      return new Just("nested-elements");
    }
    ;
    if (currentId === "nested-elements") {
      return new Just("three-little-dimensions");
    }
    ;
    if (currentId === "three-little-dimensions") {
      return new Just("bar-chart");
    }
    ;
    if (currentId === "bar-chart") {
      return new Just("scatter-plot");
    }
    ;
    if (currentId === "scatter-plot") {
      return new Just("line-chart");
    }
    ;
    if (currentId === "line-chart") {
      return new Just("grouped-bar-chart");
    }
    ;
    if (currentId === "grouped-bar-chart") {
      return new Just("simple-hierarchy");
    }
    ;
    if (currentId === "simple-hierarchy") {
      return new Just("lesmis-force");
    }
    ;
    if (currentId === "lesmis-force") {
      return Nothing.value;
    }
    ;
    return Nothing.value;
  };
  var renderHeader = function(currentId) {
    return function(maybeMeta) {
      return render5({
        logoSize: Large.value,
        quadrant: NoQuadrant.value,
        prevNext: new Just({
          prev: map50(Example.create)(getPrevExampleId(currentId)),
          next: map50(Example.create)(getNextExampleId(currentId))
        }),
        pageTitle: map50(function(m) {
          return m.name;
        })(maybeMeta)
      });
    };
  };
  var getModuleName = function(v) {
    if (v === "three-little-circles") {
      return "ThreeLittleCircles";
    }
    ;
    if (v === "three-circles-transition") {
      return "ThreeLittleCirclesTransition";
    }
    ;
    if (v === "simple-tree") {
      return "SimpleTreeExample";
    }
    ;
    if (v === "nested-elements") {
      return "NestedElementsExample";
    }
    ;
    if (v === "bar-chart") {
      return "BarChartExample";
    }
    ;
    if (v === "scatter-plot") {
      return "ScatterPlotExample";
    }
    ;
    if (v === "line-chart") {
      return "LineChartExample";
    }
    ;
    if (v === "grouped-bar-chart") {
      return "GroupedBarChartExample";
    }
    ;
    if (v === "simple-hierarchy") {
      return "SimpleHierarchyExample";
    }
    ;
    if (v === "three-little-dimensions") {
      return "ThreeLittleDimensionsExample";
    }
    ;
    if (v === "lesmis-force") {
      return "LesMisTreeExample";
    }
    ;
    return "Unknown";
  };
  var getGithubLink = function(exampleId) {
    return "https://github.com/afcondon/purescript-d3-tagless/tree/main/src/website/Viz/TreeAPI/" + (getModuleName(exampleId) + ".purs");
  };
  var getExampleMeta = function(id5) {
    if (id5 === "three-little-circles") {
      return new Just({
        id: id5,
        name: "Three Little Circles",
        description: "Data join basics - bind data to DOM elements",
        category: "Basic Examples"
      });
    }
    ;
    if (id5 === "three-circles-transition") {
      return new Just({
        id: id5,
        name: "Circles Transition",
        description: "Animated transitions with easing and delays",
        category: "Basic Examples"
      });
    }
    ;
    if (id5 === "simple-tree") {
      return new Just({
        id: id5,
        name: "Simple Tree",
        description: "Basic nesting with named selections",
        category: "Basic Examples"
      });
    }
    ;
    if (id5 === "nested-elements") {
      return new Just({
        id: id5,
        name: "Nested Elements",
        description: "Multi-level nesting (Group \u2192 Circle + Text)",
        category: "Basic Examples"
      });
    }
    ;
    if (id5 === "bar-chart") {
      return new Just({
        id: id5,
        name: "Bar Chart",
        description: "Data-driven bars with scaling",
        category: "Chart Examples"
      });
    }
    ;
    if (id5 === "scatter-plot") {
      return new Just({
        id: id5,
        name: "Scatter Plot",
        description: "Points positioned by data coordinates",
        category: "Chart Examples"
      });
    }
    ;
    if (id5 === "line-chart") {
      return new Just({
        id: id5,
        name: "Line Chart",
        description: "Path element generated from data",
        category: "Chart Examples"
      });
    }
    ;
    if (id5 === "grouped-bar-chart") {
      return new Just({
        id: id5,
        name: "Grouped Bar Chart",
        description: "Nested joins with multiple series",
        category: "Chart Examples"
      });
    }
    ;
    if (id5 === "simple-hierarchy") {
      return new Just({
        id: id5,
        name: "Tree Layout",
        description: "Hierarchical node-link diagram (pure PureScript)",
        category: "Hierarchies & Simulations"
      });
    }
    ;
    if (id5 === "three-little-dimensions") {
      return new Just({
        id: id5,
        name: "Three Little Dimensions",
        description: "Nested data joins (2D array \u2192 table)",
        category: "Basic Examples"
      });
    }
    ;
    if (id5 === "lesmis-force") {
      return new Just({
        id: id5,
        name: "Les Mis\xE9rables Network",
        description: "Force-directed graph with simulation",
        category: "Hierarchies & Simulations"
      });
    }
    ;
    return Nothing.value;
  };
  var getExampleCodeSummary = function(v) {
    if (v === "three-little-circles") {
      return getSnippet("threeLittleCircles");
    }
    ;
    if (v === "three-circles-transition") {
      return getSnippet("threeLittleCirclesTransition");
    }
    ;
    if (v === "simple-tree") {
      return getSnippet("simpleTree");
    }
    ;
    if (v === "nested-elements") {
      return getSnippet("nestedElements");
    }
    ;
    if (v === "bar-chart") {
      return getSnippet("barChart");
    }
    ;
    if (v === "scatter-plot") {
      return getSnippet("scatterPlot");
    }
    ;
    if (v === "line-chart") {
      return getSnippet("lineChart");
    }
    ;
    if (v === "grouped-bar-chart") {
      return getSnippet("groupedBarChart");
    }
    ;
    if (v === "simple-hierarchy") {
      return getSnippet("treeViz");
    }
    ;
    if (v === "three-little-dimensions") {
      return getSnippet("threeLittleDimensions");
    }
    ;
    if (v === "lesmis-force") {
      return getSnippet("lesMisTree");
    }
    ;
    return "-- See GitHub for full source code";
  };
  var render7 = function(state3) {
    var v = getExampleMeta(state3.exampleId);
    if (v instanceof Nothing) {
      return div2([classes(["example-page"])])([renderHeader(state3.exampleId)(Nothing.value), main([classes(["example-content"])])([h1_([text2("Example Not Found")]), p_([text2("No example found with ID: " + state3.exampleId)]), p_([a([href("#" + routeToPath(Gallery.value))])([text2("Return to Examples Gallery")])])])]);
    }
    ;
    if (v instanceof Just) {
      return div2([classes(["example-page"])])([renderHeader(state3.exampleId)(new Just(v.value0)), main([classes(["example-content"])])([div2([classes(["example-description"])])([h1([classes(["example-title"])])([text2(v.value0.name)]), p([classes(["example-subtitle"])])([text2(v.value0.description)]), p([classes(["example-category-badge"])])([text2(v.value0.category)])]), div2([classes(["example-viz-panel"])])([div2([id3("viz"), classes(["example-viz"])])([])]), div2([classes(["example-code-panel"])])([h2([classes(["code-panel-title"])])([text2("Source Code")]), p([classes(["code-note"])])([text2("View the source for this example in the "), a([href(getGithubLink(v.value0.id)), target2("_blank"), rel("noopener noreferrer")])([text2("GitHub repository")])]), div2([classes(["code-block"])])(syntaxHighlightedCode(getExampleCodeSummary(v.value0.id)))])])]);
    }
    ;
    throw new Error("Failed pattern match at Component.Example (line 178, column 3 - line 241, column 10): " + [v.constructor.name]);
  };
  var clearVizContainer = function(dictMonadAff) {
    return clear2(monadEffectHalogenM(dictMonadAff.MonadEffect0()))("#viz");
  };
  var handleAction3 = function(dictMonadAff) {
    var clearVizContainer1 = clearVizContainer(dictMonadAff);
    var liftEffect51 = liftEffect(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    return function(v) {
      if (v instanceof Initialize4) {
        return discard20(clearVizContainer1)(function() {
          return bind31(get10)(function(state3) {
            return discard20((function() {
              if (state3.exampleId === "three-little-circles") {
                return liftEffect51(threeLittleCircles);
              }
              ;
              if (state3.exampleId === "three-circles-transition") {
                return liftEffect51($$void9(threeLittleCirclesTransition("#viz")));
              }
              ;
              if (state3.exampleId === "simple-tree") {
                return liftEffect51(testSimpleTree);
              }
              ;
              if (state3.exampleId === "nested-elements") {
                return liftEffect51(testNestedElements);
              }
              ;
              if (state3.exampleId === "bar-chart") {
                return liftEffect51(barChart);
              }
              ;
              if (state3.exampleId === "scatter-plot") {
                return liftEffect51(scatterPlot);
              }
              ;
              if (state3.exampleId === "line-chart") {
                return liftEffect51(lineChart);
              }
              ;
              if (state3.exampleId === "grouped-bar-chart") {
                return liftEffect51(groupedBarChart("#viz"));
              }
              ;
              if (state3.exampleId === "simple-hierarchy") {
                return liftEffect51(treeViz("#viz"));
              }
              ;
              if (state3.exampleId === "three-little-dimensions") {
                return liftEffect51(threeLittleDimensions);
              }
              ;
              if (state3.exampleId === "lesmis-force") {
                return liftEffect51(testLesMisTree);
              }
              ;
              return pure21(unit);
            })())(function() {
              return liftEffect51(highlightAll);
            });
          });
        });
      }
      ;
      if (v instanceof Receive2) {
        return bind31(get10)(function(state3) {
          return when3(state3.exampleId !== v.value0)(discard20(modify_6(function(v1) {
            var $38 = {};
            for (var $39 in v1) {
              if ({}.hasOwnProperty.call(v1, $39)) {
                $38[$39] = v1[$39];
              }
              ;
            }
            ;
            $38.exampleId = v.value0;
            return $38;
          }))(function() {
            return handleAction3(dictMonadAff)(Initialize4.value);
          }));
        });
      }
      ;
      throw new Error("Failed pattern match at Component.Example (line 70, column 16 - line 107, column 30): " + [v.constructor.name]);
    };
  };
  var component3 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(exampleId) {
        return {
          exampleId
        };
      },
      render: render7,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        finalize: defaultEval.finalize,
        handleAction: handleAction3(dictMonadAff),
        initialize: new Just(Initialize4.value),
        receive: function($42) {
          return Just.create(Receive2.create($42));
        }
      })
    });
  };

  // output/Component.ExamplesGallery/foreign.js
  function filterImpl2(predicate) {
    return function(array2) {
      return array2.filter(predicate);
    };
  }

  // output/Component.ExamplesGallery/index.js
  var mapFlipped9 = /* @__PURE__ */ mapFlipped(functorArray);
  var renderExampleCard = function(ex) {
    return a([href("#" + routeToPath(ex.route)), classes(["example-card"])])([div2([classes(["example-thumbnail"])])([img([src2(ex.thumbnail), alt4(ex.name), classes(["example-thumbnail-img"])])]), div2([classes(["example-card-content"])])([h3([classes(["example-card-title"])])([text2(ex.name)]), p([classes(["example-card-description"])])([text2(ex.description)])])]);
  };
  var renderCategory = function(categoryName) {
    return function(examples) {
      return section([classes(["gallery-category"])])([h2([classes(["gallery-category-title"])])([text2(categoryName)]), div2([classes(["gallery-grid"])])(mapFlipped9(examples)(renderExampleCard))]);
    };
  };
  var filter6 = filterImpl2;
  var renderCategories = function(examples) {
    var categories = ["Basic Examples", "Chart Examples", "Hierarchies & Simulations", "Advanced Examples", "Alternative Interpreters"];
    return mapFlipped9(categories)(function(category) {
      var examplesInCategory = filter6(function(ex) {
        return ex.category === category;
      })(examples);
      return renderCategory(category)(examplesInCategory);
    });
  };
  var allExamples = /* @__PURE__ */ (function() {
    return [{
      id: "three-little-circles",
      name: "Three Little Circles",
      description: "Data join basics - bind data to DOM elements",
      category: "Basic Examples",
      route: new Example("three-little-circles"),
      thumbnail: "assets/example-thumbnails/three-little-circles.png"
    }, {
      id: "three-circles-transition",
      name: "Circles Transition",
      description: "Animated transitions with easing and delays",
      category: "Basic Examples",
      route: new Example("three-circles-transition"),
      thumbnail: "assets/example-thumbnails/three-little-circles.png"
    }, {
      id: "simple-tree",
      name: "Simple Tree",
      description: "Basic nesting with named selections",
      category: "Basic Examples",
      route: new Example("simple-tree"),
      thumbnail: "assets/example-thumbnails/simple-tree.png"
    }, {
      id: "nested-elements",
      name: "Nested Elements",
      description: "Multi-level nesting (Group \u2192 Circle + Text)",
      category: "Basic Examples",
      route: new Example("nested-elements"),
      thumbnail: "assets/example-thumbnails/nested-elements.png"
    }, {
      id: "three-little-dimensions",
      name: "Three Little Dimensions",
      description: "Nested data joins (2D array \u2192 table)",
      category: "Basic Examples",
      route: new Example("three-little-dimensions"),
      thumbnail: "assets/example-thumbnails/nested-data.png"
    }, {
      id: "bar-chart",
      name: "Bar Chart",
      description: "Data-driven bars with scaling",
      category: "Chart Examples",
      route: new Example("bar-chart"),
      thumbnail: "assets/example-thumbnails/simple-bar-chart.png"
    }, {
      id: "scatter-plot",
      name: "Scatter Plot",
      description: "Points positioned by data coordinates",
      category: "Chart Examples",
      route: new Example("scatter-plot"),
      thumbnail: "assets/example-thumbnails/anscombes-quartet.png"
    }, {
      id: "line-chart",
      name: "Line Chart",
      description: "Path element generated from data",
      category: "Chart Examples",
      route: new Example("line-chart"),
      thumbnail: "assets/example-thumbnails/simple-line-chart.png"
    }, {
      id: "grouped-bar-chart",
      name: "Grouped Bar Chart",
      description: "Nested joins with multiple series",
      category: "Chart Examples",
      route: new Example("grouped-bar-chart"),
      thumbnail: "assets/example-thumbnails/grouped-bar-chart.png"
    }, {
      id: "simple-hierarchy",
      name: "Tree Layout",
      description: "Hierarchical node-link diagram (pure PureScript)",
      category: "Hierarchies & Simulations",
      route: new Example("simple-hierarchy"),
      thumbnail: "assets/example-thumbnails/tree-purescript.png"
    }, {
      id: "lesmis-force",
      name: "Les Mis\xE9rables Network",
      description: "Force-directed graph with simulation",
      category: "Hierarchies & Simulations",
      route: new Example("lesmis-force"),
      thumbnail: "assets/example-thumbnails/les-miserables.png"
    }, {
      id: "animated-tree-cluster",
      name: "Animated Tree \u2194 Cluster",
      description: "Smooth transitions between pure PureScript layouts with proper data joins",
      category: "Advanced Examples",
      route: AnimatedTreeCluster.value,
      thumbnail: "assets/example-thumbnails/tree-purescript.png"
    }, {
      id: "lesmis-gup-tree",
      name: "Les Mis\xE9rables GUP",
      description: "Force layout + dynamic layouts (grid, phylotaxis) + node filtering with General Update Pattern",
      category: "Advanced Examples",
      route: LesMisGUPTree.value,
      thumbnail: "assets/example-thumbnails/les-miserables-gup.png"
    }, {
      id: "module-graph",
      name: "Module Graph",
      description: "Visualize this codebase's own module dependencies - dogfooding!",
      category: "Advanced Examples",
      route: ModuleGraph.value,
      thumbnail: "assets/example-thumbnails/module-graph.png"
    }, {
      id: "mermaid-tree-demo",
      name: "Mermaid Tree Visualizer",
      description: "Visualize Tree API structure as Mermaid diagrams - see how trees are composed!",
      category: "Alternative Interpreters",
      route: MermaidTreeDemo.value,
      thumbnail: "assets/example-thumbnails/mermaid-diagram.png"
    }];
  })();
  var render8 = function(v) {
    return div2([classes(["examples-gallery-page"])])([render5({
      logoSize: Large.value,
      quadrant: NoQuadrant.value,
      prevNext: Nothing.value,
      pageTitle: new Just("Tree API Examples")
    }), main([classes(["gallery-content"])])(renderCategories(allExamples))]);
  };
  var component4 = /* @__PURE__ */ mkComponent({
    initialState: function(v) {
      return unit;
    },
    render: render8,
    "eval": /* @__PURE__ */ mkEval(defaultEval)
  });

  // output/D3.Viz.GUP.Unsafe/index.js
  var coerceIndexToNumber = unsafeCoerce2;
  var charToKey = singleton7;

  // output/D3.Viz.GUP/index.js
  var andThen2 = /* @__PURE__ */ andThen(semigroupArray);
  var classed3 = /* @__PURE__ */ classed(toAttrString);
  var fill17 = /* @__PURE__ */ fill(toAttrString);
  var y11 = /* @__PURE__ */ y(toAttrNumber);
  var x11 = /* @__PURE__ */ x(toAttrNumberFnI);
  var text7 = /* @__PURE__ */ text(toAttrStringFn);
  var fontSize6 = /* @__PURE__ */ fontSize(toAttrNumber);
  var discard21 = /* @__PURE__ */ discard(discardUnit);
  var exGeneralUpdatePattern = function(dictSelectionM) {
    var Monad0 = dictSelectionM.Monad0();
    var Bind1 = Monad0.Bind1();
    var bind87 = bind(Bind1);
    var attach2 = attach(dictSelectionM);
    var appendTo2 = appendTo(dictSelectionM);
    var pure91 = pure(Monad0.Applicative0());
    var openSelection2 = openSelection(dictSelectionM);
    var updateJoin2 = updateJoin(dictSelectionM);
    var discard120 = discard21(Bind1);
    var setAttributes2 = setAttributes(dictSelectionM);
    return function(selector) {
      var xFromIndex = function(v) {
        return function(i2) {
          return 50 + coerceIndexToNumber(i2) * 48;
        };
      };
      var transition2 = transitionWithDuration(2e3);
      var update7 = andThen2([classed3("update"), fill17("gray"), y11(200)])(to(transition2)([x11(xFromIndex)]));
      var exit = andThen2([classed3("exit"), fill17("brown")])(to(transition2)([y11(400), remove]));
      var enter = andThen2([classed3("enter"), fill17("green"), x11(xFromIndex), y11(0), text7(singleton7), fontSize6(60)])(to(transition2)([y11(200)]));
      return bind87(attach2(selector))(function(root3) {
        return bind87(appendTo2(root3)(Svg.value)([viewBox(0)(100)(800)(350), classed3("d3svg gup")]))(function(svg2) {
          return bind87(appendTo2(svg2)(Group.value)([]))(function(letterGroup) {
            return pure91(function(letters) {
              return bind87(openSelection2(letterGroup)("text"))(function(enterSelection) {
                return bind87(updateJoin2(enterSelection)(Text.value)(letters)(charToKey))(function(updateSelections) {
                  return discard120(setAttributes2(updateSelections.exit)(exit))(function() {
                    return discard120(setAttributes2(updateSelections.update)(update7))(function() {
                      return bind87(appendTo2(updateSelections.enter)(Text.value)([]))(function(newlyEntered) {
                        return discard120(setAttributes2(newlyEntered)(enter))(function() {
                          return pure91(newlyEntered);
                        });
                      });
                    });
                  });
                });
              });
            });
          });
        });
      });
    };
  };

  // output/Effect.Random/foreign.js
  var random = Math.random;

  // output/Component.GeneralUpdatePattern/index.js
  var discard24 = /* @__PURE__ */ discard(discardUnit);
  var exGeneralUpdatePattern2 = /* @__PURE__ */ exGeneralUpdatePattern(d3TaglessD3M);
  var liftEffect17 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var applySecond3 = /* @__PURE__ */ applySecond(applyEffect);
  var pure24 = /* @__PURE__ */ pure(applicativeEffect);
  var bind113 = /* @__PURE__ */ bind(bindAff);
  var discard110 = /* @__PURE__ */ discard24(bindAff);
  var discard25 = /* @__PURE__ */ discard24(bindHalogenM);
  var bind210 = /* @__PURE__ */ bind(bindHalogenM);
  var forever2 = /* @__PURE__ */ forever(monadRecAff);
  var modify_7 = /* @__PURE__ */ modify_2(monadStateHalogenM);
  var get11 = /* @__PURE__ */ get(monadStateHalogenM);
  var pure111 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Running = /* @__PURE__ */ (function() {
    function Running2() {
    }
    ;
    Running2.value = new Running2();
    return Running2;
  })();
  var Paused = /* @__PURE__ */ (function() {
    function Paused2() {
    }
    ;
    Paused2.value = new Paused2();
    return Paused2;
  })();
  var Initialize5 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var ToggleStatus = /* @__PURE__ */ (function() {
    function ToggleStatus2() {
    }
    ;
    ToggleStatus2.value = new ToggleStatus2();
    return ToggleStatus2;
  })();
  var Finalize2 = /* @__PURE__ */ (function() {
    function Finalize5() {
    }
    ;
    Finalize5.value = new Finalize5();
    return Finalize5;
  })();
  var showStatus = {
    show: function(v) {
      if (v instanceof Running) {
        return "Running";
      }
      ;
      if (v instanceof Paused) {
        return "Paused";
      }
      ;
      throw new Error("Failed pattern match at Component.GeneralUpdatePattern (line 33, column 1 - line 35, column 25): " + [v.constructor.name]);
    }
  };
  var show37 = /* @__PURE__ */ show(showStatus);
  var runGeneralUpdatePattern = function(dictBind) {
    var discard310 = discard24(dictBind);
    var bind310 = bind(dictBind);
    return function(dictMonadAff) {
      var MonadEffect0 = dictMonadAff.MonadEffect0();
      var liftEffect121 = liftEffect(MonadEffect0);
      var pure213 = pure(MonadEffect0.Monad0().Applicative0());
      return discard310(log3(MonadEffect0)("General Update Pattern example"))(function() {
        return bind310(liftEffect121(eval_D3M(exGeneralUpdatePattern2("div.svg-container"))))(function(update7) {
          return pure213(function(letters) {
            return liftEffect17(applySecond3(runD3M(update7(letters)))(pure24(unit)));
          });
        });
      });
    };
  };
  var runGeneralUpdatePattern1 = /* @__PURE__ */ runGeneralUpdatePattern(bindHalogenM);
  var render9 = function(state3) {
    return div2([class_("gup-page")])([div2([class_("page-header")])([h1_([text2("General Update Pattern")]), p([class_("page-description")])([text2("A simple example of D3's enter/update/exit pattern with animated letters.")])]), div2([class_("controls-panel")])([button([class_("control-button"), onClick(function(v) {
      return ToggleStatus.value;
    })])([text2(show37(state3.status))])]), div2([class_("svg-container")])([]), div2([class_("info-panel")])([h3_([text2("What This Demonstrates")]), ul_([li_([text2("Enter/Update/Exit pattern - letters appear, move, and disappear")]), li_([text2("Green letters are entering (new data)")]), li_([text2("Gray letters are updating (existing data, new position)")]), li_([text2("Brown letters are exiting (removed from data)")]), li_([text2("All transitions are smoothly animated")])]), h3_([text2("Code Pattern")]), pre([class_("code-snippet")])([text2('openSelection <- openSelection letterGroup "text"\nupdateSelections <- updateJoin openSelection Text letters charToKey\n\n-- Handle each phase with transitions\nsetAttributes updateSelections.exit [classed "exit", ...]\nsetAttributes updateSelections.update [classed "update", ...]\n\nnewlyEntered <- appendTo updateSelections.enter Text []\nsetAttributes newlyEntered [classed "enter", ...]')])])]);
  };
  var getLetters = /* @__PURE__ */ liftEffect17(/* @__PURE__ */ (function() {
    var letters = toCharArray("abcdefghijklmnopqrstuvwxyz");
    var coinToss = function(c) {
      return function __do3() {
        var n = random();
        var $51 = n > 0.6;
        if ($51) {
          return new Just(c);
        }
        ;
        return Nothing.value;
      };
    };
    return function __do3() {
      var choices = sequence(traversableArray)(applicativeEffect)(map(functorArray)(coinToss)(letters))();
      return catMaybes(choices);
    };
  })());
  var runUpdate = function(update7) {
    return bind113(getLetters)(function(letters) {
      return discard110(update7(letters))(function() {
        return delay(2300);
      });
    });
  };
  var handleAction4 = function(dictMonadAff) {
    var log9 = log3(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    var monadAffHalogenM2 = monadAffHalogenM(dictMonadAff);
    var runGeneralUpdatePattern2 = runGeneralUpdatePattern1(monadAffHalogenM2);
    var liftAff3 = liftAff(monadAffHalogenM2);
    return function(v) {
      if (v instanceof Initialize5) {
        return discard25(log9("GeneralUpdatePattern: Initializing"))(function() {
          return bind210(runGeneralUpdatePattern2)(function(updateFn) {
            return bind210(liftAff3(forkAff(forever2(runUpdate(updateFn)))))(function(fiber) {
              return discard25(modify_7(function(s) {
                var $53 = {};
                for (var $54 in s) {
                  if ({}.hasOwnProperty.call(s, $54)) {
                    $53[$54] = s[$54];
                  }
                  ;
                }
                ;
                $53.status = Running.value;
                $53.fiber = new Just(fiber);
                $53.update = new Just(updateFn);
                return $53;
              }))(function() {
                return log9("GeneralUpdatePattern: Initialized successfully");
              });
            });
          });
        });
      }
      ;
      if (v instanceof ToggleStatus) {
        return bind210(get11)(function(state3) {
          if (state3.status instanceof Running) {
            return discard25(log9("Pausing updates"))(function() {
              return discard25((function() {
                if (state3.fiber instanceof Nothing) {
                  return pure111(unit);
                }
                ;
                if (state3.fiber instanceof Just) {
                  return liftAff3(killFiber(error("Cancel fiber to suspend computation"))(state3.fiber.value0));
                }
                ;
                throw new Error("Failed pattern match at Component.GeneralUpdatePattern (line 142, column 9 - line 145, column 86): " + [state3.fiber.constructor.name]);
              })())(function() {
                return modify_7(function(s) {
                  var $59 = {};
                  for (var $60 in s) {
                    if ({}.hasOwnProperty.call(s, $60)) {
                      $59[$60] = s[$60];
                    }
                    ;
                  }
                  ;
                  $59.status = Paused.value;
                  $59.fiber = Nothing.value;
                  return $59;
                });
              });
            });
          }
          ;
          if (state3.status instanceof Paused) {
            return discard25(log9("Starting updates"))(function() {
              if (state3.update instanceof Nothing) {
                return pure111(unit);
              }
              ;
              if (state3.update instanceof Just) {
                return bind210(liftAff3(forkAff(forever2(runUpdate(state3.update.value0)))))(function(fiber) {
                  return modify_7(function(s) {
                    var $63 = {};
                    for (var $64 in s) {
                      if ({}.hasOwnProperty.call(s, $64)) {
                        $63[$64] = s[$64];
                      }
                      ;
                    }
                    ;
                    $63.status = Running.value;
                    $63.fiber = new Just(fiber);
                    return $63;
                  });
                });
              }
              ;
              throw new Error("Failed pattern match at Component.GeneralUpdatePattern (line 149, column 9 - line 153, column 71): " + [state3.update.constructor.name]);
            });
          }
          ;
          throw new Error("Failed pattern match at Component.GeneralUpdatePattern (line 139, column 5 - line 153, column 71): " + [state3.status.constructor.name]);
        });
      }
      ;
      if (v instanceof Finalize2) {
        return discard25(log9("GeneralUpdatePattern: Finalizing"))(function() {
          return bind210(get11)(function(state3) {
            return discard25((function() {
              if (state3.fiber instanceof Nothing) {
                return pure111(unit);
              }
              ;
              if (state3.fiber instanceof Just) {
                return liftAff3(killFiber(error("Cancelling fiber and terminating computation"))(state3.fiber.value0));
              }
              ;
              throw new Error("Failed pattern match at Component.GeneralUpdatePattern (line 158, column 5 - line 160, column 103): " + [state3.fiber.constructor.name]);
            })())(function() {
              return modify_7(function(s) {
                var $69 = {};
                for (var $70 in s) {
                  if ({}.hasOwnProperty.call(s, $70)) {
                    $69[$70] = s[$70];
                  }
                  ;
                }
                ;
                $69.status = Paused.value;
                $69.fiber = Nothing.value;
                $69.update = Nothing.value;
                return $69;
              });
            });
          });
        });
      }
      ;
      throw new Error("Failed pattern match at Component.GeneralUpdatePattern (line 129, column 16 - line 161, column 77): " + [v.constructor.name]);
    };
  };
  var component5 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return {
          status: Paused.value,
          fiber: Nothing.value,
          update: Nothing.value
        };
      },
      render: render9,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        handleAction: handleAction4(dictMonadAff),
        initialize: new Just(Initialize5.value),
        finalize: new Just(Finalize2.value)
      })
    });
  };

  // output/Component.HowTo.HowtoAxesScales/index.js
  var pure25 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize6 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var render10 = function(v) {
    return div2([classes(["tutorial-page"])])([render5({
      logoSize: Large.value,
      quadrant: QuadHowTo.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("Creating Axes and Scales")]), p_([text2("PSD3 provides color scales and supports D3's scale/axis FFI for custom scales.")])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Color Scales")]), p_([text2("Built-in color interpolation (0-1 input):")]), pre([classes(["code-block"])])([code_([text2("import PSD3.Internal.Scales.Scales\n\n-- Sequential scales\nfill (\\\\d -> d3InterpolateViridis_ (d.value / maxValue))\nfill (\\\\d -> d3InterpolatePlasma_ (d.value / maxValue))\n\n-- Diverging scales (good for -1 to 1 ranges)\nfill (\\\\d -> d3InterpolateRdYlGn_ (normalize d.change))\n\n-- Categorical by index\nfill (\\\\d -> d3SchemeCategory10N_ (toNumber d.index))")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Custom D3 Scales via FFI")]), p_([text2("For linear/band/time scales, use FFI:")]), h3_([text2("JavaScript FFI")]), pre([classes(["code-block"])])([code_([text2("export const scaleLinear_ = domain => range => () =>\n  d3.scaleLinear().domain(domain).range(range);\n\nexport const scaleBand_ = domain => range => padding => () =>\n  d3.scaleBand().domain(domain).range(range).padding(padding);\n\nexport const applyScale_ = scale => value => scale(value);")])]), h3_([text2("PureScript")]), pre([classes(["code-block"])])([code_([text2("foreign import scaleLinear_ :: Array Number -> Array Number -> Effect Scale\nforeign import scaleBand_ :: Array String -> Array Number -> Number -> Effect Scale\nforeign import applyScale_ :: Scale -> Number -> Number\n\n-- Usage\nxScale <- liftEffect $ scaleLinear_ [0.0, maxX] [0.0, width]\nlet xPos d = applyScale_ xScale d.value")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Creating Axes")]), p_([text2("Axes via FFI:")]), pre([classes(["code-block"])])([code_([text2('-- JavaScript\nexport const axisBottom_ = scale => () => d3.axisBottom(scale);\nexport const axisLeft_ = scale => () => d3.axisLeft(scale);\nexport const callAxis_ = selection => axis => () => selection.call(axis);\n\n-- PureScript: Append group then call axis\naxisGroup <- append Group [transform ("translate(0," <> show height <> ")")] svg\nliftEffect $ callAxis_ axisGroup xAxis')])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Key Points")]), ul_([li_([strong_([text2("Color interpolators")]), text2(" - Take 0-1, return color string")]), li_([strong_([text2("Normalize data")]), text2(" - Scale values to 0-1 for interpolators")]), li_([strong_([text2("FFI for numeric scales")]), text2(" - scaleLinear, scaleBand, scaleTime")]), li_([strong_([text2("Axis via .call()")]), text2(" - D3 pattern for rendering axes")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Real Example")]), p_([text2("See scales in action:")]), ul_([li_([code_([text2("src/lib/PSD3/Internal/Scales/Scales.purs")]), text2(" - Color interpolators")]), li_([code_([text2("src/website/Viz/Spago/Draw/Attributes.purs")]), text2(" - Color-by-metric scales")])])])])]);
  };
  var handleAction5 = function(dictMonadAff) {
    return function(v) {
      return pure25(unit);
    };
  };
  var component6 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render10,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction5(dictMonadAff),
        initialize: new Just(Initialize6.value)
      })
    });
  };

  // output/Component.HowTo.HowtoDebugging/index.js
  var pure26 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize7 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var render11 = function(v) {
    return div2([classes(["tutorial-page"])])([render5({
      logoSize: Large.value,
      quadrant: QuadHowTo.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("Debugging Visualizations")]), p_([text2("Techniques for finding and fixing visualization issues.")])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Console Logging")]), p_([text2("Log data in attribute functions:")]), pre([classes(["code-block"])])([code_([text2('import Effect.Console (log)\nimport Effect.Unsafe (unsafePerformEffect)\n\n-- Debug attribute values\nfill (\\\\d -> unsafePerformEffect do\n  log $ "Node: " <> show d.id <> ", value: " <> show d.value\n  pure $ colorScale d.value\n)')])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Browser DevTools")]), ul_([li_([strong_([text2("Elements panel")]), text2(" - Inspect SVG structure and attributes")]), li_([strong_([text2("$0.__data__")]), text2(" - View bound data on selected element")]), li_([strong_([text2("Network tab")]), text2(" - Verify data loading")]), li_([strong_([text2("Performance tab")]), text2(" - Profile slow renders")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Mermaid Diagrams")]), p_([text2("Visualize tree structure with Mermaid interpreter:")]), pre([classes(["code-block"])])([code_([text2("-- Generate Mermaid code from TreeAPI tree\nlet mermaidCode = runMermaidInterpreter myTree\n\n-- Copy to https://mermaid.live to visualize structure")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Common Issues")]), ul_([li_([strong_([text2("Nothing renders")]), text2(" - Check container exists, SVG has size")]), li_([strong_([text2("Elements at origin")]), text2(" - Verify coordinate attributes (cx, cy, x, y)")]), li_([strong_([text2("Wrong colors")]), text2(" - Check scale domain/range, normalize values to 0-1")]), li_([strong_([text2("No data binding")]), text2(" - Use joinData, check key function")]), li_([strong_([text2("Type errors")]), text2(" - Ensure datum type matches selection")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Key Points")]), ul_([li_([strong_([text2("unsafePerformEffect")]), text2(" - Escape hatch for logging")]), li_([strong_([text2("$0.__data__")]), text2(" - Console access to bound data")]), li_([strong_([text2("Mermaid interpreter")]), text2(" - Visualize tree structure")]), li_([strong_([text2("Check dimensions")]), text2(" - SVG needs viewBox or width/height")])])])])]);
  };
  var handleAction6 = function(dictMonadAff) {
    return function(v) {
      return pure26(unit);
    };
  };
  var component7 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render11,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction6(dictMonadAff),
        initialize: new Just(Initialize7.value)
      })
    });
  };

  // output/Component.HowTo.HowtoEvents/index.js
  var pure27 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize8 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var render12 = function(v) {
    return div2([classes(["tutorial-page"])])([render5({
      logoSize: Large.value,
      quadrant: QuadHowTo.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("Responding to User Events")]), p_([text2("PSD3 provides type-safe event handlers. Use the 'on' function to attach behaviors to selections.")])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Click Handlers")]), p_([text2("Access the bound datum when an element is clicked:")]), pre([classes(["code-block"])])([code_([text2('import PSD3v2.Behavior.Types (onClickWithDatum)\n\ncircles <- append Circle [fill "blue", radius 20.0] container\n_ <- on (onClickWithDatum \\\\d -> log ("Clicked: " <> d.name)) circles')])]), p_([text2("Without datum access:")]), pre([classes(["code-block"])])([code_([text2('import PSD3v2.Behavior.Types (onClick)\n\n_ <- on (onClick (log "Button clicked!")) button')])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Hover Effects")]), p_([text2("Simple enter/leave handlers:")]), pre([classes(["code-block"])])([code_([text2("import PSD3v2.Behavior.Types (onMouseEnter, onMouseLeave)\n\n_ <- on (onMouseEnter \\\\d -> highlightNode d) circles\n_ <- on (onMouseLeave \\\\_ -> clearHighlight) circles")])]), p_([text2("Built-in style changes with onHover:")]), pre([classes(["code-block"])])([code_([text2('import PSD3v2.Behavior.Types (onHover)\n\n_ <- on (onHover\n  { enter: [{ attr: "stroke", value: "#333" }, { attr: "stroke-width", value: "3" }]\n  , leave: [{ attr: "stroke", value: "#ddd" }, { attr: "stroke-width", value: "1.5" }]\n  }) lines')])]), p_([text2("With mouse coordinates (for tooltips):")]), pre([classes(["code-block"])])([code_([text2("import PSD3v2.Behavior.Types (onMouseEnterWithInfo)\n\n_ <- on (onMouseEnterWithInfo \\\\info -> do\n  -- info.datum: bound data\n  -- info.pageX/pageY: document coordinates\n  -- info.offsetX/offsetY: element coordinates\n  showTooltip info.datum info.pageX info.pageY\n) circles")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Drag & Zoom")]), p_([text2("Simple drag behavior:")]), pre([classes(["code-block"])])([code_([text2("import PSD3v2.Behavior.Types (Drag(..), defaultDrag)\n\n_ <- on (Drag defaultDrag) draggableElement")])]), p_([text2("Force simulation drag (reheats on drag):")]), pre([classes(["code-block"])])([code_([text2('import PSD3v2.Behavior.Types (Drag(..), simulationDrag)\n\n_ <- on (Drag (simulationDrag "my-simulation-id")) nodes')])]), p_([text2("Pan and zoom:")]), pre([classes(["code-block"])])([code_([text2('import PSD3v2.Behavior.Types (Zoom(..), defaultZoom, ScaleExtent(..))\n\n-- Attach to outer SVG, transforms inner group\n_ <- on (Zoom (defaultZoom (ScaleExtent 0.5 4.0) ".zoom-group")) svg')])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Key Points")]), ul_([li_([strong_([text2("Type-safe")]), text2(" - Datum type flows through handlers")]), li_([strong_([text2("MouseEventInfo")]), text2(" - Contains datum + all coordinates")]), li_([strong_([text2("Combine behaviors")]), text2(" - Attach multiple with separate 'on' calls")]), li_([strong_([text2("simulationDrag")]), text2(" - Auto-reheats force simulation")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Real Example")]), p_([text2("See the Code Explorer implementation:")]), ul_([li_([code_([text2("src/website/Viz/Spago/Render.purs:81-96")]), text2(" - Drag, click, hover behaviors")]), li_([code_([text2("src/lib/PSD3v2/Behavior/Types.purs")]), text2(" - All behavior types with docs")])])])])]);
  };
  var handleAction7 = function(dictMonadAff) {
    return function(v) {
      return pure27(unit);
    };
  };
  var component8 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render12,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction7(dictMonadAff),
        initialize: new Just(Initialize8.value)
      })
    });
  };

  // output/Component.HowTo.HowtoForceGraphs/index.js
  var pure28 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize9 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var render13 = function(v) {
    return div2([classes(["tutorial-page"])])([render5({
      logoSize: Large.value,
      quadrant: QuadHowTo.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("Building Force-Directed Graphs")]), p_([text2("PSD3 provides SimulationM and SimulationM2 capabilities for force-directed layouts.")])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Initialize Simulation")]), p_([text2("Create a force simulation with nodes and links:")]), pre([classes(["code-block"])])([code_([text2('import PSD3v2.Capabilities.Simulation (class SimulationM, init, addTickFunction, start, Step(..))\n\n{ nodes, links } <- init\n  { nodes: myNodeData\n  , links: myLinkData\n  , forces: [centerForce w h, chargeForce (const (-100.0)), linkForce]\n  , activeForces: Set.fromFoldable ["center", "charge", "link"]\n  , config: defaultSimConfig\n  , keyFn: _.id\n  , ticks: Map.empty\n  }')])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Tick Functions")]), p_([text2("Register callbacks to update DOM on each simulation tick:")]), pre([classes(["code-block"])])([code_([text2('-- Update node positions\naddTickFunction "nodes" $ Step nodeCircles\n  [ cx (_.x)\n  , cy (_.y)\n  ]\n\n-- Update link positions\naddTickFunction "links" $ Step linkLines\n  [ x1 (\\\\l -> l.source.x)\n  , y1 (\\\\l -> l.source.y)\n  , x2 (\\\\l -> l.target.x)\n  , y2 (\\\\l -> l.target.y)\n  ]\n\nstart -- Begin animation')])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Available Forces")]), ul_([li_([strong_([text2("centerForce")]), text2(" - Keep nodes centered")]), li_([strong_([text2("chargeForce")]), text2(" - Repulsion/attraction between nodes")]), li_([strong_([text2("linkForce")]), text2(" - Springs between connected nodes")]), li_([strong_([text2("collideForce")]), text2(" - Prevent node overlap")]), li_([strong_([text2("forceX/Y")]), text2(" - Push toward position")]), li_([strong_([text2("radialForce")]), text2(" - Push toward circle")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Dynamic Updates")]), p_([text2("Use SimulationM2 for dynamic data changes:")]), pre([classes(["code-block"])])([code_([text2("import PSD3v2.Capabilities.Simulation (class SimulationM2, update, reheat)\n\n{ nodes, links } <- update\n  { nodes: Just newNodeArray\n  , links: Just newLinkArray\n  , nodeFilter: Nothing\n  , linkFilter: Nothing\n  , activeForces: Nothing\n  , config: Nothing\n  , keyFn: _.id\n  }\n\nreheat 0.7  -- Re-energize simulation\nstart       -- Begin animation")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Node Dragging")]), p_([text2("Enable simulation-aware drag:")]), pre([classes(["code-block"])])([code_([text2('import PSD3v2.Behavior.Types (Drag(..), simulationDrag)\n\n-- Drag reheats simulation automatically\n_ <- on (Drag (simulationDrag "my-simulation-id")) nodeCircles')])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Key Points")]), ul_([li_([strong_([text2("SimulationM")]), text2(" - Static simulations")]), li_([strong_([text2("SimulationM2")]), text2(" - Adds update/reheat for dynamic data")]), li_([strong_([text2("Step")]), text2(" - Maps selection to tick attributes")]), li_([strong_([text2("activeForces")]), text2(" - Control which forces are enabled")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Real Example")]), p_([text2("See force simulation in action:")]), ul_([li_([code_([text2("src/website/Component/CodeExplorer")]), text2(" - Full force graph with scenes")]), li_([code_([text2("src/lib/PSD3v2/Capabilities/Simulation.purs")]), text2(" - SimulationM type class")])])])])]);
  };
  var handleAction8 = function(dictMonadAff) {
    return function(v) {
      return pure28(unit);
    };
  };
  var component9 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render13,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction8(dictMonadAff),
        initialize: new Just(Initialize9.value)
      })
    });
  };

  // output/Component.HowTo.HowtoHierarchical/index.js
  var pure29 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize10 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var render14 = function(v) {
    return div2([classes(["tutorial-page"])])([render5({
      logoSize: Large.value,
      quadrant: QuadHowTo.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("Working with Hierarchical Data")]), p_([text2("PSD3 supports D3's hierarchy layouts for trees, clusters, and treemaps.")])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Creating Hierarchy")]), p_([text2("Convert JSON to d3.hierarchy via FFI:")]), pre([classes(["code-block"])])([code_([text2("-- JavaScript FFI\nexport const hierarchy_ = data => () => d3.hierarchy(data);\nexport const descendants_ = root => root.descendants();\nexport const links_ = root => root.links();\n\n-- PureScript\nforeign import hierarchy_ :: Json -> Effect HierarchyNode\nforeign import descendants_ :: HierarchyNode -> Array HierarchyNode\nforeign import links_ :: HierarchyNode -> Array HierarchyLink\n\nroot <- liftEffect $ hierarchy_ jsonData\nlet nodes = descendants_ root\nlet links = links_ root")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Layout Functions")]), p_([text2("Apply layouts to compute positions:")]), pre([classes(["code-block"])])([code_([text2("-- Tree layout (neat spacing)\nexport const tree_ = width => height => () =>\n  d3.tree().size([height, width]);\n\n-- Cluster layout (leaves aligned)\nexport const cluster_ = width => height => () =>\n  d3.cluster().size([height, width]);\n\n-- Treemap layout (space-filling)\nexport const treemap_ = width => height => () =>\n  d3.treemap().size([width, height]).padding(1);\n\n-- Apply layout to hierarchy\nexport const applyLayout_ = layout => root => () => layout(root);")])]), p_([text2("After layout, nodes have x/y coordinates:")]), pre([classes(["code-block"])])([code_([text2("treeLayout <- liftEffect $ tree_ width height\nliftEffect $ applyLayout_ treeLayout root\n\n-- Now render nodes at computed positions\ncircles <- append Circle\n  [ cx (_.y)  -- Note: tree layout swaps x/y\n  , cy (_.x)\n  , radius 5.0\n  ] nodeEnter")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Drawing Links")]), p_([text2("Generate curved paths for tree connections:")]), pre([classes(["code-block"])])([code_([text2('-- Horizontal curved links (for tree layout)\nexport const linkHorizontal_ = d3.linkHorizontal()\n  .x(d => d.y)\n  .y(d => d.x);\n\n-- PureScript\npaths <- append Path\n  [ d (\\\\link -> linkHorizontal_ link)\n  , stroke "#999"\n  , fill "none"\n  ] linkEnter')])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Key Points")]), ul_([li_([strong_([text2("hierarchy()")]), text2(" - Converts JSON to hierarchy nodes")]), li_([strong_([text2("descendants()/links()")]), text2(" - Get flat arrays for data binding")]), li_([strong_([text2("tree/cluster layouts")]), text2(" - Swap x/y in coordinates")]), li_([strong_([text2("linkHorizontal/Vertical")]), text2(" - Curved path generators")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Real Example")]), p_([text2("See hierarchical layouts:")]), ul_([li_([code_([text2("src/website/Viz/TreeAPI/LesMisTreeExample.purs")]), text2(" - Tree visualization")]), li_([code_([text2("src/website/Component/AnimatedTreeCluster.purs")]), text2(" - Animated transitions")])])])])]);
  };
  var handleAction9 = function(dictMonadAff) {
    return function(v) {
      return pure29(unit);
    };
  };
  var component10 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render14,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction9(dictMonadAff),
        initialize: new Just(Initialize10.value)
      })
    });
  };

  // output/Component.HowTo.HowtoLoadingData/index.js
  var pure30 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize11 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var render15 = function(v) {
    return div2([classes(["tutorial-page"])])([render5({
      logoSize: Large.value,
      quadrant: QuadHowTo.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("Loading External Data")]), p_([text2("PSD3 uses Affjax for async data loading with configurable strategies.")])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Simple JSON Loading")]), p_([text2("Load JSON with automatic error fallback:")]), pre([classes(["code-block"])])([code_([text2('import PSD3.Shared.DataLoader (simpleLoadJSON)\n\njson <- H.liftAff $ simpleLoadJSON "data/les-miserables.json"\n-- Returns fallback on error, never throws')])]), p_([text2("With explicit error handling:")]), pre([classes(["code-block"])])([code_([text2('import PSD3.Shared.DataLoader (loadJSON, defaultConfig, LoadError(..))\n\nresult <- H.liftAff $ loadJSON defaultConfig "data/graph.json"\ncase result of\n  Left (NetworkError msg) -> log ("Network error: " <> msg)\n  Left (ParseError msg) -> log ("Parse error: " <> msg)\n  Right json -> processData json')])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Load Strategies")]), p_([text2("Configure where to load data from:")]), pre([classes(["code-block"])])([code_([text2('import PSD3.Shared.DataLoader (loadJSON, LoadStrategy(..), LoadConfig)\n\n-- Local only (bundled files)\nlet localConfig = { strategy: LocalOnly, baseUrl: Nothing }\n\n-- Remote only (requires server)\nlet remoteConfig = { strategy: RemoteOnly, baseUrl: Just "http://localhost:8080" }\n\n-- Try local first, fallback to remote\nlet hybridConfig = { strategy: LocalFirst, baseUrl: Just "http://localhost:8080" }\n\njson <- H.liftAff $ loadJSON hybridConfig "data/graph.json\\"')])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("CSV Loading")]), p_([text2("Load CSV data as Foreign array:")]), pre([classes(["code-block"])])([code_([text2('import PSD3.Shared.DataLoader (simpleLoadCSV, loadCSV)\nimport Foreign (Foreign)\n\n-- Simple loading with empty array fallback\nrows <- H.liftAff $ simpleLoadCSV "data/population.csv"\n\n-- With error handling\nresult <- H.liftAff $ loadCSV defaultConfig "data/timeseries.csv"\ncase result of\n  Left err -> log (show err)\n  Right rows -> processRows rows')])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Halogen Pattern")]), p_([text2("Common pattern for loading in component initialization:")]), pre([classes(["code-block"])])([code_([text2('data State = { loading :: Boolean, graphData :: Maybe GraphData }\n\nhandleAction = case _ of\n  Initialize -> do\n    H.modify_ _ { loading = true }\n    json <- H.liftAff $ simpleLoadJSON "data/graph.json"\n    let graphData = decodeGraphData json\n    H.modify_ _ { loading = false, graphData = Just graphData }\n\nrender state\n  | state.loading = HH.div_ [ HH.text "Loading..." ]\n  | otherwise = renderVisualization state.graphData')])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Key Points")]), ul_([li_([strong_([text2("Aff-based")]), text2(" - Use H.liftAff to run in Halogen")]), li_([strong_([text2("Strategies")]), text2(" - LocalOnly, RemoteOnly, LocalFirst, RemoteFirst")]), li_([strong_([text2("Error types")]), text2(" - NetworkError, ParseError, FileNotFound, ConfigError")]), li_([strong_([text2("simple* helpers")]), text2(" - Return fallbacks instead of Either")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Real Example")]), p_([text2("See data loading in action:")]), ul_([li_([code_([text2("src/website/Shared/DataLoader.purs")]), text2(" - Full DataLoader module")]), li_([code_([text2("src/website/Component/CodeExplorer/Data.purs")]), text2(" - Loading Spago graph data")])])])])]);
  };
  var handleAction10 = function(dictMonadAff) {
    return function(v) {
      return pure30(unit);
    };
  };
  var component11 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render15,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction10(dictMonadAff),
        initialize: new Just(Initialize11.value)
      })
    });
  };

  // output/Component.HowTo.HowtoPerformance/index.js
  var pure31 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize12 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var render16 = function(v) {
    return div2([classes(["tutorial-page"])])([render5({
      logoSize: Large.value,
      quadrant: QuadHowTo.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("Performance Optimization")]), p_([text2("Tips for fast, smooth visualizations with large datasets.")])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Reduce DOM Elements")]), ul_([li_([strong_([text2("Sample data")]), text2(" - Random sample for preview, full for export")]), li_([strong_([text2("Aggregate")]), text2(" - Bin/group data points")]), li_([strong_([text2("Filter visually")]), text2(" - Hide offscreen elements")]), li_([strong_([text2("Canvas")]), text2(" - Consider d3-canvas for 10k+ elements")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Minimize Updates")]), p_([text2("Batch DOM mutations:")]), pre([classes(["code-block"])])([code_([text2("-- Good: Set multiple attributes at once\nsetAttrs [cx newX, cy newY, fill newColor] circles\n\n-- Avoid: Multiple separate setAttrs calls\n-- Each call triggers layout recalculation")])]), p_([text2("Debounce rapid updates:")]), pre([classes(["code-block"])])([code_([text2("-- Only update after user stops resizing\nwindow.addEventListener('resize', debounce(updateChart, 150))")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Force Simulation Tips")]), ul_([li_([strong_([text2("Minimal tick attrs")]), text2(" - Only update position, not style")]), li_([strong_([text2("Alpha decay")]), text2(" - Higher decay = faster cooldown")]), li_([strong_([text2("Stop when idle")]), text2(" - Call stop() when alpha reaches min")])]), pre([classes(["code-block"])])([code_([text2(`-- Minimal tick: just positions
addTickFunction "nodes" $ Step circles [cx (_.x), cy (_.y)]

-- Don't recalculate colors on every frame!`)])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("CSS vs D3 Transitions")]), p_([text2("CSS transitions are often faster for simple changes:")]), pre([classes(["code-block"])])([code_([text2(".node circle {\n  transition: fill 0.2s ease, opacity 0.2s ease;\n}\n\n/* PSD3 just toggles class, CSS handles animation */\n.node.highlighted circle { fill: #fbbf24; }")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Key Points")]), ul_([li_([strong_([text2("< 1000 elements")]), text2(" - SVG fine, no optimization needed")]), li_([strong_([text2("1000-5000 elements")]), text2(" - Optimize tick functions, batch updates")]), li_([strong_([text2("> 5000 elements")]), text2(" - Consider Canvas, sampling, or aggregation")]), li_([strong_([text2("Profile first")]), text2(" - Use DevTools Performance tab")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Real Example")]), p_([text2("The Code Explorer handles 1400+ nodes smoothly:")]), ul_([li_([code_([text2("src/website/Component/CodeExplorer")]), text2(" - Force graph with many nodes")]), li_([code_([text2("src/website/Viz/Spago/Render.purs")]), text2(" - Efficient render callbacks")])])])])]);
  };
  var handleAction11 = function(dictMonadAff) {
    return function(v) {
      return pure31(unit);
    };
  };
  var component12 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render16,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction11(dictMonadAff),
        initialize: new Just(Initialize12.value)
      })
    });
  };

  // output/Component.HowTo.HowtoTooltips/index.js
  var pure32 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize13 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var render17 = function(v) {
    return div2([classes(["tutorial-page"])])([render5({
      logoSize: Large.value,
      quadrant: QuadHowTo.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("Adding Tooltips & Hover Behaviors")]), p_([text2("PSD3 provides built-in tooltip support. Just provide a function that formats your data as HTML.")])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Basic Tooltip")]), p_([text2("Import the tooltip module and attach behaviors:")]), pre([classes(["code-block"])])([code_([text2('import PSD3v2.Tooltip (onTooltip, onTooltipHide)\n\n-- In your render callback, attach to elements:\n_ <- on (onTooltip \\\\d -> d.name <> ": " <> show d.value) circles\n_ <- on onTooltipHide circles')])]), p_([text2("That's it! The tooltip automatically:")]), ul_([li_([text2("Shows on mouse enter at cursor position")]), li_([text2("Hides on mouse leave")]), li_([text2("Stays within viewport bounds")]), li_([text2("Has sensible default styling")])]), h3_([text2("Custom Styling")]), p_([text2("Override the default styles with CSS:")]), pre([classes(["code-block"])])([code_([text2(".psd3-tooltip {\n  background: #1a1a2e;\n  font-family: monospace;\n}")])]), p_([text2("Or set a custom class:")]), pre([classes(["code-block"])])([code_([text2('import PSD3v2.Tooltip (setTooltipClass)\n\n-- In initialization:\nliftEffect $ setTooltipClass "my-custom-tooltip\\"')])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Advanced: Highlight Connected Elements")]), p_([text2("Combine tooltips with highlighting related elements. This requires a small FFI for D3 class manipulation:")]), h3_([text2("PureScript")]), pre([classes(["code-block"])])([code_([text2("import PSD3v2.Tooltip (onTooltip, hideTooltip)\n\nforeign import highlightConnected_ :: MyNode -> Effect Unit\nforeign import clearHighlights_ :: Effect Unit\n\n-- Combine in hover handlers:\n_ <- on (onMouseEnterWithInfo \\\\info -> do\n  showTooltip (formatContent info.datum) info.pageX info.pageY\n  highlightConnected_ info.datum\n) element\n\n_ <- on (onMouseLeave \\\\_ -> do\n  hideTooltip\n  clearHighlights_\n) element")])]), h3_([text2("JavaScript FFI")]), pre([classes(["code-block"])])([code_([text2("export const highlightConnected_ = node => () => {\n  const connectedIds = new Set([\n    ...node.links.targets,\n    ...node.links.sources\n  ]);\n\n  d3.selectAll('svg g').filter(d => d && d.id)\n    .classed('highlighted', d => connectedIds.has(d.id))\n    .classed('dimmed', d => d.id !== node.id && !connectedIds.has(d.id));\n};\n\nexport const clearHighlights_ = () => {\n  d3.selectAll('.highlighted').classed('highlighted', false);\n  d3.selectAll('.dimmed').classed('dimmed', false);\n};")])]), h3_([text2("CSS")]), pre([classes(["code-block"])])([code_([text2(".highlighted circle {\n  stroke: #fbbf24;\n  filter: drop-shadow(0 0 6px rgba(251, 191, 36, 0.6));\n}\n\n.dimmed { opacity: 0.15; }\n\ng circle { transition: opacity 0.15s ease, stroke 0.15s ease; }")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Key Points")]), ul_([li_([strong_([text2("Use library tooltips")]), text2(" - onTooltip + onTooltipHide")]), li_([strong_([text2("Format function")]), text2(" - Returns HTML string from datum")]), li_([strong_([text2("Combine behaviors")]), text2(" - Tooltip + highlight in same handler")]), li_([strong_([text2("CSS transitions")]), text2(" - Smooth fade/glow effects")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Real Example")]), p_([text2("See the Code Explorer implementation:")]), ul_([li_([code_([text2("src/website/Viz/Spago/Tooltip.js/.purs")]), text2(" - Tooltips with git metrics")]), li_([code_([text2("src/website/Viz/Spago/Highlight.js/.purs")]), text2(" - Connected node highlighting")]), li_([code_([text2("src/website/Viz/Spago/Render.purs:88-96")]), text2(" - Behavior attachment")])])])])]);
  };
  var handleAction12 = function(dictMonadAff) {
    return function(v) {
      return pure32(unit);
    };
  };
  var component13 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render17,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction12(dictMonadAff),
        initialize: new Just(Initialize13.value)
      })
    });
  };

  // output/Component.HowTo.HowtoTransitions/index.js
  var pure33 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize14 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var render18 = function(v) {
    return div2([classes(["tutorial-page"])])([render5({
      logoSize: Large.value,
      quadrant: QuadHowTo.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("Creating Animated Transitions")]), p_([text2("PSD3 provides a TransitionM capability for smooth, animated attribute changes.")])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Basic Transition")]), p_([text2("Animate attributes over a duration:")]), pre([classes(["code-block"])])([code_([text2('import Data.Time.Duration (Milliseconds(..))\nimport PSD3v2.Transition.Types (transition)\nimport PSD3v2.Capabilities.Transition (withTransition)\n\n-- Animate circles to new state over 1 second\nwithTransition (transition (Milliseconds 1000.0)) circles\n  [ fill "orange"\n  , radius 25.0\n  , cx 100.0\n  ]')])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Easing & Delay")]), p_([text2("Add easing functions and delays:")]), pre([classes(["code-block"])])([code_([text2("import PSD3v2.Transition.Types (transitionWith, Easing(..))\n\nlet config = transitionWith\n      { duration: Milliseconds 1500.0\n      , delay: Just (Milliseconds 500.0)\n      , easing: Just ElasticOut\n      }\n\nwithTransition config circles [radius 30.0]")])]), p_([text2("Available easings include: Linear, Cubic, Quad, Sin, Exp, Circle, Elastic, Back, Bounce (each with In/Out/InOut variants).")])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Staggered Animations")]), p_([text2("Animate elements sequentially with per-element delays:")]), pre([classes(["code-block"])])([code_([text2('import PSD3v2.Capabilities.Transition (withTransitionStaggered, staggerByIndex)\n\n-- Each element delays 50ms more than the previous\nwithTransitionStaggered config (staggerByIndex 50.0) bars\n  [ height \\\\d -> d.value * 10.0\n  , fill "steelblue"\n  ]')])]), p_([text2("Custom delay based on data:")]), pre([classes(["code-block"])])([code_([text2("-- Delay based on datum value\nwithTransitionStaggered config (\\\\d _ -> Milliseconds (d.priority * 100.0)) items\n  [ opacity 1.0 ]")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Exit Transitions")]), p_([text2("Animate elements before removal:")]), pre([classes(["code-block"])])([code_([text2("import PSD3v2.Capabilities.Transition (withTransitionExit)\n\n-- Fade out and shrink before removing\nwithTransitionExit (transition (Milliseconds 500.0)) exitSelection\n  [ opacity 0.0\n  , radius 0.0\n  ]")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Key Points")]), ul_([li_([strong_([text2("Type-safe")]), text2(" - Only bound selections can be transitioned")]), li_([strong_([text2("Milliseconds")]), text2(" - All durations use Data.Time.Duration")]), li_([strong_([text2("staggerByIndex")]), text2(" - Helper for simple sequential delays")]), li_([strong_([text2("D3 easings")]), text2(" - Full set of D3's easing functions")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Real Example")]), p_([text2("See these files for transition usage:")]), ul_([li_([code_([text2("src/lib/PSD3v2/Transition/Types.purs")]), text2(" - All easing options")]), li_([code_([text2("src/lib/PSD3v2/Capabilities/Transition.purs")]), text2(" - TransitionM type class")])])])])]);
  };
  var handleAction13 = function(dictMonadAff) {
    return function(v) {
      return pure33(unit);
    };
  };
  var component14 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render18,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction13(dictMonadAff),
        initialize: new Just(Initialize14.value)
      })
    });
  };

  // output/Component.HowTo.HowtoTreeAPI/index.js
  var pure34 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize15 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var render19 = function(v) {
    return div2([classes(["tutorial-page"])])([render5({
      logoSize: Large.value,
      quadrant: QuadHowTo.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("Using the TreeAPI")]), p_([text2("TreeAPI provides a declarative way to build visualization structures with multiple interpreters.")])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("When to Use TreeAPI")]), ul_([li_([text2("Need multiple outputs (D3, String, Mermaid diagram)")]), li_([text2("Want to visualize the tree structure for debugging")]), li_([text2("Building reusable visualization components")]), li_([text2("Working with General Update Pattern")])]), p_([text2("For simple one-off visualizations, SelectionM is simpler.")])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Static Elements")]), p_([text2("Build static DOM structure:")]), pre([classes(["code-block"])])([code_([text2('import PSD3v2.Tree.Types (Tree(..), Element(..), Child(..))\n\nmyTree :: Tree Unit\nmyTree =\n  Tree\n    (Element SVG [viewBox "0 0 800 600"])\n    [ Child $ Tree (Element Group [class_ "chart-area"])\n        [ Child $ Tree (Element Rect [width 100.0, height 50.0]) [] ]\n    ]')])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Data-Driven Elements")]), p_([text2("Use Join for data binding:")]), pre([classes(["code-block"])])([code_([text2('import PSD3v2.Tree.Types (Join(..))\n\nmyTree :: Array BarData -> Tree Unit\nmyTree barData =\n  Tree (Element SVG [viewBox "0 0 800 600"])\n    [ Join barData "bar" Group\n        [ width 20.0\n        , height (\\\\d -> d.value * 10.0)\n        , x (\\\\d i -> toNumber i * 25.0)\n        , fill "steelblue"\n        ]\n    ]')])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Interpreters")]), p_([text2("Same tree, multiple outputs:")]), pre([classes(["code-block"])])([code_([text2("-- Render to D3/DOM\nrunD3Interpreter container myTree\n\n-- Generate Mermaid diagram\nlet mermaidCode = runMermaidInterpreter myTree\n\n-- Generate HTML string\nlet htmlString = runStringInterpreter myTree")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Key Points")]), ul_([li_([strong_([text2("Tree")]), text2(" - Root element with children")]), li_([strong_([text2("Child/Join")]), text2(" - Static vs data-bound children")]), li_([strong_([text2("Interpreters")]), text2(" - Same DSL, multiple backends")]), li_([strong_([text2("Mermaid")]), text2(" - Debug tree structure visually")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Real Example")]), p_([text2("See TreeAPI in action:")]), ul_([li_([code_([text2("src/website/Viz/TreeAPI/LesMisTreeExample.purs")]), text2(" - TreeAPI visualization")]), li_([code_([text2("src/lib/PSD3v2/Tree/Types.purs")]), text2(" - Tree type definitions")])])])])]);
  };
  var handleAction14 = function(dictMonadAff) {
    return function(v) {
      return pure34(unit);
    };
  };
  var component15 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render19,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction14(dictMonadAff),
        initialize: new Just(Initialize15.value)
      })
    });
  };

  // output/Component.HowTo.HowtoTreeExplorer/foreign.js
  var parseFloat2 = (str2) => {
    const n = Number.parseFloat(str2);
    return isNaN(n) ? null : n;
  };
  var setInnerHTML = (element3) => (html2) => () => {
    element3.innerHTML = html2;
  };
  var floor3 = Math.floor;

  // output/Data.String.CodePoints/foreign.js
  var hasArrayFrom = typeof Array.from === "function";
  var hasStringIterator = typeof Symbol !== "undefined" && Symbol != null && typeof Symbol.iterator !== "undefined" && typeof String.prototype[Symbol.iterator] === "function";
  var hasFromCodePoint = typeof String.prototype.fromCodePoint === "function";
  var hasCodePointAt = typeof String.prototype.codePointAt === "function";
  var _unsafeCodePointAt0 = function(fallback) {
    return hasCodePointAt ? function(str2) {
      return str2.codePointAt(0);
    } : fallback;
  };
  var _codePointAt = function(fallback) {
    return function(Just2) {
      return function(Nothing2) {
        return function(unsafeCodePointAt02) {
          return function(index5) {
            return function(str2) {
              var length10 = str2.length;
              if (index5 < 0 || index5 >= length10) return Nothing2;
              if (hasStringIterator) {
                var iter = str2[Symbol.iterator]();
                for (var i2 = index5; ; --i2) {
                  var o = iter.next();
                  if (o.done) return Nothing2;
                  if (i2 === 0) return Just2(unsafeCodePointAt02(o.value));
                }
              }
              return fallback(index5)(str2);
            };
          };
        };
      };
    };
  };
  var _singleton = function(fallback) {
    return hasFromCodePoint ? String.fromCodePoint : fallback;
  };
  var _take = function(fallback) {
    return function(n) {
      if (hasStringIterator) {
        return function(str2) {
          var accum = "";
          var iter = str2[Symbol.iterator]();
          for (var i2 = 0; i2 < n; ++i2) {
            var o = iter.next();
            if (o.done) return accum;
            accum += o.value;
          }
          return accum;
        };
      }
      return fallback(n);
    };
  };
  var _toCodePointArray = function(fallback) {
    return function(unsafeCodePointAt02) {
      if (hasArrayFrom) {
        return function(str2) {
          return Array.from(str2, unsafeCodePointAt02);
        };
      }
      return fallback;
    };
  };

  // output/Data.String.CodePoints/index.js
  var $runtime_lazy9 = function(name16, moduleName, init13) {
    var state3 = 0;
    var val;
    return function(lineNumber) {
      if (state3 === 2) return val;
      if (state3 === 1) throw new ReferenceError(name16 + " was needed before it finished initializing (module " + moduleName + ", line " + lineNumber + ")", moduleName, lineNumber);
      state3 = 1;
      val = init13();
      state3 = 2;
      return val;
    };
  };
  var fromEnum2 = /* @__PURE__ */ fromEnum(boundedEnumChar);
  var map51 = /* @__PURE__ */ map(functorMaybe);
  var unfoldr2 = /* @__PURE__ */ unfoldr(unfoldableArray);
  var div3 = /* @__PURE__ */ div(euclideanRingInt);
  var mod3 = /* @__PURE__ */ mod(euclideanRingInt);
  var compare9 = /* @__PURE__ */ compare(ordInt);
  var unsurrogate = function(lead) {
    return function(trail) {
      return (((lead - 55296 | 0) * 1024 | 0) + (trail - 56320 | 0) | 0) + 65536 | 0;
    };
  };
  var isTrail = function(cu) {
    return 56320 <= cu && cu <= 57343;
  };
  var isLead = function(cu) {
    return 55296 <= cu && cu <= 56319;
  };
  var uncons5 = function(s) {
    var v = length3(s);
    if (v === 0) {
      return Nothing.value;
    }
    ;
    if (v === 1) {
      return new Just({
        head: fromEnum2(charAt(0)(s)),
        tail: ""
      });
    }
    ;
    var cu1 = fromEnum2(charAt(1)(s));
    var cu0 = fromEnum2(charAt(0)(s));
    var $43 = isLead(cu0) && isTrail(cu1);
    if ($43) {
      return new Just({
        head: unsurrogate(cu0)(cu1),
        tail: drop3(2)(s)
      });
    }
    ;
    return new Just({
      head: cu0,
      tail: drop3(1)(s)
    });
  };
  var unconsButWithTuple = function(s) {
    return map51(function(v) {
      return new Tuple(v.head, v.tail);
    })(uncons5(s));
  };
  var toCodePointArrayFallback = function(s) {
    return unfoldr2(unconsButWithTuple)(s);
  };
  var unsafeCodePointAt0Fallback = function(s) {
    var cu0 = fromEnum2(charAt(0)(s));
    var $47 = isLead(cu0) && length3(s) > 1;
    if ($47) {
      var cu1 = fromEnum2(charAt(1)(s));
      var $48 = isTrail(cu1);
      if ($48) {
        return unsurrogate(cu0)(cu1);
      }
      ;
      return cu0;
    }
    ;
    return cu0;
  };
  var unsafeCodePointAt0 = /* @__PURE__ */ _unsafeCodePointAt0(unsafeCodePointAt0Fallback);
  var toCodePointArray = /* @__PURE__ */ _toCodePointArray(toCodePointArrayFallback)(unsafeCodePointAt0);
  var length9 = function($74) {
    return length(toCodePointArray($74));
  };
  var indexOf2 = function(p2) {
    return function(s) {
      return map51(function(i2) {
        return length9(take3(i2)(s));
      })(indexOf(p2)(s));
    };
  };
  var fromCharCode2 = /* @__PURE__ */ (function() {
    var $75 = toEnumWithDefaults(boundedEnumChar)(bottom(boundedChar))(top(boundedChar));
    return function($76) {
      return singleton7($75($76));
    };
  })();
  var singletonFallback = function(v) {
    if (v <= 65535) {
      return fromCharCode2(v);
    }
    ;
    var lead = div3(v - 65536 | 0)(1024) + 55296 | 0;
    var trail = mod3(v - 65536 | 0)(1024) + 56320 | 0;
    return fromCharCode2(lead) + fromCharCode2(trail);
  };
  var singleton11 = /* @__PURE__ */ _singleton(singletonFallback);
  var takeFallback = function(v) {
    return function(v1) {
      if (v < 1) {
        return "";
      }
      ;
      var v2 = uncons5(v1);
      if (v2 instanceof Just) {
        return singleton11(v2.value0.head) + takeFallback(v - 1 | 0)(v2.value0.tail);
      }
      ;
      return v1;
    };
  };
  var take4 = /* @__PURE__ */ _take(takeFallback);
  var splitAt3 = function(i2) {
    return function(s) {
      var before = take4(i2)(s);
      return {
        before,
        after: drop3(length3(before))(s)
      };
    };
  };
  var eqCodePoint = {
    eq: function(x47) {
      return function(y48) {
        return x47 === y48;
      };
    }
  };
  var ordCodePoint = {
    compare: function(x47) {
      return function(y48) {
        return compare9(x47)(y48);
      };
    },
    Eq0: function() {
      return eqCodePoint;
    }
  };
  var drop5 = function(n) {
    return function(s) {
      return drop3(length3(take4(n)(s)))(s);
    };
  };
  var codePointAtFallback = function($copy_n) {
    return function($copy_s) {
      var $tco_var_n = $copy_n;
      var $tco_done = false;
      var $tco_result;
      function $tco_loop(n, s) {
        var v = uncons5(s);
        if (v instanceof Just) {
          var $66 = n === 0;
          if ($66) {
            $tco_done = true;
            return new Just(v.value0.head);
          }
          ;
          $tco_var_n = n - 1 | 0;
          $copy_s = v.value0.tail;
          return;
        }
        ;
        $tco_done = true;
        return Nothing.value;
      }
      ;
      while (!$tco_done) {
        $tco_result = $tco_loop($tco_var_n, $copy_s);
      }
      ;
      return $tco_result;
    };
  };
  var codePointAt = function(v) {
    return function(v1) {
      if (v < 0) {
        return Nothing.value;
      }
      ;
      if (v === 0 && v1 === "") {
        return Nothing.value;
      }
      ;
      if (v === 0) {
        return new Just(unsafeCodePointAt0(v1));
      }
      ;
      return _codePointAt(codePointAtFallback)(Just.create)(Nothing.value)(unsafeCodePointAt0)(v)(v1);
    };
  };
  var boundedCodePoint = {
    bottom: 0,
    top: 1114111,
    Ord0: function() {
      return ordCodePoint;
    }
  };
  var boundedEnumCodePoint = /* @__PURE__ */ (function() {
    return {
      cardinality: 1114111 + 1 | 0,
      fromEnum: function(v) {
        return v;
      },
      toEnum: function(n) {
        if (n >= 0 && n <= 1114111) {
          return new Just(n);
        }
        ;
        if (otherwise) {
          return Nothing.value;
        }
        ;
        throw new Error("Failed pattern match at Data.String.CodePoints (line 63, column 1 - line 68, column 26): " + [n.constructor.name]);
      },
      Bounded0: function() {
        return boundedCodePoint;
      },
      Enum1: function() {
        return $lazy_enumCodePoint(0);
      }
    };
  })();
  var $lazy_enumCodePoint = /* @__PURE__ */ $runtime_lazy9("enumCodePoint", "Data.String.CodePoints", function() {
    return {
      succ: defaultSucc(toEnum(boundedEnumCodePoint))(fromEnum(boundedEnumCodePoint)),
      pred: defaultPred(toEnum(boundedEnumCodePoint))(fromEnum(boundedEnumCodePoint)),
      Ord0: function() {
        return ordCodePoint;
      }
    };
  });

  // output/PSD3.Layout.Hierarchy.Link/index.js
  var show38 = /* @__PURE__ */ show(showNumber);
  var StepHorizontal = /* @__PURE__ */ (function() {
    function StepHorizontal2() {
    }
    ;
    StepHorizontal2.value = new StepHorizontal2();
    return StepHorizontal2;
  })();
  var StepVertical = /* @__PURE__ */ (function() {
    function StepVertical2() {
    }
    ;
    StepVertical2.value = new StepVertical2();
    return StepVertical2;
  })();
  var BezierVertical = /* @__PURE__ */ (function() {
    function BezierVertical2() {
    }
    ;
    BezierVertical2.value = new BezierVertical2();
    return BezierVertical2;
  })();
  var BezierHorizontal = /* @__PURE__ */ (function() {
    function BezierHorizontal2() {
    }
    ;
    BezierHorizontal2.value = new BezierHorizontal2();
    return BezierHorizontal2;
  })();
  var BezierRadial = /* @__PURE__ */ (function() {
    function BezierRadial2() {
    }
    ;
    BezierRadial2.value = new BezierRadial2();
    return BezierRadial2;
  })();
  var Diagonal = /* @__PURE__ */ (function() {
    function Diagonal2() {
    }
    ;
    Diagonal2.value = new Diagonal2();
    return Diagonal2;
  })();
  var linkStepVertical = function(x116) {
    return function(y116) {
      return function(x217) {
        return function(y217) {
          var midY = (y116 + y217) / 2;
          return "M" + (show38(x116) + ("," + (show38(y116) + ("V" + (show38(midY) + ("H" + (show38(x217) + ("V" + show38(y217)))))))));
        };
      };
    };
  };
  var linkStepHorizontal = function(x116) {
    return function(y116) {
      return function(x217) {
        return function(y217) {
          var midX = (x116 + x217) / 2;
          return "M" + (show38(x116) + ("," + (show38(y116) + ("H" + (show38(midX) + ("V" + (show38(y217) + ("H" + show38(x217)))))))));
        };
      };
    };
  };
  var linkDiagonal2 = function(x116) {
    return function(y116) {
      return function(x217) {
        return function(y217) {
          return "M" + (show38(x116) + ("," + (show38(y116) + ("L" + (show38(x217) + ("," + show38(y217)))))));
        };
      };
    };
  };
  var linkBezierVertical = function(x116) {
    return function(y116) {
      return function(x217) {
        return function(y217) {
          var midY = (y116 + y217) / 2;
          return "M" + (show38(x116) + ("," + (show38(y116) + ("C" + (show38(x116) + ("," + (show38(midY) + (" " + (show38(x217) + ("," + (show38(midY) + (" " + (show38(x217) + ("," + show38(y217)))))))))))))));
        };
      };
    };
  };
  var linkBezierRadial = function(x116) {
    return function(y116) {
      return function(x217) {
        return function(y217) {
          var cr1 = (y116 + y217) / 2;
          var angle2 = (x217 - 90) * pi / 180;
          var cx210 = cr1 * cos(angle2);
          var cy210 = cr1 * sin(angle2);
          var tx = y217 * cos(angle2);
          var ty = y217 * sin(angle2);
          var angle1 = (x116 - 90) * pi / 180;
          var cx112 = cr1 * cos(angle1);
          var cy112 = cr1 * sin(angle1);
          var sx = y116 * cos(angle1);
          var sy = y116 * sin(angle1);
          return "M" + (show38(sx) + ("," + (show38(sy) + ("C" + (show38(cx112) + ("," + (show38(cy112) + (" " + (show38(cx210) + ("," + (show38(cy210) + (" " + (show38(tx) + ("," + show38(ty)))))))))))))));
        };
      };
    };
  };
  var linkBezierHorizontal = function(x116) {
    return function(y116) {
      return function(x217) {
        return function(y217) {
          var midX = (x116 + x217) / 2;
          return "M" + (show38(x116) + ("," + (show38(y116) + ("C" + (show38(midX) + ("," + (show38(y116) + (" " + (show38(midX) + ("," + (show38(y217) + (" " + (show38(x217) + ("," + show38(y217)))))))))))))));
        };
      };
    };
  };
  var linkGenerator = function(v) {
    if (v instanceof StepHorizontal) {
      return linkStepHorizontal;
    }
    ;
    if (v instanceof StepVertical) {
      return linkStepVertical;
    }
    ;
    if (v instanceof BezierVertical) {
      return linkBezierVertical;
    }
    ;
    if (v instanceof BezierHorizontal) {
      return linkBezierHorizontal;
    }
    ;
    if (v instanceof BezierRadial) {
      return linkBezierRadial;
    }
    ;
    if (v instanceof Diagonal) {
      return linkDiagonal2;
    }
    ;
    throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Link (line 104, column 1 - line 104, column 79): " + [v.constructor.name]);
  };
  var eqLinkStyle = {
    eq: function(x47) {
      return function(y48) {
        if (x47 instanceof StepHorizontal && y48 instanceof StepHorizontal) {
          return true;
        }
        ;
        if (x47 instanceof StepVertical && y48 instanceof StepVertical) {
          return true;
        }
        ;
        if (x47 instanceof BezierVertical && y48 instanceof BezierVertical) {
          return true;
        }
        ;
        if (x47 instanceof BezierHorizontal && y48 instanceof BezierHorizontal) {
          return true;
        }
        ;
        if (x47 instanceof BezierRadial && y48 instanceof BezierRadial) {
          return true;
        }
        ;
        if (x47 instanceof Diagonal && y48 instanceof Diagonal) {
          return true;
        }
        ;
        return false;
      };
    }
  };

  // output/Component.HowTo.HowtoTreeExplorer/index.js
  var add4 = /* @__PURE__ */ add(semiringNumber);
  var bind32 = /* @__PURE__ */ bind(bindList);
  var append21 = /* @__PURE__ */ append(semigroupList);
  var fromFoldable36 = /* @__PURE__ */ fromFoldable(foldableList);
  var append112 = /* @__PURE__ */ append(semigroupArray);
  var eq7 = /* @__PURE__ */ eq(eqLinkStyle);
  var show39 = /* @__PURE__ */ show(showNumber);
  var type_19 = /* @__PURE__ */ type_3(isPropInputType);
  var value14 = /* @__PURE__ */ value3(isPropString);
  var sortWith2 = /* @__PURE__ */ sortWith(ordNumber);
  var foldl13 = /* @__PURE__ */ foldl(foldableArray);
  var insertWith2 = /* @__PURE__ */ insertWith(ordInt);
  var fromEnum3 = /* @__PURE__ */ fromEnum(boundedEnumCodePoint);
  var discard26 = /* @__PURE__ */ discard(discardUnit);
  var bind211 = /* @__PURE__ */ bind(bindD3v2M);
  var select11 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var map52 = /* @__PURE__ */ map(functorTree);
  var fromFoldable113 = /* @__PURE__ */ fromFoldable(foldableTree);
  var discard27 = /* @__PURE__ */ discard26(bindD3v2M);
  var liftEffect18 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var show119 = /* @__PURE__ */ show(showInt);
  var width20 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height20 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox14 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var class_17 = /* @__PURE__ */ class_2(toAttrStringString);
  var d9 = /* @__PURE__ */ d4(toAttrStringString);
  var fill18 = /* @__PURE__ */ fill3(toAttrStringString);
  var stroke10 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth10 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var renderTree17 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D);
  var ordRecord5 = /* @__PURE__ */ ordRecord();
  var ordRecordCons5 = /* @__PURE__ */ ordRecordCons(ordRecordNil)();
  var ordRecordCons13 = /* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons5({
    reflectSymbol: function() {
      return "y";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "x";
    }
  })(ordNumber);
  var ordRecord13 = /* @__PURE__ */ ordRecord5(ordRecordCons13);
  var renderTree18 = /* @__PURE__ */ renderTree17(/* @__PURE__ */ ordRecord5(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons5({
    reflectSymbol: function() {
      return "target";
    }
  })(ordRecord13))()({
    reflectSymbol: function() {
      return "source";
    }
  })(ordRecord13)));
  var cx11 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy11 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius12 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var strokeOpacity2 = /* @__PURE__ */ strokeOpacity(toAttrNumberNumber);
  var renderTree26 = /* @__PURE__ */ renderTree17(/* @__PURE__ */ ordRecord5(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordCons13)()({
    reflectSymbol: function() {
      return "value";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "radius";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "name";
    }
  })(ordString))()({
    reflectSymbol: function() {
      return "height";
    }
  })(ordInt))()({
    reflectSymbol: function() {
      return "depth";
    }
  })(ordInt)));
  var pure112 = /* @__PURE__ */ pure(applicativeD3v2M);
  var discard32 = /* @__PURE__ */ discard26(bindHalogenM);
  var bind33 = /* @__PURE__ */ bind(bindHalogenM);
  var modify_8 = /* @__PURE__ */ modify_2(monadStateHalogenM);
  var get12 = /* @__PURE__ */ get(monadStateHalogenM);
  var pure210 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Linear2 = /* @__PURE__ */ (function() {
    function Linear3() {
    }
    ;
    Linear3.value = new Linear3();
    return Linear3;
  })();
  var SquareRoot = /* @__PURE__ */ (function() {
    function SquareRoot2() {
    }
    ;
    SquareRoot2.value = new SquareRoot2();
    return SquareRoot2;
  })();
  var Logarithmic = /* @__PURE__ */ (function() {
    function Logarithmic2() {
    }
    ;
    Logarithmic2.value = new Logarithmic2();
    return Logarithmic2;
  })();
  var Exponential2 = /* @__PURE__ */ (function() {
    function Exponential3() {
    }
    ;
    Exponential3.value = new Exponential3();
    return Exponential3;
  })();
  var Custom = /* @__PURE__ */ (function() {
    function Custom2() {
    }
    ;
    Custom2.value = new Custom2();
    return Custom2;
  })();
  var Initialize16 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var SetMinSeparation = /* @__PURE__ */ (function() {
    function SetMinSeparation2(value0) {
      this.value0 = value0;
    }
    ;
    SetMinSeparation2.create = function(value0) {
      return new SetMinSeparation2(value0);
    };
    return SetMinSeparation2;
  })();
  var SetLayerScalePreset = /* @__PURE__ */ (function() {
    function SetLayerScalePreset2(value0) {
      this.value0 = value0;
    }
    ;
    SetLayerScalePreset2.create = function(value0) {
      return new SetLayerScalePreset2(value0);
    };
    return SetLayerScalePreset2;
  })();
  var SetExponent = /* @__PURE__ */ (function() {
    function SetExponent2(value0) {
      this.value0 = value0;
    }
    ;
    SetExponent2.create = function(value0) {
      return new SetExponent2(value0);
    };
    return SetExponent2;
  })();
  var SetLinkStyle = /* @__PURE__ */ (function() {
    function SetLinkStyle2(value0) {
      this.value0 = value0;
    }
    ;
    SetLinkStyle2.create = function(value0) {
      return new SetLinkStyle2(value0);
    };
    return SetLinkStyle2;
  })();
  var Redraw = /* @__PURE__ */ (function() {
    function Redraw2() {
    }
    ;
    Redraw2.value = new Redraw2();
    return Redraw2;
  })();
  var radiusSeparation = function(a2) {
    return function(b10) {
      return a2.radius + b10.radius + 0.5;
    };
  };
  var parseNumber = function($$default) {
    return function(str2) {
      return fromMaybe($$default)(parseFloat2(str2));
    };
  };
  var makeLinks3 = function(tree$prime) {
    var makeLinksList = function(v) {
      var grandchildLinks = bind32(v.value1)(makeLinksList);
      var childLinks = bind32(v.value1)(function(v1) {
        return new Cons({
          source: {
            x: v.value0.x,
            y: v.value0.y
          },
          target: {
            x: v1.value0.x,
            y: v1.value0.y
          }
        }, Nil.value);
      });
      return append21(childLinks)(grandchildLinks);
    };
    return fromFoldable36(makeLinksList(tree$prime));
  };
  var linkStyleButton = function(style3) {
    return function(label5) {
      return function(current) {
        return button([classes(append112(["preset-btn"])((function() {
          var $134 = eq7(style3)(current);
          if ($134) {
            return ["active"];
          }
          ;
          return [];
        })())), onClick(function(v) {
          return new SetLinkStyle(style3);
        })])([text2(label5)]);
      };
    };
  };
  var initialState = function(v) {
    return {
      flareData: Nothing.value,
      minSeparation: 1,
      layerScalePreset: Linear2.value,
      exponent: 1.5,
      linkStyle: BezierVertical.value,
      error: Nothing.value
    };
  };
  var getLayerScaleFn = function(preset) {
    return function(exponent) {
      return function(depth) {
        var d1 = toNumber(depth);
        if (preset instanceof Linear2) {
          return d1;
        }
        ;
        if (preset instanceof SquareRoot) {
          return sqrt(d1);
        }
        ;
        if (preset instanceof Logarithmic) {
          return log(d1 + 1);
        }
        ;
        if (preset instanceof Exponential2) {
          return pow(d1)(exponent);
        }
        ;
        if (preset instanceof Custom) {
          return d1;
        }
        ;
        throw new Error("Failed pattern match at Component.HowTo.HowtoTreeExplorer (line 363, column 6 - line 368, column 16): " + [preset.constructor.name]);
      };
    };
  };
  var eqLayerScalePreset = {
    eq: function(x47) {
      return function(y48) {
        if (x47 instanceof Linear2 && y48 instanceof Linear2) {
          return true;
        }
        ;
        if (x47 instanceof SquareRoot && y48 instanceof SquareRoot) {
          return true;
        }
        ;
        if (x47 instanceof Logarithmic && y48 instanceof Logarithmic) {
          return true;
        }
        ;
        if (x47 instanceof Exponential2 && y48 instanceof Exponential2) {
          return true;
        }
        ;
        if (x47 instanceof Custom && y48 instanceof Custom) {
          return true;
        }
        ;
        return false;
      };
    }
  };
  var eq23 = /* @__PURE__ */ eq(eqLayerScalePreset);
  var presetButton = function(preset) {
    return function(label5) {
      return function(current) {
        return button([classes(append112(["preset-btn"])((function() {
          var $138 = eq23(preset)(current);
          if ($138) {
            return ["active"];
          }
          ;
          return [];
        })())), onClick(function(v) {
          return new SetLayerScalePreset(preset);
        })])([text2(label5)]);
      };
    };
  };
  var render20 = function(state3) {
    return div2([classes(["tutorial-page", "tree-explorer"])])([render5({
      logoSize: Large.value,
      quadrant: QuadHowTo.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), h1_([text2("Tree Layout Explorer")]), p_([text2("Experiment with tree layout configuration options. Adjust the controls below to see how they affect the Reingold-Tilford tree layout algorithm.")]), (function() {
      if (state3.error instanceof Just) {
        return div2([classes(["error"])])([text2(state3.error.value0)]);
      }
      ;
      if (state3.error instanceof Nothing) {
        return text2("");
      }
      ;
      throw new Error("Failed pattern match at Component.HowTo.HowtoTreeExplorer (line 387, column 7 - line 389, column 30): " + [state3.error.constructor.name]);
    })(), div2([classes(["tree-explorer-controls"])])([div2([classes(["control-group"])])([label_([text2("Min Separation: " + show39(state3.minSeparation))]), input([type_19(InputRange.value), min4(0.1), max4(5), step3(new Step(0.1)), value14(show39(state3.minSeparation)), onValueInput((function() {
      var $177 = parseNumber(1);
      return function($178) {
        return SetMinSeparation.create($177($178));
      };
    })())])]), div2([classes(["control-group"])])([label_([text2("Layer Scale:")]), div2([classes(["button-group"])])([presetButton(Linear2.value)("Linear")(state3.layerScalePreset), presetButton(SquareRoot.value)("\u221A Sqrt")(state3.layerScalePreset), presetButton(Logarithmic.value)("Log")(state3.layerScalePreset), presetButton(Exponential2.value)("d^n")(state3.layerScalePreset)])]), (function() {
      var $141 = eq23(state3.layerScalePreset)(Exponential2.value);
      if ($141) {
        return div2([classes(["control-group"])])([label_([text2("Exponent: " + show39(state3.exponent))]), input([type_19(InputRange.value), min4(0.5), max4(3), step3(new Step(0.1)), value14(show39(state3.exponent)), onValueInput((function() {
          var $179 = parseNumber(1.5);
          return function($180) {
            return SetExponent.create($179($180));
          };
        })())])]);
      }
      ;
      return text2("");
    })(), div2([classes(["control-group"])])([label_([text2("Link Style:")]), div2([classes(["button-group"])])([linkStyleButton(StepVertical.value)("Step V")(state3.linkStyle), linkStyleButton(StepHorizontal.value)("Step H")(state3.linkStyle), linkStyleButton(BezierVertical.value)("Bezier V")(state3.linkStyle), linkStyleButton(BezierHorizontal.value)("Bezier H")(state3.linkStyle), linkStyleButton(Diagonal.value)("Diagonal")(state3.linkStyle)])])]), div2([id3("tree-explorer-viz"), classes(["viz-container"])])([])]);
  };
  var computeScaleFactor = function(minSep) {
    return function(nodes) {
      var computePairScale = function(v) {
        var pixelDist = v.value1.x - v.value0.x;
        var expectedSep = radiusSeparation(v.value0)(v.value1) + minSep;
        var $143 = pixelDist > 1 && expectedSep > 0.01;
        if ($143) {
          return new Just(pixelDist / expectedSep);
        }
        ;
        return Nothing.value;
      };
      var getScaleSamples = function(depthNodes) {
        var sorted = sortWith2(function(v) {
          return v.x;
        })(depthNodes);
        var pairs = zip(sorted)(drop(1)(sorted));
        return mapMaybe(computePairScale)(pairs);
      };
      var grouped = foldl13(function(m) {
        return function(n) {
          return insertWith2(append112)(n.depth)([n])(m);
        };
      })(empty3)(nodes);
      var samples = concatMap(getScaleSamples)(fromFoldable36(values(grouped)));
      var avgScale = (function() {
        var $146 = length(samples) === 0;
        if ($146) {
          return 5;
        }
        ;
        return foldl13(add4)(0)(samples) / toNumber(length(samples));
      })();
      return avgScale;
    };
  };
  var computeRadius = function(node) {
    var charCode = maybe(0)(fromEnum3)(codePointAt(0)(node.name));
    var hash2 = toNumber(length9(node.name)) + toNumber(charCode);
    var base2 = hash2 - floor3(hash2 / 4) * 4 + 1;
    return base2 * 0.5 + 0.5;
  };
  var computeColor = function(node) {
    var charCode = maybe(65)(fromEnum3)(codePointAt(1)(node.name));
    var hue = toNumber(charCode * 7 | 0) - floor3(toNumber(charCode * 7 | 0) / 360) * 360;
    return "hsl(" + (show39(hue) + ", 70%, 50%)");
  };
  var clearContainer = function(selector) {
    return function __do3() {
      var win = windowImpl();
      var doc = document2(win)();
      var maybeEl = querySelector(selector)(toParentNode2(doc))();
      if (maybeEl instanceof Nothing) {
        return unit;
      }
      ;
      if (maybeEl instanceof Just) {
        return setInnerHTML(maybeEl.value0)("")();
      }
      ;
      throw new Error("Failed pattern match at Component.HowTo.HowtoTreeExplorer (line 251, column 3 - line 253, column 34): " + [maybeEl.constructor.name]);
    };
  };
  var addRadius = function(node) {
    return {
      name: node.name,
      value: node.value,
      x: node.x,
      y: node.y,
      depth: node.depth,
      height: node.height,
      radius: computeRadius(node)
    };
  };
  var drawTreeExplorer = function(selector) {
    return function(state3) {
      return function(flareTree) {
        return function __do3() {
          clearContainer(selector)();
          return runD3v2M(bind211(select11(selector))(function(container) {
            var treeWithRadius = map52(addRadius)(flareTree);
            var layerScaleFn = getLayerScaleFn(state3.layerScalePreset)(state3.exponent);
            var config = {
              size: {
                width: 800 - 2 * 40,
                height: 600 - 2 * 40
              },
              minSeparation: state3.minSeparation,
              layerScale: new Just(layerScaleFn),
              separation: new Just(radiusSeparation)
            };
            var linkPathFn = linkGenerator(state3.linkStyle);
            var positioned = tree2(config)(treeWithRadius);
            var nodes = fromFoldable113(positioned);
            var links = makeLinks3(positioned);
            var radiusScale = computeScaleFactor(state3.minSeparation)(nodes);
            return discard27(liftEffect18(log2("TreeExplorer: " + (show119(length(nodes)) + (" nodes, minSep=" + (show39(state3.minSeparation) + (", radiusScale=" + show39(radiusScale))))))))(function() {
              var linksTree = withChild(named2(SVG.value)("svg")([width20(800), height20(600), viewBox14("0 0 " + (show39(800) + (" " + show39(600)))), class_17("tree-explorer-svg")]))(withChild(named2(Group2.value)("chartGroup")([class_17("tree-content")]))(withChild(named2(Group2.value)("linksGroup")([class_17("links")]))(joinData2("links")("path")(links)(function(link4) {
                return elem4(Path3.value)([d9(linkPathFn(link4.source.x + 40)(link4.source.y + 40)(link4.target.x + 40)(link4.target.y + 40)), fill18("none"), stroke10("#555"), strokeWidth10(1.5), class_17("link")]);
              }))));
              return bind211(renderTree18(container)(linksTree))(function(linksSelections) {
                return bind211(liftEffect18(reselectD3v2("chartGroup")(linksSelections)))(function(chartGroupSel) {
                  var nodesTree = withChild(named2(Group2.value)("nodesGroup")([class_17("nodes")]))(joinData2("nodeGroups")("g")(nodes)(function(node) {
                    return elem4(Circle2.value)([cx11(node.x + 40), cy11(node.y + 40), radius12(node.radius * radiusScale), fill18(computeColor(node)), stroke10("none"), strokeOpacity2(0), class_17("node")]);
                  }));
                  return bind211(renderTree26(chartGroupSel)(nodesTree))(function() {
                    return pure112(unit);
                  });
                });
              });
            });
          }))();
        };
      };
    };
  };
  var handleAction15 = function(dictMonadAff) {
    var liftAff3 = liftAff(monadAffHalogenM(dictMonadAff));
    var liftEffect121 = liftEffect(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    return function(v) {
      if (v instanceof Initialize16) {
        return discard32(liftAff3(delay(100)))(function() {
          return bind33(liftAff3(loadFlareData))(function(result) {
            if (result instanceof Left) {
              return modify_8(function(v1) {
                var $151 = {};
                for (var $152 in v1) {
                  if ({}.hasOwnProperty.call(v1, $152)) {
                    $151[$152] = v1[$152];
                  }
                  ;
                }
                ;
                $151.error = new Just(result.value0);
                return $151;
              });
            }
            ;
            if (result instanceof Right) {
              return discard32(modify_8(function(v1) {
                var $155 = {};
                for (var $156 in v1) {
                  if ({}.hasOwnProperty.call(v1, $156)) {
                    $155[$156] = v1[$156];
                  }
                  ;
                }
                ;
                $155.flareData = new Just(result.value0);
                $155.error = Nothing.value;
                return $155;
              }))(function() {
                return bind33(get12)(function(state3) {
                  return liftEffect121(drawTreeExplorer("#tree-explorer-viz")(state3)(result.value0));
                });
              });
            }
            ;
            throw new Error("Failed pattern match at Component.HowTo.HowtoTreeExplorer (line 192, column 5 - line 198, column 70): " + [result.constructor.name]);
          });
        });
      }
      ;
      if (v instanceof SetMinSeparation) {
        return discard32(modify_8(function(v1) {
          var $159 = {};
          for (var $160 in v1) {
            if ({}.hasOwnProperty.call(v1, $160)) {
              $159[$160] = v1[$160];
            }
            ;
          }
          ;
          $159.minSeparation = v.value0;
          return $159;
        }))(function() {
          return handleAction15(dictMonadAff)(Redraw.value);
        });
      }
      ;
      if (v instanceof SetLayerScalePreset) {
        return discard32(modify_8(function(v1) {
          var $163 = {};
          for (var $164 in v1) {
            if ({}.hasOwnProperty.call(v1, $164)) {
              $163[$164] = v1[$164];
            }
            ;
          }
          ;
          $163.layerScalePreset = v.value0;
          return $163;
        }))(function() {
          return handleAction15(dictMonadAff)(Redraw.value);
        });
      }
      ;
      if (v instanceof SetExponent) {
        return discard32(modify_8(function(v1) {
          var $167 = {};
          for (var $168 in v1) {
            if ({}.hasOwnProperty.call(v1, $168)) {
              $167[$168] = v1[$168];
            }
            ;
          }
          ;
          $167.exponent = v.value0;
          return $167;
        }))(function() {
          return handleAction15(dictMonadAff)(Redraw.value);
        });
      }
      ;
      if (v instanceof SetLinkStyle) {
        return discard32(modify_8(function(v1) {
          var $171 = {};
          for (var $172 in v1) {
            if ({}.hasOwnProperty.call(v1, $172)) {
              $171[$172] = v1[$172];
            }
            ;
          }
          ;
          $171.linkStyle = v.value0;
          return $171;
        }))(function() {
          return handleAction15(dictMonadAff)(Redraw.value);
        });
      }
      ;
      if (v instanceof Redraw) {
        return bind33(get12)(function(state3) {
          if (state3.flareData instanceof Nothing) {
            return pure210(unit);
          }
          ;
          if (state3.flareData instanceof Just) {
            return liftEffect121(drawTreeExplorer("#tree-explorer-viz")(state3)(state3.flareData.value0));
          }
          ;
          throw new Error("Failed pattern match at Component.HowTo.HowtoTreeExplorer (line 218, column 5 - line 220, column 81): " + [state3.flareData.constructor.name]);
        });
      }
      ;
      throw new Error("Failed pattern match at Component.HowTo.HowtoTreeExplorer (line 185, column 16 - line 220, column 81): " + [v.constructor.name]);
    };
  };
  var component16 = function(dictMonadAff) {
    return mkComponent({
      initialState,
      render: render20,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction15(dictMonadAff),
        initialize: new Just(Initialize16.value)
      })
    });
  };

  // output/D3.Viz.LesMis.LesMisRenderCallbacks/index.js
  var cx13 = /* @__PURE__ */ cx3(toAttrNumberFunctionNumbe);
  var cy13 = /* @__PURE__ */ cy3(toAttrNumberFunctionNumbe);
  var radius13 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill19 = /* @__PURE__ */ fill3(toAttrStringFunctionStrin);
  var stroke11 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth11 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var fill110 = /* @__PURE__ */ fill3(toAttrStringString);
  var strokeWidth12 = /* @__PURE__ */ strokeWidth3(toAttrNumberFunctionNumbe);
  var stroke12 = /* @__PURE__ */ stroke(toAttrStringFunctionStrin);
  var x14 = /* @__PURE__ */ x1(toAttrNumberFunctionNumbe);
  var y14 = /* @__PURE__ */ y1(toAttrNumberFunctionNumbe);
  var x25 = /* @__PURE__ */ x22(toAttrNumberFunctionNumbe);
  var y25 = /* @__PURE__ */ y22(toAttrNumberFunctionNumbe);
  var lesMisRenderCallbacks = function(dictMonad) {
    var bind87 = bind(dictMonad.Bind1());
    var pure91 = pure(dictMonad.Applicative0());
    return function(dictSelectionM) {
      var append34 = append10(dictSelectionM);
      var on14 = on2(dictSelectionM);
      var setAttrs6 = setAttrs(dictSelectionM);
      var setAttrsExit4 = setAttrsExit(dictSelectionM);
      var remove9 = remove3(dictSelectionM);
      return {
        onNodeEnter: function(enterSel) {
          return function(_attrs) {
            return bind87(append34(Circle2.value)([cx13(function(v) {
              return v.x;
            }), cy13(function(v) {
              return v.y;
            }), radius13(5), fill19(function(v) {
              return d3SchemeCategory10N_(toNumber(v.group));
            }), stroke11("#fff"), strokeWidth11(2)])(enterSel))(function(nodeEnter) {
              return bind87(on14(new Drag2(simulationDrag("lesmis")))(nodeEnter))(function() {
                return pure91(nodeEnter);
              });
            });
          };
        },
        onNodeUpdate: function(updateSel) {
          return function(_attrs) {
            return bind87(setAttrs6([fill19(function(v) {
              return d3SchemeCategory10N_(toNumber(v.group));
            })])(updateSel))(function() {
              return pure91(unit);
            });
          };
        },
        onNodeExit: function(exitSel) {
          return bind87(setAttrsExit4([fill110("gray"), stroke11("black")])(exitSel))(function() {
            return remove9(exitSel);
          });
        },
        onLinkEnter: function(enterSel) {
          return function(_attrs) {
            return append34(Line2.value)([strokeWidth12(function(v) {
              return sqrt(v.value);
            }), stroke12(function(v) {
              return d3SchemeCategory10N_(toNumber(v.target.group));
            })])(enterSel);
          };
        },
        onLinkUpdate: function(updateSel) {
          return function(_attrs) {
            return bind87(setAttrs6([stroke12(function(v) {
              return d3SchemeCategory10N_(toNumber(v.target.group));
            })])(updateSel))(function() {
              return pure91(unit);
            });
          };
        },
        onLinkExit: function(exitSel) {
          return remove9(exitSel);
        },
        nodeTickAttrs: function(_attrs) {
          return [cx13(function(v) {
            return v.x;
          }), cy13(function(v) {
            return v.y;
          })];
        },
        linkTickAttrs: [x14(function(v) {
          return v.source.x;
        }), y14(function(v) {
          return v.source.y;
        }), x25(function(v) {
          return v.target.x;
        }), y25(function(v) {
          return v.target.y;
        })]
      };
    };
  };
  var defaultLesMisAttributes = {};

  // output/PSD3v2.Transition.Scene/index.js
  var TransitionMove = /* @__PURE__ */ (function() {
    function TransitionMove2() {
    }
    ;
    TransitionMove2.value = new TransitionMove2();
    return TransitionMove2;
  })();
  var InstantMove = /* @__PURE__ */ (function() {
    function InstantMove2() {
    }
    ;
    InstantMove2.value = new InstantMove2();
    return InstantMove2;
  })();
  var FadeOut = /* @__PURE__ */ (function() {
    function FadeOut2() {
    }
    ;
    FadeOut2.value = new FadeOut2();
    return FadeOut2;
  })();
  var ScaleDown = /* @__PURE__ */ (function() {
    function ScaleDown2() {
    }
    ;
    ScaleDown2.value = new ScaleDown2();
    return ScaleDown2;
  })();
  var InstantExit = /* @__PURE__ */ (function() {
    function InstantExit2() {
    }
    ;
    InstantExit2.value = new InstantExit2();
    return InstantExit2;
  })();
  var FadeIn = /* @__PURE__ */ (function() {
    function FadeIn2() {
    }
    ;
    FadeIn2.value = new FadeIn2();
    return FadeIn2;
  })();
  var ScaleUp = /* @__PURE__ */ (function() {
    function ScaleUp2() {
    }
    ;
    ScaleUp2.value = new ScaleUp2();
    return ScaleUp2;
  })();
  var InstantEnter = /* @__PURE__ */ (function() {
    function InstantEnter2() {
    }
    ;
    InstantEnter2.value = new InstantEnter2();
    return InstantEnter2;
  })();
  var smoothTransitionPinned = /* @__PURE__ */ (function() {
    return {
      duration: 1500,
      enterNodes: FadeIn.value,
      exitNodes: FadeOut.value,
      updateNodes: TransitionMove.value,
      pinAfterTransition: true
    };
  })();
  var smoothTransition = /* @__PURE__ */ (function() {
    return {
      duration: 1500,
      enterNodes: FadeIn.value,
      exitNodes: FadeOut.value,
      updateNodes: TransitionMove.value,
      pinAfterTransition: false
    };
  })();
  var encodeUpdateBehavior = function(v) {
    if (v instanceof TransitionMove) {
      return "TransitionMove";
    }
    ;
    if (v instanceof InstantMove) {
      return "InstantMove";
    }
    ;
    throw new Error("Failed pattern match at PSD3v2.Transition.Scene (line 59, column 1 - line 59, column 49): " + [v.constructor.name]);
  };
  var encodeExitBehavior = function(v) {
    if (v instanceof FadeOut) {
      return "FadeOut";
    }
    ;
    if (v instanceof ScaleDown) {
      return "ScaleDown";
    }
    ;
    if (v instanceof InstantExit) {
      return "InstantExit";
    }
    ;
    throw new Error("Failed pattern match at PSD3v2.Transition.Scene (line 54, column 1 - line 54, column 45): " + [v.constructor.name]);
  };
  var encodeEnterBehavior = function(v) {
    if (v instanceof FadeIn) {
      return "FadeIn";
    }
    ;
    if (v instanceof ScaleUp) {
      return "ScaleUp";
    }
    ;
    if (v instanceof InstantEnter) {
      return "InstantEnter";
    }
    ;
    throw new Error("Failed pattern match at PSD3v2.Transition.Scene (line 49, column 1 - line 49, column 47): " + [v.constructor.name]);
  };

  // output/D3.Viz.LesMis.LesMisScenes/index.js
  var mapFlipped10 = /* @__PURE__ */ mapFlipped(functorArray);
  var unpinAllNodes2 = function(nodes) {
    return mapFlipped10(nodes)(function(node) {
      var $11 = {};
      for (var $12 in node) {
        if ({}.hasOwnProperty.call(node, $12)) {
          $11[$12] = node[$12];
        }
        ;
      }
      ;
      $11.fx = toNullable(Nothing.value);
      $11.fy = toNullable(Nothing.value);
      return $11;
    });
  };
  var numberToGridPoint2 = function(columns) {
    return function(i2) {
      var d18 = toNumber(i2);
      var c = toNumber(columns);
      var x47 = remainder(d18)(c);
      var y48 = floor(d18 / c);
      return {
        x: x47,
        y: y48
      };
    };
  };
  var setGridPositions = function(gridSpacing) {
    return function(nodes) {
      var nodeCount = length(nodes);
      var columns = floor2(ceil(sqrt(toNumber(nodeCount))));
      var offset = -(toNumber(columns) * gridSpacing) / 2;
      var setPosition = function(i2) {
        return function(node) {
          var gridPt = numberToGridPoint2(columns)(i2);
          var newX = gridPt.x * gridSpacing + offset;
          var newY = gridPt.y * gridSpacing + offset;
          var $14 = {};
          for (var $15 in node) {
            if ({}.hasOwnProperty.call(node, $15)) {
              $14[$15] = node[$15];
            }
            ;
          }
          ;
          $14.x = newX;
          $14.y = newY;
          $14.fx = toNullable(new Just(newX));
          $14.fy = toNullable(new Just(newY));
          return $14;
        };
      };
      return mapWithIndex2(setPosition)(nodes);
    };
  };
  var initialRadius3 = 10;
  var initialAngle3 = /* @__PURE__ */ (function() {
    return pi * (3 - sqrt(5));
  })();
  var setPhyllotaxisInitialPositions = function(nodes) {
    var setPosition = function(index5) {
      return function(node) {
        var i2 = toNumber(index5);
        var rad = initialRadius3 * sqrt(0.5 + i2);
        var angle = i2 * initialAngle3;
        var newX = rad * cos(angle);
        var newY = rad * sin(angle);
        var $17 = {};
        for (var $18 in node) {
          if ({}.hasOwnProperty.call(node, $18)) {
            $17[$18] = node[$18];
          }
          ;
        }
        ;
        $17.x = newX;
        $17.y = newY;
        return $17;
      };
    };
    return mapWithIndex2(setPosition)(nodes);
  };
  var setPhyllotaxisPositions2 = function(nodes) {
    var setPosition = function(index5) {
      return function(node) {
        var i2 = toNumber(index5);
        var rad = initialRadius3 * sqrt(0.5 + i2);
        var angle = i2 * initialAngle3;
        var newX = rad * cos(angle);
        var newY = rad * sin(angle);
        var $20 = {};
        for (var $21 in node) {
          if ({}.hasOwnProperty.call(node, $21)) {
            $20[$21] = node[$21];
          }
          ;
        }
        ;
        $20.x = newX;
        $20.y = newY;
        $20.fx = toNullable(new Just(newX));
        $20.fy = toNullable(new Just(newY));
        return $20;
      };
    };
    return mapWithIndex2(setPosition)(nodes);
  };
  var phylotaxisScene = /* @__PURE__ */ (function() {
    return {
      chooseNodes: $$const(true),
      linksShown: $$const(true),
      linksActive: $$const(false),
      cssClass: "phylotaxis-layout",
      attributes: defaultLesMisAttributes,
      activeForces: empty8,
      nodeInitializerFunctions: [setPhyllotaxisPositions2],
      transitionConfig: new Just(smoothTransitionPinned)
    };
  })();
  var gridScene = function(gridSpacing) {
    return {
      chooseNodes: $$const(true),
      linksShown: $$const(true),
      linksActive: $$const(false),
      cssClass: "grid-layout",
      attributes: defaultLesMisAttributes,
      activeForces: empty8,
      nodeInitializerFunctions: [setGridPositions(gridSpacing)],
      transitionConfig: new Just(smoothTransitionPinned)
    };
  };
  var fullGraphScene = function(activeForces2) {
    return {
      chooseNodes: $$const(true),
      linksShown: $$const(true),
      linksActive: $$const(true),
      cssClass: "full-graph",
      attributes: defaultLesMisAttributes,
      activeForces: activeForces2,
      nodeInitializerFunctions: [unpinAllNodes2, setPhyllotaxisInitialPositions],
      transitionConfig: new Just(smoothTransition)
    };
  };
  var filteredGraphScene = function(minGroup) {
    return function(activeForces2) {
      return {
        chooseNodes: function(n) {
          return n.group >= minGroup;
        },
        linksShown: $$const(true),
        linksActive: $$const(true),
        cssClass: "filtered-graph",
        attributes: defaultLesMisAttributes,
        activeForces: activeForces2,
        nodeInitializerFunctions: [unpinAllNodes2, setPhyllotaxisInitialPositions],
        transitionConfig: new Just(smoothTransition)
      };
    };
  };

  // output/D3.Viz.LesMis.LesMisGUP/index.js
  var ordNullable4 = /* @__PURE__ */ ordNullable(ordNumber);
  var genericUpdateSimulation2 = /* @__PURE__ */ genericUpdateSimulation(monadEffectD3v2SimM)(selectionMD3v2Selection_D1)(simulationM2D3v2Selection)(/* @__PURE__ */ ordRecord()(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordNil)()({
    reflectSymbol: function() {
      return "y";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "x";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "vy";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "vx";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "sy";
    }
  })(ordNullable4))()({
    reflectSymbol: function() {
      return "sx";
    }
  })(ordNullable4))()({
    reflectSymbol: function() {
      return "id";
    }
  })(ordString))()({
    reflectSymbol: function() {
      return "group";
    }
  })(ordInt))()({
    reflectSymbol: function() {
      return "fy";
    }
  })(ordNullable4))()({
    reflectSymbol: function() {
      return "fx";
    }
  })(ordNullable4)))(ordString)(eqString)(showString)(ordString);
  var lesMisRenderCallbacks2 = /* @__PURE__ */ lesMisRenderCallbacks(monadD3v2SimM)(selectionMD3v2Selection_D1);
  var discard28 = /* @__PURE__ */ discard(discardUnit)(bindD3v2SimM);
  var stop2 = /* @__PURE__ */ stop(simulationMD3v2Selection_);
  var start5 = /* @__PURE__ */ start3(simulationMD3v2Selection_);
  var reheat2 = /* @__PURE__ */ reheat(simulationM2D3v2Selection);
  var bind34 = /* @__PURE__ */ bind(bindD3v2SimM);
  var liftEffect19 = /* @__PURE__ */ liftEffect(monadEffectD3v2SimM);
  var select12 = /* @__PURE__ */ select4(selectionMD3v2Selection_D1);
  var width21 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height21 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox15 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var show40 = /* @__PURE__ */ show(showNumber);
  var id_7 = /* @__PURE__ */ id_(toAttrStringString);
  var class_18 = /* @__PURE__ */ class_2(toAttrStringString);
  var renderTree19 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D1)(ordUnit);
  var on5 = /* @__PURE__ */ on2(selectionMD3v2Selection_D1);
  var init6 = /* @__PURE__ */ init4(simulationMD3v2Selection_);
  var pure35 = /* @__PURE__ */ pure(applicativeD3v2SimM);
  var updateLesMisSimulation = function(selections) {
    return function(v) {
      return genericUpdateSimulation2(selections)(Circle2.value)(Line2.value)({
        allNodes: v.allNodes,
        allLinks: v.allLinks,
        nodeFilter: v.scene.chooseNodes,
        linkFilter: new Just(v.scene.linksShown),
        nodeInitializers: v.scene.nodeInitializerFunctions,
        activeForces: new Just(v.scene.activeForces),
        config: Nothing.value
      })(function(n) {
        return n.id;
      })(function(l) {
        return l.source.id + ("-" + l.target.id);
      })(v.scene.attributes)(lesMisRenderCallbacks2);
    };
  };
  var switchToPhylotaxis = function(selections) {
    return function(model) {
      return discard28(stop2)(function() {
        return discard28(updateLesMisSimulation(selections)({
          allNodes: model.nodes,
          allLinks: model.links,
          scene: phylotaxisScene
        }))(function() {
          return start5;
        });
      });
    };
  };
  var switchToGrid = function(selections) {
    return function(model) {
      return function(gridSpacing) {
        return discard28(stop2)(function() {
          var scene = gridScene(gridSpacing);
          return discard28(updateLesMisSimulation(selections)({
            allNodes: model.nodes,
            allLinks: model.links,
            scene
          }))(function() {
            return start5;
          });
        });
      };
    };
  };
  var switchToFullGraph = function(selections) {
    return function(model) {
      return function(activeForces2) {
        return discard28(stop2)(function() {
          var scene = fullGraphScene(activeForces2);
          return discard28(updateLesMisSimulation(selections)({
            allNodes: model.nodes,
            allLinks: model.links,
            scene
          }))(function() {
            return discard28(reheat2(0.8))(function() {
              return start5;
            });
          });
        });
      };
    };
  };
  var switchToFilteredGraph = function(selections) {
    return function(model) {
      return function(minGroup) {
        return function(activeForces2) {
          return discard28(stop2)(function() {
            var scene = filteredGraphScene(minGroup)(activeForces2);
            return discard28(updateLesMisSimulation(selections)({
              allNodes: model.nodes,
              allLinks: model.links,
              scene
            }))(function() {
              return discard28(reheat2(0.8))(function() {
                return start5;
              });
            });
          });
        };
      };
    };
  };
  var drawLesMisGUP = function(forcesArray) {
    return function(activeForces2) {
      return function(model) {
        return function(containerSelector) {
          return bind34(liftEffect19(getWindowWidthHeight))(function(v) {
            return bind34(select12(containerSelector))(function(container) {
              var forceGraphTree = withChild(named2(SVG.value)("svg")([width21(v.value0), height21(v.value1), viewBox15(show40(-v.value0 / 2) + (" " + (show40(-v.value1 / 2) + (" " + (show40(v.value0) + (" " + show40(v.value1))))))), id_7("lesmis-gup-svg"), class_18("lesmis-gup")]))(withChildren(named2(Group2.value)("zoomGroup")([id_7("zoom-group"), class_18("zoom-group")]))([named2(Group2.value)("linksGroup")([id_7("links"), class_18("links")]), named2(Group2.value)("nodesGroup")([id_7("nodes"), class_18("nodes")])]));
              return bind34(renderTree19(container)(forceGraphTree))(function(selections) {
                return bind34(liftEffect19(reselectD3v2("svg")(selections)))(function(svg2) {
                  return bind34(liftEffect19(reselectD3v2("zoomGroup")(selections)))(function(zoomGroup) {
                    return bind34(liftEffect19(reselectD3v2("linksGroup")(selections)))(function(linksGroup) {
                      return bind34(liftEffect19(reselectD3v2("nodesGroup")(selections)))(function(nodesGroup) {
                        return bind34(on5(new Drag2(defaultDrag))(zoomGroup))(function() {
                          return bind34(on5(new Zoom2(defaultZoom(new ScaleExtent2(0.5, 4))("#zoom-group")))(svg2))(function() {
                            return bind34(init6({
                              nodes: model.nodes,
                              links: model.links,
                              forces: forcesArray,
                              activeForces: activeForces2,
                              config: {
                                alpha: 1,
                                alphaTarget: 0,
                                alphaMin: 1e-3,
                                alphaDecay: 0.0228,
                                velocityDecay: 0.4
                              },
                              keyFn: keyIsID_,
                              ticks: empty3
                            }))(function() {
                              var scene = fullGraphScene(activeForces2);
                              return discard28(updateLesMisSimulation({
                                nodes: nodesGroup,
                                links: linksGroup
                              })({
                                allNodes: model.nodes,
                                allLinks: model.links,
                                scene
                              }))(function() {
                                return discard28(start5)(function() {
                                  return pure35({
                                    nodesGroup,
                                    linksGroup,
                                    model
                                  });
                                });
                              });
                            });
                          });
                        });
                      });
                    });
                  });
                });
              });
            });
          });
        };
      };
    };
  };

  // output/Component.LesMisGUP/index.js
  var show41 = /* @__PURE__ */ show(showInt);
  var show120 = /* @__PURE__ */ show(showNumber);
  var discard29 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var bind35 = /* @__PURE__ */ bind(bindHalogenM);
  var modify_9 = /* @__PURE__ */ modify_2(monadStateHalogenM);
  var get13 = /* @__PURE__ */ get(monadStateHalogenM);
  var put3 = /* @__PURE__ */ put(monadStateHalogenM);
  var when4 = /* @__PURE__ */ when(applicativeHalogenM);
  var FullGraph = /* @__PURE__ */ (function() {
    function FullGraph2() {
    }
    ;
    FullGraph2.value = new FullGraph2();
    return FullGraph2;
  })();
  var FilteredGraph = /* @__PURE__ */ (function() {
    function FilteredGraph2(value0) {
      this.value0 = value0;
    }
    ;
    FilteredGraph2.create = function(value0) {
      return new FilteredGraph2(value0);
    };
    return FilteredGraph2;
  })();
  var Grid = /* @__PURE__ */ (function() {
    function Grid2(value0) {
      this.value0 = value0;
    }
    ;
    Grid2.create = function(value0) {
      return new Grid2(value0);
    };
    return Grid2;
  })();
  var Phylotaxis = /* @__PURE__ */ (function() {
    function Phylotaxis2() {
    }
    ;
    Phylotaxis2.value = new Phylotaxis2();
    return Phylotaxis2;
  })();
  var Initialize17 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var SwitchToScene = /* @__PURE__ */ (function() {
    function SwitchToScene2(value0) {
      this.value0 = value0;
    }
    ;
    SwitchToScene2.create = function(value0) {
      return new SwitchToScene2(value0);
    };
    return SwitchToScene2;
  })();
  var ToggleAutoCycle = /* @__PURE__ */ (function() {
    function ToggleAutoCycle2() {
    }
    ;
    ToggleAutoCycle2.value = new ToggleAutoCycle2();
    return ToggleAutoCycle2;
  })();
  var AutoCycleNext = /* @__PURE__ */ (function() {
    function AutoCycleNext2() {
    }
    ;
    AutoCycleNext2.value = new AutoCycleNext2();
    return AutoCycleNext2;
  })();
  var sceneDescription = function(v) {
    if (v instanceof FullGraph) {
      return "Full force-directed graph with all 77 nodes";
    }
    ;
    if (v instanceof FilteredGraph) {
      return "Filtered graph showing only nodes with group \u2265 " + show41(v.value0);
    }
    ;
    if (v instanceof Grid) {
      return "Grid layout with " + (show120(v.value0) + "px spacing (pinned)");
    }
    ;
    if (v instanceof Phylotaxis) {
      return "Phylotaxis (sunflower spiral) layout (pinned)";
    }
    ;
    throw new Error("Failed pattern match at Component.LesMisGUP (line 178, column 20 - line 182, column 64): " + [v.constructor.name]);
  };
  var forces2 = /* @__PURE__ */ (function() {
    return {
      manyBodyNeg: createForce("many body negative")(new RegularForce(ForceManyBody.value))(allNodes)([strengthVal(-100)]),
      collision: createForce("collision")(new RegularForce(ForceCollide.value))(allNodes)([radiusVal(6)]),
      center: createForce("center")(new RegularForce(ForceCenter.value))(allNodes)([xVal(0), yVal(0), strengthVal(0.1)]),
      links: createLinkForce(allNodes)([])
    };
  })();
  var forceLibrary2 = /* @__PURE__ */ (function() {
    return initialize(foldableArray)(functorArray)([forces2.manyBodyNeg, forces2.collision, forces2.center, forces2.links]);
  })();
  var eqSceneType = {
    eq: function(x47) {
      return function(y48) {
        if (x47 instanceof FullGraph && y48 instanceof FullGraph) {
          return true;
        }
        ;
        if (x47 instanceof FilteredGraph && y48 instanceof FilteredGraph) {
          return x47.value0 === y48.value0;
        }
        ;
        if (x47 instanceof Grid && y48 instanceof Grid) {
          return x47.value0 === y48.value0;
        }
        ;
        if (x47 instanceof Phylotaxis && y48 instanceof Phylotaxis) {
          return true;
        }
        ;
        return false;
      };
    }
  };
  var eq24 = /* @__PURE__ */ eq(eqSceneType);
  var renderSceneButton = function(state3) {
    return function(sceneType) {
      return function(label5) {
        return function(description) {
          return button([class_("control-button" + (function() {
            var $54 = eq24(state3.currentScene)(sceneType);
            if ($54) {
              return " active";
            }
            ;
            return "";
          })()), onClick(function(v) {
            return new SwitchToScene(sceneType);
          }), title(description)])([text2(label5)]);
        };
      };
    };
  };
  var render21 = function(state3) {
    return div2([class_("lesmis-gup-page")])([div2([class_("page-header")])([h1_([text2("Les Mis\xE9rables - Declarative Scene-Based Visualization")]), p([class_("page-description")])([text2("Fully declarative force-directed graph using the scene-based pattern. Zero boilerplate, automatic link filtering, clean scene switching.")])]), div2([class_("controls-panel")])([div2([class_("control-section")])([h3_([text2("Scene Selection")]), p_([text2("Switch between different visualization scenes:")]), div2([class_("button-group")])([renderSceneButton(state3)(FullGraph.value)("Full Graph")("Force-directed with all 77 nodes"), renderSceneButton(state3)(new FilteredGraph(5))("Filtered (\u22655)")("Show only nodes with group \u2265 5"), renderSceneButton(state3)(new Grid(50))("Grid Layout")("Nodes arranged in a grid (pinned)"), renderSceneButton(state3)(Phylotaxis.value)("Phylotaxis")("Sunflower spiral pattern (pinned)")])]), div2([class_("control-section")])([h3_([text2("Auto-Cycling")]), p_([text2("Automatically cycle through all scenes:")]), div2([class_("button-group")])([button([class_("control-button" + (function() {
      if (state3.autoCycling) {
        return " active";
      }
      ;
      return "";
    })()), onClick(function(v) {
      return ToggleAutoCycle.value;
    })])([text2((function() {
      if (state3.autoCycling) {
        return "\u23F8 Stop Auto-Cycle";
      }
      ;
      return "\u25B6 Start Auto-Cycle";
    })())])]), (function() {
      if (state3.autoCycling) {
        return p([class_("info-text")])([text2("Switching scenes every 4 seconds...")]);
      }
      ;
      return text2("");
    })()])]), div2([id3("lesmis-gup-viz"), class_("viz-container")])([]), div2([class_("info-panel")])([h3_([text2("Declarative Pattern Benefits")]), ul_([li_([text2("\u2705 Scene-based architecture - complete specifications, no partial updates")]), li_([text2("\u2705 Automatic link filtering - library ensures consistency")]), li_([text2("\u2705 Zero boilerplate - no manual GUP steps, no wrapper types")]), li_([text2("\u2705 Impossible to mess up - scene configs are validated at compile time")]), li_([text2("\u2705 Clean scene switching - just one function call")])]), h3_([text2("Current Scene")]), p_([text2(sceneDescription(state3.currentScene))])])]);
  };
  var activeForces = /* @__PURE__ */ fromFoldable8(foldableArray)(ordString)(["many body negative", "collision", "center", linksForceName_]);
  var handleAction16 = function(dictMonadAff) {
    var log9 = log3(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    var liftAff3 = liftAff(monadAffHalogenM(dictMonadAff));
    return function(v) {
      if (v instanceof Initialize17) {
        return discard29(log9("LesMisGUP: Initializing declarative visualization"))(function() {
          return discard29(liftAff3(delay(100)))(function() {
            return bind35(liftAff3(get3(string)("./data/miserables.json")))(function(lesMisResponse) {
              if (lesMisResponse instanceof Left) {
                return log9("LesMisGUP: Failed to load data");
              }
              ;
              if (lesMisResponse instanceof Right) {
                var model = readGraphFromFileContents(new Right(lesMisResponse.value0));
                return discard29(log9("LesMisGUP: Loaded " + (show41(length(model.nodes)) + (" nodes and " + (show41(length(model.links)) + " links")))))(function() {
                  return discard29(modify_9(function(v1) {
                    var $61 = {};
                    for (var $62 in v1) {
                      if ({}.hasOwnProperty.call(v1, $62)) {
                        $61[$62] = v1[$62];
                      }
                      ;
                    }
                    ;
                    $61.model = new Just(model);
                    return $61;
                  }))(function() {
                    return bind35(get13)(function(state3) {
                      return bind35(liftAff3(runD3v2SimM(state3)((function() {
                        var forcesArray = [forces2.manyBodyNeg, forces2.collision, forces2.center, forces2.links];
                        return drawLesMisGUP(forcesArray)(activeForces)(model)("#lesmis-gup-viz");
                      })())))(function(v1) {
                        return discard29(put3(v1.value1))(function() {
                          return discard29(modify_9(function(v2) {
                            var $65 = {};
                            for (var $66 in v2) {
                              if ({}.hasOwnProperty.call(v2, $66)) {
                                $65[$66] = v2[$66];
                              }
                              ;
                            }
                            ;
                            $65.selections = new Just({
                              nodesGroup: v1.value0.nodesGroup,
                              linksGroup: v1.value0.linksGroup
                            });
                            return $65;
                          }))(function() {
                            return log9("LesMisGUP: Initial visualization complete");
                          });
                        });
                      });
                    });
                  });
                });
              }
              ;
              throw new Error("Failed pattern match at Component.LesMisGUP (line 193, column 5 - line 214, column 56): " + [lesMisResponse.constructor.name]);
            });
          });
        });
      }
      ;
      if (v instanceof SwitchToScene) {
        return discard29(log9("LesMisGUP: Switching to scene: " + sceneDescription(v.value0)))(function() {
          return bind35(get13)(function(state3) {
            if (state3.model instanceof Just && state3.selections instanceof Just) {
              var selections = {
                nodes: state3.selections.value0.nodesGroup,
                links: state3.selections.value0.linksGroup
              };
              return bind35(liftAff3(runD3v2SimM(state3)((function() {
                if (v.value0 instanceof FullGraph) {
                  return switchToFullGraph(selections)(state3.model.value0)(activeForces);
                }
                ;
                if (v.value0 instanceof FilteredGraph) {
                  return switchToFilteredGraph(selections)(state3.model.value0)(v.value0.value0)(activeForces);
                }
                ;
                if (v.value0 instanceof Grid) {
                  return switchToGrid(selections)(state3.model.value0)(v.value0.value0);
                }
                ;
                if (v.value0 instanceof Phylotaxis) {
                  return switchToPhylotaxis(selections)(state3.model.value0);
                }
                ;
                throw new Error("Failed pattern match at Component.LesMisGUP (line 225, column 11 - line 236, column 60): " + [v.value0.constructor.name]);
              })())))(function(v1) {
                return discard29(put3(v1.value1))(function() {
                  return modify_9(function(v2) {
                    var $77 = {};
                    for (var $78 in v2) {
                      if ({}.hasOwnProperty.call(v2, $78)) {
                        $77[$78] = v2[$78];
                      }
                      ;
                    }
                    ;
                    $77.currentScene = v.value0;
                    return $77;
                  });
                });
              });
            }
            ;
            return log9("LesMisGUP: Cannot switch scene - no model or selections available");
          });
        });
      }
      ;
      if (v instanceof ToggleAutoCycle) {
        return bind35(get13)(function(state3) {
          var newState = !state3.autoCycling;
          return discard29(modify_9(function(v1) {
            var $85 = {};
            for (var $86 in v1) {
              if ({}.hasOwnProperty.call(v1, $86)) {
                $85[$86] = v1[$86];
              }
              ;
            }
            ;
            $85.autoCycling = newState;
            return $85;
          }))(function() {
            if (newState) {
              return discard29(log9("LesMisGUP: Starting auto-cycle"))(function() {
                return handleAction16(dictMonadAff)(AutoCycleNext.value);
              });
            }
            ;
            return log9("LesMisGUP: Stopping auto-cycle");
          });
        });
      }
      ;
      if (v instanceof AutoCycleNext) {
        return bind35(get13)(function(state3) {
          return when4(state3.autoCycling)((function() {
            var nextScene = (function() {
              if (state3.currentScene instanceof FullGraph) {
                return new FilteredGraph(5);
              }
              ;
              if (state3.currentScene instanceof FilteredGraph && state3.currentScene.value0 === 5) {
                return new Grid(50);
              }
              ;
              if (state3.currentScene instanceof Grid) {
                return Phylotaxis.value;
              }
              ;
              if (state3.currentScene instanceof Phylotaxis) {
                return FullGraph.value;
              }
              ;
              return FullGraph.value;
            })();
            return discard29(handleAction16(dictMonadAff)(new SwitchToScene(nextScene)))(function() {
              return discard29(liftAff3(delay(4e3)))(function() {
                return handleAction16(dictMonadAff)(AutoCycleNext.value);
              });
            });
          })());
        });
      }
      ;
      throw new Error("Failed pattern match at Component.LesMisGUP (line 186, column 16 - line 275, column 33): " + [v.constructor.name]);
    };
  };
  var component17 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return {
          simulation: initialSimulationState(forceLibrary2),
          model: Nothing.value,
          selections: Nothing.value,
          currentScene: FullGraph.value,
          autoCycling: false
        };
      },
      render: render21,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction16(dictMonadAff),
        initialize: new Just(Initialize17.value)
      })
    });
  };

  // output/D3.Viz.LesMis.LesMisGUPClean/index.js
  var bind36 = /* @__PURE__ */ bind(bindD3v2SimM);
  var update4 = /* @__PURE__ */ update3(simulationM2D3v2Selection);
  var select13 = /* @__PURE__ */ select4(selectionMD3v2Selection_D1);
  var joinDataWithKey4 = /* @__PURE__ */ joinDataWithKey(selectionMD3v2Selection_D1)(foldableArray)(ordString);
  var append22 = /* @__PURE__ */ append10(selectionMD3v2Selection_D1);
  var setAttrs4 = /* @__PURE__ */ setAttrs(selectionMD3v2Selection_D1);
  var cx14 = /* @__PURE__ */ cx3(toAttrNumberFunctionNumbe);
  var cy14 = /* @__PURE__ */ cy3(toAttrNumberFunctionNumbe);
  var radius14 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill20 = /* @__PURE__ */ fill3(toAttrStringFunctionStrin);
  var stroke13 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth13 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var remove7 = /* @__PURE__ */ remove3(selectionMD3v2Selection_D1);
  var merge4 = /* @__PURE__ */ merge(selectionMD3v2Selection_D1);
  var discard30 = /* @__PURE__ */ discard(discardUnit)(bindD3v2SimM);
  var addTickFunction3 = /* @__PURE__ */ addTickFunction(simulationMD3v2Selection_);
  var pure36 = /* @__PURE__ */ pure(applicativeD3v2SimM);
  var liftEffect20 = /* @__PURE__ */ liftEffect(monadEffectD3v2SimM);
  var width22 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height22 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox16 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var show42 = /* @__PURE__ */ show(showNumber);
  var id_8 = /* @__PURE__ */ id_(toAttrStringString);
  var class_19 = /* @__PURE__ */ class_2(toAttrStringString);
  var renderTree20 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D1)(ordUnit);
  var on6 = /* @__PURE__ */ on2(selectionMD3v2Selection_D1);
  var init7 = /* @__PURE__ */ init4(simulationMD3v2Selection_);
  var show121 = /* @__PURE__ */ show(showInt);
  var x15 = /* @__PURE__ */ x1(toAttrNumberFunctionNumbe);
  var y15 = /* @__PURE__ */ y1(toAttrNumberFunctionNumbe);
  var x26 = /* @__PURE__ */ x22(toAttrNumberFunctionNumbe);
  var y26 = /* @__PURE__ */ y22(toAttrNumberFunctionNumbe);
  var start6 = /* @__PURE__ */ start3(simulationMD3v2Selection_);
  var updateNodes = function(newNodes) {
    return bind36(update4({
      nodes: new Just(newNodes),
      links: Nothing.value,
      nodeFilter: Nothing.value,
      linkFilter: Nothing.value,
      activeForces: Nothing.value,
      config: Nothing.value,
      keyFn: keyIsID_
    }))(function(v) {
      return bind36(select13("#nodes"))(function(nodesGroup) {
        return bind36(joinDataWithKey4(v.nodes)(function(v1) {
          return v1.id;
        })("circle")(nodesGroup))(function(v1) {
          return bind36(append22(Circle2.value)([])(v1.value0.enter))(function(enterBound) {
            return bind36(setAttrs4([cx14(function(v2) {
              return v2.x;
            }), cy14(function(v2) {
              return v2.y;
            }), radius14(5), fill20(function(n) {
              return d3SchemeCategory10N_(toNumber(n.group));
            }), stroke13("#fff"), strokeWidth13(2)])(enterBound))(function() {
              return bind36(remove7(v1.value0.exit))(function() {
                return bind36(merge4(enterBound)(v1.value0.update))(function(nodeCircles) {
                  return discard30(addTickFunction3("nodes")(new Step4(nodeCircles, [cx14(function(v2) {
                    return v2.x;
                  }), cy14(function(v2) {
                    return v2.y;
                  })])))(function() {
                    return pure36(unit);
                  });
                });
              });
            });
          });
        });
      });
    });
  };
  var phylotaxisPosition = function(i2) {
    var i$prime = toNumber(i2);
    var r = 10 * sqrt(0.5 + i$prime);
    var angle = i$prime * pi * (3 - sqrt(5));
    return {
      x: r * cos(angle),
      y: r * sin(angle)
    };
  };
  var setPhyllotaxisPositions3 = function(nodes) {
    return mapWithIndex2(function(i2) {
      return function(n) {
        var $91 = {};
        for (var $92 in n) {
          if ({}.hasOwnProperty.call(n, $92)) {
            $91[$92] = n[$92];
          }
          ;
        }
        ;
        $91.x = phylotaxisPosition(i2).x;
        $91.y = phylotaxisPosition(i2).y;
        return $91;
      };
    })(nodes);
  };
  var drawLesMisGUPClean = function(forcesArray) {
    return function(activeForces2) {
      return function(model) {
        return function(containerSelector) {
          return bind36(liftEffect20(getWindowWidthHeight))(function(v) {
            return bind36(select13(containerSelector))(function(container) {
              var svgTree = withChild(named2(SVG.value)("svg")([width22(v.value0), height22(v.value1), viewBox16(show42(-v.value0 / 2) + (" " + (show42(-v.value1 / 2) + (" " + (show42(v.value0) + (" " + show42(v.value1))))))), id_8("lesmis-gup-clean-svg"), class_19("lesmis-gup-clean")]))(withChildren(named2(Group2.value)("zoomGroup")([id_8("zoom-group"), class_19("zoom-group")]))([named2(Group2.value)("linksGroup")([id_8("links"), class_19("links")]), named2(Group2.value)("nodesGroup")([id_8("nodes"), class_19("nodes")])]));
              return bind36(renderTree20(container)(svgTree))(function(selections) {
                return bind36(liftEffect20(reselectD3v2("svg")(selections)))(function(svg2) {
                  return bind36(liftEffect20(reselectD3v2("zoomGroup")(selections)))(function(zoomGroup) {
                    return bind36(liftEffect20(reselectD3v2("linksGroup")(selections)))(function(linksGroup) {
                      return bind36(liftEffect20(reselectD3v2("nodesGroup")(selections)))(function(nodesGroup) {
                        return bind36(on6(new Drag2(defaultDrag))(zoomGroup))(function() {
                          return bind36(on6(new Zoom2(defaultZoom(new ScaleExtent2(0.5, 4))("#zoom-group")))(svg2))(function() {
                            var nodesWithPositions = setPhyllotaxisPositions3(model.nodes);
                            return bind36(init7({
                              nodes: nodesWithPositions,
                              links: model.links,
                              forces: forcesArray,
                              activeForces: activeForces2,
                              config: {
                                alpha: 1,
                                alphaTarget: 0,
                                alphaMin: 1e-3,
                                alphaDecay: 0.0228,
                                velocityDecay: 0.4
                              },
                              keyFn: keyIsID_,
                              ticks: empty3
                            }))(function(v1) {
                              var indexedLinks = mapWithIndex2(function(i2) {
                                return function(link4) {
                                  return {
                                    index: i2,
                                    link: link4
                                  };
                                };
                              })(v1.links);
                              return bind36(joinDataWithKey4(indexedLinks)(function(v2) {
                                return show121(v2.index);
                              })("line")(linksGroup))(function(v2) {
                                return bind36(append22(Line2.value)([])(v2.value0.enter))(function(linksEnterBound) {
                                  return bind36(setAttrs4([strokeWidth13(1), stroke13("#999"), x15(function(v3) {
                                    return v3.link.source.x;
                                  }), y15(function(v3) {
                                    return v3.link.source.y;
                                  }), x26(function(v3) {
                                    return v3.link.target.x;
                                  }), y26(function(v3) {
                                    return v3.link.target.y;
                                  })])(linksEnterBound))(function() {
                                    return bind36(remove7(v2.value0.exit))(function() {
                                      return bind36(merge4(linksEnterBound)(v2.value0.update))(function(linkLines) {
                                        return bind36(joinDataWithKey4(v1.nodes)(function(v3) {
                                          return v3.id;
                                        })("circle")(nodesGroup))(function(v3) {
                                          return bind36(append22(Circle2.value)([])(v3.value0.enter))(function(nodesEnterBound) {
                                            return bind36(setAttrs4([cx14(function(v4) {
                                              return v4.x;
                                            }), cy14(function(v4) {
                                              return v4.y;
                                            }), radius14(5), fill20(function(n) {
                                              return d3SchemeCategory10N_(toNumber(n.group));
                                            }), stroke13("#fff"), strokeWidth13(2)])(nodesEnterBound))(function() {
                                              return bind36(remove7(v3.value0.exit))(function() {
                                                return bind36(merge4(nodesEnterBound)(v3.value0.update))(function(nodeCircles) {
                                                  return bind36(on6(new Drag2(simulationDrag("lesmis-gup-clean")))(nodeCircles))(function() {
                                                    return discard30(addTickFunction3("nodes")(new Step4(nodeCircles, [cx14(function(v4) {
                                                      return v4.x;
                                                    }), cy14(function(v4) {
                                                      return v4.y;
                                                    })])))(function() {
                                                      return discard30(addTickFunction3("links")(new Step4(linkLines, [x15(function(v4) {
                                                        return v4.link.source.x;
                                                      }), y15(function(v4) {
                                                        return v4.link.source.y;
                                                      }), x26(function(v4) {
                                                        return v4.link.target.x;
                                                      }), y26(function(v4) {
                                                        return v4.link.target.y;
                                                      })])))(function() {
                                                        return start6;
                                                      });
                                                    });
                                                  });
                                                });
                                              });
                                            });
                                          });
                                        });
                                      });
                                    });
                                  });
                                });
                              });
                            });
                          });
                        });
                      });
                    });
                  });
                });
              });
            });
          });
        };
      };
    };
  };

  // output/Component.LesMisGUPClean/index.js
  var discard31 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var bind37 = /* @__PURE__ */ bind(bindHalogenM);
  var fromFoldable37 = /* @__PURE__ */ fromFoldable8(foldableArray)(ordString);
  var modify_10 = /* @__PURE__ */ modify_2(monadStateHalogenM);
  var get14 = /* @__PURE__ */ get(monadStateHalogenM);
  var bind114 = /* @__PURE__ */ bind(bindD3v2SimM);
  var pure37 = /* @__PURE__ */ pure(applicativeD3v2SimM);
  var pure113 = /* @__PURE__ */ pure(applicativeHalogenM);
  var show43 = /* @__PURE__ */ show(showInt);
  var Initialize18 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var FilterNodes = /* @__PURE__ */ (function() {
    function FilterNodes5(value0) {
      this.value0 = value0;
    }
    ;
    FilterNodes5.create = function(value0) {
      return new FilterNodes5(value0);
    };
    return FilterNodes5;
  })();
  var render22 = function(v) {
    return div2([class_("lesmis-gup-clean-page")])([div2([class_("page-header")])([h1_([text2("Les Mis\xE9rables - Clean GUP (No Wrappers!)")]), p([class_("page-description")])([text2("Force simulation using existing SelectionM primitives. No SceneNestedJoin, no SceneData, no KeyedNode - just arrays and functions!")])]), div2([class_("controls-panel")])([div2([class_("control-section")])([h3_([text2("Node Filtering (GUP)")]), p_([text2("Test enter/update/exit pattern by filtering nodes:")]), div2([class_("button-group")])([button([class_("control-button"), onClick(function(v1) {
      return new FilterNodes(0);
    })])([text2("All Nodes (77)")]), button([class_("control-button"), onClick(function(v1) {
      return new FilterNodes(5);
    })])([text2("Group \u2265 5")]), button([class_("control-button"), onClick(function(v1) {
      return new FilterNodes(8);
    })])([text2("Group \u2265 8")])])])]), div2([id3("lesmis-gup-clean-viz"), class_("viz-container")])([]), div2([class_("info-panel")])([h3_([text2("What This Demonstrates")]), ul_([li_([text2("Direct use of joinDataWithKey - no wrapper types needed!")]), li_([text2("No SceneData, no KeyedNode - just raw Array LesMisSimNode")]), li_([text2("Uses existing SelectionM primitives: joinDataWithKey + append + setAttrs + merge")]), li_([text2("Update function: rejoin data and merge enter + update selections")]), li_([text2("Tree API only for static structure (SVG container)")])]), h3_([text2("Key Code Pattern")]), pre([class_("code-snippet")])([text2('-- Join data directly (no wrappers!)\nJoinResult { enter, update, exit } <-\n  joinDataWithKey nodes (_.id) "circle" nodesGroup\n\n-- Handle each phase\nenterBound <- append Circle [] enter\n_ <- setAttrs [...] enterBound\n_ <- remove exit\nnodeCircles <- merge enterBound update\n\n-- Update: just rejoin!\nupdateNodes newNodes = do\n  { nodes } <- update { nodes: Just newNodes, ... }\n  nodesGroup <- select "#nodes"\n  JoinResult { enter, update, exit } <-\n    joinDataWithKey nodes (_.id) "circle" nodesGroup\n  -- ... same pattern ...\n')])])]);
  };
  var forces3 = /* @__PURE__ */ (function() {
    return {
      manyBodyNeg: createForce("many body negative")(new RegularForce(ForceManyBody.value))(allNodes)([strengthVal(-100)]),
      collision: createForce("collision")(new RegularForce(ForceCollide.value))(allNodes)([radiusVal(6)]),
      center: createForce("center")(new RegularForce(ForceCenter.value))(allNodes)([xVal(0), yVal(0), strengthVal(0.1)]),
      links: createLinkForce(allNodes)([])
    };
  })();
  var handleAction17 = function(dictMonadAff) {
    var log9 = log3(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    var liftAff3 = liftAff(monadAffHalogenM(dictMonadAff));
    return function(v) {
      if (v instanceof Initialize18) {
        return discard31(log9("LesMisGUPClean: Initializing"))(function() {
          return discard31(liftAff3(delay(100)))(function() {
            return bind37(liftAff3(get3(string)("./data/miserables.json")))(function(lesMisResponse) {
              return discard31((function() {
                if (lesMisResponse instanceof Left) {
                  return log9("Failed to load Les Mis\xE9rables data");
                }
                ;
                if (lesMisResponse instanceof Right) {
                  var graph = readGraphFromFileContents(new Right(lesMisResponse.value0));
                  var forcesArray = [forces3.manyBodyNeg, forces3.collision, forces3.center, forces3.links];
                  var activeForces2 = fromFoldable37(["many body negative", "collision", "center", linksForceName_]);
                  return discard31(modify_10(function(s) {
                    var $38 = {};
                    for (var $39 in s) {
                      if ({}.hasOwnProperty.call(s, $39)) {
                        $38[$39] = s[$39];
                      }
                      ;
                    }
                    ;
                    $38.originalGraph = new Just(graph);
                    return $38;
                  }))(function() {
                    return bind37(get14)(function(state3) {
                      return bind37(liftAff3(execD3v2SimM({
                        simulation: state3.lesMisGUPSimulation
                      })(bind114(drawLesMisGUPClean(forcesArray)(activeForces2)(graph)("#lesmis-gup-clean-viz"))(function() {
                        return pure37(unit);
                      }))))(function(newState) {
                        return discard31(modify_10(function(s) {
                          var $41 = {};
                          for (var $42 in s) {
                            if ({}.hasOwnProperty.call(s, $42)) {
                              $41[$42] = s[$42];
                            }
                            ;
                          }
                          ;
                          $41.lesMisGUPSimulation = newState.simulation;
                          return $41;
                        }))(function() {
                          return log9("LesMisGUPClean: Initialized successfully");
                        });
                      });
                    });
                  });
                }
                ;
                throw new Error("Failed pattern match at Component.LesMisGUPClean (line 143, column 5 - line 158, column 55): " + [lesMisResponse.constructor.name]);
              })())(function() {
                return pure113(unit);
              });
            });
          });
        });
      }
      ;
      if (v instanceof FilterNodes) {
        return discard31(log9("Filtering nodes to group >= " + show43(v.value0)))(function() {
          return bind37(get14)(function(state3) {
            if (state3.originalGraph instanceof Nothing) {
              return log9("Error: Original graph data not loaded");
            }
            ;
            if (state3.originalGraph instanceof Just) {
              var filteredNodes = (function() {
                var $46 = v.value0 === 0;
                if ($46) {
                  return state3.originalGraph.value0.nodes;
                }
                ;
                return filter(function(n) {
                  return n.group >= v.value0;
                })(state3.originalGraph.value0.nodes);
              })();
              return discard31(log9("Filtered to " + (show43(length(filteredNodes)) + " nodes")))(function() {
                return bind37(liftAff3(execD3v2SimM({
                  simulation: state3.lesMisGUPSimulation
                })(updateNodes(filteredNodes))))(function(newState) {
                  return modify_10(function(s) {
                    var $47 = {};
                    for (var $48 in s) {
                      if ({}.hasOwnProperty.call(s, $48)) {
                        $47[$48] = s[$48];
                      }
                      ;
                    }
                    ;
                    $47.lesMisGUPSimulation = newState.simulation;
                    return $47;
                  });
                });
              });
            }
            ;
            throw new Error("Failed pattern match at Component.LesMisGUPClean (line 165, column 5 - line 176, column 72): " + [state3.originalGraph.constructor.name]);
          });
        });
      }
      ;
      throw new Error("Failed pattern match at Component.LesMisGUPClean (line 136, column 16 - line 176, column 72): " + [v.constructor.name]);
    };
  };
  var forceLibrary3 = /* @__PURE__ */ (function() {
    return initialize(foldableArray)(functorArray)([forces3.manyBodyNeg, forces3.collision, forces3.center, forces3.links]);
  })();
  var component18 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return {
          lesMisGUPSimulation: initialSimulationState(forceLibrary3),
          originalGraph: Nothing.value
        };
      },
      render: render22,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction17(dictMonadAff),
        initialize: new Just(Initialize18.value)
      })
    });
  };

  // output/D3.Viz.LesMis.LesMisGUPSimple/index.js
  var compare10 = /* @__PURE__ */ compare(ordString);
  var eq14 = /* @__PURE__ */ eq(eqOrdering);
  var map53 = /* @__PURE__ */ map(functorArray);
  var cx15 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy15 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius15 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill21 = /* @__PURE__ */ fill3(toAttrStringFunctionStrin);
  var stroke14 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth14 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var bind38 = /* @__PURE__ */ bind(bindD3v2SimM);
  var liftEffect21 = /* @__PURE__ */ liftEffect(monadEffectD3v2SimM);
  var select14 = /* @__PURE__ */ select4(selectionMD3v2Selection_D1);
  var width23 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height23 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox17 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var show44 = /* @__PURE__ */ show(showNumber);
  var id_9 = /* @__PURE__ */ id_(toAttrStringString);
  var class_20 = /* @__PURE__ */ class_2(toAttrStringString);
  var renderTree21 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D1);
  var renderTree110 = /* @__PURE__ */ renderTree21(ordUnit);
  var on7 = /* @__PURE__ */ on2(selectionMD3v2Selection_D1);
  var init8 = /* @__PURE__ */ init4(simulationMD3v2Selection_);
  var x16 = /* @__PURE__ */ x1(toAttrNumberFunctionNumbe);
  var y16 = /* @__PURE__ */ y1(toAttrNumberFunctionNumbe);
  var x27 = /* @__PURE__ */ x22(toAttrNumberFunctionNumbe);
  var y27 = /* @__PURE__ */ y22(toAttrNumberFunctionNumbe);
  var lookup23 = /* @__PURE__ */ lookup2(ordString);
  var discard33 = /* @__PURE__ */ discard(discardUnit)(bindD3v2SimM);
  var addTickFunction4 = /* @__PURE__ */ addTickFunction(simulationMD3v2Selection_);
  var cx16 = /* @__PURE__ */ cx3(toAttrNumberFunctionNumbe);
  var cy16 = /* @__PURE__ */ cy3(toAttrNumberFunctionNumbe);
  var start7 = /* @__PURE__ */ start3(simulationMD3v2Selection_);
  var update5 = /* @__PURE__ */ update3(simulationM2D3v2Selection);
  var pure38 = /* @__PURE__ */ pure(applicativeD3v2SimM);
  var KeyedNode = function(x47) {
    return x47;
  };
  var eqSceneData = {
    eq: function(v) {
      return function(v1) {
        return true;
      };
    }
  };
  var ordSceneData = {
    compare: function(v) {
      return function(v1) {
        return EQ.value;
      };
    },
    Eq0: function() {
      return eqSceneData;
    }
  };
  var renderTree27 = /* @__PURE__ */ renderTree21(ordSceneData);
  var eqIndexedLink2 = {
    eq: function(v) {
      return function(v1) {
        return v.link.source.id === v1.link.source.id && v.link.target.id === v1.link.target.id;
      };
    }
  };
  var ordIndexedLink2 = {
    compare: function(v) {
      return function(v1) {
        var sourceComp = compare10(v.link.source.id)(v1.link.source.id);
        var $92 = eq14(sourceComp)(EQ.value);
        if ($92) {
          return compare10(v.link.target.id)(v1.link.target.id);
        }
        ;
        return sourceComp;
      };
    },
    Eq0: function() {
      return eqIndexedLink2;
    }
  };
  var renderTree33 = /* @__PURE__ */ renderTree21(ordIndexedLink2);
  var phylotaxisPosition2 = function(i2) {
    var i$prime = toNumber(i2);
    var r = 10 * sqrt(0.5 + i$prime);
    var angle = i$prime * pi * (3 - sqrt(5));
    return {
      x: r * cos(angle),
      y: r * sin(angle)
    };
  };
  var setPhyllotaxisPositions4 = function(nodes) {
    return mapWithIndex2(function(i2) {
      return function(n) {
        var $93 = {};
        for (var $94 in n) {
          if ({}.hasOwnProperty.call(n, $94)) {
            $93[$94] = n[$94];
          }
          ;
        }
        ;
        $93.x = phylotaxisPosition2(i2).x;
        $93.y = phylotaxisPosition2(i2).y;
        return $93;
      };
    })(nodes);
  };
  var createNodesTree = function(v) {
    return sceneNestedJoin("nodeElements")("circle")([v])(function(v1) {
      return map53(KeyedNode)(v1.nodes);
    })(function(v1) {
      return elem4(Circle2.value)([cx15(v1.x), cy15(v1.y), radius15(5), fill21(function(v2) {
        return d3SchemeCategory10N_(toNumber(v2.group));
      }), stroke14("#fff"), strokeWidth14(2)]);
    })({
      enterBehavior: new Just({
        initialAttrs: [cx15(0), cy15(0), radius15(0)],
        transition: new Just({
          duration: 600,
          delay: Nothing.value,
          easing: new Just(CubicInOut.value)
        })
      }),
      updateBehavior: Nothing.value,
      exitBehavior: new Just({
        attrs: [radius15(0)],
        transition: new Just({
          duration: 500,
          delay: Nothing.value,
          easing: new Just(CubicIn.value)
        })
      })
    });
  };
  var drawLesMisGUPSimple = function(forcesArray) {
    return function(activeForces2) {
      return function(model) {
        return function(containerSelector) {
          return bind38(liftEffect21(getWindowWidthHeight))(function(v) {
            return bind38(select14(containerSelector))(function(container) {
              var svgTree = withChild(named2(SVG.value)("svg")([width23(v.value0), height23(v.value1), viewBox17(show44(-v.value0 / 2) + (" " + (show44(-v.value1 / 2) + (" " + (show44(v.value0) + (" " + show44(v.value1))))))), id_9("lesmis-gup-simple-svg"), class_20("lesmis-gup-simple")]))(withChildren(named2(Group2.value)("zoomGroup")([id_9("zoom-group"), class_20("zoom-group")]))([named2(Group2.value)("linksGroup")([id_9("links"), class_20("links")]), named2(Group2.value)("nodesGroup")([id_9("nodes"), class_20("nodes")])]));
              return bind38(renderTree110(container)(svgTree))(function(selections) {
                return bind38(liftEffect21(reselectD3v2("svg")(selections)))(function(svg2) {
                  return bind38(liftEffect21(reselectD3v2("zoomGroup")(selections)))(function(zoomGroup) {
                    return bind38(liftEffect21(reselectD3v2("linksGroup")(selections)))(function(linksGroup) {
                      return bind38(liftEffect21(reselectD3v2("nodesGroup")(selections)))(function(nodesGroup) {
                        return bind38(on7(new Drag2(defaultDrag))(zoomGroup))(function() {
                          return bind38(on7(new Zoom2(defaultZoom(new ScaleExtent2(0.5, 4))("#zoom-group")))(svg2))(function() {
                            var nodesWithPositions = setPhyllotaxisPositions4(model.nodes);
                            return bind38(init8({
                              nodes: nodesWithPositions,
                              links: model.links,
                              forces: forcesArray,
                              activeForces: activeForces2,
                              config: {
                                alpha: 1,
                                alphaTarget: 0,
                                alphaMin: 1e-3,
                                alphaDecay: 0.0228,
                                velocityDecay: 0.4
                              },
                              keyFn: keyIsID_,
                              ticks: empty3
                            }))(function(v1) {
                              var indexedLinks = mapWithIndex2(function(i2) {
                                return function(link4) {
                                  return {
                                    index: i2,
                                    link: link4
                                  };
                                };
                              })(v1.links);
                              var linksTree = joinData2("linkElements")("line")(indexedLinks)(function(v2) {
                                return elem4(Line2.value)([x16(function(v3) {
                                  return v2.link.source.x;
                                }), y16(function(v3) {
                                  return v2.link.source.y;
                                }), x27(function(v3) {
                                  return v2.link.target.x;
                                }), y27(function(v3) {
                                  return v2.link.target.y;
                                }), strokeWidth14(1), stroke14("#999")]);
                              });
                              return bind38(renderTree33(linksGroup)(linksTree))(function(linksSelections) {
                                var linkLines = (function() {
                                  var v2 = lookup23("linkElements")(linksSelections);
                                  if (v2 instanceof Just) {
                                    return v2.value0;
                                  }
                                  ;
                                  if (v2 instanceof Nothing) {
                                    return unsafeCrashWith("linkElements not found");
                                  }
                                  ;
                                  throw new Error("Failed pattern match at D3.Viz.LesMis.LesMisGUPSimple (line 198, column 19 - line 200, column 76): " + [v2.constructor.name]);
                                })();
                                var scene = {
                                  nodes: v1.nodes
                                };
                                return bind38(renderTree27(nodesGroup)(createNodesTree(scene)))(function(nodesSelections) {
                                  var nodeCircles = (function() {
                                    var v2 = lookup23("nodeElements")(nodesSelections);
                                    if (v2 instanceof Just) {
                                      return v2.value0;
                                    }
                                    ;
                                    if (v2 instanceof Nothing) {
                                      return unsafeCrashWith("nodeElements not found");
                                    }
                                    ;
                                    throw new Error("Failed pattern match at D3.Viz.LesMis.LesMisGUPSimple (line 205, column 21 - line 207, column 76): " + [v2.constructor.name]);
                                  })();
                                  return bind38(on7(new Drag2(simulationDrag("lesmis-gup-simple")))(nodeCircles))(function() {
                                    return discard33(addTickFunction4("nodes")(new Step4(nodeCircles, [cx16(function(v2) {
                                      return v2.x;
                                    }), cy16(function(v2) {
                                      return v2.y;
                                    })])))(function() {
                                      return discard33(addTickFunction4("links")(new Step4(linkLines, [x16(function(v2) {
                                        return v2.link.source.x;
                                      }), y16(function(v2) {
                                        return v2.link.source.y;
                                      }), x27(function(v2) {
                                        return v2.link.target.x;
                                      }), y27(function(v2) {
                                        return v2.link.target.y;
                                      })])))(function() {
                                        return start7;
                                      });
                                    });
                                  });
                                });
                              });
                            });
                          });
                        });
                      });
                    });
                  });
                });
              });
            });
          });
        };
      };
    };
  };
  var updateNodes2 = function(newNodes) {
    return bind38(update5({
      nodes: new Just(newNodes),
      links: Nothing.value,
      nodeFilter: Nothing.value,
      linkFilter: Nothing.value,
      activeForces: Nothing.value,
      config: Nothing.value,
      keyFn: keyIsID_
    }))(function(v) {
      return bind38(select14("#nodes"))(function(nodesGroup) {
        var scene = {
          nodes: v.nodes
        };
        return bind38(renderTree27(nodesGroup)(createNodesTree(scene)))(function() {
          return pure38(unit);
        });
      });
    });
  };

  // output/Component.LesMisGUPSimple/index.js
  var discard34 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var bind39 = /* @__PURE__ */ bind(bindHalogenM);
  var fromFoldable38 = /* @__PURE__ */ fromFoldable8(foldableArray)(ordString);
  var modify_11 = /* @__PURE__ */ modify_2(monadStateHalogenM);
  var get15 = /* @__PURE__ */ get(monadStateHalogenM);
  var bind115 = /* @__PURE__ */ bind(bindD3v2SimM);
  var pure39 = /* @__PURE__ */ pure(applicativeD3v2SimM);
  var pure114 = /* @__PURE__ */ pure(applicativeHalogenM);
  var show45 = /* @__PURE__ */ show(showInt);
  var Initialize19 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var FilterNodes2 = /* @__PURE__ */ (function() {
    function FilterNodes5(value0) {
      this.value0 = value0;
    }
    ;
    FilterNodes5.create = function(value0) {
      return new FilterNodes5(value0);
    };
    return FilterNodes5;
  })();
  var render23 = function(v) {
    return div2([class_("lesmis-gup-simple-page")])([div2([class_("page-header")])([h1_([text2("Les Mis\xE9rables - Minimal GUP Demo (SceneNestedJoin)")]), p([class_("page-description")])([text2("Minimal force simulation demonstrating SceneNestedJoin with declarative enter/update/exit behaviors. Colors based on node group.")])]), div2([class_("controls-panel")])([div2([class_("control-section")])([h3_([text2("Node Filtering (GUP)")]), p_([text2("Demonstrate enter/update/exit pattern by filtering nodes:")]), div2([class_("button-group")])([button([class_("control-button"), onClick(function(v1) {
      return new FilterNodes2(0);
    })])([text2("All Nodes (77)")]), button([class_("control-button"), onClick(function(v1) {
      return new FilterNodes2(5);
    })])([text2("Group \u2265 5")]), button([class_("control-button"), onClick(function(v1) {
      return new FilterNodes2(8);
    })])([text2("Group \u2265 8")])])])]), div2([id3("lesmis-gup-simple-viz"), class_("viz-container")])([]), div2([class_("info-panel")])([h3_([text2("What This Demonstrates")]), ul_([li_([text2("SceneNestedJoin - declarative GUP with type decomposition (SceneData \u2192 KeyedNode)")]), li_([text2("12-line update function - just call renderTree with new scene data!")]), li_([text2("Datum-based colors - no functions in scene data (like Letters GUP)")]), li_([text2("Phylotaxis initial layout - sunflower spiral positioning")]), li_([text2("Interactive behaviors - drag nodes, zoom/pan")])]), h3_([text2("Implementation Highlights")]), pre([class_("code-snippet")])([text2('-- Define scene structure ONCE:\ncreateNodesTree :: SceneData -> T.Tree SceneData\ncreateNodesTree scene =\n  T.sceneNestedJoin "nodeElements" "circle"\n    [scene]\n    (_.nodes >>> map KeyedNode)\n    template\n    { enterBehavior: ..., updateBehavior: ..., exitBehavior: ... }\n\n-- Update is just 12 lines:\nupdateNodes :: Array LesMisSimNode -> D3v2SimM () LesMisSimNode Unit\nupdateNodes newNodes = do\n  { nodes } <- update { nodes: Just newNodes, ... }\n  nodesGroup <- select "#nodes"\n  _ <- renderTree nodesGroup (createNodesTree (SceneData { nodes }))\n  pure unit')])])]);
  };
  var forces4 = /* @__PURE__ */ (function() {
    return {
      manyBodyNeg: createForce("many body negative")(new RegularForce(ForceManyBody.value))(allNodes)([strengthVal(-100)]),
      collision: createForce("collision")(new RegularForce(ForceCollide.value))(allNodes)([radiusVal(6)]),
      center: createForce("center")(new RegularForce(ForceCenter.value))(allNodes)([xVal(0), yVal(0), strengthVal(0.1)]),
      links: createLinkForce(allNodes)([])
    };
  })();
  var handleAction18 = function(dictMonadAff) {
    var log9 = log3(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    var liftAff3 = liftAff(monadAffHalogenM(dictMonadAff));
    return function(v) {
      if (v instanceof Initialize19) {
        return discard34(log9("LesMisGUPSimple: Initializing"))(function() {
          return discard34(liftAff3(delay(100)))(function() {
            return bind39(liftAff3(get3(string)("./data/miserables.json")))(function(lesMisResponse) {
              return discard34((function() {
                if (lesMisResponse instanceof Left) {
                  return log9("Failed to load Les Mis\xE9rables data");
                }
                ;
                if (lesMisResponse instanceof Right) {
                  var graph = readGraphFromFileContents(new Right(lesMisResponse.value0));
                  var forcesArray = [forces4.manyBodyNeg, forces4.collision, forces4.center, forces4.links];
                  var activeForces2 = fromFoldable38(["many body negative", "collision", "center", linksForceName_]);
                  return discard34(modify_11(function(s) {
                    var $38 = {};
                    for (var $39 in s) {
                      if ({}.hasOwnProperty.call(s, $39)) {
                        $38[$39] = s[$39];
                      }
                      ;
                    }
                    ;
                    $38.originalGraph = new Just(graph);
                    return $38;
                  }))(function() {
                    return bind39(get15)(function(state3) {
                      return bind39(liftAff3(execD3v2SimM({
                        simulation: state3.lesMisGUPSimulation
                      })(bind115(drawLesMisGUPSimple(forcesArray)(activeForces2)(graph)("#lesmis-gup-simple-viz"))(function() {
                        return pure39(unit);
                      }))))(function(newState) {
                        return discard34(modify_11(function(s) {
                          var $41 = {};
                          for (var $42 in s) {
                            if ({}.hasOwnProperty.call(s, $42)) {
                              $41[$42] = s[$42];
                            }
                            ;
                          }
                          ;
                          $41.lesMisGUPSimulation = newState.simulation;
                          return $41;
                        }))(function() {
                          return log9("LesMisGUPSimple: Initialized successfully");
                        });
                      });
                    });
                  });
                }
                ;
                throw new Error("Failed pattern match at Component.LesMisGUPSimple (line 141, column 5 - line 156, column 56): " + [lesMisResponse.constructor.name]);
              })())(function() {
                return pure114(unit);
              });
            });
          });
        });
      }
      ;
      if (v instanceof FilterNodes2) {
        return discard34(log9("Filtering nodes to group >= " + show45(v.value0)))(function() {
          return bind39(get15)(function(state3) {
            if (state3.originalGraph instanceof Nothing) {
              return log9("Error: Original graph data not loaded");
            }
            ;
            if (state3.originalGraph instanceof Just) {
              var filteredNodes = (function() {
                var $46 = v.value0 === 0;
                if ($46) {
                  return state3.originalGraph.value0.nodes;
                }
                ;
                return filter(function(n) {
                  return n.group >= v.value0;
                })(state3.originalGraph.value0.nodes);
              })();
              return discard34(log9("Filtered to " + (show45(length(filteredNodes)) + " nodes")))(function() {
                return bind39(liftAff3(execD3v2SimM({
                  simulation: state3.lesMisGUPSimulation
                })(updateNodes2(filteredNodes))))(function(newState) {
                  return modify_11(function(s) {
                    var $47 = {};
                    for (var $48 in s) {
                      if ({}.hasOwnProperty.call(s, $48)) {
                        $47[$48] = s[$48];
                      }
                      ;
                    }
                    ;
                    $47.lesMisGUPSimulation = newState.simulation;
                    return $47;
                  });
                });
              });
            }
            ;
            throw new Error("Failed pattern match at Component.LesMisGUPSimple (line 163, column 5 - line 174, column 72): " + [state3.originalGraph.constructor.name]);
          });
        });
      }
      ;
      throw new Error("Failed pattern match at Component.LesMisGUPSimple (line 134, column 16 - line 174, column 72): " + [v.constructor.name]);
    };
  };
  var forceLibrary4 = /* @__PURE__ */ (function() {
    return initialize(foldableArray)(functorArray)([forces4.manyBodyNeg, forces4.collision, forces4.center, forces4.links]);
  })();
  var component19 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return {
          lesMisGUPSimulation: initialSimulationState(forceLibrary4),
          originalGraph: Nothing.value
        };
      },
      render: render23,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction18(dictMonadAff),
        initialize: new Just(Initialize19.value)
      })
    });
  };

  // output/D3.Viz.LesMisGUPV2/foreign.js
  function setNodesGridPositions_(nodes) {
    return function(gridSpacing) {
      return function() {
        const nodeCount = nodes.length;
        const columns = Math.floor(Math.ceil(Math.sqrt(nodeCount)));
        const offset = -(columns * gridSpacing) / 2;
        nodes.forEach((node, i2) => {
          node.sx = node.x;
          node.sy = node.y;
          const d18 = i2;
          const c = columns;
          const x47 = d18 % c;
          const y48 = Math.floor(d18 / c);
          node.fx = x47 * gridSpacing + offset;
          node.fy = y48 * gridSpacing + offset;
        });
        return nodes;
      };
    };
  }
  function setNodesPhyllotaxisPositions_(nodes) {
    return function() {
      const initialRadius8 = 10;
      const initialAngle7 = Math.PI * (3 - Math.sqrt(5));
      nodes.forEach((node, index5) => {
        node.sx = node.x;
        node.sy = node.y;
        const i2 = index5;
        const radius39 = initialRadius8 * Math.sqrt(0.5 + i2);
        const angle = i2 * initialAngle7;
        node.fx = radius39 * Math.cos(angle);
        node.fy = radius39 * Math.sin(angle);
      });
      return nodes;
    };
  }
  function transitionToCachedPositions_(svgSelector) {
    return function(nodeSelector) {
      return function(linkSelector) {
        return function(nodes) {
          return function(links) {
            return function(onComplete) {
              return function() {
                requestAnimationFrame(() => {
                  const svg2 = select_default2(svgSelector);
                  const nodeElements = svg2.selectAll(nodeSelector);
                  const linkElements = svg2.selectAll(linkSelector);
                  if (nodeElements.empty()) {
                    console.error(`Could not find ${nodeSelector} elements to transition`);
                    onComplete();
                    return;
                  }
                  const t = transition().duration(1500);
                  nodeElements.transition(t).attrTween("cx", function(d18, i2) {
                    const startX = parseFloat(select_default2(this).attr("cx"));
                    const node = nodes[i2];
                    const endX = node && node.sx !== null && node.sx !== void 0 ? node.sx : node && node.x !== void 0 ? node.x : startX;
                    return value_default(startX, endX);
                  }).attrTween("cy", function(d18, i2) {
                    const startY = parseFloat(select_default2(this).attr("cy"));
                    const node = nodes[i2];
                    const endY = node && node.sy !== null && node.sy !== void 0 ? node.sy : node && node.y !== void 0 ? node.y : startY;
                    return value_default(startY, endY);
                  }).on("end", function(d18, i2) {
                    if (i2 === nodes.length - 1) {
                      nodes.forEach((node) => {
                        node.fx = null;
                        node.fy = null;
                        node.sx = null;
                        node.sy = null;
                      });
                      onComplete();
                    }
                  });
                  linkElements.transition(t).attrTween("x1", function(d18, i2) {
                    const startX = parseFloat(select_default2(this).attr("x1"));
                    if (i2 >= links.length) {
                      console.warn("Link index out of bounds:", i2, "of", links.length);
                      return () => startX;
                    }
                    const link4 = links[i2];
                    const sourceNode = nodes.find((n) => n.id === link4.source.id);
                    const endX = sourceNode && sourceNode.sx !== null && sourceNode.sx !== void 0 ? sourceNode.sx : sourceNode ? sourceNode.x : startX;
                    return value_default(startX, endX);
                  }).attrTween("y1", function(d18, i2) {
                    const startY = parseFloat(select_default2(this).attr("y1"));
                    if (i2 >= links.length) return () => startY;
                    const link4 = links[i2];
                    const sourceNode = nodes.find((n) => n.id === link4.source.id);
                    const endY = sourceNode && sourceNode.sy !== null && sourceNode.sy !== void 0 ? sourceNode.sy : sourceNode ? sourceNode.y : startY;
                    return value_default(startY, endY);
                  }).attrTween("x2", function(d18, i2) {
                    const startX = parseFloat(select_default2(this).attr("x2"));
                    if (i2 >= links.length) return () => startX;
                    const link4 = links[i2];
                    const targetNode = nodes.find((n) => n.id === link4.target.id);
                    const endX = targetNode && targetNode.sx !== null && targetNode.sx !== void 0 ? targetNode.sx : targetNode ? targetNode.x : startX;
                    return value_default(startX, endX);
                  }).attrTween("y2", function(d18, i2) {
                    const startY = parseFloat(select_default2(this).attr("y2"));
                    if (i2 >= links.length) return () => startY;
                    const link4 = links[i2];
                    const targetNode = nodes.find((n) => n.id === link4.target.id);
                    const endY = targetNode && targetNode.sy !== null && targetNode.sy !== void 0 ? targetNode.sy : targetNode ? targetNode.y : startY;
                    return value_default(startY, endY);
                  });
                });
              };
            };
          };
        };
      };
    };
  }
  function transitionToFxFyPositions_(svgSelector) {
    return function(nodeSelector) {
      return function(linkSelector) {
        return function(nodes) {
          return function(links) {
            return function(onComplete) {
              return function() {
                const svg2 = select_default2(svgSelector);
                const nodeElements = svg2.selectAll(nodeSelector);
                const linkElements = svg2.selectAll(linkSelector);
                if (nodeElements.empty()) {
                  console.error(`Could not find ${nodeSelector} elements to transition`);
                  onComplete();
                  return;
                }
                const t = transition().duration(1500);
                nodeElements.transition(t).attrTween("cx", function(d18, i2) {
                  const startX = parseFloat(select_default2(this).attr("cx"));
                  const node = nodes[i2];
                  if (node && node.fx !== null && node.fx !== void 0) {
                    return value_default(startX, node.fx);
                  }
                  const endX = node && node.x !== void 0 ? node.x : startX;
                  return value_default(startX, endX);
                }).attrTween("cy", function(d18, i2) {
                  const startY = parseFloat(select_default2(this).attr("cy"));
                  const node = nodes[i2];
                  if (node && node.fy !== null && node.fy !== void 0) {
                    return value_default(startY, node.fy);
                  }
                  const endY = node && node.y !== void 0 ? node.y : startY;
                  return value_default(startY, endY);
                }).on("end", function(d18, i2) {
                  if (i2 === nodes.length - 1) {
                    onComplete();
                  }
                });
                linkElements.transition(t).attrTween("x1", function(d18, i2) {
                  const startX = parseFloat(select_default2(this).attr("x1"));
                  if (i2 >= links.length) {
                    console.warn("Link index out of bounds:", i2, "of", links.length);
                    return () => startX;
                  }
                  const link4 = links[i2];
                  const sourceNode = nodes.find((n) => n.id === link4.source.id);
                  const endX = sourceNode && sourceNode.fx !== null && sourceNode.fx !== void 0 ? sourceNode.fx : sourceNode ? sourceNode.x : startX;
                  return value_default(startX, endX);
                }).attrTween("y1", function(d18, i2) {
                  const startY = parseFloat(select_default2(this).attr("y1"));
                  if (i2 >= links.length) return () => startY;
                  const link4 = links[i2];
                  const sourceNode = nodes.find((n) => n.id === link4.source.id);
                  const endY = sourceNode && sourceNode.fy !== null && sourceNode.fy !== void 0 ? sourceNode.fy : sourceNode ? sourceNode.y : startY;
                  return value_default(startY, endY);
                }).attrTween("x2", function(d18, i2) {
                  const startX = parseFloat(select_default2(this).attr("x2"));
                  if (i2 >= links.length) return () => startX;
                  const link4 = links[i2];
                  const targetNode = nodes.find((n) => n.id === link4.target.id);
                  const endX = targetNode && targetNode.fx !== null && targetNode.fx !== void 0 ? targetNode.fx : targetNode ? targetNode.x : startX;
                  return value_default(startX, endX);
                }).attrTween("y2", function(d18, i2) {
                  const startY = parseFloat(select_default2(this).attr("y2"));
                  if (i2 >= links.length) return () => startY;
                  const link4 = links[i2];
                  const targetNode = nodes.find((n) => n.id === link4.target.id);
                  const endY = targetNode && targetNode.fy !== null && targetNode.fy !== void 0 ? targetNode.fy : targetNode ? targetNode.y : startY;
                  return value_default(startY, endY);
                });
              };
            };
          };
        };
      };
    };
  }

  // output/D3.Viz.LesMisGUPV2/index.js
  var compare11 = /* @__PURE__ */ compare(ordString);
  var eq15 = /* @__PURE__ */ eq(eqOrdering);
  var discard35 = /* @__PURE__ */ discard(discardUnit)(bindD3v2SimM);
  var log8 = /* @__PURE__ */ log3(monadEffectD3v2SimM);
  var show46 = /* @__PURE__ */ show(showInt);
  var bind40 = /* @__PURE__ */ bind(bindD3v2SimM);
  var select15 = /* @__PURE__ */ select4(selectionMD3v2Selection_D1);
  var mapFlipped11 = /* @__PURE__ */ mapFlipped(functorArray);
  var x17 = /* @__PURE__ */ x1(toAttrNumberFunctionNumbe);
  var y17 = /* @__PURE__ */ y1(toAttrNumberFunctionNumbe);
  var x28 = /* @__PURE__ */ x22(toAttrNumberFunctionNumbe);
  var y28 = /* @__PURE__ */ y22(toAttrNumberFunctionNumbe);
  var strokeWidth15 = /* @__PURE__ */ strokeWidth3(toAttrNumberFunctionNumbe);
  var stroke15 = /* @__PURE__ */ stroke(toAttrStringFunctionStrin);
  var cx17 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy17 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius16 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill22 = /* @__PURE__ */ fill3(toAttrStringString);
  var stroke16 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth16 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var renderTree28 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D1);
  var lookup24 = /* @__PURE__ */ lookup2(ordString);
  var on8 = /* @__PURE__ */ on2(selectionMD3v2Selection_D1);
  var addTickFunction5 = /* @__PURE__ */ addTickFunction(simulationMD3v2Selection_);
  var cx18 = /* @__PURE__ */ cx3(toAttrNumberFunctionNumbe);
  var cy18 = /* @__PURE__ */ cy3(toAttrNumberFunctionNumbe);
  var reheat3 = /* @__PURE__ */ reheat(simulationM2D3v2Selection);
  var start8 = /* @__PURE__ */ start3(simulationMD3v2Selection_);
  var update6 = /* @__PURE__ */ update3(simulationM2D3v2Selection);
  var get16 = /* @__PURE__ */ get(monadStateRecordD3v2SimM);
  var liftEffect22 = /* @__PURE__ */ liftEffect(monadEffectD3v2SimM);
  var $$void10 = /* @__PURE__ */ $$void(functorAff);
  var stop3 = /* @__PURE__ */ stop(simulationMD3v2Selection_);
  var pure40 = /* @__PURE__ */ pure(applicativeEffect);
  var fromFoldable39 = /* @__PURE__ */ fromFoldable8(foldableArray)(ordString);
  var member4 = /* @__PURE__ */ member2(ordString);
  var width24 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height24 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox18 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var show122 = /* @__PURE__ */ show(showNumber);
  var id_10 = /* @__PURE__ */ id_(toAttrStringString);
  var class_21 = /* @__PURE__ */ class_2(toAttrStringString);
  var renderTree111 = /* @__PURE__ */ renderTree28(ordUnit);
  var init9 = /* @__PURE__ */ init4(simulationMD3v2Selection_);
  var pure115 = /* @__PURE__ */ pure(applicativeD3v2SimM);
  var KeyedNode2 = function(x47) {
    return x47;
  };
  var eqKeyedNode = {
    eq: function(v) {
      return function(v1) {
        return v.id === v1.id;
      };
    }
  };
  var ordKeyedNode = {
    compare: function(v) {
      return function(v1) {
        return compare11(v.id)(v1.id);
      };
    },
    Eq0: function() {
      return eqKeyedNode;
    }
  };
  var renderTree29 = /* @__PURE__ */ renderTree28(ordKeyedNode);
  var eqIndexedLink3 = {
    eq: function(v) {
      return function(v1) {
        return v.link.source.id === v1.link.source.id && v.link.target.id === v1.link.target.id;
      };
    }
  };
  var ordIndexedLink3 = {
    compare: function(v) {
      return function(v1) {
        var sourceComp = compare11(v.link.source.id)(v1.link.source.id);
        var $121 = eq15(sourceComp)(EQ.value);
        if ($121) {
          return compare11(v.link.target.id)(v1.link.target.id);
        }
        ;
        return sourceComp;
      };
    },
    Eq0: function() {
      return eqIndexedLink3;
    }
  };
  var renderTree34 = /* @__PURE__ */ renderTree28(ordIndexedLink3);
  var updateForceGraph = function(nodesInSim) {
    return function(linksInSim) {
      return discard35(log8("updateForceGraph: " + (show46(length(nodesInSim)) + (" nodes, " + (show46(length(linksInSim)) + " links")))))(function() {
        return bind40(select15("#links"))(function(linksGroup) {
          return bind40(select15("#nodes"))(function(nodesGroup) {
            var indexedLinks = mapWithIndex2(function(i2) {
              return function(link4) {
                return {
                  index: i2,
                  link: link4
                };
              };
            })(linksInSim);
            var keyedNodes = mapFlipped11(nodesInSim)(KeyedNode2);
            var linksTree = joinData2("linkElements")("line")(indexedLinks)(function(v) {
              return elem4(Line2.value)([x17(function(v1) {
                return v.link.source.x;
              }), y17(function(v1) {
                return v.link.source.y;
              }), x28(function(v1) {
                return v.link.target.x;
              }), y28(function(v1) {
                return v.link.target.y;
              }), strokeWidth15(function(v1) {
                return sqrt(v.link.value);
              }), stroke15(function(v1) {
                return d3SchemeCategory10N_(toNumber(v.link.target.group));
              })]);
            });
            var nodesTree = joinData2("nodeElements")("circle")(keyedNodes)(function(v) {
              return elem4(Circle2.value)([cx17(v.x), cy17(v.y), radius16(5), fill22(d3SchemeCategory10N_(toNumber(v.group))), stroke16("#fff"), strokeWidth16(2)]);
            });
            return bind40(renderTree34(linksGroup)(linksTree))(function(linksSelections) {
              return bind40(renderTree29(nodesGroup)(nodesTree))(function(nodesSelections) {
                var nodeCircles = (function() {
                  var v = lookup24("nodeElements")(nodesSelections);
                  if (v instanceof Just) {
                    return v.value0;
                  }
                  ;
                  if (v instanceof Nothing) {
                    return unsafeCrashWith("nodeElements not found");
                  }
                  ;
                  throw new Error("Failed pattern match at D3.Viz.LesMisGUPV2 (line 489, column 21 - line 491, column 76): " + [v.constructor.name]);
                })();
                var linkLines = (function() {
                  var v = lookup24("linkElements")(linksSelections);
                  if (v instanceof Just) {
                    return v.value0;
                  }
                  ;
                  if (v instanceof Nothing) {
                    return unsafeCrashWith("linkElements not found");
                  }
                  ;
                  throw new Error("Failed pattern match at D3.Viz.LesMisGUPV2 (line 494, column 19 - line 496, column 76): " + [v.constructor.name]);
                })();
                return bind40(on8(new Drag2(simulationDrag("lesmis-gup")))(nodeCircles))(function() {
                  return discard35(addTickFunction5("nodes")(new Step4(nodeCircles, [cx18(function(v) {
                    return v.x;
                  }), cy18(function(v) {
                    return v.y;
                  })])))(function() {
                    return discard35(addTickFunction5("links")(new Step4(linkLines, [x17(function(v) {
                      return v.link.source.x;
                    }), y17(function(v) {
                      return v.link.source.y;
                    }), x28(function(v) {
                      return v.link.target.x;
                    }), y28(function(v) {
                      return v.link.target.y;
                    })])))(function() {
                      return discard35(reheat3(0.8))(function() {
                        return start8;
                      });
                    });
                  });
                });
              });
            });
          });
        });
      });
    };
  };
  var unpinNodes = /* @__PURE__ */ (function() {
    return bind40(update6({
      nodes: Nothing.value,
      links: Nothing.value,
      nodeFilter: Nothing.value,
      linkFilter: Nothing.value,
      activeForces: Nothing.value,
      config: Nothing.value,
      keyFn: keyIsID_
    }))(function(v) {
      return bind40(get16)(function(simHandle) {
        return liftEffect22(transitionToCachedPositions_("#lesmis-gup-v2-svg")(".nodes circle")(".links line")(v.nodes)(v.links)(launchAff_($$void10(runD3v2SimM(simHandle)(discard35(reheat3(0.5))(function() {
          return start8;
        }))))));
      });
    });
  })();
  var moveToPhylotaxis = /* @__PURE__ */ discard35(stop3)(function() {
    return bind40(update6({
      nodes: Nothing.value,
      links: Nothing.value,
      nodeFilter: Nothing.value,
      linkFilter: Nothing.value,
      activeForces: Nothing.value,
      config: Nothing.value,
      keyFn: keyIsID_
    }))(function(v) {
      return bind40(liftEffect22(setNodesPhyllotaxisPositions_(v.nodes)))(function() {
        return liftEffect22(transitionToFxFyPositions_("#lesmis-gup-v2-svg")(".nodes circle")(".links line")(v.nodes)(v.links)(pure40(unit)));
      });
    });
  });
  var moveToGrid = function(gridSpacing) {
    return discard35(stop3)(function() {
      return bind40(update6({
        nodes: Nothing.value,
        links: Nothing.value,
        nodeFilter: Nothing.value,
        linkFilter: Nothing.value,
        activeForces: Nothing.value,
        config: Nothing.value,
        keyFn: keyIsID_
      }))(function(v) {
        return bind40(liftEffect22(setNodesGridPositions_(v.nodes)(gridSpacing)))(function() {
          return liftEffect22(transitionToFxFyPositions_("#lesmis-gup-v2-svg")(".nodes circle")(".links line")(v.nodes)(v.links)(pure40(unit)));
        });
      });
    });
  };
  var initialRadius4 = 10;
  var initialAngle4 = /* @__PURE__ */ (function() {
    return pi * (3 - sqrt(5));
  })();
  var setPhyllotaxisInitialPositions2 = function(nodes) {
    var setPosition = function(index5) {
      return function(node) {
        var i2 = toNumber(index5);
        var rad = initialRadius4 * sqrt(0.5 + i2);
        var angle = i2 * initialAngle4;
        var newX = rad * cos(angle);
        var newY = rad * sin(angle);
        var $149 = {};
        for (var $150 in node) {
          if ({}.hasOwnProperty.call(node, $150)) {
            $149[$150] = node[$150];
          }
          ;
        }
        ;
        $149.x = newX;
        $149.y = newY;
        return $149;
      };
    };
    return mapWithIndex2(setPosition)(nodes);
  };
  var filterByGroupWithOriginal = function(minGroup) {
    return function(originalGraph) {
      return discard35(log8("=== filterByGroupWithOriginal: minGroup = " + (show46(minGroup) + " ===")))(function() {
        return discard35(stop3)(function() {
          var filteredNodes = filter(function(n) {
            return n.group >= minGroup;
          })(originalGraph.nodes);
          var filteredNodeIds = fromFoldable39(mapFlipped11(filteredNodes)(function(n) {
            return n.id;
          }));
          var filteredLinks = filter(function(link4) {
            return member4(link4.source)(filteredNodeIds) && member4(link4.target)(filteredNodeIds);
          })(originalGraph.links);
          return discard35(log8("Filtered from " + (show46(length(originalGraph.nodes)) + (" to " + (show46(length(filteredNodes)) + " nodes")))))(function() {
            return bind40(update6({
              nodes: new Just(filteredNodes),
              links: new Just(filteredLinks),
              nodeFilter: Nothing.value,
              linkFilter: Nothing.value,
              activeForces: Nothing.value,
              config: Nothing.value,
              keyFn: keyIsID_
            }))(function(v) {
              return updateForceGraph(v.nodes)(v.links);
            });
          });
        });
      });
    };
  };
  var drawLesMisGUPV2 = function(forcesArray) {
    return function(activeForces2) {
      return function(model) {
        return function(containerSelector) {
          return bind40(liftEffect22(getWindowWidthHeight))(function(v) {
            return bind40(select15(containerSelector))(function(container) {
              var forceGraphTree = withChild(named2(SVG.value)("svg")([width24(v.value0), height24(v.value1), viewBox18(show122(-v.value0 / 2) + (" " + (show122(-v.value1 / 2) + (" " + (show122(v.value0) + (" " + show122(v.value1))))))), id_10("lesmis-gup-v2-svg"), class_21("lesmis-gup-v2")]))(withChildren(named2(Group2.value)("zoomGroup")([id_10("zoom-group"), class_21("zoom-group")]))([named2(Group2.value)("linksGroup")([id_10("links"), class_21("links")]), named2(Group2.value)("nodesGroup")([id_10("nodes"), class_21("nodes")])]));
              return bind40(renderTree111(container)(forceGraphTree))(function(selections) {
                return bind40(liftEffect22(reselectD3v2("svg")(selections)))(function(svg2) {
                  return bind40(liftEffect22(reselectD3v2("zoomGroup")(selections)))(function(zoomGroup) {
                    return bind40(liftEffect22(reselectD3v2("linksGroup")(selections)))(function(linksGroup) {
                      return bind40(liftEffect22(reselectD3v2("nodesGroup")(selections)))(function(nodesGroup) {
                        return bind40(on8(new Drag2(defaultDrag))(zoomGroup))(function() {
                          return bind40(on8(new Zoom2(defaultZoom(new ScaleExtent2(0.5, 4))("#zoom-group")))(svg2))(function() {
                            var nodesWithPositions = setPhyllotaxisInitialPositions2(model.nodes);
                            return bind40(init9({
                              nodes: nodesWithPositions,
                              links: model.links,
                              forces: forcesArray,
                              activeForces: activeForces2,
                              config: {
                                alpha: 1,
                                alphaTarget: 0,
                                alphaMin: 1e-3,
                                alphaDecay: 0.0228,
                                velocityDecay: 0.4
                              },
                              keyFn: keyIsID_,
                              ticks: empty3
                            }))(function(v1) {
                              var indexedLinks = mapWithIndex2(function(i2) {
                                return function(link4) {
                                  return {
                                    index: i2,
                                    link: link4
                                  };
                                };
                              })(v1.links);
                              var linksTree = joinData2("linkElements")("line")(indexedLinks)(function(v2) {
                                return elem4(Line2.value)([x17(function(v3) {
                                  return v2.link.source.x;
                                }), y17(function(v3) {
                                  return v2.link.source.y;
                                }), x28(function(v3) {
                                  return v2.link.target.x;
                                }), y28(function(v3) {
                                  return v2.link.target.y;
                                }), strokeWidth15(function(v3) {
                                  return sqrt(v2.link.value);
                                }), stroke15(function(v3) {
                                  return d3SchemeCategory10N_(toNumber(v2.link.target.group));
                                })]);
                              });
                              return bind40(renderTree34(linksGroup)(linksTree))(function(linksSelections) {
                                var keyedNodes = mapFlipped11(v1.nodes)(KeyedNode2);
                                var nodesTree = joinData2("nodeElements")("circle")(keyedNodes)(function(v2) {
                                  return elem4(Circle2.value)([cx17(v2.x), cy17(v2.y), radius16(5), fill22(d3SchemeCategory10N_(toNumber(v2.group))), stroke16("#fff"), strokeWidth16(2)]);
                                });
                                return bind40(renderTree29(nodesGroup)(nodesTree))(function(nodesSelections) {
                                  var nodeCircles = (function() {
                                    var v2 = lookup24("nodeElements")(nodesSelections);
                                    if (v2 instanceof Just) {
                                      return v2.value0;
                                    }
                                    ;
                                    if (v2 instanceof Nothing) {
                                      return unsafeCrashWith("nodeElements not found");
                                    }
                                    ;
                                    throw new Error("Failed pattern match at D3.Viz.LesMisGUPV2 (line 275, column 21 - line 277, column 76): " + [v2.constructor.name]);
                                  })();
                                  var linkLines = (function() {
                                    var v2 = lookup24("linkElements")(linksSelections);
                                    if (v2 instanceof Just) {
                                      return v2.value0;
                                    }
                                    ;
                                    if (v2 instanceof Nothing) {
                                      return unsafeCrashWith("linkElements not found");
                                    }
                                    ;
                                    throw new Error("Failed pattern match at D3.Viz.LesMisGUPV2 (line 280, column 19 - line 282, column 76): " + [v2.constructor.name]);
                                  })();
                                  return bind40(on8(new Drag2(simulationDrag("lesmis-gup")))(nodeCircles))(function() {
                                    return discard35(addTickFunction5("nodes")(new Step4(nodeCircles, [cx18(function(v2) {
                                      return v2.x;
                                    }), cy18(function(v2) {
                                      return v2.y;
                                    })])))(function() {
                                      return discard35(addTickFunction5("links")(new Step4(linkLines, [x17(function(v2) {
                                        return v2.link.source.x;
                                      }), y17(function(v2) {
                                        return v2.link.source.y;
                                      }), x28(function(v2) {
                                        return v2.link.target.x;
                                      }), y28(function(v2) {
                                        return v2.link.target.y;
                                      })])))(function() {
                                        return discard35(start8)(function() {
                                          return pure115({
                                            nodesGroup: Group2.value,
                                            linksGroup: Group2.value
                                          });
                                        });
                                      });
                                    });
                                  });
                                });
                              });
                            });
                          });
                        });
                      });
                    });
                  });
                });
              });
            });
          });
        };
      };
    };
  };

  // output/Component.LesMisGUPTree/index.js
  var discard36 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var bind41 = /* @__PURE__ */ bind(bindHalogenM);
  var fromFoldable40 = /* @__PURE__ */ fromFoldable8(foldableArray)(ordString);
  var modify_12 = /* @__PURE__ */ modify_2(monadStateHalogenM);
  var get17 = /* @__PURE__ */ get(monadStateHalogenM);
  var bind116 = /* @__PURE__ */ bind(bindD3v2SimM);
  var pure41 = /* @__PURE__ */ pure(applicativeD3v2SimM);
  var pure116 = /* @__PURE__ */ pure(applicativeHalogenM);
  var show47 = /* @__PURE__ */ show(showInt);
  var Initialize20 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var MoveToGrid = /* @__PURE__ */ (function() {
    function MoveToGrid2() {
    }
    ;
    MoveToGrid2.value = new MoveToGrid2();
    return MoveToGrid2;
  })();
  var MoveToPhylotaxis = /* @__PURE__ */ (function() {
    function MoveToPhylotaxis2() {
    }
    ;
    MoveToPhylotaxis2.value = new MoveToPhylotaxis2();
    return MoveToPhylotaxis2;
  })();
  var UnpinNodes = /* @__PURE__ */ (function() {
    function UnpinNodes2() {
    }
    ;
    UnpinNodes2.value = new UnpinNodes2();
    return UnpinNodes2;
  })();
  var FilterNodes3 = /* @__PURE__ */ (function() {
    function FilterNodes5(value0) {
      this.value0 = value0;
    }
    ;
    FilterNodes5.create = function(value0) {
      return new FilterNodes5(value0);
    };
    return FilterNodes5;
  })();
  var render24 = function(v) {
    return div2([class_("lesmis-gup-tree-page")])([div2([class_("page-header")])([h1_([text2("Les Mis\xE9rables - Tree API + GUP + Dynamic Layouts")]), p([class_("page-description")])([text2("Full-featured force simulation using declarative Tree API with General Update Pattern (enter/update/exit) and dynamic layout transitions.")])]), div2([class_("controls-panel")])([div2([class_("control-section")])([h3_([text2("Layout Transitions")]), p_([text2("Transform node positions with smooth D3 transitions:")]), div2([class_("button-group")])([button([class_("control-button"), onClick(function(v1) {
      return MoveToGrid.value;
    })])([text2("Grid Layout")]), button([class_("control-button"), onClick(function(v1) {
      return MoveToPhylotaxis.value;
    })])([text2("Phylotaxis (Spiral)")]), button([class_("control-button"), onClick(function(v1) {
      return UnpinNodes.value;
    })])([text2("Force-Directed")])])]), div2([class_("control-section")])([h3_([text2("Node Filtering (GUP)")]), p_([text2("Demonstrate enter/update/exit pattern by filtering nodes:")]), div2([class_("button-group")])([button([class_("control-button"), onClick(function(v1) {
      return new FilterNodes3(0);
    })])([text2("All Nodes (77)")]), button([class_("control-button"), onClick(function(v1) {
      return new FilterNodes3(5);
    })])([text2("Group \u2265 5")]), button([class_("control-button"), onClick(function(v1) {
      return new FilterNodes3(8);
    })])([text2("Group \u2265 8")])])])]), div2([id3("lesmis-gup-tree-viz"), class_("viz-container")])([]), div2([class_("info-panel")])([h3_([text2("What This Demonstrates")]), ul_([li_([text2("Declarative Tree API - entire DOM structure defined as a tree")]), li_([text2("General Update Pattern - Tree API handles enter/update/exit automatically")]), li_([text2("Dynamic layouts - Grid, Phylotaxis (sunflower spiral), Force-directed")]), li_([text2("Simulation state management - forces, nodes, links updated declaratively")]), li_([text2("Interactive behaviors - drag nodes, zoom/pan, simulation drag")])]), h3_([text2("Check Browser Console")]), p_([text2("Open the browser console to see detailed logging of simulation state, node counts, and GUP operations.")])])]);
  };
  var forces5 = /* @__PURE__ */ (function() {
    return {
      manyBodyNeg: createForce("many body negative")(new RegularForce(ForceManyBody.value))(allNodes)([strengthVal(-100)]),
      collision: createForce("collision")(new RegularForce(ForceCollide.value))(allNodes)([radiusVal(6)]),
      center: createForce("center")(new RegularForce(ForceCenter.value))(allNodes)([xVal(0), yVal(0), strengthVal(0.1)]),
      links: createLinkForce(allNodes)([])
    };
  })();
  var handleAction19 = function(dictMonadAff) {
    var log9 = log3(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    var liftAff3 = liftAff(monadAffHalogenM(dictMonadAff));
    return function(v) {
      if (v instanceof Initialize20) {
        return discard36(log9("LesMisGUPTree: Initializing"))(function() {
          return discard36(liftAff3(delay(100)))(function() {
            return bind41(liftAff3(get3(string)("./data/miserables.json")))(function(lesMisResponse) {
              return discard36((function() {
                if (lesMisResponse instanceof Left) {
                  return log9("Failed to load Les Mis\xE9rables data");
                }
                ;
                if (lesMisResponse instanceof Right) {
                  var graph = readGraphFromFileContents(new Right(lesMisResponse.value0));
                  var forcesArray = [forces5.manyBodyNeg, forces5.collision, forces5.center, forces5.links];
                  var activeForces2 = fromFoldable40(["many body negative", "collision", "center", linksForceName_]);
                  return discard36(modify_12(function(s) {
                    var $42 = {};
                    for (var $43 in s) {
                      if ({}.hasOwnProperty.call(s, $43)) {
                        $42[$43] = s[$43];
                      }
                      ;
                    }
                    ;
                    $42.originalGraph = new Just(graph);
                    return $42;
                  }))(function() {
                    return bind41(get17)(function(state3) {
                      return bind41(liftAff3(execD3v2SimM({
                        simulation: state3.lesMisGUPSimulation
                      })(bind116(drawLesMisGUPV2(forcesArray)(activeForces2)(graph)("#lesmis-gup-tree-viz"))(function() {
                        return pure41(unit);
                      }))))(function(newState) {
                        return discard36(modify_12(function(s) {
                          var $45 = {};
                          for (var $46 in s) {
                            if ({}.hasOwnProperty.call(s, $46)) {
                              $45[$46] = s[$46];
                            }
                            ;
                          }
                          ;
                          $45.lesMisGUPSimulation = newState.simulation;
                          return $45;
                        }))(function() {
                          return log9("LesMisGUPTree: Initialized successfully");
                        });
                      });
                    });
                  });
                }
                ;
                throw new Error("Failed pattern match at Component.LesMisGUPTree (line 150, column 5 - line 165, column 54): " + [lesMisResponse.constructor.name]);
              })())(function() {
                return pure116(unit);
              });
            });
          });
        });
      }
      ;
      if (v instanceof MoveToGrid) {
        return discard36(log9("Moving to grid layout"))(function() {
          return bind41(get17)(function(state3) {
            return bind41(liftAff3(execD3v2SimM({
              simulation: state3.lesMisGUPSimulation
            })(moveToGrid(30))))(function(newState) {
              return modify_12(function(s) {
                var $49 = {};
                for (var $50 in s) {
                  if ({}.hasOwnProperty.call(s, $50)) {
                    $49[$50] = s[$50];
                  }
                  ;
                }
                ;
                $49.lesMisGUPSimulation = newState.simulation;
                return $49;
              });
            });
          });
        });
      }
      ;
      if (v instanceof MoveToPhylotaxis) {
        return discard36(log9("Moving to phylotaxis layout"))(function() {
          return bind41(get17)(function(state3) {
            return bind41(liftAff3(execD3v2SimM({
              simulation: state3.lesMisGUPSimulation
            })(moveToPhylotaxis)))(function(newState) {
              return modify_12(function(s) {
                var $52 = {};
                for (var $53 in s) {
                  if ({}.hasOwnProperty.call(s, $53)) {
                    $52[$53] = s[$53];
                  }
                  ;
                }
                ;
                $52.lesMisGUPSimulation = newState.simulation;
                return $52;
              });
            });
          });
        });
      }
      ;
      if (v instanceof UnpinNodes) {
        return discard36(log9("Unpinning nodes (returning to force layout)"))(function() {
          return bind41(get17)(function(state3) {
            return bind41(liftAff3(execD3v2SimM({
              simulation: state3.lesMisGUPSimulation
            })(unpinNodes)))(function(newState) {
              return modify_12(function(s) {
                var $55 = {};
                for (var $56 in s) {
                  if ({}.hasOwnProperty.call(s, $56)) {
                    $55[$56] = s[$56];
                  }
                  ;
                }
                ;
                $55.lesMisGUPSimulation = newState.simulation;
                return $55;
              });
            });
          });
        });
      }
      ;
      if (v instanceof FilterNodes3) {
        return discard36(log9("Filtering nodes to group >= " + show47(v.value0)))(function() {
          return bind41(get17)(function(state3) {
            if (state3.originalGraph instanceof Nothing) {
              return log9("Error: Original graph data not loaded");
            }
            ;
            if (state3.originalGraph instanceof Just) {
              return bind41(liftAff3(execD3v2SimM({
                simulation: state3.lesMisGUPSimulation
              })(filterByGroupWithOriginal(v.value0)(state3.originalGraph.value0))))(function(newState) {
                return modify_12(function(s) {
                  var $59 = {};
                  for (var $60 in s) {
                    if ({}.hasOwnProperty.call(s, $60)) {
                      $59[$60] = s[$60];
                    }
                    ;
                  }
                  ;
                  $59.lesMisGUPSimulation = newState.simulation;
                  return $59;
                });
              });
            }
            ;
            throw new Error("Failed pattern match at Component.LesMisGUPTree (line 193, column 5 - line 198, column 72): " + [state3.originalGraph.constructor.name]);
          });
        });
      }
      ;
      throw new Error("Failed pattern match at Component.LesMisGUPTree (line 143, column 16 - line 198, column 72): " + [v.constructor.name]);
    };
  };
  var forceLibrary5 = /* @__PURE__ */ (function() {
    return initialize(foldableArray)(functorArray)([forces5.manyBodyNeg, forces5.collision, forces5.center, forces5.links]);
  })();
  var component20 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return {
          lesMisGUPSimulation: initialSimulationState(forceLibrary5),
          originalGraph: Nothing.value
        };
      },
      render: render24,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction19(dictMonadAff),
        initialize: new Just(Initialize20.value)
      })
    });
  };

  // output/D3.Viz.LesMis.QueryDemoFFI/foreign.js
  function createGroupButtons(groups) {
    return function(colorFn) {
      return function(onToggle) {
        return function() {
          console.log("createGroupButtons called with:", { groups, colorFn, onToggle });
          const container = document.createElement("div");
          container.className = "query-demo-controls";
          container.style.cssText = "position: fixed; top: 10px; right: 10px; background: white; padding: 10px; border-radius: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); z-index: 1000; max-width: 200px;";
          const title4 = document.createElement("h3");
          title4.textContent = "Toggle Group Sizes";
          title4.style.cssText = "margin: 0 0 10px 0; font-size: 14px; font-weight: bold;";
          container.appendChild(title4);
          const desc = document.createElement("p");
          desc.textContent = "Click to toggle size for each group";
          desc.style.cssText = "margin: 0 0 10px 0; font-size: 11px; color: #666;";
          container.appendChild(desc);
          const largeGroups = /* @__PURE__ */ new Set();
          groups.forEach((group4) => {
            const btn = document.createElement("button");
            btn.className = `group-btn group-btn-${group4}`;
            btn.textContent = `Group ${group4}`;
            btn.style.cssText = `display: block; margin: 5px 0; padding: 5px 10px; background: ${colorFn(group4)}; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 12px; width: 100%; transition: all 0.2s;`;
            btn.addEventListener("click", () => {
              const isLarge = !largeGroups.has(group4);
              if (isLarge) {
                largeGroups.add(group4);
                btn.style.border = "2px solid #333";
                btn.style.fontWeight = "bold";
              } else {
                largeGroups.delete(group4);
                btn.style.border = "none";
                btn.style.fontWeight = "normal";
              }
              const selector = `.group-${group4}`;
              console.log(`Looking for: ${selector}`);
              const circles = document.querySelectorAll(selector);
              console.log(`Found ${circles.length} circles`);
              const newRadius = isLarge ? 10 : 5;
              circles.forEach((circle) => {
                circle.setAttribute("r", newRadius);
              });
            });
            container.appendChild(btn);
          });
          document.body.appendChild(container);
          return container;
        };
      };
    };
  }

  // output/D3.Viz.LesMis.QueryDemo/index.js
  var compare13 = /* @__PURE__ */ compare(ordInt);
  var bind42 = /* @__PURE__ */ bind(bindD3v2SimM);
  var liftEffect23 = /* @__PURE__ */ liftEffect(monadEffectD3v2SimM);
  var nub5 = /* @__PURE__ */ nub(ordInt);
  var map54 = /* @__PURE__ */ map(functorArray);
  var sort3 = /* @__PURE__ */ sort(ordInt);
  var select16 = /* @__PURE__ */ select4(selectionMD3v2Selection_D1);
  var width25 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height25 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox19 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var show48 = /* @__PURE__ */ show(showNumber);
  var id_11 = /* @__PURE__ */ id_(toAttrStringString);
  var class_22 = /* @__PURE__ */ class_2(toAttrStringString);
  var ordNullable5 = /* @__PURE__ */ ordNullable(ordNumber);
  var ordRecord6 = /* @__PURE__ */ ordRecord()(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordNil)()({
    reflectSymbol: function() {
      return "y";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "x";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "vy";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "vx";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "sy";
    }
  })(ordNullable5))()({
    reflectSymbol: function() {
      return "sx";
    }
  })(ordNullable5))()({
    reflectSymbol: function() {
      return "id";
    }
  })(ordString))()({
    reflectSymbol: function() {
      return "group";
    }
  })(ordInt))()({
    reflectSymbol: function() {
      return "fy";
    }
  })(ordNullable5))()({
    reflectSymbol: function() {
      return "fx";
    }
  })(ordNullable5));
  var renderTree30 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D1)(ordRecord6);
  var on9 = /* @__PURE__ */ on2(selectionMD3v2Selection_D1);
  var init10 = /* @__PURE__ */ init4(simulationMD3v2Selection_);
  var joinData5 = /* @__PURE__ */ joinData(selectionMD3v2Selection_D1)(foldableArray);
  var append113 = /* @__PURE__ */ append10(selectionMD3v2Selection_D1);
  var x18 = /* @__PURE__ */ x1(toAttrNumberFunctionNumbe);
  var y18 = /* @__PURE__ */ y1(toAttrNumberFunctionNumbe);
  var x29 = /* @__PURE__ */ x22(toAttrNumberFunctionNumbe);
  var y29 = /* @__PURE__ */ y22(toAttrNumberFunctionNumbe);
  var strokeWidth17 = /* @__PURE__ */ strokeWidth3(toAttrNumberFunctionNumbe);
  var stroke17 = /* @__PURE__ */ stroke(toAttrStringFunctionStrin);
  var joinData12 = /* @__PURE__ */ joinData5(ordRecord6);
  var cx19 = /* @__PURE__ */ cx3(toAttrNumberFunctionNumbe);
  var cy19 = /* @__PURE__ */ cy3(toAttrNumberFunctionNumbe);
  var radius17 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill23 = /* @__PURE__ */ fill3(toAttrStringFunctionStrin);
  var stroke18 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth18 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var id_1 = /* @__PURE__ */ id_(toAttrStringFunctionStrin);
  var class_110 = /* @__PURE__ */ class_2(toAttrStringFunctionStrin);
  var show123 = /* @__PURE__ */ show(showInt);
  var discard37 = /* @__PURE__ */ discard(discardUnit)(bindD3v2SimM);
  var addTickFunction6 = /* @__PURE__ */ addTickFunction(simulationMD3v2Selection_);
  var pure42 = /* @__PURE__ */ pure(applicativeEffect);
  var start9 = /* @__PURE__ */ start3(simulationMD3v2Selection_);
  var pure117 = /* @__PURE__ */ pure(applicativeD3v2SimM);
  var eqIndexedLink4 = {
    eq: function(v) {
      return function(v1) {
        return v.index === v1.index;
      };
    }
  };
  var ordIndexedLink4 = {
    compare: function(v) {
      return function(v1) {
        return compare13(v.index)(v1.index);
      };
    },
    Eq0: function() {
      return eqIndexedLink4;
    }
  };
  var joinData22 = /* @__PURE__ */ joinData5(ordIndexedLink4);
  var initialRadius5 = 10;
  var initialAngle5 = /* @__PURE__ */ (function() {
    return pi * (3 - sqrt(5));
  })();
  var setPhyllotaxisPositions5 = function(nodes) {
    var setPosition = function(index5) {
      return function(node) {
        var i2 = toNumber(index5);
        var rad = initialRadius5 * sqrt(0.5 + i2);
        var angle = i2 * initialAngle5;
        var $138 = {};
        for (var $139 in node) {
          if ({}.hasOwnProperty.call(node, $139)) {
            $138[$139] = node[$139];
          }
          ;
        }
        ;
        $138.x = rad * cos(angle);
        $138.y = rad * sin(angle);
        return $138;
      };
    };
    return mapWithIndex2(setPosition)(nodes);
  };
  var drawLesMisQueryDemo = function(forcesArray) {
    return function(activeForces2) {
      return function(model) {
        return function(containerSelector) {
          return bind42(liftEffect23(getWindowWidthHeight))(function(v) {
            var groups = nub5(map54(function(v1) {
              return v1.group;
            })(model.nodes));
            var sortedGroups = sort3(groups);
            return bind42(select16(containerSelector))(function(container) {
              var vizTree = withChildren(withChild(named2(SVG.value)("svg")([width25(v.value0), height25(v.value1), viewBox19(show48(-v.value0 / 2) + (" " + (show48(-v.value1 / 2) + (" " + (show48(v.value0) + (" " + show48(v.value1))))))), id_11("lesmis-query-demo-svg"), class_22("lesmis-query-demo")]))(named2(Group2.value)("zoomGroup")([id_11("zoom-group"), class_22("zoom-group")])))([named2(Group2.value)("linksGroup")([id_11("links"), class_22("links")]), named2(Group2.value)("nodesGroup")([id_11("nodes"), class_22("nodes")])]);
              return bind42(renderTree30(container)(vizTree))(function(selections) {
                return bind42(liftEffect23(reselectD3v2("svg")(selections)))(function(svg2) {
                  return bind42(liftEffect23(reselectD3v2("zoomGroup")(selections)))(function(zoomGroup) {
                    return bind42(liftEffect23(reselectD3v2("linksGroup")(selections)))(function(linksGroup) {
                      return bind42(liftEffect23(reselectD3v2("nodesGroup")(selections)))(function(nodesGroup) {
                        return bind42(on9(new Drag2(defaultDrag))(zoomGroup))(function() {
                          return bind42(on9(new Zoom2(defaultZoom(new ScaleExtent2(0.5, 4))("#zoom-group")))(svg2))(function() {
                            var nodesWithPositions = setPhyllotaxisPositions5(model.nodes);
                            return bind42(init10({
                              nodes: nodesWithPositions,
                              links: model.links,
                              forces: forcesArray,
                              activeForces: activeForces2,
                              config: {
                                alpha: 1,
                                alphaTarget: 0,
                                alphaMin: 1e-3,
                                alphaDecay: 0.0228,
                                velocityDecay: 0.4
                              },
                              keyFn: keyIsID_,
                              ticks: empty3
                            }))(function(v1) {
                              var indexedLinks = mapWithIndex2(function(i2) {
                                return function(link4) {
                                  return {
                                    index: i2,
                                    link: link4
                                  };
                                };
                              })(v1.links);
                              return bind42(joinData22(indexedLinks)("line")(linksGroup))(function(v2) {
                                return bind42(append113(Line2.value)([x18(function(v3) {
                                  return v3.link.source.x;
                                }), y18(function(v3) {
                                  return v3.link.source.y;
                                }), x29(function(v3) {
                                  return v3.link.target.x;
                                }), y29(function(v3) {
                                  return v3.link.target.y;
                                }), strokeWidth17(function(v3) {
                                  return sqrt(v3.link.value);
                                }), stroke17(function(v3) {
                                  return d3SchemeCategory10N_(toNumber(v3.link.target.group));
                                })])(v2.value0.enter))(function(linkLines) {
                                  return bind42(joinData12(v1.nodes)("circle")(nodesGroup))(function(v3) {
                                    return bind42(append113(Circle2.value)([cx19(function(v4) {
                                      return v4.x;
                                    }), cy19(function(v4) {
                                      return v4.y;
                                    }), radius17(5), fill23(function(v4) {
                                      return d3SchemeCategory10N_(toNumber(v4.group));
                                    }), stroke18("#fff"), strokeWidth18(2), id_1(function(v4) {
                                      return "node-" + v4.id;
                                    }), class_110(function(v4) {
                                      return "node group-" + show123(v4.group);
                                    })])(v3.value0.enter))(function(nodeCircles) {
                                      return bind42(on9(new Drag2(simulationDrag("lesmis-query")))(nodeCircles))(function() {
                                        return discard37(addTickFunction6("nodes")(new Step4(nodeCircles, [cx19(function(v4) {
                                          return v4.x;
                                        }), cy19(function(v4) {
                                          return v4.y;
                                        })])))(function() {
                                          return discard37(addTickFunction6("links")(new Step4(linkLines, [x18(function(v4) {
                                            return v4.link.source.x;
                                          }), y18(function(v4) {
                                            return v4.link.source.y;
                                          }), x29(function(v4) {
                                            return v4.link.target.x;
                                          }), y29(function(v4) {
                                            return v4.link.target.y;
                                          })])))(function() {
                                            return discard37(liftEffect23(createGroupButtons(sortedGroups)(function(group4) {
                                              return d3SchemeCategory10N_(toNumber(group4));
                                            })(function(v4) {
                                              return function(v5) {
                                                return pure42(unit);
                                              };
                                            })))(function() {
                                              return discard37(start9)(function() {
                                                return pure117(unit);
                                              });
                                            });
                                          });
                                        });
                                      });
                                    });
                                  });
                                });
                              });
                            });
                          });
                        });
                      });
                    });
                  });
                });
              });
            });
          });
        };
      };
    };
  };

  // output/Component.LesMisQueryDemo/index.js
  var bind43 = /* @__PURE__ */ bind(bindHalogenM);
  var pure43 = /* @__PURE__ */ pure(applicativeEffect);
  var fromFoldable41 = /* @__PURE__ */ fromFoldable8(foldableArray)(ordString);
  var $$void11 = /* @__PURE__ */ $$void(functorHalogenM);
  var Initialize21 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var render25 = function(v) {
    return div2([class_("lesmis-query-demo-page")])([div2([class_("page-header")])([h1_([text2("Selection Query Language Demo")]), p([class_("page-description")])([text2("Demonstrates the PSD3v2 selection query language (PSD3v2.Selection.Query). Click buttons to toggle group sizes using queryAll + filterByData.")]), div2([class_("code-example")])([pre_([code_([text2('-- Query all circles\nallCircles <- queryAll "circle" selections\n\n-- Filter to specific group using data predicate\ngroupNodes <- filterByData (\\\\d -> d.group == targetGroup) allCircles\n\n-- Update attributes\nsetAttrs [radius 10.0] groupNodes')])])])]), div2([id3("lesmis-query-demo-viz"), class_("viz-container")])([])]);
  };
  var forces6 = /* @__PURE__ */ (function() {
    return {
      manyBodyNeg: createForce("many body negative")(new RegularForce(ForceManyBody.value))(allNodes)([strengthVal(-100)]),
      collision: createForce("collision")(new RegularForce(ForceCollide.value))(allNodes)([radiusVal(6)]),
      center: createForce("center")(new RegularForce(ForceCenter.value))(allNodes)([xVal(0), yVal(0), strengthVal(0.1)]),
      links: createLinkForce(allNodes)([])
    };
  })();
  var forceLibrary6 = /* @__PURE__ */ (function() {
    return initialize(foldableArray)(functorArray)([forces6.manyBodyNeg, forces6.collision, forces6.center, forces6.links]);
  })();
  var handleAction20 = function(dictMonadAff) {
    var liftAff3 = liftAff(monadAffHalogenM(dictMonadAff));
    var liftEffect51 = liftEffect(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    return function(v) {
      return bind43(liftAff3(get3(string)("./data/miserables.json")))(function(result) {
        if (result instanceof Left) {
          return liftEffect51(pure43(unit));
        }
        ;
        if (result instanceof Right) {
          var model = readGraphFromFileContents(new Right(result.value0));
          var forcesArray = [forces6.manyBodyNeg, forces6.collision, forces6.center, forces6.links];
          var activeForces2 = fromFoldable41(["many body negative", "collision", "center", "links"]);
          var initialState4 = {
            simulation: initialSimulationState(forceLibrary6)
          };
          return $$void11(liftAff3(runD3v2SimM(initialState4)(drawLesMisQueryDemo(forcesArray)(activeForces2)(model)("#lesmis-query-demo-viz"))));
        }
        ;
        throw new Error("Failed pattern match at Component.LesMisQueryDemo (line 91, column 5 - line 104, column 96): " + [result.constructor.name]);
      });
    };
  };
  var component21 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render25,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction20(dictMonadAff),
        initialize: new Just(Initialize21.value)
      })
    });
  };

  // output/Component.MermaidTreeDemo/foreign.js
  function runMermaid() {
    setTimeout(function() {
      if (window.mermaid) {
        window.mermaid.run({
          querySelector: ".mermaid"
        });
      }
    }, 0);
  }

  // output/PSD3v2.Interpreter.MermaidTree/index.js
  var bindStateT2 = /* @__PURE__ */ bindStateT(monadEffect);
  var applicativeStateT2 = /* @__PURE__ */ applicativeStateT(monadEffect);
  var bind44 = /* @__PURE__ */ bind(bindStateT2);
  var monadStateStateT2 = /* @__PURE__ */ monadStateStateT(monadEffect);
  var get18 = /* @__PURE__ */ get(monadStateStateT2);
  var show49 = /* @__PURE__ */ show(showInt);
  var discard38 = /* @__PURE__ */ discard(discardUnit);
  var discard111 = /* @__PURE__ */ discard38(bindStateT2);
  var modify_13 = /* @__PURE__ */ modify_2(monadStateStateT2);
  var pure44 = /* @__PURE__ */ pure(applicativeStateT2);
  var showElement2 = function(v) {
    if (v instanceof SVG) {
      return "svg";
    }
    ;
    if (v instanceof Group2) {
      return "g";
    }
    ;
    if (v instanceof Circle2) {
      return "circle";
    }
    ;
    if (v instanceof Rect2) {
      return "rect";
    }
    ;
    if (v instanceof Line2) {
      return "line";
    }
    ;
    if (v instanceof Path3) {
      return "path";
    }
    ;
    if (v instanceof Text3) {
      return "text";
    }
    ;
    if (v instanceof Div2) {
      return "div";
    }
    ;
    if (v instanceof Span2) {
      return "span";
    }
    ;
    if (v instanceof Table2) {
      return "table";
    }
    ;
    if (v instanceof Tr2) {
      return "tr";
    }
    ;
    if (v instanceof Td2) {
      return "td";
    }
    ;
    if (v instanceof Th) {
      return "th";
    }
    ;
    if (v instanceof Thead) {
      return "thead";
    }
    ;
    if (v instanceof Tbody) {
      return "tbody";
    }
    ;
    throw new Error("Failed pattern match at PSD3v2.Interpreter.MermaidTree (line 58, column 1 - line 58, column 37): " + [v.constructor.name]);
  };
  var generateStyleDefinitions = /* @__PURE__ */ (function() {
    return "\n    %% Style definitions\n    classDef elementNode fill:#e6f598,stroke:#abdda4,stroke-width:2px\n    classDef joinNode fill:#f46d43,stroke:#d53e4f,stroke-width:2px\n    classDef nestedJoinNode fill:#fdae61,stroke:#f46d43,stroke-width:2px\n    classDef templateNode fill:#abdda4,stroke:#66c2a5,stroke-width:2px\n    classDef decomposeNode fill:#fee08b,stroke:#fdae61,stroke-width:2px\n";
  })();
  var formatAttribute = function(v) {
    if (v instanceof StaticAttr) {
      return v.value0;
    }
    ;
    if (v instanceof DataAttr) {
      return v.value0 + "(datum)";
    }
    ;
    if (v instanceof IndexedAttr) {
      return v.value0 + "(datum, i)";
    }
    ;
    throw new Error("Failed pattern match at PSD3v2.Interpreter.MermaidTree (line 77, column 19 - line 80, column 61): " + [v.constructor.name]);
  };
  var formatAttributeList = function(attrs) {
    if (attrs.length === 0) {
      return "";
    }
    ;
    return foldl2(function(acc) {
      return function(attr3) {
        var $45 = acc === "";
        if ($45) {
          return formatAttribute(attr3);
        }
        ;
        return acc + (", " + formatAttribute(attr3));
      };
    })("")(attrs);
  };
  var escapeLabel = /* @__PURE__ */ replaceAll('"')("'");
  var bindMermaidTreeM = bindStateT2;
  var bind212 = /* @__PURE__ */ bind(bindMermaidTreeM);
  var discard210 = /* @__PURE__ */ discard38(bindMermaidTreeM);
  var applicativeMermaidTreeM = applicativeStateT2;
  var traverse4 = /* @__PURE__ */ traverse(traversableArray)(applicativeMermaidTreeM);
  var pure211 = /* @__PURE__ */ pure(applicativeMermaidTreeM);
  var addNode = function(label5) {
    return function(styleClass) {
      return bind44(get18)(function(state3) {
        var nodeName3 = "n" + show49(state3.nodeCounter);
        var escapedLabel = escapeLabel(label5);
        var line = "    " + (nodeName3 + ('["' + (escapedLabel + ('"]:::' + (styleClass + "\n")))));
        return discard111(modify_13(function(s) {
          var $46 = {};
          for (var $47 in s) {
            if ({}.hasOwnProperty.call(s, $47)) {
              $46[$47] = s[$47];
            }
            ;
          }
          ;
          $46.nodeCounter = s.nodeCounter + 1 | 0;
          $46.mermaidCode = s.mermaidCode + line;
          return $46;
        }))(function() {
          return pure44(state3.nodeCounter);
        });
      });
    };
  };
  var addEdge = function(fromId) {
    return function(toId) {
      var toName = "n" + show49(toId);
      var fromName = "n" + show49(fromId);
      var line = "    " + (fromName + (" --> " + (toName + "\n")));
      return modify_13(function(s) {
        var $49 = {};
        for (var $50 in s) {
          if ({}.hasOwnProperty.call(s, $50)) {
            $49[$50] = s[$50];
          }
          ;
        }
        ;
        $49.mermaidCode = s.mermaidCode + line;
        return $49;
      });
    };
  };
  var renderTree31 = function(tree3) {
    return function(parentId) {
      var traverseWithParent = function(pid) {
        return function(children3) {
          return bind212(traverse4(function(child) {
            return renderTree31(child)(new Just(pid));
          })(children3))(function() {
            return pure211(unit);
          });
        };
      };
      if (tree3 instanceof Node3) {
        var nodeLabel = (function() {
          if (tree3.value0.name instanceof Just) {
            return "<" + (showElement2(tree3.value0.elemType) + (' "' + (tree3.value0.name.value0 + '">')));
          }
          ;
          if (tree3.value0.name instanceof Nothing) {
            return showElement2(tree3.value0.elemType);
          }
          ;
          throw new Error("Failed pattern match at PSD3v2.Interpreter.MermaidTree (line 94, column 21 - line 96, column 47): " + [tree3.value0.name.constructor.name]);
        })();
        var attrSuffix = (function() {
          var $55 = length(tree3.value0.attrs) > 0;
          if ($55) {
            return " + [" + (formatAttributeList(tree3.value0.attrs) + "]");
          }
          ;
          return "";
        })();
        var fullLabel = nodeLabel + attrSuffix;
        return bind212(addNode(fullLabel)("elementNode"))(function(nodeId) {
          return discard210((function() {
            if (parentId instanceof Just) {
              return addEdge(parentId.value0)(nodeId);
            }
            ;
            if (parentId instanceof Nothing) {
              return pure211(unit);
            }
            ;
            throw new Error("Failed pattern match at PSD3v2.Interpreter.MermaidTree (line 105, column 5 - line 107, column 27): " + [parentId.constructor.name]);
          })())(function() {
            return bind212(traverseWithParent(nodeId)(tree3.value0.children))(function() {
              return pure211(nodeId);
            });
          });
        });
      }
      ;
      if (tree3 instanceof Join2) {
        var joinLabel = 'JOIN "' + (tree3.value0.name + ('" (' + (tree3.value0.key + (") [" + (show49(length(tree3.value0.joinData)) + " items]")))));
        return bind212(addNode(joinLabel)("joinNode"))(function(joinId) {
          return discard210((function() {
            if (parentId instanceof Just) {
              return addEdge(parentId.value0)(joinId);
            }
            ;
            if (parentId instanceof Nothing) {
              return pure211(unit);
            }
            ;
            throw new Error("Failed pattern match at PSD3v2.Interpreter.MermaidTree (line 119, column 5 - line 121, column 27): " + [parentId.constructor.name]);
          })())(function() {
            return bind212(addNode("template(datum) \u2192")("templateNode"))(function(templateLabel) {
              return discard210(addEdge(joinId)(templateLabel))(function() {
                return discard210((function() {
                  var v = uncons(tree3.value0.joinData);
                  if (v instanceof Nothing) {
                    return pure211(unit);
                  }
                  ;
                  if (v instanceof Just) {
                    var templateTree = tree3.value0.template(v.value0.head);
                    return bind212(renderTree31(templateTree)(new Just(templateLabel)))(function() {
                      return pure211(unit);
                    });
                  }
                  ;
                  throw new Error("Failed pattern match at PSD3v2.Interpreter.MermaidTree (line 128, column 5 - line 133, column 18): " + [v.constructor.name]);
                })())(function() {
                  return pure211(joinId);
                });
              });
            });
          });
        });
      }
      ;
      if (tree3 instanceof NestedJoin) {
        var joinLabel = 'NESTED JOIN "' + (tree3.value0.name + ('" (' + (tree3.value0.key + (") [" + (show49(length(tree3.value0.joinData)) + " items]")))));
        return bind212(addNode(joinLabel)("nestedJoinNode"))(function(joinId) {
          return discard210((function() {
            if (parentId instanceof Just) {
              return addEdge(parentId.value0)(joinId);
            }
            ;
            if (parentId instanceof Nothing) {
              return pure211(unit);
            }
            ;
            throw new Error("Failed pattern match at PSD3v2.Interpreter.MermaidTree (line 143, column 5 - line 145, column 27): " + [parentId.constructor.name]);
          })())(function() {
            return bind212(addNode("decompose(datum) \u2192")("decomposeNode"))(function(decomposeId) {
              return discard210(addEdge(joinId)(decomposeId))(function() {
                return bind212(addNode("template(innerDatum) \u2192")("templateNode"))(function(templateId) {
                  return discard210(addEdge(decomposeId)(templateId))(function() {
                    return discard210((function() {
                      var v = uncons(tree3.value0.joinData);
                      if (v instanceof Nothing) {
                        return pure211(unit);
                      }
                      ;
                      if (v instanceof Just) {
                        var innerData = tree3.value0.decompose(v.value0.head);
                        var v1 = uncons(innerData);
                        if (v1 instanceof Nothing) {
                          return pure211(unit);
                        }
                        ;
                        if (v1 instanceof Just) {
                          var templateTree = tree3.value0.template(v1.value0.head);
                          return bind212(renderTree31(templateTree)(new Just(templateId)))(function() {
                            return pure211(unit);
                          });
                        }
                        ;
                        throw new Error("Failed pattern match at PSD3v2.Interpreter.MermaidTree (line 160, column 9 - line 165, column 22): " + [v1.constructor.name]);
                      }
                      ;
                      throw new Error("Failed pattern match at PSD3v2.Interpreter.MermaidTree (line 156, column 5 - line 165, column 22): " + [v.constructor.name]);
                    })())(function() {
                      return pure211(joinId);
                    });
                  });
                });
              });
            });
          });
        });
      }
      ;
      if (tree3 instanceof SceneJoin) {
        var behaviorInfo = (function() {
          var $74 = isJust(tree3.value0.enterBehavior);
          if ($74) {
            return "E";
          }
          ;
          return "";
        })() + ((function() {
          var $75 = isJust(tree3.value0.updateBehavior);
          if ($75) {
            return "U";
          }
          ;
          return "";
        })() + (function() {
          var $76 = isJust(tree3.value0.exitBehavior);
          if ($76) {
            return "X";
          }
          ;
          return "";
        })());
        var joinLabel = 'SCENE JOIN "' + (tree3.value0.name + ('" (' + (tree3.value0.key + (") [" + (show49(length(tree3.value0.joinData)) + (" items] {" + (behaviorInfo + "}")))))));
        return bind212(addNode(joinLabel)("sceneJoinNode"))(function(joinId) {
          return discard210((function() {
            if (parentId instanceof Just) {
              return addEdge(parentId.value0)(joinId);
            }
            ;
            if (parentId instanceof Nothing) {
              return pure211(unit);
            }
            ;
            throw new Error("Failed pattern match at PSD3v2.Interpreter.MermaidTree (line 180, column 5 - line 182, column 27): " + [parentId.constructor.name]);
          })())(function() {
            return bind212(addNode("template(datum) \u2192")("templateNode"))(function(templateLabel) {
              return discard210(addEdge(joinId)(templateLabel))(function() {
                return discard210((function() {
                  var v = uncons(tree3.value0.joinData);
                  if (v instanceof Nothing) {
                    return pure211(unit);
                  }
                  ;
                  if (v instanceof Just) {
                    var templateTree = tree3.value0.template(v.value0.head);
                    return bind212(renderTree31(templateTree)(new Just(templateLabel)))(function() {
                      return pure211(unit);
                    });
                  }
                  ;
                  throw new Error("Failed pattern match at PSD3v2.Interpreter.MermaidTree (line 189, column 5 - line 194, column 18): " + [v.constructor.name]);
                })())(function() {
                  return pure211(joinId);
                });
              });
            });
          });
        });
      }
      ;
      if (tree3 instanceof SceneNestedJoin) {
        var behaviorInfo = (function() {
          var $83 = isJust(tree3.value0.enterBehavior);
          if ($83) {
            return "E";
          }
          ;
          return "";
        })() + ((function() {
          var $84 = isJust(tree3.value0.updateBehavior);
          if ($84) {
            return "U";
          }
          ;
          return "";
        })() + (function() {
          var $85 = isJust(tree3.value0.exitBehavior);
          if ($85) {
            return "X";
          }
          ;
          return "";
        })());
        var joinLabel = 'SCENE NESTED JOIN "' + (tree3.value0.name + ('" (' + (tree3.value0.key + (") [" + (show49(length(tree3.value0.joinData)) + (" items] {" + (behaviorInfo + "}")))))));
        return bind212(addNode(joinLabel)("sceneNestedJoinNode"))(function(joinId) {
          return discard210((function() {
            if (parentId instanceof Just) {
              return addEdge(parentId.value0)(joinId);
            }
            ;
            if (parentId instanceof Nothing) {
              return pure211(unit);
            }
            ;
            throw new Error("Failed pattern match at PSD3v2.Interpreter.MermaidTree (line 209, column 5 - line 211, column 27): " + [parentId.constructor.name]);
          })())(function() {
            return bind212(addNode("decompose(datum) \u2192")("decomposeNode"))(function(decomposeId) {
              return discard210(addEdge(joinId)(decomposeId))(function() {
                return bind212(addNode("template(innerDatum) \u2192")("templateNode"))(function(templateLabel) {
                  return discard210(addEdge(decomposeId)(templateLabel))(function() {
                    return discard210((function() {
                      var v = uncons(tree3.value0.joinData);
                      if (v instanceof Nothing) {
                        return pure211(unit);
                      }
                      ;
                      if (v instanceof Just) {
                        var innerData = tree3.value0.decompose(v.value0.head);
                        var v1 = uncons(innerData);
                        if (v1 instanceof Nothing) {
                          return pure211(unit);
                        }
                        ;
                        if (v1 instanceof Just) {
                          var templateTree = tree3.value0.template(v1.value0.head);
                          return bind212(renderTree31(templateTree)(new Just(templateLabel)))(function() {
                            return pure211(unit);
                          });
                        }
                        ;
                        throw new Error("Failed pattern match at PSD3v2.Interpreter.MermaidTree (line 226, column 9 - line 231, column 22): " + [v1.constructor.name]);
                      }
                      ;
                      throw new Error("Failed pattern match at PSD3v2.Interpreter.MermaidTree (line 222, column 5 - line 231, column 22): " + [v.constructor.name]);
                    })())(function() {
                      return pure211(joinId);
                    });
                  });
                });
              });
            });
          });
        });
      }
      ;
      throw new Error("Failed pattern match at PSD3v2.Interpreter.MermaidTree (line 91, column 28 - line 233, column 16): " + [tree3.constructor.name]);
    };
  };
  var runMermaidTree = function(tree3) {
    var initialState4 = {
      nodeCounter: 0,
      mermaidCode: ""
    };
    var v = renderTree31(tree3)(Nothing.value);
    return function __do3() {
      var v1 = runStateT(v)(initialState4)();
      return "%%{init: {'theme':'base', 'themeVariables': {'fontFamily':'monospace'}, 'look':'handDrawn', 'flowchart':{'curve':'basis'}}}%%\n" + ("graph TD\n" + (v1.value1.mermaidCode + generateStyleDefinitions));
    };
  };

  // output/Component.MermaidTreeDemo/index.js
  var pure45 = /* @__PURE__ */ pure(applicativeHalogenM);
  var bind45 = /* @__PURE__ */ bind(bindHalogenM);
  var discard39 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var modify_14 = /* @__PURE__ */ modify_2(monadStateHalogenM);
  var Initialize22 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var GenerateSimpleTree = /* @__PURE__ */ (function() {
    function GenerateSimpleTree2() {
    }
    ;
    GenerateSimpleTree2.value = new GenerateSimpleTree2();
    return GenerateSimpleTree2;
  })();
  var GenerateJoinTree = /* @__PURE__ */ (function() {
    function GenerateJoinTree2() {
    }
    ;
    GenerateJoinTree2.value = new GenerateJoinTree2();
    return GenerateJoinTree2;
  })();
  var staticAttr = function(name16) {
    return function(value18) {
      return new StaticAttr(name16, new StringValue(value18));
    };
  };
  var render26 = function(state3) {
    return div2([class_("mermaid-tree-demo")])([h1_([text2("Mermaid Tree API Visualizer")]), p_([text2("This demonstrates the new Mermaid interpreter for the Tree API.")]), div2([class_("controls")])([button([class_("btn"), onClick(function(v) {
      return GenerateSimpleTree.value;
    })])([text2("Generate Simple Tree")]), button([class_("btn"), onClick(function(v) {
      return GenerateJoinTree.value;
    })])([text2("Generate Data Join Tree")])]), (function() {
      if (state3.mermaidCode instanceof Nothing) {
        return div_([text2("Click a button to generate a Mermaid diagram")]);
      }
      ;
      if (state3.mermaidCode instanceof Just) {
        return div_([h2_([text2("Generated Mermaid Code:")]), pre([class_("mermaid-code")])([text2(state3.mermaidCode.value0)]), div2([class_("mermaid")])([text2(state3.mermaidCode.value0)])]);
      }
      ;
      throw new Error("Failed pattern match at Component.MermaidTreeDemo (line 64, column 7 - line 74, column 12): " + [state3.mermaidCode.constructor.name]);
    })()]);
  };
  var dataAttr = function(name16) {
    return function(fn) {
      return new DataAttr(name16, fn);
    };
  };
  var handleAction21 = function(dictMonadAff) {
    var liftEffect51 = liftEffect(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    return function(v) {
      if (v instanceof Initialize22) {
        return pure45(unit);
      }
      ;
      if (v instanceof GenerateSimpleTree) {
        var tree3 = withChildren(named2(SVG.value)("svg")([staticAttr("width")("800"), staticAttr("height")("600")]))([withChild(elem4(Group2.value)([staticAttr("class")("container")]))(elem4(Circle2.value)([staticAttr("r")("50"), staticAttr("fill")("blue")])), elem4(Text3.value)([staticAttr("x")("100"), staticAttr("y")("100")])]);
        return bind45(liftEffect51(runMermaidTree(tree3)))(function(code2) {
          return discard39(modify_14(function(v1) {
            var $23 = {};
            for (var $24 in v1) {
              if ({}.hasOwnProperty.call(v1, $24)) {
                $23[$24] = v1[$24];
              }
              ;
            }
            ;
            $23.mermaidCode = new Just(code2);
            return $23;
          }))(function() {
            return liftEffect51(runMermaid);
          });
        });
      }
      ;
      if (v instanceof GenerateJoinTree) {
        var sampleData2 = [1, 2, 3, 4, 5];
        var tree3 = withChild(named2(SVG.value)("svg")([staticAttr("width")("800")]))(joinData2("circles")("circle")(sampleData2)(function(n) {
          return elem4(Circle2.value)([dataAttr("cx")(function(d18) {
            return new NumberValue(toNumber(d18) * 50);
          }), dataAttr("cy")(function(v1) {
            return new NumberValue(100);
          }), staticAttr("r")("20"), staticAttr("fill")("steelblue")]);
        }));
        return bind45(liftEffect51(runMermaidTree(tree3)))(function(code2) {
          return discard39(modify_14(function(v1) {
            var $26 = {};
            for (var $27 in v1) {
              if ({}.hasOwnProperty.call(v1, $27)) {
                $26[$27] = v1[$27];
              }
              ;
            }
            ;
            $26.mermaidCode = new Just(code2);
            return $26;
          }))(function() {
            return liftEffect51(runMermaid);
          });
        });
      }
      ;
      throw new Error("Failed pattern match at Component.MermaidTreeDemo (line 78, column 16 - line 107, column 26): " + [v.constructor.name]);
    };
  };
  var component22 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return {
          mermaidCode: Nothing.value
        };
      },
      render: render26,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction21(dictMonadAff),
        initialize: new Just(Initialize22.value)
      })
    });
  };

  // output/D3.Viz.ModuleGraph.Model/index.js
  var startsWith = function(prefix) {
    return function(str2) {
      var prefixLen = length3(prefix);
      return take3(prefixLen)(str2) === prefix;
    };
  };
  var moduleGroup = function(name16) {
    if (startsWith("PSD3.Internal")(name16)) {
      return 0;
    }
    ;
    if (startsWith("PSD3v2")(name16)) {
      return 1;
    }
    ;
    if (startsWith("PSD3.Layout")(name16)) {
      return 2;
    }
    ;
    if (startsWith("PSD3.Shared")(name16)) {
      return 3;
    }
    ;
    if (startsWith("PSD3.")(name16)) {
      return 4;
    }
    ;
    if (startsWith("Component.")(name16)) {
      return 5;
    }
    ;
    if (startsWith("D3.Viz")(name16)) {
      return 6;
    }
    ;
    if (startsWith("D3.")(name16)) {
      return 7;
    }
    ;
    if (startsWith("Utility")(name16)) {
      return 8;
    }
    ;
    if (otherwise) {
      return 9;
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.ModuleGraph.Model (line 44, column 1 - line 44, column 29): " + [name16.constructor.name]);
  };

  // output/D3.Viz.ModuleGraph.LoadModuleGraph/index.js
  var member5 = /* @__PURE__ */ member2(ordString);
  var map55 = /* @__PURE__ */ map(functorArray);
  var fromFoldable42 = /* @__PURE__ */ fromFoldable8(foldableArray)(ordString);
  var pure46 = /* @__PURE__ */ pure(applicativeAff);
  var startsWith2 = function(prefix) {
    return function(str2) {
      var v = indexOf2(prefix)(str2);
      if (v instanceof Just && v.value0 === 0) {
        return true;
      }
      ;
      return false;
    };
  };
  var makeNode = function(index5) {
    return function(name16) {
      return {
        id: name16,
        name: name16,
        group: moduleGroup(name16),
        index: index5,
        x: 0,
        y: 0,
        vx: 0,
        vy: 0,
        fx: toNullable(Nothing.value),
        fy: toNullable(Nothing.value)
      };
    };
  };
  var makeLinks4 = function(raw) {
    return function(localModulesSet) {
      return function(sourceIndex) {
        return function(sourceName) {
          var v = lookup(sourceName)(raw);
          if (v instanceof Nothing) {
            return [];
          }
          ;
          if (v instanceof Just) {
            var makeLink = function(target7) {
              return {
                source: sourceName,
                target: target7
              };
            };
            var localDeps = filter(function(dep) {
              return member5(dep)(localModulesSet);
            })(v.value0.depends);
            return map55(makeLink)(localDeps);
          }
          ;
          throw new Error("Failed pattern match at D3.Viz.ModuleGraph.LoadModuleGraph (line 80, column 3 - line 89, column 31): " + [v.constructor.name]);
        };
      };
    };
  };
  var isLocalModule = function(name16) {
    return startsWith2("PSD3")(name16) || (startsWith2("Component.")(name16) || (startsWith2("D3.Viz")(name16) || startsWith2("Utility")(name16)));
  };
  var processModuleGraph = function(raw) {
    var allModules = keys(raw);
    var localModules = filter(isLocalModule)(allModules);
    var localModulesSet = fromFoldable42(localModules);
    var links = concat(mapWithIndex2(makeLinks4(raw)(localModulesSet))(localModules));
    var nodes = mapWithIndex2(makeNode)(localModules);
    return {
      nodes,
      links
    };
  };
  var loadModuleGraph = /* @__PURE__ */ bind(bindAff)(/* @__PURE__ */ get3(json)("./data/spago-modules.json"))(function(result) {
    if (result instanceof Left) {
      return pure46(new Left("Failed to load module graph: " + printError(result.value0)));
    }
    ;
    if (result instanceof Right) {
      return pure46(new Right(processModuleGraph(result.value0.body)));
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.ModuleGraph.LoadModuleGraph (line 24, column 3 - line 29, column 44): " + [result.constructor.name]);
  });

  // output/D3.Viz.ModuleGraph.Viz/index.js
  var compare14 = /* @__PURE__ */ compare(ordInt);
  var bind46 = /* @__PURE__ */ bind(bindD3v2SimM);
  var liftEffect24 = /* @__PURE__ */ liftEffect(monadEffectD3v2SimM);
  var select17 = /* @__PURE__ */ select4(selectionMD3v2Selection_D1);
  var width26 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height26 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox20 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var show50 = /* @__PURE__ */ show(showNumber);
  var id_12 = /* @__PURE__ */ id_(toAttrStringString);
  var class_23 = /* @__PURE__ */ class_2(toAttrStringString);
  var renderTree35 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D1);
  var renderTree112 = /* @__PURE__ */ renderTree35(ordUnit);
  var on10 = /* @__PURE__ */ on2(selectionMD3v2Selection_D1);
  var init11 = /* @__PURE__ */ init4(simulationMD3v2Selection_);
  var x19 = /* @__PURE__ */ x1(toAttrNumberFunctionNumbe);
  var y19 = /* @__PURE__ */ y1(toAttrNumberFunctionNumbe);
  var x210 = /* @__PURE__ */ x22(toAttrNumberFunctionNumbe);
  var y210 = /* @__PURE__ */ y22(toAttrNumberFunctionNumbe);
  var strokeWidth19 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var stroke19 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeOpacity3 = /* @__PURE__ */ strokeOpacity(toAttrNumberNumber);
  var cx20 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy20 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius18 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill24 = /* @__PURE__ */ fill3(toAttrStringString);
  var ordNullable6 = /* @__PURE__ */ ordNullable(ordNumber);
  var renderTree210 = /* @__PURE__ */ renderTree35(/* @__PURE__ */ ordRecord()(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordNil)()({
    reflectSymbol: function() {
      return "y";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "x";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "vy";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "vx";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "name";
    }
  })(ordString))()({
    reflectSymbol: function() {
      return "index";
    }
  })(ordInt))()({
    reflectSymbol: function() {
      return "id";
    }
  })(ordString))()({
    reflectSymbol: function() {
      return "group";
    }
  })(ordInt))()({
    reflectSymbol: function() {
      return "fy";
    }
  })(ordNullable6))()({
    reflectSymbol: function() {
      return "fx";
    }
  })(ordNullable6)));
  var x20 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y20 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var textAnchor7 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var fontSize7 = /* @__PURE__ */ fontSize2(toAttrNumberNumber);
  var textContent9 = /* @__PURE__ */ textContent(toAttrStringString);
  var lookup25 = /* @__PURE__ */ lookup2(ordString);
  var discard40 = /* @__PURE__ */ discard(discardUnit)(bindD3v2SimM);
  var addTickFunction7 = /* @__PURE__ */ addTickFunction(simulationMD3v2Selection_);
  var cx110 = /* @__PURE__ */ cx3(toAttrNumberFunctionNumbe);
  var cy110 = /* @__PURE__ */ cy3(toAttrNumberFunctionNumbe);
  var x32 = /* @__PURE__ */ x3(toAttrNumberFunctionNumbe);
  var y32 = /* @__PURE__ */ y3(toAttrNumberFunctionNumbe);
  var start10 = /* @__PURE__ */ start3(simulationMD3v2Selection_);
  var pure47 = /* @__PURE__ */ pure(applicativeD3v2SimM);
  var eqIndexedLink5 = {
    eq: function(v) {
      return function(v1) {
        return v.index === v1.index;
      };
    }
  };
  var ordIndexedLink5 = {
    compare: function(v) {
      return function(v1) {
        return compare14(v.index)(v1.index);
      };
    },
    Eq0: function() {
      return eqIndexedLink5;
    }
  };
  var renderTree36 = /* @__PURE__ */ renderTree35(ordIndexedLink5);
  var drawModuleGraph = function(forcesArray) {
    return function(activeForces2) {
      return function(graph) {
        return function(containerSelector) {
          return bind46(liftEffect24(getWindowWidthHeight))(function(v) {
            return bind46(select17(containerSelector))(function(container) {
              var forceGraphTree = withChild(named2(SVG.value)("svg")([width26(v.value0), height26(v.value1), viewBox20(show50(-v.value0 / 2) + (" " + (show50(-v.value1 / 2) + (" " + (show50(v.value0) + (" " + show50(v.value1))))))), id_12("module-graph-svg"), class_23("module-graph")]))(withChildren(named2(Group2.value)("zoomGroup")([id_12("zoom-group"), class_23("zoom-group")]))([named2(Group2.value)("linksGroup")([id_12("links"), class_23("links")]), named2(Group2.value)("nodesGroup")([id_12("nodes"), class_23("nodes")]), named2(Group2.value)("labelsGroup")([id_12("labels"), class_23("labels")])]));
              return bind46(renderTree112(container)(forceGraphTree))(function(selections) {
                return bind46(liftEffect24(reselectD3v2("svg")(selections)))(function(svg2) {
                  return bind46(liftEffect24(reselectD3v2("linksGroup")(selections)))(function(linksGroup) {
                    return bind46(liftEffect24(reselectD3v2("nodesGroup")(selections)))(function(nodesGroup) {
                      return bind46(liftEffect24(reselectD3v2("labelsGroup")(selections)))(function(labelsGroup) {
                        return bind46(on10(new Zoom2(defaultZoom(new ScaleExtent2(0.1, 10))("#zoom-group")))(svg2))(function() {
                          return bind46(init11({
                            nodes: graph.nodes,
                            links: graph.links,
                            forces: forcesArray,
                            activeForces: activeForces2,
                            config: {
                              alpha: 1,
                              alphaTarget: 0,
                              alphaMin: 1e-3,
                              alphaDecay: 0.0228,
                              velocityDecay: 0.4
                            },
                            keyFn: keyIsID_,
                            ticks: empty3
                          }))(function(v1) {
                            var indexedLinks = mapWithIndex2(function(i2) {
                              return function(link4) {
                                return {
                                  index: i2,
                                  link: link4
                                };
                              };
                            })(v1.links);
                            var linksTree = joinData2("linkElements")("line")(indexedLinks)(function(v2) {
                              return elem4(Line2.value)([x19(function(v3) {
                                return v2.link.source.x;
                              }), y19(function(v3) {
                                return v2.link.source.y;
                              }), x210(function(v3) {
                                return v2.link.target.x;
                              }), y210(function(v3) {
                                return v2.link.target.y;
                              }), strokeWidth19(1), stroke19("#999"), strokeOpacity3(0.6)]);
                            });
                            return bind46(renderTree36(linksGroup)(linksTree))(function(linksSelections) {
                              var nodesTree = joinData2("nodeElements")("circle")(v1.nodes)(function(v2) {
                                return elem4(Circle2.value)([cx20(v2.x), cy20(v2.y), radius18(5), fill24(d3SchemeCategory10N_(toNumber(v2.group))), stroke19("#fff"), strokeWidth19(1.5)]);
                              });
                              return bind46(renderTree210(nodesGroup)(nodesTree))(function(nodesSelections) {
                                var labelsTree = joinData2("labelElements")("text")(v1.nodes)(function(v2) {
                                  return elem4(Text3.value)([x20(v2.x), y20(v2.y + 3), textAnchor7("middle"), fontSize7(10), fill24("#000"), strokeOpacity3(1), class_23("node-label"), textContent9(v2.name)]);
                                });
                                return bind46(renderTree210(labelsGroup)(labelsTree))(function(labelsSelections) {
                                  var nodeCircles = (function() {
                                    var v2 = lookup25("nodeElements")(nodesSelections);
                                    if (v2 instanceof Just) {
                                      return v2.value0;
                                    }
                                    ;
                                    if (v2 instanceof Nothing) {
                                      return unsafeCrashWith("nodeElements not found");
                                    }
                                    ;
                                    throw new Error("Failed pattern match at D3.Viz.ModuleGraph.Viz (line 179, column 21 - line 181, column 76): " + [v2.constructor.name]);
                                  })();
                                  var linkLines = (function() {
                                    var v2 = lookup25("linkElements")(linksSelections);
                                    if (v2 instanceof Just) {
                                      return v2.value0;
                                    }
                                    ;
                                    if (v2 instanceof Nothing) {
                                      return unsafeCrashWith("linkElements not found");
                                    }
                                    ;
                                    throw new Error("Failed pattern match at D3.Viz.ModuleGraph.Viz (line 184, column 19 - line 186, column 76): " + [v2.constructor.name]);
                                  })();
                                  var labelTexts = (function() {
                                    var v2 = lookup25("labelElements")(labelsSelections);
                                    if (v2 instanceof Just) {
                                      return v2.value0;
                                    }
                                    ;
                                    if (v2 instanceof Nothing) {
                                      return unsafeCrashWith("labelElements not found");
                                    }
                                    ;
                                    throw new Error("Failed pattern match at D3.Viz.ModuleGraph.Viz (line 189, column 20 - line 191, column 77): " + [v2.constructor.name]);
                                  })();
                                  return bind46(on10(new Drag2(simulationDrag("module-graph")))(nodeCircles))(function() {
                                    return discard40(addTickFunction7("links")(new Step4(linkLines, [x19(function(v2) {
                                      return v2.link.source.x;
                                    }), y19(function(v2) {
                                      return v2.link.source.y;
                                    }), x210(function(v2) {
                                      return v2.link.target.x;
                                    }), y210(function(v2) {
                                      return v2.link.target.y;
                                    })])))(function() {
                                      return discard40(addTickFunction7("nodes")(new Step4(nodeCircles, [cx110(function(v2) {
                                        return v2.x;
                                      }), cy110(function(v2) {
                                        return v2.y;
                                      })])))(function() {
                                        return discard40(addTickFunction7("labels")(new Step4(labelTexts, [x32(function(v2) {
                                          return v2.x;
                                        }), y32(function(v2) {
                                          return v2.y + 3;
                                        })])))(function() {
                                          return discard40(start10)(function() {
                                            return pure47(unit);
                                          });
                                        });
                                      });
                                    });
                                  });
                                });
                              });
                            });
                          });
                        });
                      });
                    });
                  });
                });
              });
            });
          });
        };
      };
    };
  };

  // output/Component.ModuleGraph/index.js
  var show51 = /* @__PURE__ */ show(showInt);
  var discard41 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var bind47 = /* @__PURE__ */ bind(bindHalogenM);
  var modify_15 = /* @__PURE__ */ modify_2(monadStateHalogenM);
  var fromFoldable43 = /* @__PURE__ */ fromFoldable8(foldableArray)(ordString);
  var get19 = /* @__PURE__ */ get(monadStateHalogenM);
  var pure48 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize23 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var render27 = function(state3) {
    var getGroupColor = function(v) {
      if (v === 0) {
        return "#1f77b4";
      }
      ;
      if (v === 1) {
        return "#ff7f0e";
      }
      ;
      if (v === 2) {
        return "#2ca02c";
      }
      ;
      if (v === 3) {
        return "#d62728";
      }
      ;
      if (v === 4) {
        return "#9467bd";
      }
      ;
      if (v === 5) {
        return "#8c564b";
      }
      ;
      if (v === 6) {
        return "#e377c2";
      }
      ;
      if (v === 7) {
        return "#7f7f7f";
      }
      ;
      if (v === 8) {
        return "#bcbd22";
      }
      ;
      return "#17becf";
    };
    var colorBox = function(group4) {
      return span2([class_("color-box"), style("background-color: " + (getGroupColor(group4) + ";"))])([]);
    };
    return div2([class_("module-graph-page")])([div2([class_("page-header")])([h1_([text2("Module Dependency Graph")]), p([class_("page-description")])([text2("Force-directed visualization of local module dependencies in this codebase. "), text2("Each node is a PureScript module, colored by top-level namespace. "), text2("Links show import relationships.")]), (function() {
      if (state3.moduleCount instanceof Just && state3.linkCount instanceof Just) {
        return p([class_("stats")])([text2(show51(state3.moduleCount.value0) + (" modules, " + (show51(state3.linkCount.value0) + " dependencies")))]);
      }
      ;
      return text2("");
    })()]), div2([id3("module-graph-viz"), class_("viz-container")])([]), div2([class_("info-panel")])([h3_([text2("Module Groups (by color)")]), ul_([li_([colorBox(0), text2("PSD3.Internal - Core library internals")]), li_([colorBox(1), text2("PSD3v2 - Tree API implementation")]), li_([colorBox(2), text2("PSD3.Layout - Layout algorithms (Sankey, Hierarchy)")]), li_([colorBox(3), text2("PSD3.Shared - Shared website utilities")]), li_([colorBox(4), text2("PSD3.* - Other library modules")]), li_([colorBox(5), text2("Component.* - Halogen components")]), li_([colorBox(6), text2("D3.Viz - Visualization implementations")]), li_([colorBox(7), text2("D3.* - Other viz modules")]), li_([colorBox(8), text2("Utility - Utility functions")])]), h3_([text2("Interactions")]), ul_([li_([text2("Drag nodes to reposition them")]), li_([text2("Zoom and pan with mouse wheel / trackpad")]), li_([text2("Watch for clusters and orphan modules")])])])]);
  };
  var forces7 = /* @__PURE__ */ (function() {
    return {
      manyBodyNeg: createForce("many body negative")(new RegularForce(ForceManyBody.value))(allNodes)([strengthVal(-30)]),
      collision: createForce("collision")(new RegularForce(ForceCollide.value))(allNodes)([radiusVal(8)]),
      center: createForce("center")(new RegularForce(ForceCenter.value))(allNodes)([xVal(0), yVal(0), strengthVal(0.1)]),
      links: createLinkForce(allNodes)([distanceVal(30)])
    };
  })();
  var handleAction22 = function(dictMonadAff) {
    var log9 = log3(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    var liftAff3 = liftAff(monadAffHalogenM(dictMonadAff));
    return function(v) {
      return discard41(log9("ModuleGraph: Initializing"))(function() {
        return discard41(liftAff3(delay(100)))(function() {
          return bind47(liftAff3(loadModuleGraph))(function(graphResult) {
            return discard41((function() {
              if (graphResult instanceof Left) {
                return log9("Failed to load module graph: " + graphResult.value0);
              }
              ;
              if (graphResult instanceof Right) {
                return discard41(log9("Loaded " + (show51(length(graphResult.value0.nodes)) + " modules")))(function() {
                  return discard41(modify_15(function(v1) {
                    var $35 = {};
                    for (var $36 in v1) {
                      if ({}.hasOwnProperty.call(v1, $36)) {
                        $35[$36] = v1[$36];
                      }
                      ;
                    }
                    ;
                    $35.moduleCount = new Just(length(graphResult.value0.nodes));
                    $35.linkCount = new Just(length(graphResult.value0.links));
                    return $35;
                  }))(function() {
                    var forcesArray = [forces7.manyBodyNeg, forces7.collision, forces7.center, forces7.links];
                    var activeForces2 = fromFoldable43(["many body negative", "collision", "center", linksForceName_]);
                    return bind47(get19)(function(state3) {
                      return bind47(liftAff3(execD3v2SimM({
                        simulation: state3.simulation
                      })(drawModuleGraph(forcesArray)(activeForces2)(graphResult.value0)("#module-graph-viz"))))(function(newState) {
                        return discard41(modify_15(function(s) {
                          var $38 = {};
                          for (var $39 in s) {
                            if ({}.hasOwnProperty.call(s, $39)) {
                              $38[$39] = s[$39];
                            }
                            ;
                          }
                          ;
                          $38.simulation = newState.simulation;
                          return $38;
                        }))(function() {
                          return log9("ModuleGraph: Initialized successfully");
                        });
                      });
                    });
                  });
                });
              }
              ;
              throw new Error("Failed pattern match at Component.ModuleGraph (line 135, column 5 - line 152, column 52): " + [graphResult.constructor.name]);
            })())(function() {
              return pure48(unit);
            });
          });
        });
      });
    };
  };
  var forceLibrary7 = /* @__PURE__ */ (function() {
    return initialize(foldableArray)(functorArray)([forces7.manyBodyNeg, forces7.collision, forces7.center, forces7.links]);
  })();
  var component23 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return {
          simulation: initialSimulationState(forceLibrary7),
          moduleCount: Nothing.value,
          linkCount: Nothing.value
        };
      },
      render: render27,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction22(dictMonadAff),
        initialize: new Just(Initialize23.value)
      })
    });
  };

  // output/D3.Viz.TreeAPI.SceneJoinDemo/foreign.js
  function clearInnerHTML(selector) {
    return function() {
      const element3 = document.querySelector(selector);
      if (element3) {
        element3.innerHTML = "";
      }
    };
  }

  // output/D3.Viz.TreeAPI.SceneJoinDemo/index.js
  var bind48 = /* @__PURE__ */ bind(bindD3v2M);
  var select18 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var discard42 = /* @__PURE__ */ discard(discardUnit)(bindD3v2M);
  var liftEffect25 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var width27 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height27 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox21 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var id_13 = /* @__PURE__ */ id_(toAttrStringString);
  var class_24 = /* @__PURE__ */ class_2(toAttrStringString);
  var renderTree37 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D);
  var renderTree113 = /* @__PURE__ */ renderTree37(ordUnit);
  var pure49 = /* @__PURE__ */ pure(applicativeD3v2M);
  var cx21 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy21 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius19 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill25 = /* @__PURE__ */ fill3(toAttrStringString);
  var stroke20 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth20 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var ordRecord7 = /* @__PURE__ */ ordRecord();
  var ordRecordCons6 = /* @__PURE__ */ ordRecordCons(ordRecordNil)();
  var renderTree211 = /* @__PURE__ */ renderTree37(/* @__PURE__ */ ordRecord7(/* @__PURE__ */ ordRecordCons6({
    reflectSymbol: function() {
      return "points";
    }
  })(/* @__PURE__ */ ordArray(/* @__PURE__ */ ordRecord7(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons6({
    reflectSymbol: function() {
      return "y";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "x";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "color";
    }
  })(ordString))))));
  var createSvgContainer = function(containerSelector) {
    return bind48(select18(containerSelector))(function(container) {
      return discard42(liftEffect25(clearInnerHTML(containerSelector)))(function() {
        var svgTree = withChildren(named2(SVG.value)("svg")([width27(800), height27(300), viewBox21("0 0 800 300"), id_13("scene-join-demo-svg"), class_24("scene-join-demo")]))([]);
        return bind48(renderTree113(container)(svgTree))(function() {
          return pure49(unit);
        });
      });
    });
  };
  var createCirclesTree = function(scene) {
    return sceneNestedJoin("circles")("circle")([scene])(function(v) {
      return v.points;
    })(function(point) {
      return elem4(Circle2.value)([cx21(point.x), cy21(point.y), radius19(20), fill25(point.color), stroke20("#000"), strokeWidth20(2)]);
    })({
      enterBehavior: new Just({
        initialAttrs: [cx21(400), cy21(150), radius19(0)],
        transition: new Just({
          duration: 600,
          delay: Nothing.value,
          easing: new Just(CubicInOut.value)
        })
      }),
      updateBehavior: new Just({
        attrs: [new DataAttr("cx", function(p2) {
          return new NumberValue(p2.x);
        }), new DataAttr("cy", function(p2) {
          return new NumberValue(p2.y);
        }), new DataAttr("r", function(v) {
          return new NumberValue(20);
        }), new DataAttr("fill", function(p2) {
          return new StringValue(p2.color);
        }), new DataAttr("stroke", function(v) {
          return new StringValue("#000");
        }), new DataAttr("stroke-width", function(v) {
          return new NumberValue(2);
        })],
        transition: new Just({
          duration: 400,
          delay: Nothing.value,
          easing: new Just(CubicInOut.value)
        })
      }),
      exitBehavior: new Just({
        attrs: [radius19(0)],
        transition: new Just({
          duration: 300,
          delay: Nothing.value,
          easing: new Just(CubicIn.value)
        })
      })
    });
  };
  var updateCircles = function(points) {
    return bind48(select18("#scene-join-demo-svg"))(function(svgContainer) {
      var scene = {
        points
      };
      var tree3 = createCirclesTree(scene);
      return bind48(renderTree211(svgContainer)(tree3))(function() {
        return pure49(unit);
      });
    });
  };
  var drawInitial = function(containerSelector) {
    return discard42(createSvgContainer(containerSelector))(function() {
      return updateCircles([{
        x: 100,
        y: 100,
        color: "red"
      }, {
        x: 200,
        y: 150,
        color: "blue"
      }, {
        x: 300,
        y: 100,
        color: "green"
      }, {
        x: 400,
        y: 150,
        color: "orange"
      }, {
        x: 500,
        y: 100,
        color: "purple"
      }]);
    });
  };
  var updateToSeven = function(v) {
    return updateCircles([{
      x: 100,
      y: 100,
      color: "red"
    }, {
      x: 200,
      y: 150,
      color: "blue"
    }, {
      x: 300,
      y: 100,
      color: "green"
    }, {
      x: 400,
      y: 150,
      color: "orange"
    }, {
      x: 500,
      y: 100,
      color: "purple"
    }, {
      x: 600,
      y: 150,
      color: "pink"
    }, {
      x: 700,
      y: 100,
      color: "cyan"
    }]);
  };
  var updateToThree = function(v) {
    return updateCircles([{
      x: 150,
      y: 120,
      color: "red"
    }, {
      x: 300,
      y: 100,
      color: "green"
    }, {
      x: 450,
      y: 130,
      color: "orange"
    }]);
  };

  // output/Component.SceneJoinDemo/index.js
  var Initialize24 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var ShowInitial = /* @__PURE__ */ (function() {
    function ShowInitial2() {
    }
    ;
    ShowInitial2.value = new ShowInitial2();
    return ShowInitial2;
  })();
  var ShowThree = /* @__PURE__ */ (function() {
    function ShowThree2() {
    }
    ;
    ShowThree2.value = new ShowThree2();
    return ShowThree2;
  })();
  var ShowSeven = /* @__PURE__ */ (function() {
    function ShowSeven2() {
    }
    ;
    ShowSeven2.value = new ShowSeven2();
    return ShowSeven2;
  })();
  var render28 = function(v) {
    return div2([class_("scene-join-demo-container")])([h1_([text2("SceneNestedJoin Demo")]), p_([text2("This demonstrates SceneNestedJoin - the clean solution for General Update Pattern with type decomposition!")]), div2([class_("controls")])([button([onClick(function(v1) {
      return ShowInitial.value;
    }), class_("btn btn-primary")])([text2("Show 5 Circles (Initial)")]), button([onClick(function(v1) {
      return ShowThree.value;
    }), class_("btn btn-warning")])([text2("Show 3 Circles (Exit)")]), button([onClick(function(v1) {
      return ShowSeven.value;
    }), class_("btn btn-success")])([text2("Show 7 Circles (Enter)")])]), div2([id3("scene-join-demo-viz"), class_("visualization")])([]), div2([class_("explanation")])([h3_([text2("What's Happening?")]), ul_([li_([text2("Initial: 5 circles enter from center with transition")]), li_([text2("Show 3: 2 circles exit (shrink away), 3 update positions")]), li_([text2("Show 7: 2 new circles enter from center, 5 update positions")])]), h3_([text2("The Code")]), pre_([code_([text2('T.sceneNestedJoin "circles" "circle"\n  [scene]              -- Outer data: SceneData\n  (_.points)           -- Decompose to Array DataPoint\n  (\\\\point -> ...)      -- Template\n  { enterBehavior: Just { initialAttrs: [...], transition: ... }\n  , updateBehavior: Just { attrs: [], transition: ... }\n  , exitBehavior: Just { attrs: [...], transition: ... }\n  }')])])])]);
  };
  var handleAction23 = function(dictMonadAff) {
    var liftEffect51 = liftEffect(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    return function(v) {
      if (v instanceof Initialize24) {
        return liftEffect51(runD3v2M(drawInitial("#scene-join-demo-viz")));
      }
      ;
      if (v instanceof ShowInitial) {
        return liftEffect51(runD3v2M(drawInitial("#scene-join-demo-viz")));
      }
      ;
      if (v instanceof ShowThree) {
        return liftEffect51(runD3v2M(updateToThree("#scene-join-demo-viz")));
      }
      ;
      if (v instanceof ShowSeven) {
        return liftEffect51(runD3v2M(updateToSeven("#scene-join-demo-viz")));
      }
      ;
      throw new Error("Failed pattern match at Component.SceneJoinDemo (line 92, column 16 - line 103, column 70): " + [v.constructor.name]);
    };
  };
  var component24 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render28,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction23(dictMonadAff),
        initialize: new Just(Initialize24.value)
      })
    });
  };

  // output/Component.Showcase.ShowcaseIndex/index.js
  var pure50 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize25 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var renderCard = function(route) {
    return function(title4) {
      return function(description) {
        return a([classes(["howto-card"]), href("#" + routeToPath(route))])([h3([classes(["howto-card__title"])])([text2(title4)]), p([classes(["howto-card__description"])])([text2(description)])]);
      };
    };
  };
  var render29 = function(v) {
    return div2([classes(["docs-page", "showcase-index"])])([render5({
      logoSize: Large.value,
      quadrant: NoQuadrant.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), section([classes(["docs-hero"])])([div2([classes(["docs-hero-content"])])([h1([classes(["docs-hero-title"])])([text2("Showcase")]), p([classes(["docs-hero-description"])])([text2("Complex, app-like visualizations that demonstrate PSD3's full capabilities. These examples benefit from full-screen treatment.")])])]), section([classes(["docs-section"])])([h2([classes(["docs-section-title"])])([text2("Interactive Visualizations")]), div2([classes(["howto-card-grid"])])([renderCard(CodeExplorer.value)("Code Explorer")("Interactive force-directed graph of PureScript module dependencies. Zoom, pan, expand, and explore the codebase."), renderCard(TourWealthHealth.value)("Wealth & Health of Nations")("Animated bubble chart showing GDP vs life expectancy over time. A classic visualization recreated in PSD3."), renderCard(TourShowcase.value)("Flagship Demos")("Collection of complex visualizations demonstrating advanced PSD3 patterns and capabilities.")])])]);
  };
  var handleAction24 = function(v) {
    return pure50(unit);
  };
  var component25 = /* @__PURE__ */ (function() {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render29,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction24,
        initialize: new Just(Initialize25.value)
      })
    });
  })();

  // output/D3.Viz.FPFTW.AnscombeQuartet/index.js
  var class_25 = /* @__PURE__ */ class_2(toAttrStringString);
  var append114 = /* @__PURE__ */ append(semigroupArray);
  var x21 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y21 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var textContent10 = /* @__PURE__ */ textContent(toAttrStringString);
  var textAnchor8 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var fill26 = /* @__PURE__ */ fill3(toAttrStringString);
  var x110 = /* @__PURE__ */ x1(toAttrNumberNumber);
  var y110 = /* @__PURE__ */ y1(toAttrNumberNumber);
  var x211 = /* @__PURE__ */ x22(toAttrNumberNumber);
  var y211 = /* @__PURE__ */ y22(toAttrNumberNumber);
  var stroke21 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth21 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var map56 = /* @__PURE__ */ map(functorArray);
  var cx22 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy22 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius20 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fillOpacity3 = /* @__PURE__ */ fillOpacity(toAttrNumberNumber);
  var bind49 = /* @__PURE__ */ bind(bindD3v2M);
  var select19 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var width28 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height28 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox22 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var transform10 = /* @__PURE__ */ transform2(toAttrStringString);
  var show52 = /* @__PURE__ */ show(showNumber);
  var renderTree38 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(ordUnit);
  var pure51 = /* @__PURE__ */ pure(applicativeD3v2M);
  var scaleY = function(y310) {
    return 280 - (y310 - 3) * 20;
  };
  var scaleX = function(x310) {
    return (x310 - 4) * 30 + 30;
  };
  var scatterplot = function(datasetName) {
    return function(points) {
      return withChildren(named2(Group2.value)("plot-" + datasetName)([class_25("anscombe-plot")]))(append114([elem4(Text3.value)([x21(260), y21(30), textContent10(datasetName), textAnchor8("middle"), fill26("#333"), class_25("plot-title")]), elem4(Line2.value)([x110(30), y110(280), x211(480), y211(280), stroke21("#999"), strokeWidth21(1)]), elem4(Line2.value)([x110(30), y110(80), x211(30), y211(280), stroke21("#999"), strokeWidth21(1)])])(map56(function(pt) {
        return elem4(Circle2.value)([cx22(scaleX(pt.x)), cy22(scaleY(pt.y)), radius20(4), fill26("#4A90E2"), fillOpacity3(0.7), stroke21("#2E5C8A"), strokeWidth21(1.5), class_25("data-point")]);
      })(points)));
    };
  };
  var dataset4 = [{
    x: 8,
    y: 6.58
  }, {
    x: 8,
    y: 5.76
  }, {
    x: 8,
    y: 7.71
  }, {
    x: 8,
    y: 8.84
  }, {
    x: 8,
    y: 8.47
  }, {
    x: 8,
    y: 7.04
  }, {
    x: 8,
    y: 5.25
  }, {
    x: 19,
    y: 12.5
  }, {
    x: 8,
    y: 5.56
  }, {
    x: 8,
    y: 7.91
  }, {
    x: 8,
    y: 6.89
  }];
  var dataset3 = [{
    x: 10,
    y: 7.46
  }, {
    x: 8,
    y: 6.77
  }, {
    x: 13,
    y: 12.74
  }, {
    x: 9,
    y: 7.11
  }, {
    x: 11,
    y: 7.81
  }, {
    x: 14,
    y: 8.84
  }, {
    x: 6,
    y: 6.08
  }, {
    x: 4,
    y: 5.39
  }, {
    x: 12,
    y: 8.15
  }, {
    x: 7,
    y: 6.42
  }, {
    x: 5,
    y: 5.73
  }];
  var dataset2 = [{
    x: 10,
    y: 9.14
  }, {
    x: 8,
    y: 8.14
  }, {
    x: 13,
    y: 8.74
  }, {
    x: 9,
    y: 8.77
  }, {
    x: 11,
    y: 9.26
  }, {
    x: 14,
    y: 8.1
  }, {
    x: 6,
    y: 6.13
  }, {
    x: 4,
    y: 3.1
  }, {
    x: 12,
    y: 9.13
  }, {
    x: 7,
    y: 7.26
  }, {
    x: 5,
    y: 4.74
  }];
  var dataset1 = [{
    x: 10,
    y: 8.04
  }, {
    x: 8,
    y: 6.95
  }, {
    x: 13,
    y: 7.58
  }, {
    x: 9,
    y: 8.81
  }, {
    x: 11,
    y: 8.33
  }, {
    x: 14,
    y: 9.96
  }, {
    x: 6,
    y: 7.24
  }, {
    x: 4,
    y: 4.26
  }, {
    x: 12,
    y: 10.84
  }, {
    x: 7,
    y: 4.82
  }, {
    x: 5,
    y: 5.68
  }];
  var anscombeData = [{
    name: "Dataset I",
    points: dataset1
  }, {
    name: "Dataset II",
    points: dataset2
  }, {
    name: "Dataset III",
    points: dataset3
  }, {
    name: "Dataset IV",
    points: dataset4
  }];
  var drawAnscombeQuartet = function(containerSelector) {
    return runD3v2M(bind49(select19(containerSelector))(function(container) {
      var quartetTree = withChildren(named2(SVG.value)("svg")([width28(1040), height28(600), viewBox22("0 0 1040 600"), class_25("anscombe-quartet")]))(map56(function(v) {
        var yOffset = (function() {
          var $36 = v.name === "Dataset I" || v.name === "Dataset II";
          if ($36) {
            return 0;
          }
          ;
          return 300;
        })();
        var xOffset = (function() {
          var $37 = v.name === "Dataset I" || v.name === "Dataset III";
          if ($37) {
            return 0;
          }
          ;
          return 520;
        })();
        return withChild(named2(Group2.value)("group-" + v.name)([transform10("translate(" + (show52(xOffset) + ("," + (show52(yOffset) + ")"))))]))(scatterplot(v.name)(v.points));
      })(anscombeData));
      return bind49(renderTree38(container)(quartetTree))(function() {
        return pure51(unit);
      });
    }));
  };

  // output/D3.Viz.FPFTW.SetOperations/index.js
  var fromFoldable44 = /* @__PURE__ */ fromFoldable8(foldableArray)(ordString);
  var class_26 = /* @__PURE__ */ class_2(toAttrStringString);
  var append115 = /* @__PURE__ */ append(semigroupArray);
  var cx23 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy23 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius21 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill27 = /* @__PURE__ */ fill3(toAttrStringString);
  var stroke22 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth22 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var x30 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y30 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var textContent11 = /* @__PURE__ */ textContent(toAttrStringString);
  var textAnchor9 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var show53 = /* @__PURE__ */ show(showInt);
  var fillOpacity4 = /* @__PURE__ */ fillOpacity(toAttrNumberNumber);
  var toUnfoldable6 = /* @__PURE__ */ toUnfoldable4(unfoldableArray);
  var bind50 = /* @__PURE__ */ bind(bindD3v2M);
  var select20 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var width29 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height29 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox23 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var div4 = /* @__PURE__ */ div(euclideanRingInt);
  var mod4 = /* @__PURE__ */ mod(euclideanRingInt);
  var transform11 = /* @__PURE__ */ transform2(toAttrStringString);
  var show124 = /* @__PURE__ */ show(showNumber);
  var renderTree39 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(ordUnit);
  var pure52 = /* @__PURE__ */ pure(applicativeD3v2M);
  var setB = /* @__PURE__ */ fromFoldable44(["blue", "green", "brown", "black", "purple"]);
  var setA = /* @__PURE__ */ fromFoldable44(["yellow", "blue", "red", "orange", "purple"]);
  var setsToVisualize = [{
    name: "Set A",
    set: setA,
    borderColor: "#E74C3C"
  }, {
    name: "Set B",
    set: setB,
    borderColor: "#3498DB"
  }, {
    name: "A \u222A B (Union)",
    set: /* @__PURE__ */ union3(ordString)(setA)(setB),
    borderColor: "#9B59B6"
  }, {
    name: "A \u2229 B (Intersection)",
    set: /* @__PURE__ */ intersection2(ordString)(setA)(setB),
    borderColor: "#27AE60"
  }];
  var initialRadius6 = 8;
  var goldenAngle = /* @__PURE__ */ (function() {
    return pi * (3 - sqrt(5));
  })();
  var phylotaxisPosition3 = function(index5) {
    var i2 = toNumber(index5);
    var rad = initialRadius6 * sqrt(0.5 + i2);
    var angle = i2 * goldenAngle;
    return {
      x: rad * cos(angle),
      y: rad * sin(angle)
    };
  };
  var colorMap = [{
    name: "yellow",
    hex: "#FFD700"
  }, {
    name: "blue",
    hex: "#4169E1"
  }, {
    name: "red",
    hex: "#DC143C"
  }, {
    name: "orange",
    hex: "#FF8C00"
  }, {
    name: "purple",
    hex: "#9370DB"
  }, {
    name: "green",
    hex: "#32CD32"
  }, {
    name: "brown",
    hex: "#8B4513"
  }, {
    name: "black",
    hex: "#2C2C2C"
  }, {
    name: "pink",
    hex: "#FF69B4"
  }];
  var getColorHex = function(colorName) {
    var v = find2(function(c) {
      return c.name === colorName;
    })(colorMap);
    if (v instanceof Just) {
      return v.value0.hex;
    }
    ;
    if (v instanceof Nothing) {
      return "#999999";
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.FPFTW.SetOperations (line 78, column 3 - line 80, column 25): " + [v.constructor.name]);
  };
  var visualizeSet = function(setName14) {
    return function(elements) {
      return function(borderColor) {
        return withChildren(named2(Group2.value)("set-" + setName14)([class_26("set-visualization")]))(append115([elem4(Circle2.value)([cx23(0), cy23(0), radius21(120), fill27("none"), stroke22(borderColor), strokeWidth22(3), class_26("set-boundary")]), elem4(Text3.value)([x30(0), y30(-135), textContent11(setName14), textAnchor9("middle"), fill27("#333"), class_26("set-title")]), elem4(Text3.value)([x30(0), y30(145), textContent11("(" + (show53(size4(elements)) + " colors)")), textAnchor9("middle"), fill27("#666"), class_26("set-count")])])(mapWithIndex2(function(index5) {
          return function(colorName) {
            var pos = phylotaxisPosition3(index5);
            var colorHex = getColorHex(colorName);
            return elem4(Circle2.value)([cx23(pos.x), cy23(pos.y), radius21(12), fill27(colorHex), fillOpacity4(0.9), stroke22("#fff"), strokeWidth22(2), class_26("set-element")]);
          };
        })(toUnfoldable6(elements))));
      };
    };
  };
  var drawSetOperations = function(containerSelector) {
    return runD3v2M(bind50(select20(containerSelector))(function(container) {
      var setsTree = withChildren(named2(SVG.value)("svg")([width29(1e3), height29(700), viewBox23("0 0 1000 700"), class_26("set-operations")]))(mapWithIndex2(function(index5) {
        return function(v) {
          var row = div4(index5)(2);
          var yOffset = toNumber(row) * 350 + 200;
          var col2 = mod4(index5)(2);
          var xOffset = toNumber(col2) * 500 + 250;
          return withChild(named2(Group2.value)("group-" + v.name)([transform11("translate(" + (show124(xOffset) + ("," + (show124(yOffset) + ")"))))]))(visualizeSet(v.name)(v.set)(v.borderColor));
        };
      })(setsToVisualize));
      return bind50(renderTree39(container)(setsTree))(function() {
        return pure52(unit);
      });
    }));
  };

  // output/PSD3.Shared.TutorialNav/index.js
  var eq8 = /* @__PURE__ */ eq(eqRoute);
  var show54 = /* @__PURE__ */ show(showRoute);
  var allTutorialRoutes = /* @__PURE__ */ (function() {
    return [TourFoundations.value, TourProfessional.value, TourFlow.value, TourHierarchies.value, TourMotion.value, TourInterpreters.value, TourFPFTW.value, TourGraphAlgorithms.value, TourLesMisGUP.value];
  })();
  var getNextTutorial = function(currentRoute) {
    var v = findIndex(function(r) {
      return eq8(r)(currentRoute);
    })(allTutorialRoutes);
    if (v instanceof Nothing) {
      return Nothing.value;
    }
    ;
    if (v instanceof Just) {
      return index(allTutorialRoutes)(v.value0 + 1 | 0);
    }
    ;
    throw new Error("Failed pattern match at PSD3.Shared.TutorialNav (line 33, column 3 - line 35, column 53): " + [v.constructor.name]);
  };
  var getPrevTutorial = function(currentRoute) {
    var v = findIndex(function(r) {
      return eq8(r)(currentRoute);
    })(allTutorialRoutes);
    if (v instanceof Nothing) {
      return Nothing.value;
    }
    ;
    if (v instanceof Just) {
      var $10 = v.value0 > 0;
      if ($10) {
        return index(allTutorialRoutes)(v.value0 - 1 | 0);
      }
      ;
      return Nothing.value;
    }
    ;
    throw new Error("Failed pattern match at PSD3.Shared.TutorialNav (line 40, column 3 - line 42, column 82): " + [v.constructor.name]);
  };
  var renderHeader2 = function(currentRoute) {
    return render5({
      logoSize: Large.value,
      quadrant: NoQuadrant.value,
      prevNext: new Just({
        prev: getPrevTutorial(currentRoute),
        next: getNextTutorial(currentRoute)
      }),
      pageTitle: new Just(show54(currentRoute))
    });
  };

  // output/Component.Tour.TourFPFTW/index.js
  var discard43 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var pure53 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize26 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var render30 = function(v) {
    return div2([classes(["tutorial-page"])])([renderHeader2(TourFPFTW.value), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("Functional Programming For The Win")]), p_([text2("PureScript's powerful type system and functional programming features unlock visualization capabilities that are difficult or impossible in JavaScript. This page showcases how Maps, Sets, Foldable types, and contravariant functors make data visualization more flexible and type-safe.")]), p_([text2('These examples demonstrate the "FP For The Win" philosophy: using advanced functional programming techniques to create more composable, reusable, and maintainable visualization code.')])]), section([classes(["tutorial-section"]), id3("anscombe")])([h2([classes(["tutorial-section-title"])])([text2("1. Anscombe's Quartet: The Power of Map")]), p_([text2("Anscombe's Quartet is a famous dataset demonstrating why visualization matters. All four datasets have "), strong_([text2("identical statistical properties")]), text2(" (mean, variance, correlation \u2248 0.816), but "), strong_([text2("completely different distributions")]), text2(". Statistics can lie; plots don't!")]), p_([text2("This example showcases functional programming's ")]), em_([text2("map")]), text2(" pattern: we define "), strong_([text2("one scatterplot component")]), text2(" and "), strong_([text2("map it over four datasets")]), text2(". Same code, different data, four visualizations. This is composability in action:")]), pre([classes(["code-block"]), style("background: #f5f5f5; padding: 15px; border-radius: 5px; color: #333; overflow-x: auto;")])([code_([text2("-- One component definition\nscatterplot :: String -> Array Point -> Tree\nscatterplot name points = ...\n\n-- Map over all four datasets!\nmap (\\{ name, points } -> scatterplot name points) anscombeData")])]), div2([id3("anscombe-quartet"), classes(["viz-container"]), style("margin: 20px 0; text-align: center;")])([]), p_([text2("Notice how:")]), ul_([li_([strong_([text2("Dataset I")]), text2(": Linear relationship with some scatter")]), li_([strong_([text2("Dataset II")]), text2(": Perfect quadratic curve")]), li_([strong_([text2("Dataset III")]), text2(": Linear with one outlier skewing statistics")]), li_([strong_([text2("Dataset IV")]), text2(": No relationship except one influential point")])]), p_([text2("The FP win: We wrote the visualization component once and reused it four times. In imperative code, you'd repeat yourself or write complex loops. With "), code_([text2("map")]), text2(", composition is natural and type-safe.")])]), section([classes(["tutorial-section"]), id3("sets")])([h2([classes(["tutorial-section-title"])])([text2("2. Set Operations: Map + Foldable + Phylotaxis")]), p_([text2("Sets are unordered, unique collections. This example demonstrates ")]), strong_([text2("three FP wins at once")]), text2(":"), ul_([li_([strong_([text2("Map pattern: ")]), text2("One visualizer component, mapped over four different sets (A, B, A \u222A B, A \u2229 B)")]), li_([strong_([text2("Foldable abstraction: ")]), text2("We iterate over a Set, not an Array! The visualization works with any Foldable type.")]), li_([strong_([text2("Code reuse: ")]), text2("Uses the same phylotaxis (sunflower spiral) layout from our network simulations.")])]), p_([text2("Each set is visualized as colored circles arranged in a phylotaxis pattern (the mathematical arrangement of seeds in a sunflower). Watch how union combines elements and intersection shows only shared elements:")]), div2([id3("set-operations"), classes(["viz-container"]), style("margin: 20px 0; text-align: center;")])([]), p_([text2("The FP win: This visualization demonstrates that PureScript's type classes let you write generic, reusable code. The same phylotaxis layout function works in network graphs "), em_([text2("and")]), text2(" set visualizations. In JavaScript, you'd rewrite it each time.")])]), section([classes(["tutorial-section"]), id3("tree-api-power")])([h2([classes(["tutorial-section-title"])])([text2("3. TreeAPI: A Composable DSL")]), p_([text2("The TreeAPI demonstrates functional programming principles in action. It's a deeply embedded DSL (Domain-Specific Language) that leverages PureScript's type system to provide:")]), ul_([li_([strong_([text2("Composability: ")]), text2("Build complex visualizations from simple, reusable pieces. Trees compose with attributes, which compose with scales and axes.")]), li_([strong_([text2("Type Safety: ")]), text2("The compiler ensures you can't attach circle attributes to rect elements, or pass the wrong data type to a layout.")]), li_([strong_([text2("Multiple Interpretations: ")]), text2("The same TreeAPI code can be interpreted as SVG, Mermaid diagrams, or even generated JavaScript.")]), li_([strong_([text2("Referential Transparency: ")]), text2("Tree descriptions are pure values that can be tested, transformed, and reasoned about before rendering.")])]), p_([text2("For examples of TreeAPI in action, see the "), a([href("#" + routeToPath(TreeAPI.value))])([text2("Tree API Examples")]), text2(" page, or explore the "), a([href("#" + routeToPath(AnimatedTreeCluster.value))])([text2("Animated Tree \u2194 Cluster")]), text2(" demonstration which shows how the same tree structure can smoothly transition between different layout algorithms.")])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Why Functional Programming Wins")]), p_([text2("These techniques might seem abstract, but they solve real problems:")]), ul_([li_([strong_([text2("Maintainability: ")]), text2("Type-safe code means fewer runtime errors and easier refactoring.")]), li_([strong_([text2("Reusability: ")]), text2("Contravariant functors and type classes let you write code once and use it with many data types.")]), li_([strong_([text2("Correctness: ")]), text2("The compiler catches bugs that would only appear at runtime in JavaScript.")]), li_([strong_([text2("Expressiveness: ")]), text2("Foldable, Functor, and other abstractions let you express complex data transformations concisely.")])]), p_([text2(`This is why we say "Functional Programming For The Win" - not because it's academically interesting, but because it produces better visualization code that's easier to write, test, and maintain.`)])])]);
  };
  var handleAction25 = function(dictMonadAff) {
    var liftAff3 = liftAff(monadAffHalogenM(dictMonadAff));
    var liftEffect51 = liftEffect(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    return function(v) {
      return discard43(liftAff3(delay(100)))(function() {
        return discard43(liftEffect51(drawAnscombeQuartet("#anscombe-quartet")))(function() {
          return discard43(liftEffect51(drawSetOperations("#set-operations")))(function() {
            return pure53(unit);
          });
        });
      });
    };
  };
  var component26 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render30,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction25(dictMonadAff),
        initialize: new Just(Initialize26.value)
      })
    });
  };

  // output/D3.Viz.TreeAPI.ChordDiagram/index.js
  var compare15 = /* @__PURE__ */ compare(ordInt);
  var lookup26 = /* @__PURE__ */ lookup2(ordString);
  var discard44 = /* @__PURE__ */ discard(discardUnit)(bindD3v2M);
  var liftEffect26 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var bind51 = /* @__PURE__ */ bind(bindD3v2M);
  var select21 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var show55 = /* @__PURE__ */ show(showInt);
  var width30 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height30 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox24 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var show125 = /* @__PURE__ */ show(showNumber);
  var id_14 = /* @__PURE__ */ id_(toAttrStringString);
  var class_27 = /* @__PURE__ */ class_2(toAttrStringString);
  var transform12 = /* @__PURE__ */ transform2(toAttrStringString);
  var renderTree40 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D);
  var renderTree114 = /* @__PURE__ */ renderTree40(ordUnit);
  var d10 = /* @__PURE__ */ d4(toAttrStringString);
  var fill28 = /* @__PURE__ */ fill3(toAttrStringString);
  var fillOpacity5 = /* @__PURE__ */ fillOpacity(toAttrNumberNumber);
  var stroke23 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth23 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var x31 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y31 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var textAnchor10 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var textContent12 = /* @__PURE__ */ textContent(toAttrStringString);
  var fontSize8 = /* @__PURE__ */ fontSize2(toAttrNumberNumber);
  var pure54 = /* @__PURE__ */ pure(applicativeD3v2M);
  var bind117 = /* @__PURE__ */ bind(bindAff);
  var liftEffect110 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var eqIndexedRibbon = {
    eq: function(v) {
      return function(v1) {
        return v.index === v1.index;
      };
    }
  };
  var ordIndexedRibbon = {
    compare: function(v) {
      return function(v1) {
        return compare15(v.index)(v1.index);
      };
    },
    Eq0: function() {
      return eqIndexedRibbon;
    }
  };
  var renderTree212 = /* @__PURE__ */ renderTree40(ordIndexedRibbon);
  var eqIndexedArc = {
    eq: function(v) {
      return function(v1) {
        return v.index === v1.index;
      };
    }
  };
  var ordIndexedArc = {
    compare: function(v) {
      return function(v1) {
        return compare15(v.index)(v1.index);
      };
    },
    Eq0: function() {
      return eqIndexedArc;
    }
  };
  var renderTree310 = /* @__PURE__ */ renderTree40(ordIndexedArc);
  var regionColorMap = /* @__PURE__ */ (function() {
    return fromFoldable6(ordString)(foldableArray)([new Tuple("WBR", "#d62728"), new Tuple("Pointe Coupee", "#ff9896"), new Tuple("Point Coupe", "#ff9896"), new Tuple("Iberville", "#e7969c"), new Tuple("EBR-M", "#5ab4ac"), new Tuple("EBR - M", "#5ab4ac"), new Tuple("EBR-S", "#c7eae5"), new Tuple("EBR - S", "#c7eae5"), new Tuple("Ascension", "#80cdc1"), new Tuple("Livingston", "#d8daeb"), new Tuple("I-10 Lafayette", "#b2abd2"), new Tuple("US-190 Opelousas", "#ff7f0e"), new Tuple("US 190 Opelousas", "#ff7f0e"), new Tuple("I-10 NOLA", "#ffbb78"), new Tuple("I-12", "#98df8a")]);
  })();
  var getTargetValue = function(d1) {
    return d1.target.value;
  };
  var getTargetIndex = function(d1) {
    return d1.target.index;
  };
  var getSourceValue = function(d1) {
    return d1.source.value;
  };
  var getSourceIndex = function(d1) {
    return d1.source.index;
  };
  var getRegionColor = function(labels9) {
    return function(idx) {
      var v = index(labels9)(idx);
      if (v instanceof Just) {
        var v1 = lookup26(v.value0)(regionColorMap);
        if (v1 instanceof Just) {
          return v1.value0;
        }
        ;
        if (v1 instanceof Nothing) {
          return "#999999";
        }
        ;
        throw new Error("Failed pattern match at D3.Viz.TreeAPI.ChordDiagram (line 78, column 17 - line 80, column 25): " + [v1.constructor.name]);
      }
      ;
      if (v instanceof Nothing) {
        return "#999999";
      }
      ;
      throw new Error("Failed pattern match at D3.Viz.TreeAPI.ChordDiagram (line 77, column 29 - line 81, column 23): " + [v.constructor.name]);
    };
  };
  var getGroupIndex = function(d1) {
    return d1.index;
  };
  var getDominantFlowIndex = function(d1) {
    var targetVal = getTargetValue(d1);
    var sourceVal = getSourceValue(d1);
    var $71 = sourceVal >= targetVal;
    if ($71) {
      return getSourceIndex(d1);
    }
    ;
    return getTargetIndex(d1);
  };
  var drawChord = function(matrix) {
    return function(labels9) {
      return function(containerSelector) {
        return function(w) {
          return function(h) {
            return runD3v2M(discard44(liftEffect26(log2("=== Drawing Chord Diagram with TreeAPI ===")))(function() {
              return bind51(select21(containerSelector))(function(container) {
                var centerX = w / 2;
                var centerY = h / 2;
                var chordData = chordLayoutWithPadAngle_(matrix)(0.05);
                var groups = chordGroups_(chordData);
                var chords = chordArray_(chordData);
                return discard44(liftEffect26(log2("Chord layout: " + (show55(length(groups)) + (" groups, " + (show55(length(chords)) + " chords"))))))(function() {
                  var indexedGroups = mapWithIndex2(function(i2) {
                    return function(d1) {
                      return {
                        index: i2,
                        datum: d1
                      };
                    };
                  })(groups);
                  var indexedChords = mapWithIndex2(function(i2) {
                    return function(d1) {
                      return {
                        index: i2,
                        datum: d1
                      };
                    };
                  })(chords);
                  var ribbonGen = setRibbonRadius_(ribbonGenerator_(unit))(270);
                  var arcGen = setArcOuterRadius_(setArcInnerRadius_(arcGenerator_(unit))(270))(280);
                  var chordTree = withChild(named2(SVG.value)("svg")([width30(w), height30(h), viewBox24("0 0 " + (show125(w) + (" " + show125(h)))), id_14("chord-svg"), class_27("chord-diagram")]))(withChildren(named2(Group2.value)("centerGroup")([transform12("translate(" + (show125(centerX) + ("," + (show125(centerY) + ")")))), class_27("chord-group")]))([named2(Group2.value)("ribbonsGroup")([class_27("ribbons")]), named2(Group2.value)("arcsGroup")([class_27("arcs")]), named2(Group2.value)("labelsGroup")([class_27("labels")])]));
                  return bind51(renderTree114(container)(chordTree))(function(selections) {
                    return bind51(liftEffect26(reselectD3v2("ribbonsGroup")(selections)))(function(ribbonsGroupSel) {
                      return bind51(liftEffect26(reselectD3v2("arcsGroup")(selections)))(function(arcsGroupSel) {
                        return bind51(liftEffect26(reselectD3v2("labelsGroup")(selections)))(function(labelsGroupSel) {
                          var ribbonsTree = joinData2("ribbonElements")("path")(indexedChords)(function(v) {
                            var dominantIdx = getDominantFlowIndex(v.datum);
                            var color2 = getRegionColor(labels9)(dominantIdx);
                            return elem4(Path3.value)([class_27("ribbon"), d10(ribbonPath_(ribbonGen)(v.datum)), fill28(color2), fillOpacity5(0.67), stroke23("#000000"), strokeWidth23(0.5)]);
                          });
                          return bind51(renderTree212(ribbonsGroupSel)(ribbonsTree))(function() {
                            var arcsTree = joinData2("arcElements")("path")(indexedGroups)(function(v) {
                              var idx = getGroupIndex(v.datum);
                              var color2 = getRegionColor(labels9)(idx);
                              return elem4(Path3.value)([class_27("arc"), d10(arcPath_(arcGen)(v.datum)), fill28(color2), stroke23("#ffffff"), strokeWidth23(2)]);
                            });
                            return bind51(renderTree310(arcsGroupSel)(arcsTree))(function() {
                              var labelsTree = joinData2("labelElements")("text")(indexedGroups)(function(v) {
                                var labelR = 280 + 8;
                                var idx = getGroupIndex(v.datum);
                                var label5 = fromMaybe("")(index(labels9)(idx));
                                var angle = (v.datum.startAngle + v.datum.endAngle) / 2;
                                var labelX = labelR * cos(angle - pi / 2);
                                var labelY = labelR * sin(angle - pi / 2);
                                var anchor = (function() {
                                  var $75 = angle > pi;
                                  if ($75) {
                                    return "end";
                                  }
                                  ;
                                  return "start";
                                })();
                                return elem4(Text3.value)([class_27("chord-label"), x31(labelX), y31(labelY), textAnchor10(anchor), fill28("#000"), textContent12(label5), fontSize8(10)]);
                              });
                              return bind51(renderTree310(labelsGroupSel)(labelsTree))(function() {
                                return discard44(liftEffect26(log2("Chord diagram rendered with TreeAPI")))(function() {
                                  return pure54(unit);
                                });
                              });
                            });
                          });
                        });
                      });
                    });
                  });
                });
              });
            }));
          };
        };
      };
    };
  };
  var startChord = function(containerSelector) {
    return launchAff_(bind117(loadBridgesData)(function(result) {
      if (result instanceof Left) {
        return liftEffect110(log2("Failed to load bridges data: " + result.value0));
      }
      ;
      if (result instanceof Right) {
        return liftEffect110(drawChord(result.value0.matrix)(result.value0.labels)(containerSelector)(700)(700));
      }
      ;
      throw new Error("Failed pattern match at D3.Viz.TreeAPI.ChordDiagram (line 283, column 3 - line 285, column 105): " + [result.constructor.name]);
    }));
  };

  // output/PSD3.Layout.Sankey.CSV/index.js
  var map57 = /* @__PURE__ */ map(functorArray);
  var parseLine = function(line) {
    var parts = map57(trim)(split(",")(line));
    if (parts.length === 3) {
      var v = fromString(parts[2]);
      if (v instanceof Just) {
        return new Just({
          s: parts[0],
          t: parts[1],
          v: v.value0
        });
      }
      ;
      if (v instanceof Nothing) {
        return Nothing.value;
      }
      ;
      throw new Error("Failed pattern match at PSD3.Layout.Sankey.CSV (line 42, column 9 - line 45, column 29): " + [v.constructor.name]);
    }
    ;
    return Nothing.value;
  };
  var parseSankeyCSV = function(csvString) {
    var isEmpty3 = function(s) {
      return $$null2(trim(s));
    };
    var lines = split("\n")(csvString);
    var dataLines = filter(function($10) {
      return !isEmpty3($10);
    })(drop(1)(lines));
    return mapMaybe(parseLine)(dataLines);
  };

  // output/Control.Monad.State/index.js
  var execState = function(v) {
    return function(s) {
      var v1 = v(s);
      return v1.value1;
    };
  };

  // output/PSD3.Layout.Sankey.Types/index.js
  var compare16 = /* @__PURE__ */ compare(ordInt);
  var bind52 = /* @__PURE__ */ bind(bindMaybe);
  var pure55 = /* @__PURE__ */ pure(applicativeMaybe);
  var SourceColor = /* @__PURE__ */ (function() {
    function SourceColor2() {
    }
    ;
    SourceColor2.value = new SourceColor2();
    return SourceColor2;
  })();
  var TargetColor = /* @__PURE__ */ (function() {
    function TargetColor2() {
    }
    ;
    TargetColor2.value = new TargetColor2();
    return TargetColor2;
  })();
  var SourceTargetGradient = /* @__PURE__ */ (function() {
    function SourceTargetGradient2() {
    }
    ;
    SourceTargetGradient2.value = new SourceTargetGradient2();
    return SourceTargetGradient2;
  })();
  var StaticColor = /* @__PURE__ */ (function() {
    function StaticColor2(value0) {
      this.value0 = value0;
    }
    ;
    StaticColor2.create = function(value0) {
      return new StaticColor2(value0);
    };
    return StaticColor2;
  })();
  var Justify = /* @__PURE__ */ (function() {
    function Justify2() {
    }
    ;
    Justify2.value = new Justify2();
    return Justify2;
  })();
  var Left3 = /* @__PURE__ */ (function() {
    function Left4() {
    }
    ;
    Left4.value = new Left4();
    return Left4;
  })();
  var Right3 = /* @__PURE__ */ (function() {
    function Right4() {
    }
    ;
    Right4.value = new Right4();
    return Right4;
  })();
  var Center = /* @__PURE__ */ (function() {
    function Center2() {
    }
    ;
    Center2.value = new Center2();
    return Center2;
  })();
  var initialiseSankeyLink = function(l) {
    return {
      sourceIndex: l.source,
      targetIndex: l.target,
      value: l.value,
      width: 0,
      y0: 0,
      y1: 0,
      color: "",
      index: l.id
    };
  };
  var initialSankeyGraphModel = function(config) {
    return {
      linkCount: 0,
      nodeCount: 0,
      nodeNameToID: empty3,
      nodeIDToName: empty3,
      deps: empty3,
      sped: empty3,
      sankeyNodes: [],
      sankeyLinks: [],
      config
    };
  };
  var eqNodeID = {
    eq: function(x47) {
      return function(y48) {
        return x47 === y48;
      };
    }
  };
  var ordNodeID = {
    compare: function(x47) {
      return function(y48) {
        return compare16(x47)(y48);
      };
    },
    Eq0: function() {
      return eqNodeID;
    }
  };
  var lookup27 = /* @__PURE__ */ lookup2(ordNodeID);
  var initialiseSankeyNode = function(m) {
    return function(id5) {
      return bind52(lookup27(id5)(m.nodeIDToName))(function(name16) {
        var sourceLinks = fromMaybe(empty8)(lookup27(id5)(m.deps));
        var targetLinks = fromMaybe(empty8)(lookup27(id5)(m.sped));
        return pure55({
          name: name16,
          x0: 0,
          x1: 0,
          y0: 0,
          y1: 0,
          value: 0,
          depth: 0,
          nodeHeight: 0,
          layer: 0,
          index: id5,
          color: "",
          sourceLinks,
          targetLinks
        });
      });
    };
  };
  var eqLinkID = {
    eq: function(x47) {
      return function(y48) {
        return x47 === y48;
      };
    }
  };
  var defaultSankeyConfig = function(width53) {
    return function(height53) {
      return {
        alignment: Justify.value,
        linkColorMode: SourceColor.value,
        nodeWidth: 15,
        nodePadding: 10,
        iterations: 6,
        extent: {
          x0: 1,
          y0: 1,
          x1: width53 - 1,
          y1: height53 - 5
        }
      };
    };
  };

  // output/PSD3.Layout.Sankey.Compute/index.js
  var lookup28 = /* @__PURE__ */ lookup2(ordNodeID);
  var insert9 = /* @__PURE__ */ insert4(ordNodeID);
  var insert12 = /* @__PURE__ */ insert(ordNodeID);
  var eq9 = /* @__PURE__ */ eq(eqNodeID);
  var compare17 = /* @__PURE__ */ compare(ordNumber);
  var max8 = /* @__PURE__ */ max(ordInt);
  var map58 = /* @__PURE__ */ map(functorArray);
  var max1 = /* @__PURE__ */ max(ordNumber);
  var min7 = /* @__PURE__ */ min(ordNumber);
  var eq25 = /* @__PURE__ */ eq(eqOrdering);
  var show56 = /* @__PURE__ */ show(showInt);
  var show126 = /* @__PURE__ */ show(showNumber);
  var bindStateT3 = /* @__PURE__ */ bindStateT(monadIdentity);
  var bind53 = /* @__PURE__ */ bind(bindStateT3);
  var monadStateStateT3 = /* @__PURE__ */ monadStateStateT(monadIdentity);
  var get20 = /* @__PURE__ */ get(monadStateStateT3);
  var lookup110 = /* @__PURE__ */ lookup2(ordString);
  var modify_16 = /* @__PURE__ */ modify_2(monadStateStateT3);
  var insert22 = /* @__PURE__ */ insert(ordString);
  var toUnfoldable7 = /* @__PURE__ */ toUnfoldable4(unfoldableArray);
  var member6 = /* @__PURE__ */ member2(ordNodeID);
  var union5 = /* @__PURE__ */ union3(ordNodeID);
  var fromFoldable45 = /* @__PURE__ */ fromFoldable8(foldableArray)(ordNodeID);
  var eq32 = /* @__PURE__ */ eq(eqLinkID);
  var mod5 = /* @__PURE__ */ mod(euclideanRingInt);
  var discard45 = /* @__PURE__ */ discard(discardUnit);
  var discard211 = /* @__PURE__ */ discard45(bindStateT3);
  var for_2 = /* @__PURE__ */ for_(/* @__PURE__ */ applicativeStateT(monadIdentity))(foldableArray);
  var unionInsert = function(sid) {
    return function(tid) {
      return function(deps) {
        var targetSet = (function() {
          var v = lookup28(sid)(deps);
          if (v instanceof Nothing) {
            return singleton10(tid);
          }
          ;
          if (v instanceof Just) {
            return insert9(tid)(v.value0);
          }
          ;
          throw new Error("Failed pattern match at PSD3.Layout.Sankey.Compute (line 95, column 11 - line 97, column 53): " + [v.constructor.name]);
        })();
        return insert12(sid)(targetSet)(deps);
      };
    };
  };
  var relaxation = function(nodes) {
    return function(links) {
      return function(config) {
        return function(y0) {
          return function(y116) {
            var updateNodes3 = function(allNodes3) {
              return function(updated) {
                return map58(function(node) {
                  var v = find2(function(u2) {
                    return eq9(u2.node.index)(node.index);
                  })(updated);
                  if (v instanceof Just) {
                    return v.value0.node;
                  }
                  ;
                  if (v instanceof Nothing) {
                    return node;
                  }
                  ;
                  throw new Error("Failed pattern match at PSD3.Layout.Sankey.Compute (line 661, column 9 - line 663, column 26): " + [v.constructor.name]);
                })(allNodes3);
              };
            };
            var resolveCollisions = function(sorted) {
              return function(padding) {
                return function(yMin) {
                  return function(yMax) {
                    var $110 = $$null(sorted);
                    if ($110) {
                      return sorted;
                    }
                    ;
                    var nodeHeight = function(n) {
                      return n.node.y1 - n.node.y0;
                    };
                    var pushedDown = foldl2(function(acc) {
                      return function(item) {
                        var height53 = nodeHeight(item);
                        var desiredY0 = item.targetY - height53 / 2;
                        var actualY0 = max1(acc.y)(desiredY0);
                        var actualY1 = actualY0 + height53;
                        var updatedNode = {
                          color: item.node.color,
                          depth: item.node.depth,
                          index: item.node.index,
                          layer: item.node.layer,
                          name: item.node.name,
                          nodeHeight: item.node.nodeHeight,
                          sourceLinks: item.node.sourceLinks,
                          targetLinks: item.node.targetLinks,
                          value: item.node.value,
                          x0: item.node.x0,
                          x1: item.node.x1,
                          y0: actualY0,
                          y1: actualY1
                        };
                        return {
                          y: actualY1 + padding,
                          nodes: snoc(acc.nodes)({
                            node: updatedNode,
                            targetY: item.targetY
                          })
                        };
                      };
                    })({
                      y: yMin,
                      nodes: []
                    })(sorted);
                    var pushedUp = foldr2(function(item) {
                      return function(acc) {
                        var height53 = nodeHeight(item);
                        var desiredY1 = min7(item.node.y1)(acc.y - padding);
                        var actualY0 = desiredY1 - height53;
                        var updatedNode = {
                          color: item.node.color,
                          depth: item.node.depth,
                          index: item.node.index,
                          layer: item.node.layer,
                          name: item.node.name,
                          nodeHeight: item.node.nodeHeight,
                          sourceLinks: item.node.sourceLinks,
                          targetLinks: item.node.targetLinks,
                          value: item.node.value,
                          x0: item.node.x0,
                          x1: item.node.x1,
                          y0: actualY0,
                          y1: desiredY1
                        };
                        return {
                          y: actualY0,
                          nodes: cons({
                            node: updatedNode,
                            targetY: item.targetY
                          })(acc.nodes)
                        };
                      };
                    })({
                      y: yMax,
                      nodes: []
                    })(pushedDown.nodes);
                    return pushedUp.nodes;
                  };
                };
              };
            };
            var calculateWeightedFromTargets = function(node) {
              return function(allNodes3) {
                return function(allLinks) {
                  var result = foldl2(function(acc) {
                    return function(link4) {
                      var $111 = eq9(link4.sourceIndex)(node.index);
                      if ($111) {
                        var v = find2(function(n) {
                          return eq9(n.index)(link4.targetIndex);
                        })(allNodes3);
                        if (v instanceof Just) {
                          var layerDist = toNumber(v.value0.layer - node.layer | 0);
                          var v1 = link4.value * layerDist;
                          var center2 = (v.value0.y0 + v.value0.y1) / 2;
                          return {
                            sum: acc.sum + center2 * v1,
                            totalWeight: acc.totalWeight + v1
                          };
                        }
                        ;
                        if (v instanceof Nothing) {
                          return acc;
                        }
                        ;
                        throw new Error("Failed pattern match at PSD3.Layout.Sankey.Compute (line 570, column 13 - line 578, column 29): " + [v.constructor.name]);
                      }
                      ;
                      return acc;
                    };
                  })({
                    sum: 0,
                    totalWeight: 0
                  })(allLinks);
                  var $114 = result.totalWeight > 0;
                  if ($114) {
                    return result.sum / result.totalWeight;
                  }
                  ;
                  return node.y0;
                };
              };
            };
            var calculateWeightedFromSources = function(node) {
              return function(allNodes3) {
                return function(allLinks) {
                  var result = foldl2(function(acc) {
                    return function(link4) {
                      var $115 = eq9(link4.targetIndex)(node.index);
                      if ($115) {
                        var v = find2(function(n) {
                          return eq9(n.index)(link4.sourceIndex);
                        })(allNodes3);
                        if (v instanceof Just) {
                          var layerDist = toNumber(node.layer - v.value0.layer | 0);
                          var v1 = link4.value * layerDist;
                          var center2 = (v.value0.y0 + v.value0.y1) / 2;
                          return {
                            sum: acc.sum + center2 * v1,
                            totalWeight: acc.totalWeight + v1
                          };
                        }
                        ;
                        if (v instanceof Nothing) {
                          return acc;
                        }
                        ;
                        throw new Error("Failed pattern match at PSD3.Layout.Sankey.Compute (line 595, column 13 - line 603, column 29): " + [v.constructor.name]);
                      }
                      ;
                      return acc;
                    };
                  })({
                    sum: 0,
                    totalWeight: 0
                  })(allLinks);
                  var $118 = result.totalWeight > 0;
                  if ($118) {
                    return result.sum / result.totalWeight;
                  }
                  ;
                  return node.y0;
                };
              };
            };
            var relaxLayer = function(currentNodes) {
              return function(allLinks) {
                return function(layerIdx) {
                  return function(padding) {
                    return function(ascending2) {
                      return function(alpha) {
                        return function(beta) {
                          var layerNodes = filter(function(n) {
                            return n.layer === layerIdx;
                          })(currentNodes);
                          var nodesWithTarget = map58(function(node) {
                            var weightedY = (function() {
                              if (ascending2) {
                                return calculateWeightedFromSources(node)(currentNodes)(allLinks);
                              }
                              ;
                              return calculateWeightedFromTargets(node)(currentNodes)(allLinks);
                            })();
                            var dy4 = (weightedY - node.y0) * alpha;
                            var newY0 = node.y0 + dy4;
                            var newY1 = node.y1 + dy4;
                            return {
                              node: {
                                color: node.color,
                                depth: node.depth,
                                index: node.index,
                                layer: node.layer,
                                name: node.name,
                                nodeHeight: node.nodeHeight,
                                sourceLinks: node.sourceLinks,
                                targetLinks: node.targetLinks,
                                value: node.value,
                                x0: node.x0,
                                x1: node.x1,
                                y0: newY0,
                                y1: newY1
                              },
                              targetY: newY0
                            };
                          })(layerNodes);
                          var sorted = sortBy(function(a2) {
                            return function(b10) {
                              var posCompare = compare17(a2.targetY)(b10.targetY);
                              var $120 = eq25(posCompare)(EQ.value);
                              if ($120) {
                                return compare17(b10.node.value)(a2.node.value);
                              }
                              ;
                              return posCompare;
                            };
                          })(nodesWithTarget);
                          var resolved = resolveCollisions(sorted)(padding)(y0)(y116);
                          return updateNodes3(currentNodes)(resolved);
                        };
                      };
                    };
                  };
                };
              };
            };
            var relaxByLayer = function(currentNodes) {
              return function(allLinks) {
                return function(padding) {
                  return function(ascending2) {
                    return function(alpha) {
                      return function(beta) {
                        var maxLayer = foldl2(function(acc) {
                          return function(node) {
                            return max8(acc)(node.layer);
                          };
                        })(0)(currentNodes);
                        var layerIndices = (function() {
                          if (ascending2) {
                            return range2(0)(maxLayer);
                          }
                          ;
                          return reverse(range2(0)(maxLayer));
                        })();
                        var relaxed2 = foldl2(function(nodes1) {
                          return function(layerIdx) {
                            return relaxLayer(nodes1)(allLinks)(layerIdx)(padding)(ascending2)(alpha)(beta);
                          };
                        })(currentNodes)(layerIndices);
                        return relaxed2;
                      };
                    };
                  };
                };
              };
            };
            var relaxed = foldl2(function(currentNodes) {
              return function(i2) {
                var alpha = pow(0.99)(toNumber(i2));
                var beta = max1(1 - alpha)(toNumber(i2 + 1 | 0) / toNumber(config.iterations));
                var v = unsafePerformEffect(log2("Relaxation iteration " + (show56(i2) + (", alpha=" + (show126(alpha) + (", beta=" + show126(beta)))))));
                var rtl = relaxByLayer(currentNodes)(links)(config.nodePadding)(false)(alpha)(beta);
                var ltr = relaxByLayer(rtl)(links)(config.nodePadding)(true)(alpha)(beta);
                return ltr;
              };
            })(nodes)(range2(0)(config.iterations - 1 | 0));
            return relaxed;
          };
        };
      };
    };
  };
  var processCSVLink = function(link4) {
    return bind53(get20)(function(model) {
      var t = lookup110(link4.t)(model.nodeNameToID);
      var s = lookup110(link4.s)(model.nodeNameToID);
      var v = (function() {
        if (s instanceof Just && t instanceof Just) {
          return {
            nodeCount: model.nodeCount,
            sid: s.value0,
            tid: t.value0
          };
        }
        ;
        if (s instanceof Just && t instanceof Nothing) {
          return {
            nodeCount: model.nodeCount + 1 | 0,
            sid: s.value0,
            tid: model.nodeCount
          };
        }
        ;
        if (s instanceof Nothing && t instanceof Just) {
          return {
            nodeCount: model.nodeCount + 1 | 0,
            sid: model.nodeCount,
            tid: t.value0
          };
        }
        ;
        if (s instanceof Nothing && t instanceof Nothing) {
          return {
            nodeCount: model.nodeCount + 2 | 0,
            sid: model.nodeCount,
            tid: model.nodeCount + 1 | 0
          };
        }
        ;
        throw new Error("Failed pattern match at PSD3.Layout.Sankey.Compute (line 110, column 7 - line 120, column 109): " + [s.constructor.name, t.constructor.name]);
      })();
      return modify_16(function(v1) {
        var $129 = {};
        for (var $130 in v1) {
          if ({}.hasOwnProperty.call(v1, $130)) {
            $129[$130] = v1[$130];
          }
          ;
        }
        ;
        $129.linkCount = model.linkCount + 1 | 0;
        $129.nodeCount = v.nodeCount;
        $129.nodeNameToID = insert22(link4.s)(v.sid)(insert22(link4.t)(v.tid)(model.nodeNameToID));
        $129.nodeIDToName = insert12(v.sid)(link4.s)(insert12(v.tid)(link4.t)(model.nodeIDToName));
        $129.deps = unionInsert(v.sid)(v.tid)(model.deps);
        $129.sped = unionInsert(v.tid)(v.sid)(model.sped);
        $129.sankeyLinks = snoc(model.sankeyLinks)(initialiseSankeyLink({
          source: v.sid,
          target: v.tid,
          value: link4.v,
          id: model.linkCount
        }));
        return $129;
      });
    });
  };
  var initializeNodeBreadths = function(nodes) {
    return function(links) {
      return function(config) {
        return function(y0) {
          return function(y116) {
            var positionLayer = function(ky2) {
              return function(padding) {
                return function(yStart) {
                  return function(layerNodes) {
                    var stacked = foldl2(function(acc) {
                      return function(node) {
                        var nodeHeight = node.value * ky2;
                        var positioned2 = {
                          value: node.value,
                          color: node.color,
                          depth: node.depth,
                          index: node.index,
                          layer: node.layer,
                          name: node.name,
                          nodeHeight: node.nodeHeight,
                          sourceLinks: node.sourceLinks,
                          targetLinks: node.targetLinks,
                          x0: node.x0,
                          x1: node.x1,
                          y0: acc.y,
                          y1: acc.y + nodeHeight
                        };
                        return {
                          nodes: snoc(acc.nodes)(positioned2),
                          y: acc.y + nodeHeight + padding,
                          finalY: acc.finalY
                        };
                      };
                    })({
                      nodes: [],
                      y: yStart,
                      finalY: y116
                    })(layerNodes);
                    var extraSpacing = (y116 - stacked.y + padding) / (toNumber(length(layerNodes)) + 1);
                    var v2 = unsafePerformEffect(log2("  Layer extra spacing: " + (show126(extraSpacing) + (" (lastY=" + (show126(stacked.y) + (", y1=" + (show126(y116) + ")")))))));
                    var adjusted = mapWithIndex2(function(i2) {
                      return function(node) {
                        var shift = extraSpacing * toNumber(i2 + 1 | 0);
                        return {
                          color: node.color,
                          depth: node.depth,
                          index: node.index,
                          layer: node.layer,
                          name: node.name,
                          nodeHeight: node.nodeHeight,
                          sourceLinks: node.sourceLinks,
                          targetLinks: node.targetLinks,
                          value: node.value,
                          x0: node.x0,
                          x1: node.x1,
                          y0: node.y0 + shift,
                          y1: node.y1 + shift
                        };
                      };
                    })(stacked.nodes);
                    return adjusted;
                  };
                };
              };
            };
            var calculateKy = function(layers2) {
              return function(height53) {
                return function(padding) {
                  var scaleForLayer = function(layerNodes) {
                    var totalValue = foldl2(function(sum6) {
                      return function(node) {
                        return sum6 + node.value;
                      };
                    })(0)(layerNodes);
                    var numNodes = toNumber(length(layerNodes));
                    var availableHeight = height53 - (numNodes - 1) * padding;
                    var scale = (function() {
                      var $135 = totalValue > 0;
                      if ($135) {
                        return availableHeight / totalValue;
                      }
                      ;
                      return 1;
                    })();
                    var v3 = unsafePerformEffect(log2("  Layer: " + (show56(length(layerNodes)) + (" nodes, totalValue=" + (show126(totalValue) + (", availableHeight=" + (show126(availableHeight) + (", scale=" + show126(scale)))))))));
                    return scale;
                  };
                  var v2 = unsafePerformEffect(log2("calculateKy: height=" + (show126(height53) + (", padding=" + show126(padding)))));
                  var scales = map58(scaleForLayer)(layers2);
                  var nonEmptyScales = filter(function(s) {
                    return s > 0;
                  })(scales);
                  var result = (function() {
                    var v12 = head(nonEmptyScales);
                    if (v12 instanceof Just) {
                      return foldl2(min7)(v12.value0)(nonEmptyScales);
                    }
                    ;
                    if (v12 instanceof Nothing) {
                      return 1;
                    }
                    ;
                    throw new Error("Failed pattern match at PSD3.Layout.Sankey.Compute (line 444, column 18 - line 446, column 25): " + [v12.constructor.name]);
                  })();
                  var v1 = unsafePerformEffect(log2("calculateKy result (min of all scales): " + show126(result)));
                  return result;
                };
              };
            };
            var totalHeight = y116 - y0;
            var maxLayer = foldl2(function(acc) {
              return function(node) {
                return max8(acc)(node.layer);
              };
            })(0)(nodes);
            var layers = map58(function(layerIdx) {
              return filter(function(node) {
                return node.layer === layerIdx;
              })(nodes);
            })(range2(0)(maxLayer));
            var ky = calculateKy(layers)(totalHeight)(config.nodePadding);
            var v = unsafePerformEffect(log2("DEBUG initializeNodeBreadths: totalHeight=" + (show126(totalHeight) + (", ky=" + (show126(ky) + (", numLayers=" + show56(length(layers))))))));
            var positionedLayers = map58(positionLayer(ky)(config.nodePadding)(y0))(layers);
            var positioned = concat(positionedLayers);
            return positioned;
          };
        };
      };
    };
  };
  var initialiseSankeyNodes = /* @__PURE__ */ bind53(get20)(function(model) {
    var nodeNames = toUnfoldable7(keys3(model.nodeIDToName));
    var sankeyNodes = catMaybes(map58(initialiseSankeyNode(model))(nodeNames));
    return modify_16(function(v) {
      var $138 = {};
      for (var $139 in v) {
        if ({}.hasOwnProperty.call(v, $139)) {
          $138[$139] = v[$139];
        }
        ;
      }
      ;
      $138.sankeyNodes = sankeyNodes;
      return $138;
    });
  });
  var computeNodeValues = /* @__PURE__ */ (function() {
    var setNodeValue2 = function(links) {
      return function(n) {
        var totalOut = foldl2(function(sum6) {
          return function(link4) {
            return sum6 + link4.value;
          };
        })(0)(filter(function(l) {
          return eq9(l.sourceIndex)(n.index);
        })(links));
        var totalIn = foldl2(function(sum6) {
          return function(link4) {
            return sum6 + link4.value;
          };
        })(0)(filter(function(l) {
          return eq9(l.targetIndex)(n.index);
        })(links));
        return {
          name: n.name,
          x0: n.x0,
          y0: n.y0,
          x1: n.x1,
          y1: n.y1,
          depth: n.depth,
          nodeHeight: n.nodeHeight,
          layer: n.layer,
          index: n.index,
          color: n.color,
          sourceLinks: n.sourceLinks,
          targetLinks: n.targetLinks,
          value: max1(totalIn)(totalOut)
        };
      };
    };
    return bind53(get20)(function(model) {
      var updatedNodes = map58(setNodeValue2(model.sankeyLinks))(model.sankeyNodes);
      return modify_16(function(v) {
        var $141 = {};
        for (var $142 in v) {
          if ({}.hasOwnProperty.call(v, $142)) {
            $141[$142] = v[$142];
          }
          ;
        }
        ;
        $141.sankeyNodes = updatedNodes;
        return $141;
      });
    });
  })();
  var computeNodeHeights = /* @__PURE__ */ (function() {
    var bfsHeight = function($copy_nodes) {
      return function($copy_height) {
        return function($copy_current) {
          return function($copy_maxHeight) {
            var $tco_var_nodes = $copy_nodes;
            var $tco_var_height = $copy_height;
            var $tco_var_current = $copy_current;
            var $tco_done = false;
            var $tco_result;
            function $tco_loop(nodes, height53, current, maxHeight) {
              if (isEmpty2(current)) {
                $tco_done = true;
                return nodes;
              }
              ;
              if (height53 > maxHeight) {
                $tco_done = true;
                return nodes;
              }
              ;
              if (otherwise) {
                var nodesWithHeight = map58(function(node) {
                  var $148 = member6(node.index)(current);
                  if ($148) {
                    return {
                      index: node.index,
                      color: node.color,
                      depth: node.depth,
                      layer: node.layer,
                      name: node.name,
                      sourceLinks: node.sourceLinks,
                      targetLinks: node.targetLinks,
                      value: node.value,
                      x0: node.x0,
                      x1: node.x1,
                      y0: node.y0,
                      y1: node.y1,
                      nodeHeight: height53
                    };
                  }
                  ;
                  return node;
                })(nodes);
                var next2 = foldl2(function(acc) {
                  return function(node) {
                    var $149 = member6(node.index)(current);
                    if ($149) {
                      return union5(acc)(node.targetLinks);
                    }
                    ;
                    return acc;
                  };
                })(empty8)(nodes);
                $tco_var_nodes = nodesWithHeight;
                $tco_var_height = height53 + 1 | 0;
                $tco_var_current = next2;
                $copy_maxHeight = maxHeight;
                return;
              }
              ;
              throw new Error("Failed pattern match at PSD3.Layout.Sankey.Compute (line 220, column 5 - line 220, column 86): " + [nodes.constructor.name, height53.constructor.name, current.constructor.name, maxHeight.constructor.name]);
            }
            ;
            while (!$tco_done) {
              $tco_result = $tco_loop($tco_var_nodes, $tco_var_height, $tco_var_current, $copy_maxHeight);
            }
            ;
            return $tco_result;
          };
        };
      };
    };
    return bind53(get20)(function(model) {
      var n = length(model.sankeyNodes);
      var sinkNodes = filter(function(node) {
        return isEmpty2(node.sourceLinks);
      })(model.sankeyNodes);
      var initialCurrent = fromFoldable45(map58(function(v) {
        return v.index;
      })(sinkNodes));
      var result = bfsHeight(model.sankeyNodes)(0)(initialCurrent)(n);
      return modify_16(function(v) {
        var $150 = {};
        for (var $151 in v) {
          if ({}.hasOwnProperty.call(v, $151)) {
            $150[$151] = v[$151];
          }
          ;
        }
        ;
        $150.sankeyNodes = result;
        return $150;
      });
    });
  })();
  var computeNodeDepths = /* @__PURE__ */ (function() {
    var bfsDepth = function($copy_nodes) {
      return function($copy_depth) {
        return function($copy_current) {
          return function($copy_maxDepth) {
            var $tco_var_nodes = $copy_nodes;
            var $tco_var_depth = $copy_depth;
            var $tco_var_current = $copy_current;
            var $tco_done = false;
            var $tco_result;
            function $tco_loop(nodes, depth, current, maxDepth) {
              if (isEmpty2(current)) {
                $tco_done = true;
                return nodes;
              }
              ;
              if (depth > maxDepth) {
                $tco_done = true;
                return nodes;
              }
              ;
              if (otherwise) {
                var nodesWithDepth = map58(function(node) {
                  var $157 = member6(node.index)(current);
                  if ($157) {
                    return {
                      index: node.index,
                      color: node.color,
                      layer: node.layer,
                      name: node.name,
                      nodeHeight: node.nodeHeight,
                      sourceLinks: node.sourceLinks,
                      targetLinks: node.targetLinks,
                      value: node.value,
                      x0: node.x0,
                      x1: node.x1,
                      y0: node.y0,
                      y1: node.y1,
                      depth
                    };
                  }
                  ;
                  return node;
                })(nodes);
                var next2 = foldl2(function(acc) {
                  return function(node) {
                    var $158 = member6(node.index)(current);
                    if ($158) {
                      return union5(acc)(node.sourceLinks);
                    }
                    ;
                    return acc;
                  };
                })(empty8)(nodes);
                $tco_var_nodes = nodesWithDepth;
                $tco_var_depth = depth + 1 | 0;
                $tco_var_current = next2;
                $copy_maxDepth = maxDepth;
                return;
              }
              ;
              throw new Error("Failed pattern match at PSD3.Layout.Sankey.Compute (line 181, column 5 - line 181, column 85): " + [nodes.constructor.name, depth.constructor.name, current.constructor.name, maxDepth.constructor.name]);
            }
            ;
            while (!$tco_done) {
              $tco_result = $tco_loop($tco_var_nodes, $tco_var_depth, $tco_var_current, $copy_maxDepth);
            }
            ;
            return $tco_result;
          };
        };
      };
    };
    return bind53(get20)(function(model) {
      var n = length(model.sankeyNodes);
      var sourceNodes = filter(function(node) {
        return isEmpty2(node.targetLinks);
      })(model.sankeyNodes);
      var initialCurrent = fromFoldable45(map58(function(v) {
        return v.index;
      })(sourceNodes));
      var result = bfsDepth(model.sankeyNodes)(0)(initialCurrent)(n);
      return modify_16(function(v) {
        var $159 = {};
        for (var $160 in v) {
          if ({}.hasOwnProperty.call(v, $160)) {
            $159[$160] = v[$160];
          }
          ;
        }
        ;
        $159.sankeyNodes = result;
        return $159;
      });
    });
  })();
  var computeLinkBreadths = /* @__PURE__ */ (function() {
    var calculateLinkYPositions = function(nodes) {
      return function(links) {
        var linksWithY0 = foldl2(function(currentLinks) {
          return function(node) {
            var outgoingLinks = filter(function(link4) {
              return eq9(link4.sourceIndex)(node.index);
            })(currentLinks);
            var sorted = sortBy(function(a2) {
              return function(b10) {
                var v = find2(function(n) {
                  return eq9(n.index)(b10.targetIndex);
                })(nodes);
                var v1 = find2(function(n) {
                  return eq9(n.index)(a2.targetIndex);
                })(nodes);
                if (v1 instanceof Just && v instanceof Just) {
                  return compare17(v1.value0.y0)(v.value0.y0);
                }
                ;
                return EQ.value;
              };
            })(outgoingLinks);
            var withY0 = foldl2(function(acc) {
              return function(link4) {
                var y48 = acc.y + link4.width / 2;
                var updated = {
                  width: link4.width,
                  sourceIndex: link4.sourceIndex,
                  targetIndex: link4.targetIndex,
                  index: link4.index,
                  color: link4.color,
                  value: link4.value,
                  y1: link4.y1,
                  y0: y48
                };
                return {
                  y: acc.y + link4.width,
                  links: snoc(acc.links)(updated)
                };
              };
            })({
              y: node.y0,
              links: []
            })(sorted);
            return map58(function(link4) {
              var v = find2(function(l) {
                return eq32(l.index)(link4.index);
              })(withY0.links);
              if (v instanceof Just) {
                return v.value0;
              }
              ;
              if (v instanceof Nothing) {
                return link4;
              }
              ;
              throw new Error("Failed pattern match at PSD3.Layout.Sankey.Compute (line 737, column 15 - line 739, column 32): " + [v.constructor.name]);
            })(currentLinks);
          };
        })(links)(nodes);
        var linksWithY1 = foldl2(function(currentLinks) {
          return function(node) {
            var incomingLinks = filter(function(link4) {
              return eq9(link4.targetIndex)(node.index);
            })(currentLinks);
            var sorted = sortBy(function(a2) {
              return function(b10) {
                var v = find2(function(n) {
                  return eq9(n.index)(b10.sourceIndex);
                })(nodes);
                var v1 = find2(function(n) {
                  return eq9(n.index)(a2.sourceIndex);
                })(nodes);
                if (v1 instanceof Just && v instanceof Just) {
                  return compare17(v1.value0.y0)(v.value0.y0);
                }
                ;
                return EQ.value;
              };
            })(incomingLinks);
            var withY1 = foldl2(function(acc) {
              return function(link4) {
                var y48 = acc.y + link4.width / 2;
                var updated = {
                  width: link4.width,
                  sourceIndex: link4.sourceIndex,
                  targetIndex: link4.targetIndex,
                  index: link4.index,
                  color: link4.color,
                  value: link4.value,
                  y0: link4.y0,
                  y1: y48
                };
                return {
                  y: acc.y + link4.width,
                  links: snoc(acc.links)(updated)
                };
              };
            })({
              y: node.y0,
              links: []
            })(sorted);
            return map58(function(link4) {
              var v = find2(function(l) {
                return eq32(l.index)(link4.index);
              })(withY1.links);
              if (v instanceof Just) {
                return v.value0;
              }
              ;
              if (v instanceof Nothing) {
                return link4;
              }
              ;
              throw new Error("Failed pattern match at PSD3.Layout.Sankey.Compute (line 767, column 15 - line 769, column 32): " + [v.constructor.name]);
            })(currentLinks);
          };
        })(linksWithY0)(nodes);
        return linksWithY1;
      };
    };
    var calculateGlobalKy = function(nodes) {
      return function(y0) {
        return function(y116) {
          return function(padding) {
            var scaleForLayer = function(layerNodes) {
              var totalValue = foldl2(function(sum6) {
                return function(node) {
                  return sum6 + node.value;
                };
              })(0)(layerNodes);
              var numNodes = toNumber(length(layerNodes));
              var availableHeight = y116 - y0 - (numNodes - 1) * padding;
              var $174 = totalValue > 0;
              if ($174) {
                return availableHeight / totalValue;
              }
              ;
              return 1;
            };
            var maxLayer = foldl2(function(acc) {
              return function(node) {
                return max8(acc)(node.layer);
              };
            })(0)(nodes);
            var layers = map58(function(layerIdx) {
              return filter(function(node) {
                return node.layer === layerIdx;
              })(nodes);
            })(range2(0)(maxLayer));
            var scales = map58(scaleForLayer)(layers);
            var nonEmptyScales = filter(function(s) {
              return s > 0;
            })(scales);
            var v = head(nonEmptyScales);
            if (v instanceof Just) {
              return foldl2(min7)(v.value0)(nonEmptyScales);
            }
            ;
            if (v instanceof Nothing) {
              return 1;
            }
            ;
            throw new Error("Failed pattern match at PSD3.Layout.Sankey.Compute (line 705, column 9 - line 707, column 25): " + [v.constructor.name]);
          };
        };
      };
    };
    return bind53(get20)(function(model) {
      var ky = calculateGlobalKy(model.sankeyNodes)(model.config.extent.y0)(model.config.extent.y1)(model.config.nodePadding);
      var linksWithWidth = map58(function(link4) {
        return {
          value: link4.value,
          color: link4.color,
          index: link4.index,
          sourceIndex: link4.sourceIndex,
          targetIndex: link4.targetIndex,
          y0: link4.y0,
          y1: link4.y1,
          width: link4.value * ky
        };
      })(model.sankeyLinks);
      var linksWithY = calculateLinkYPositions(model.sankeyNodes)(linksWithWidth);
      return modify_16(function(v) {
        var $177 = {};
        for (var $178 in v) {
          if ({}.hasOwnProperty.call(v, $178)) {
            $177[$178] = v[$178];
          }
          ;
        }
        ;
        $177.sankeyLinks = linksWithY;
        return $177;
      });
    });
  })();
  var assignColors = /* @__PURE__ */ bind53(get20)(function(model) {
    var colors5 = ["#1f77b4", "#ff7f0e", "#2ca02c", "#d62728", "#9467bd", "#8c564b", "#e377c2", "#7f7f7f", "#bcbd22", "#17becf"];
    var nodesWithColor = mapWithIndex2(function(i2) {
      return function(node) {
        return {
          depth: node.depth,
          index: node.index,
          layer: node.layer,
          name: node.name,
          nodeHeight: node.nodeHeight,
          sourceLinks: node.sourceLinks,
          targetLinks: node.targetLinks,
          value: node.value,
          x0: node.x0,
          x1: node.x1,
          y0: node.y0,
          y1: node.y1,
          color: fromMaybe("#999")(index(colors5)(mod5(i2)(length(colors5))))
        };
      };
    })(model.sankeyNodes);
    var assignLinkColor = function(nodes) {
      return function(mode) {
        return function(link4) {
          if (mode instanceof SourceColor) {
            var sourceNode = find2(function(n) {
              return eq9(n.index)(link4.sourceIndex);
            })(nodes);
            return {
              sourceIndex: link4.sourceIndex,
              targetIndex: link4.targetIndex,
              value: link4.value,
              width: link4.width,
              y0: link4.y0,
              y1: link4.y1,
              index: link4.index,
              color: maybe("#999")(function(n) {
                return n.color;
              })(sourceNode)
            };
          }
          ;
          if (mode instanceof TargetColor) {
            var targetNode = find2(function(n) {
              return eq9(n.index)(link4.targetIndex);
            })(nodes);
            return {
              sourceIndex: link4.sourceIndex,
              targetIndex: link4.targetIndex,
              value: link4.value,
              width: link4.width,
              y0: link4.y0,
              y1: link4.y1,
              index: link4.index,
              color: maybe("#999")(function(n) {
                return n.color;
              })(targetNode)
            };
          }
          ;
          if (mode instanceof SourceTargetGradient) {
            return {
              sourceIndex: link4.sourceIndex,
              targetIndex: link4.targetIndex,
              value: link4.value,
              width: link4.width,
              y0: link4.y0,
              y1: link4.y1,
              index: link4.index,
              color: "#999"
            };
          }
          ;
          if (mode instanceof StaticColor) {
            return {
              sourceIndex: link4.sourceIndex,
              targetIndex: link4.targetIndex,
              value: link4.value,
              width: link4.width,
              y0: link4.y0,
              y1: link4.y1,
              index: link4.index,
              color: mode.value0
            };
          }
          ;
          throw new Error("Failed pattern match at PSD3.Layout.Sankey.Compute (line 795, column 9 - line 805, column 31): " + [mode.constructor.name]);
        };
      };
    };
    var linksWithColor = map58(assignLinkColor(nodesWithColor)(model.config.linkColorMode))(model.sankeyLinks);
    return modify_16(function(v) {
      var $182 = {};
      for (var $183 in v) {
        if ({}.hasOwnProperty.call(v, $183)) {
          $182[$183] = v[$183];
        }
        ;
      }
      ;
      $182.sankeyNodes = nodesWithColor;
      $182.sankeyLinks = linksWithColor;
      return $182;
    });
  });
  var alignNodeToLayer = function(alignment) {
    return function(node) {
      return function(numLayers) {
        if (alignment instanceof Left3) {
          return node.depth;
        }
        ;
        if (alignment instanceof Right3) {
          return max8(0)((numLayers - 1 | 0) - node.nodeHeight | 0);
        }
        ;
        if (alignment instanceof Justify) {
          var $186 = isEmpty2(node.sourceLinks);
          if ($186) {
            return numLayers - 1 | 0;
          }
          ;
          return node.depth;
        }
        ;
        if (alignment instanceof Center) {
          var $187 = !isEmpty2(node.targetLinks);
          if ($187) {
            return node.depth;
          }
          ;
          return 0;
        }
        ;
        throw new Error("Failed pattern match at PSD3.Layout.Sankey.Compute (line 386, column 3 - line 396, column 13): " + [alignment.constructor.name]);
      };
    };
  };
  var computeNodeLayers = function(nodes) {
    return function(config) {
      return function(x0) {
        return function(x116) {
          var maxDepth = foldl2(function(acc) {
            return function(node) {
              return max8(acc)(node.depth);
            };
          })(0)(nodes);
          var numLayers = maxDepth + 1 | 0;
          var nodesWithLayer = map58(function(node) {
            var layer = alignNodeToLayer(config.alignment)(node)(numLayers);
            return {
              color: node.color,
              depth: node.depth,
              index: node.index,
              name: node.name,
              nodeHeight: node.nodeHeight,
              sourceLinks: node.sourceLinks,
              targetLinks: node.targetLinks,
              value: node.value,
              x0: node.x0,
              x1: node.x1,
              y0: node.y0,
              y1: node.y1,
              layer
            };
          })(nodes);
          var kx = (x116 - x0 - config.nodeWidth) / max1(1)(toNumber(numLayers - 1 | 0));
          var nodesWithX = map58(function(node) {
            var x0Pos = x0 + toNumber(node.layer) * kx;
            return {
              layer: node.layer,
              color: node.color,
              depth: node.depth,
              index: node.index,
              name: node.name,
              nodeHeight: node.nodeHeight,
              sourceLinks: node.sourceLinks,
              targetLinks: node.targetLinks,
              value: node.value,
              y0: node.y0,
              y1: node.y1,
              x0: x0Pos,
              x1: x0Pos + config.nodeWidth
            };
          })(nodesWithLayer);
          return nodesWithX;
        };
      };
    };
  };
  var computeNodeBreadths = /* @__PURE__ */ bind53(get20)(function(model) {
    var nodesWithLayers = computeNodeLayers(model.sankeyNodes)(model.config)(model.config.extent.x0)(model.config.extent.x1);
    var nodesWithY = initializeNodeBreadths(nodesWithLayers)(model.sankeyLinks)(model.config)(model.config.extent.y0)(model.config.extent.y1);
    var v = unsafePerformEffect(function __do3() {
      (function() {
        var v13 = find2(function(n) {
          return n.name === "Nuclear";
        })(nodesWithY);
        if (v13 instanceof Just) {
          return log2("BEFORE relaxation - Nuclear: y0=" + (show126(v13.value0.y0) + (", y1=" + show126(v13.value0.y1))))();
        }
        ;
        if (v13 instanceof Nothing) {
          return unit;
        }
        ;
        throw new Error("Failed pattern match at PSD3.Layout.Sankey.Compute (line 262, column 9 - line 264, column 31): " + [v13.constructor.name]);
      })();
      (function() {
        var v13 = find2(function(n) {
          return n.name === "Thermal generation";
        })(nodesWithY);
        if (v13 instanceof Just) {
          return log2("BEFORE relaxation - Thermal generation: y0=" + (show126(v13.value0.y0) + (", y1=" + show126(v13.value0.y1))))();
        }
        ;
        if (v13 instanceof Nothing) {
          return unit;
        }
        ;
        throw new Error("Failed pattern match at PSD3.Layout.Sankey.Compute (line 265, column 9 - line 267, column 31): " + [v13.constructor.name]);
      })();
      var v12 = find2(function(n) {
        return n.name === "Losses";
      })(nodesWithY);
      if (v12 instanceof Just) {
        return log2("BEFORE relaxation - Losses: y0=" + (show126(v12.value0.y0) + (", y1=" + show126(v12.value0.y1))))();
      }
      ;
      if (v12 instanceof Nothing) {
        return unit;
      }
      ;
      throw new Error("Failed pattern match at PSD3.Layout.Sankey.Compute (line 268, column 9 - line 270, column 31): " + [v12.constructor.name]);
    });
    var relaxedNodes = relaxation(nodesWithY)(model.sankeyLinks)(model.config)(model.config.extent.y0)(model.config.extent.y1);
    var v1 = unsafePerformEffect(function __do3() {
      (function() {
        var v22 = find2(function(n) {
          return n.name === "Nuclear";
        })(relaxedNodes);
        if (v22 instanceof Just) {
          return log2("AFTER relaxation - Nuclear: y0=" + (show126(v22.value0.y0) + (", y1=" + show126(v22.value0.y1))))();
        }
        ;
        if (v22 instanceof Nothing) {
          return unit;
        }
        ;
        throw new Error("Failed pattern match at PSD3.Layout.Sankey.Compute (line 278, column 9 - line 280, column 31): " + [v22.constructor.name]);
      })();
      (function() {
        var v22 = find2(function(n) {
          return n.name === "Thermal generation";
        })(relaxedNodes);
        if (v22 instanceof Just) {
          return log2("AFTER relaxation - Thermal generation: y0=" + (show126(v22.value0.y0) + (", y1=" + show126(v22.value0.y1))))();
        }
        ;
        if (v22 instanceof Nothing) {
          return unit;
        }
        ;
        throw new Error("Failed pattern match at PSD3.Layout.Sankey.Compute (line 281, column 9 - line 283, column 31): " + [v22.constructor.name]);
      })();
      var v2 = find2(function(n) {
        return n.name === "Losses";
      })(relaxedNodes);
      if (v2 instanceof Just) {
        return log2("AFTER relaxation - Losses: y0=" + (show126(v2.value0.y0) + (", y1=" + show126(v2.value0.y1))))();
      }
      ;
      if (v2 instanceof Nothing) {
        return unit;
      }
      ;
      throw new Error("Failed pattern match at PSD3.Layout.Sankey.Compute (line 284, column 9 - line 286, column 31): " + [v2.constructor.name]);
    });
    return modify_16(function(v2) {
      var $200 = {};
      for (var $201 in v2) {
        if ({}.hasOwnProperty.call(v2, $201)) {
          $200[$201] = v2[$201];
        }
        ;
      }
      ;
      $200.sankeyNodes = relaxedNodes;
      return $200;
    });
  });
  var computeLayoutWithConfig = function(linkInputs) {
    return function(config) {
      var computeSankeyLayout = discard211(for_2(linkInputs)(processCSVLink))(function() {
        return discard211(initialiseSankeyNodes)(function() {
          return discard211(computeNodeValues)(function() {
            return discard211(computeNodeDepths)(function() {
              return discard211(computeNodeHeights)(function() {
                return discard211(computeNodeBreadths)(function() {
                  return discard211(computeLinkBreadths)(function() {
                    return assignColors;
                  });
                });
              });
            });
          });
        });
      });
      var finalModel = execState(computeSankeyLayout)(initialSankeyGraphModel(config));
      return {
        nodes: finalModel.sankeyNodes,
        links: finalModel.sankeyLinks
      };
    };
  };
  var computeLayout = function(linkInputs) {
    return function(width53) {
      return function(height53) {
        return computeLayoutWithConfig(linkInputs)(defaultSankeyConfig(width53)(height53));
      };
    };
  };

  // output/PSD3.Layout.Sankey.Path/index.js
  var eq10 = /* @__PURE__ */ eq(eqNodeID);
  var findNode = function(nodes) {
    return function(nodeId) {
      return find2(function(n) {
        return eq10(n.index)(nodeId);
      })(nodes);
    };
  };
  var generateLinkPath = function(nodes) {
    return function(link4) {
      var targetNode = findNode(nodes)(link4.targetIndex);
      var sourceNode = findNode(nodes)(link4.sourceIndex);
      if (sourceNode instanceof Just && targetNode instanceof Just) {
        var xi = (sourceNode.value0.x1 + targetNode.value0.x0) / 2;
        var y0Bottom = link4.y0 + link4.width / 2;
        var y0Top = link4.y0 - link4.width / 2;
        var y1Bottom = link4.y1 + link4.width / 2;
        var y1Top = link4.y1 - link4.width / 2;
        return "M" + (toString(sourceNode.value0.x1) + ("," + (toString(y0Top) + (" C" + (toString(xi) + ("," + (toString(y0Top) + (" " + (toString(xi) + ("," + (toString(y1Top) + (" " + (toString(targetNode.value0.x0) + ("," + (toString(y1Top) + (" L" + (toString(targetNode.value0.x0) + ("," + (toString(y1Bottom) + (" C" + (toString(xi) + ("," + (toString(y1Bottom) + (" " + (toString(xi) + ("," + (toString(y0Bottom) + (" " + (toString(sourceNode.value0.x1) + ("," + (toString(y0Bottom) + " Z")))))))))))))))))))))))))))))));
      }
      ;
      return "";
    };
  };

  // output/D3.Viz.TreeAPI.SankeyDiagram/index.js
  var compare18 = /* @__PURE__ */ compare(ordInt);
  var discard46 = /* @__PURE__ */ discard(discardUnit)(bindD3v2M);
  var liftEffect27 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var bind54 = /* @__PURE__ */ bind(bindD3v2M);
  var select22 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var show57 = /* @__PURE__ */ show(showInt);
  var width31 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height31 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox25 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var show127 = /* @__PURE__ */ show(showNumber);
  var id_15 = /* @__PURE__ */ id_(toAttrStringString);
  var class_28 = /* @__PURE__ */ class_2(toAttrStringString);
  var renderTree41 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D);
  var renderTree115 = /* @__PURE__ */ renderTree41(ordUnit);
  var d11 = /* @__PURE__ */ d4(toAttrStringFunctionStrin);
  var fill29 = /* @__PURE__ */ fill3(toAttrStringFunctionStrin);
  var fillOpacity6 = /* @__PURE__ */ fillOpacity(toAttrNumberNumber);
  var x33 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y33 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var fill111 = /* @__PURE__ */ fill3(toAttrStringString);
  var stroke24 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth24 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var strokeOpacity4 = /* @__PURE__ */ strokeOpacity(toAttrNumberNumber);
  var textAnchor11 = /* @__PURE__ */ textAnchor(toAttrStringFunctionStrin);
  var textContent13 = /* @__PURE__ */ textContent(toAttrStringString);
  var pure56 = /* @__PURE__ */ pure(applicativeD3v2M);
  var eqIndexedNode = {
    eq: function(v) {
      return function(v1) {
        return v.index === v1.index;
      };
    }
  };
  var ordIndexedNode = {
    compare: function(v) {
      return function(v1) {
        return compare18(v.index)(v1.index);
      };
    },
    Eq0: function() {
      return eqIndexedNode;
    }
  };
  var renderTree213 = /* @__PURE__ */ renderTree41(ordIndexedNode);
  var eqIndexedLink6 = {
    eq: function(v) {
      return function(v1) {
        return v.index === v1.index;
      };
    }
  };
  var ordIndexedLink6 = {
    compare: function(v) {
      return function(v1) {
        return compare18(v.index)(v1.index);
      };
    },
    Eq0: function() {
      return eqIndexedLink6;
    }
  };
  var renderTree311 = /* @__PURE__ */ renderTree41(ordIndexedLink6);
  var drawSankey = function(csvData) {
    return function(containerSelector) {
      return function(w) {
        return function(h) {
          return runD3v2M(discard46(liftEffect27(log2("=== Drawing Sankey with TreeAPI ===")))(function() {
            return bind54(select22(containerSelector))(function(container) {
              var linkInputs = parseSankeyCSV(csvData);
              return discard46(liftEffect27(log2("Parsed " + (show57(length(linkInputs)) + " links from CSV"))))(function() {
                var layoutResult = computeLayout(linkInputs)(w)(h);
                return discard46(liftEffect27(log2("Layout computed: " + (show57(length(layoutResult.nodes)) + (" nodes, " + (show57(length(layoutResult.links)) + " links"))))))(function() {
                  var indexedNodes = mapWithIndex2(function(i2) {
                    return function(node) {
                      return {
                        index: i2,
                        node
                      };
                    };
                  })(layoutResult.nodes);
                  var indexedLinks = mapWithIndex2(function(i2) {
                    return function(link4) {
                      return {
                        index: i2,
                        link: link4
                      };
                    };
                  })(layoutResult.links);
                  var sankeyTree = withChildren(named2(SVG.value)("svg")([width31(w), height31(h), viewBox25("0 0 " + (show127(w) + (" " + show127(h)))), id_15("sankey-svg"), class_28("sankey")]))([named2(Group2.value)("linksGroup")([class_28("links")]), named2(Group2.value)("nodesGroup")([class_28("nodes")]), named2(Group2.value)("labelsGroup")([class_28("labels")])]);
                  return bind54(renderTree115(container)(sankeyTree))(function(selections) {
                    return bind54(liftEffect27(reselectD3v2("linksGroup")(selections)))(function(linksGroupSel) {
                      return bind54(liftEffect27(reselectD3v2("nodesGroup")(selections)))(function(nodesGroupSel) {
                        return bind54(liftEffect27(reselectD3v2("labelsGroup")(selections)))(function(labelsGroupSel) {
                          var linksTree = joinData2("linkElements")("path")(indexedLinks)(function(v) {
                            return elem4(Path3.value)([class_28("sankey-link"), d11(function(v1) {
                              return generateLinkPath(layoutResult.nodes)(v.link);
                            }), fill29(function(v1) {
                              return v.link.color;
                            }), fillOpacity6(0.5)]);
                          });
                          return bind54(renderTree311(linksGroupSel)(linksTree))(function() {
                            var nodesTree = joinData2("nodeElements")("rect")(indexedNodes)(function(v) {
                              return elem4(Rect2.value)([class_28("sankey-node"), x33(v.node.x0), y33(v.node.y0), width31(v.node.x1 - v.node.x0), height31(v.node.y1 - v.node.y0), fill111(v.node.color), stroke24("#000"), strokeWidth24(1), strokeOpacity4(0.3)]);
                            });
                            return bind54(renderTree213(nodesGroupSel)(nodesTree))(function() {
                              var labelsTree = joinData2("labelElements")("text")(indexedNodes)(function(v) {
                                return elem4(Text3.value)([class_28("sankey-label"), x33((function() {
                                  var $64 = v.node.x0 < w / 2;
                                  if ($64) {
                                    return v.node.x1 + 6;
                                  }
                                  ;
                                  return v.node.x0 - 6;
                                })()), y33((v.node.y0 + v.node.y1) / 2), textAnchor11(function(v1) {
                                  var $65 = v.node.x0 < w / 2;
                                  if ($65) {
                                    return "start";
                                  }
                                  ;
                                  return "end";
                                }), fill111("#000"), textContent13(v.node.name)]);
                              });
                              return bind54(renderTree213(labelsGroupSel)(labelsTree))(function() {
                                return discard46(liftEffect27(log2("Sankey diagram rendered with TreeAPI")))(function() {
                                  return pure56(unit);
                                });
                              });
                            });
                          });
                        });
                      });
                    });
                  });
                });
              });
            });
          }));
        };
      };
    };
  };
  var startSankey = function(csvData) {
    return function(containerSelector) {
      return drawSankey(csvData)(containerSelector)(750)(500);
    };
  };

  // output/Component.Tour.TourFlow/index.js
  var discard47 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var bind55 = /* @__PURE__ */ bind(bindHalogenM);
  var pure57 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize27 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var render31 = function(v) {
    return div2([classes(["tutorial-page"])])([renderHeader2(TourFlow.value), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("3. Data Flow")]), p_([text2("Chord and Sankey diagrams are specialized visualizations for showing relationships and flows between entities. Both use visual metaphors - ribbons and flows - to make complex interconnections immediately comprehensible.")]), p_([text2("These visualization types excel at revealing patterns in network data, resource flows, and dependencies that would be difficult to understand in tabular form.")])]), section([classes(["tutorial-section"]), id3("chord")])([h2([classes(["tutorial-section-title"])])([text2("1. Chord Diagram: Traffic Flow Analysis")]), p_([text2("Chord diagrams show bidirectional relationships and flows between entities in a circular layout. They're particularly effective for displaying interconnected systems where flow goes in both directions between pairs.")]), p_([text2("This example shows traffic flow between 11 regions in Baton Rouge, Louisiana, supporting analysis for a new bridge location. Each arc represents a region, and the ribbons show the volume of trips between region pairs. Ribbons are colored by their origin region, making it easy to trace outbound traffic from each area.")]), div2([id3("chord-container"), classes(["viz-container"])])([]), p_([text2("Inspired by "), a([href("https://www.streetlightdata.com/planning-bridges-louisiana/"), target2("_blank")])([text2("StreetLight Data's bridge planning analysis")]), text2(". The circular layout reveals dominant traffic patterns - notice how West Baton Rouge (WBR, in red) and East Baton Rouge Main (EBR-M, in teal) serve as major hubs with thick ribbons to multiple regions.")])]), section([classes(["tutorial-section"]), id3("sankey")])([h2([classes(["tutorial-section-title"])])([text2("2. Sankey Diagram: Flow Visualization")]), p_([text2("Sankey diagrams visualize the flow of resources, energy, costs, or other quantities through a system. The width of each connection is proportional to the flow quantity, making it easy to identify dominant flows and inefficiencies.")]), p_([text2("This diagram shows energy flows in the UK energy system, from primary energy sources through transformation and distribution to final consumption. The Sankey layout uses a pure PureScript algorithm (not D3 FFI) that automatically positions nodes and creates smooth flow paths.")]), div2([id3("sankey-container"), classes(["viz-container"])])([]), p_([text2("The width of each flow represents the quantity of energy. Notice how the diagram reveals energy losses in transformation processes and highlights which sources contribute most to final consumption.")])])])]);
  };
  var handleAction26 = function(dictMonadAff) {
    var liftAff3 = liftAff(monadAffHalogenM(dictMonadAff));
    var liftEffect51 = liftEffect(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    return function(v) {
      return discard47(liftAff3(delay(100)))(function() {
        return bind55(liftAff3(get3(string)("./data/energy.csv")))(function(sankeyResult) {
          return discard47((function() {
            if (sankeyResult instanceof Left) {
              return pure57(unit);
            }
            ;
            if (sankeyResult instanceof Right) {
              return liftEffect51(startSankey(sankeyResult.value0.body)("#sankey-container"));
            }
            ;
            throw new Error("Failed pattern match at Component.Tour.TourFlow (line 45, column 5 - line 48, column 81): " + [sankeyResult.constructor.name]);
          })())(function() {
            return discard47(liftEffect51(startChord("#chord-container")))(function() {
              return pure57(unit);
            });
          });
        });
      });
    };
  };
  var component27 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render31,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction26(dictMonadAff),
        initialize: new Just(Initialize27.value)
      })
    });
  };

  // output/D3.Viz.TreeAPI.AnscombesQuartet/index.js
  var show58 = /* @__PURE__ */ show(showNumber);
  var map59 = /* @__PURE__ */ map(functorArray);
  var sum3 = /* @__PURE__ */ sum(foldableArray)(semiringNumber);
  var bind56 = /* @__PURE__ */ bind(bindD3v2M);
  var select23 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var mod6 = /* @__PURE__ */ mod(euclideanRingInt);
  var show128 = /* @__PURE__ */ show(showInt);
  var transform13 = /* @__PURE__ */ transform2(toAttrStringString);
  var class_29 = /* @__PURE__ */ class_2(toAttrStringString);
  var x34 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y34 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var textAnchor12 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var textContent14 = /* @__PURE__ */ textContent(toAttrStringString);
  var cx24 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy24 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius22 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill30 = /* @__PURE__ */ fill3(toAttrStringString);
  var width32 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height32 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox26 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var id_16 = /* @__PURE__ */ id_(toAttrStringString);
  var renderTree42 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(/* @__PURE__ */ ordRecord()(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordNil)()({
    reflectSymbol: function() {
      return "y";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "x";
    }
  })(ordNumber)));
  var liftEffect28 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var dataset42 = [{
    x: 8,
    y: 6.58
  }, {
    x: 8,
    y: 5.76
  }, {
    x: 8,
    y: 7.71
  }, {
    x: 8,
    y: 8.84
  }, {
    x: 8,
    y: 8.47
  }, {
    x: 8,
    y: 7.04
  }, {
    x: 8,
    y: 5.25
  }, {
    x: 19,
    y: 12.5
  }, {
    x: 8,
    y: 5.56
  }, {
    x: 8,
    y: 7.91
  }, {
    x: 8,
    y: 6.89
  }];
  var dataset32 = [{
    x: 10,
    y: 7.46
  }, {
    x: 8,
    y: 6.77
  }, {
    x: 13,
    y: 12.74
  }, {
    x: 9,
    y: 7.11
  }, {
    x: 11,
    y: 7.81
  }, {
    x: 14,
    y: 8.84
  }, {
    x: 6,
    y: 6.08
  }, {
    x: 4,
    y: 5.39
  }, {
    x: 12,
    y: 8.15
  }, {
    x: 7,
    y: 6.42
  }, {
    x: 5,
    y: 5.73
  }];
  var dataset22 = [{
    x: 10,
    y: 9.14
  }, {
    x: 8,
    y: 8.14
  }, {
    x: 13,
    y: 8.74
  }, {
    x: 9,
    y: 8.77
  }, {
    x: 11,
    y: 9.26
  }, {
    x: 14,
    y: 8.1
  }, {
    x: 6,
    y: 6.13
  }, {
    x: 4,
    y: 3.1
  }, {
    x: 12,
    y: 9.13
  }, {
    x: 7,
    y: 7.26
  }, {
    x: 5,
    y: 4.74
  }];
  var dataset12 = [{
    x: 10,
    y: 8.04
  }, {
    x: 8,
    y: 6.95
  }, {
    x: 13,
    y: 7.58
  }, {
    x: 9,
    y: 8.81
  }, {
    x: 11,
    y: 8.33
  }, {
    x: 14,
    y: 9.96
  }, {
    x: 6,
    y: 7.24
  }, {
    x: 4,
    y: 4.26
  }, {
    x: 12,
    y: 10.84
  }, {
    x: 7,
    y: 4.82
  }, {
    x: 5,
    y: 5.68
  }];
  var calculateStats = function(points) {
    var ys = map59(function(v) {
      return v.y;
    })(points);
    var xs = map59(function(v) {
      return v.x;
    })(points);
    var n = toNumber(length(points));
    var meanY = sum3(ys) / n;
    var varianceY = sum3(map59(function(y116) {
      return pow(y116 - meanY)(2);
    })(ys)) / (n - 1);
    var meanX = sum3(xs) / n;
    var varianceX = sum3(map59(function(x116) {
      return pow(x116 - meanX)(2);
    })(xs)) / (n - 1);
    var covariance = sum3(map59(function(p2) {
      return (p2.x - meanX) * (p2.y - meanY);
    })(points)) / (n - 1);
    var correlation = covariance / (sqrt(varianceX) * sqrt(varianceY));
    return {
      meanX,
      meanY,
      varianceX,
      varianceY,
      correlation
    };
  };
  var allDatasets = [{
    name: "A",
    data: dataset12,
    stats: /* @__PURE__ */ calculateStats(dataset12)
  }, {
    name: "B",
    data: dataset22,
    stats: /* @__PURE__ */ calculateStats(dataset22)
  }, {
    name: "C",
    data: dataset32,
    stats: /* @__PURE__ */ calculateStats(dataset32)
  }, {
    name: "D",
    data: dataset42,
    stats: /* @__PURE__ */ calculateStats(dataset42)
  }];
  var anscombesQuartet = function(selector) {
    return runD3v2M(bind56(select23(selector))(function(container) {
      var margin = {
        top: 20,
        right: 20,
        bottom: 40,
        left: 50
      };
      var plotHeight = 140 - margin.top - margin.bottom;
      var yScale = {
        domain: {
          min: 0,
          max: 14
        },
        range: {
          min: plotHeight,
          max: 0
        }
      };
      var scaleY3 = function(value18) {
        var rangeSpan = yScale.range.max - yScale.range.min;
        var domainSpan = yScale.domain.max - yScale.domain.min;
        var normalized = (value18 - yScale.domain.min) / domainSpan;
        return yScale.range.min + normalized * rangeSpan;
      };
      var plotWidth = 140 - margin.left - margin.right;
      var xScale = {
        domain: {
          min: 0,
          max: 20
        },
        range: {
          min: 0,
          max: plotWidth
        }
      };
      var scaleX3 = function(value18) {
        var rangeSpan = xScale.range.max - xScale.range.min;
        var domainSpan = xScale.domain.max - xScale.domain.min;
        var normalized = (value18 - xScale.domain.min) / domainSpan;
        return xScale.range.min + normalized * rangeSpan;
      };
      var getPlotX = function(idx) {
        var $48 = mod6(idx)(2) === 0;
        if ($48) {
          return 0;
        }
        ;
        return 140 + 20;
      };
      var getPlotY = function(idx) {
        var $49 = idx < 2;
        if ($49) {
          return 0;
        }
        ;
        return 140 + 20;
      };
      var buildPlot = function(idx) {
        return function(dataset) {
          return withChildren(named2(Group2.value)("plot-" + show128(idx))([transform13("translate(" + (show58(getPlotX(idx)) + ("," + (show58(getPlotY(idx)) + ")")))), class_29("anscombe-plot")]))([elem4(Text3.value)([x34(140 / 2), y34(10), textAnchor12("middle"), class_29("plot-title"), textContent14(dataset.name)]), withChildren(named2(Group2.value)("plot-area")([transform13("translate(" + (show58(margin.left) + ("," + (show58(margin.top) + ")"))))]))([withChild(named2(Group2.value)("x-axis")([transform13("translate(0," + (show58(plotHeight) + ")"))]))(renderAxis(axisBottom(xScale))), withChild(named2(Group2.value)("y-axis")([]))(renderAxis(axisLeft(yScale))), joinData2("points-" + show128(idx))("circle")(dataset.data)(function(d18) {
            return elem4(Circle2.value)([cx24(scaleX3(d18.x)), cy24(scaleY3(d18.y)), radius22(3), fill30("steelblue")]);
          })])]);
        };
      };
      var svgWidth = 140 * 2 + 20;
      var svgHeight = 140 * 2 + 20;
      var emptyDataset = {
        name: "Empty",
        data: [],
        stats: {
          meanX: 0,
          meanY: 0,
          varianceX: 0,
          varianceY: 0,
          correlation: 0
        }
      };
      var getDataset = function(idx) {
        return fromMaybe(fromMaybe(emptyDataset)(index(allDatasets)(0)))(index(allDatasets)(idx));
      };
      var tree3 = withChildren(named2(SVG.value)("svg")([width32(svgWidth), height32(svgHeight), viewBox26("0 0 " + (show58(svgWidth) + (" " + show58(svgHeight)))), id_16("anscombes-quartet-svg"), class_29("tree-api-example")]))([buildPlot(0)(getDataset(0)), buildPlot(1)(getDataset(1)), buildPlot(2)(getDataset(2)), buildPlot(3)(getDataset(3))]);
      return bind56(renderTree42(container)(tree3))(function() {
        return liftEffect28(function __do3() {
          log2("=== Anscombe's Quartet ===")();
          log2("")();
          log2("Four datasets with IDENTICAL statistics:")();
          log2("  - Mean X \u2248 9.0")();
          log2("  - Mean Y \u2248 7.5")();
          log2("  - Variance X \u2248 11.0")();
          log2("  - Variance Y \u2248 4.1")();
          log2("  - Correlation \u2248 0.816")();
          log2("")();
          log2("But look at the plots - completely different distributions!")();
          log2("  I: Linear relationship")();
          log2("  II: Curved relationship")();
          log2("  III: Linear with outlier")();
          log2("  IV: Vertical line with outlier")();
          log2("")();
          log2("THIS IS WHY VISUALIZATION MATTERS.")();
          log2("Summary statistics alone don't tell the story.")();
          return log2("")();
        });
      });
    }));
  };

  // output/D3.Viz.TreeAPI.ParabolaNoAxes/index.js
  var bind57 = /* @__PURE__ */ bind(bindD3v2M);
  var select24 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var width33 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height33 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox27 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var show59 = /* @__PURE__ */ show(showNumber);
  var id_17 = /* @__PURE__ */ id_(toAttrStringString);
  var class_30 = /* @__PURE__ */ class_2(toAttrStringString);
  var cx25 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy25 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius23 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill31 = /* @__PURE__ */ fill3(toAttrStringString);
  var renderTree43 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(/* @__PURE__ */ ordRecord()(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordNil)()({
    reflectSymbol: function() {
      return "y";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "x";
    }
  })(ordNumber)));
  var liftEffect29 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var lookup29 = /* @__PURE__ */ lookup2(ordString);
  var parabolaData = /* @__PURE__ */ (function() {
    var makePoint = function(i2) {
      var x47 = toNumber(i2);
      var y48 = x47 * x47;
      return {
        x: x47,
        y: y48
      };
    };
    return map(functorArray)(makePoint)(range2(0)(9));
  })();
  var parabolaNoAxes = function(selector) {
    return runD3v2M(bind57(select24(selector))(function(container) {
      var plotHeight = 200 - 2 * 30;
      var plotWidth = 400 - 2 * 30;
      var scaleX3 = function(x47) {
        return 30 + x47 / 9 * plotWidth;
      };
      var scaleY3 = function(y48) {
        return 200 - 30 - y48 / 81 * plotHeight;
      };
      var tree3 = withChild(named2(SVG.value)("svg")([width33(400), height33(200), viewBox27("0 0 " + (show59(400) + (" " + show59(200)))), id_17("parabola-no-axes-svg"), class_30("tree-api-example")]))(joinData2("circles")("circle")(parabolaData)(function(d18) {
        return elem4(Circle2.value)([cx25(scaleX3(d18.x)), cy25(scaleY3(d18.y)), radius23(5), fill31("green")]);
      }));
      return bind57(renderTree43(container)(tree3))(function(selections) {
        return liftEffect29(function __do3() {
          log2("=== Parabola (No Axes) ===")();
          log2("")();
          log2("Data: 10 points where y = x\xB2")();
          log2("Result: 10 circles forming a parabola")();
          log2("")();
          (function() {
            var v = lookup29("circles")(selections);
            if (v instanceof Just) {
              return log2("\u2713 Circles positioned by data (y = x\xB2)")();
            }
            ;
            if (v instanceof Nothing) {
              return log2("\u2717 Missing circles")();
            }
            ;
            throw new Error("Failed pattern match at D3.Viz.TreeAPI.ParabolaNoAxes (line 90, column 5 - line 92, column 49): " + [v.constructor.name]);
          })();
          log2("")();
          log2("The key concept: Position is a function of the data.")();
          log2("Each point (x, y) where y = x\xB2 gets mapped to a circle.")();
          log2("We can see the mathematical relationship visually!")();
          return log2("")();
        });
      });
    }));
  };

  // output/D3.Viz.TreeAPI.ParabolaWithAxes/index.js
  var bind58 = /* @__PURE__ */ bind(bindD3v2M);
  var select25 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var width34 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height34 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox28 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var show60 = /* @__PURE__ */ show(showNumber);
  var id_18 = /* @__PURE__ */ id_(toAttrStringString);
  var class_31 = /* @__PURE__ */ class_2(toAttrStringString);
  var transform14 = /* @__PURE__ */ transform2(toAttrStringString);
  var cx26 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy26 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius24 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill32 = /* @__PURE__ */ fill3(toAttrStringString);
  var renderTree44 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(/* @__PURE__ */ ordRecord()(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordNil)()({
    reflectSymbol: function() {
      return "y";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "x";
    }
  })(ordNumber)));
  var liftEffect30 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var lookup30 = /* @__PURE__ */ lookup2(ordString);
  var parabolaData2 = /* @__PURE__ */ (function() {
    var makePoint = function(i2) {
      var x47 = toNumber(i2);
      var y48 = x47 * x47;
      return {
        x: x47,
        y: y48
      };
    };
    return map(functorArray)(makePoint)(range2(0)(9));
  })();
  var parabolaWithAxes = function(selector) {
    return runD3v2M(bind58(select25(selector))(function(container) {
      var margin = {
        top: 20,
        right: 20,
        bottom: 50,
        left: 60
      };
      var plotHeight = 200 - margin.top - margin.bottom;
      var yScale = {
        domain: {
          min: 0,
          max: 81
        },
        range: {
          min: plotHeight,
          max: 0
        }
      };
      var scaleY3 = function(value18) {
        var rangeSpan = yScale.range.max - yScale.range.min;
        var domainSpan = yScale.domain.max - yScale.domain.min;
        var normalized = (value18 - yScale.domain.min) / domainSpan;
        return yScale.range.min + normalized * rangeSpan;
      };
      var plotWidth = 400 - margin.left - margin.right;
      var xScale = {
        domain: {
          min: 0,
          max: 9
        },
        range: {
          min: 0,
          max: plotWidth
        }
      };
      var scaleX3 = function(value18) {
        var rangeSpan = xScale.range.max - xScale.range.min;
        var domainSpan = xScale.domain.max - xScale.domain.min;
        var normalized = (value18 - xScale.domain.min) / domainSpan;
        return xScale.range.min + normalized * rangeSpan;
      };
      var tree3 = withChild(named2(SVG.value)("svg")([width34(400), height34(200), viewBox28("0 0 " + (show60(400) + (" " + show60(200)))), id_18("parabola-with-axes-svg"), class_31("tree-api-example")]))(withChildren(named2(Group2.value)("plot-area")([transform14("translate(" + (show60(margin.left) + ("," + (show60(margin.top) + ")")))), class_31("plot-area")]))([withChild(named2(Group2.value)("x-axis")([transform14("translate(0," + (show60(plotHeight) + ")")), class_31("x-axis")]))(renderAxis(axisBottom(xScale))), withChild(named2(Group2.value)("y-axis")([class_31("y-axis")]))(renderAxis(axisLeft(yScale))), joinData2("circles")("circle")(parabolaData2)(function(d18) {
        return elem4(Circle2.value)([cx26(scaleX3(d18.x)), cy26(scaleY3(d18.y)), radius24(5), fill32("green")]);
      })]));
      return bind58(renderTree44(container)(tree3))(function(selections) {
        return liftEffect30(function __do3() {
          log2("=== Parabola (With Axes) ===")();
          log2("")();
          log2("Data: 10 points where y = x\xB2")();
          log2("Result: Parabola with labeled axes")();
          log2("")();
          (function() {
            var v = lookup30("circles")(selections);
            if (v instanceof Just) {
              return log2("\u2713 Circles positioned using scales")();
            }
            ;
            if (v instanceof Nothing) {
              return log2("\u2717 Missing circles")();
            }
            ;
            throw new Error("Failed pattern match at D3.Viz.TreeAPI.ParabolaWithAxes (line 119, column 5 - line 121, column 49): " + [v.constructor.name]);
          })();
          log2("")();
          log2("Key concepts introduced:")();
          log2("  - SCALES: Map data values to pixel positions")();
          log2("  - AXES: Visual reference showing the scale")();
          log2("")();
          log2("The x-axis shows values 0-9, y-axis shows 0-81.")();
          log2("Now we can see exactly what the data values are!")();
          return log2("")();
        });
      });
    }));
  };

  // output/D3.Viz.TreeAPI.ThreeLittleCirclesColored/index.js
  var bind59 = /* @__PURE__ */ bind(bindD3v2M);
  var select26 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var width35 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height35 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox29 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var id_19 = /* @__PURE__ */ id_(toAttrStringString);
  var class_32 = /* @__PURE__ */ class_2(toAttrStringString);
  var cx27 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy27 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius25 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill33 = /* @__PURE__ */ fill3(toAttrStringString);
  var renderTree45 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(/* @__PURE__ */ ordRecord()(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordNil)()({
    reflectSymbol: function() {
      return "index";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "color";
    }
  })(ordString)));
  var liftEffect31 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var lookup31 = /* @__PURE__ */ lookup2(ordString);
  var colorData = [{
    color: "red",
    index: 0
  }, {
    color: "green",
    index: 1
  }, {
    color: "blue",
    index: 2
  }];
  var threeLittleCirclesColored = function(selector) {
    return runD3v2M(bind59(select26(selector))(function(container) {
      var tree3 = withChild(named2(SVG.value)("svg")([width35(400), height35(100), viewBox29("0 0 400 100"), id_19("three-circles-colored-svg"), class_32("tree-api-example")]))(joinData2("circles")("circle")(colorData)(function(d18) {
        return elem4(Circle2.value)([cx27(100 + d18.index * 100), cy27(50), radius25(25), fill33(d18.color)]);
      }));
      return bind59(renderTree45(container)(tree3))(function(selections) {
        return liftEffect31(function __do3() {
          log2("=== Three Colored Circles ===")();
          log2("")();
          log2("Data: ['red', 'green', 'blue']")();
          log2("Result: 3 circles, each with its data-driven color")();
          log2("")();
          (function() {
            var v = lookup31("circles")(selections);
            if (v instanceof Just) {
              return log2("\u2713 Circles created with data-driven colors")();
            }
            ;
            if (v instanceof Nothing) {
              return log2("\u2717 Missing circles")();
            }
            ;
            throw new Error("Failed pattern match at D3.Viz.TreeAPI.ThreeLittleCirclesColored (line 71, column 5 - line 73, column 49): " + [v.constructor.name]);
          })();
          log2("")();
          log2("The key concept: Attributes can be FUNCTIONS of the data.")();
          log2("Here, fill d.color means each circle gets its color from its datum.")();
          log2("This is the foundation of data visualization: visual encoding of data.")();
          return log2("")();
        });
      });
    }));
  };

  // output/D3.Viz.TreeAPI.ThreeLittleCirclesGreen/index.js
  var bind60 = /* @__PURE__ */ bind(bindD3v2M);
  var select27 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var width36 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height36 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox30 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var id_20 = /* @__PURE__ */ id_(toAttrStringString);
  var class_33 = /* @__PURE__ */ class_2(toAttrStringString);
  var cx28 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy28 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius26 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill34 = /* @__PURE__ */ fill3(toAttrStringString);
  var renderTree46 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(/* @__PURE__ */ ordRecord()(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordNil)()({
    reflectSymbol: function() {
      return "label";
    }
  })(ordString))()({
    reflectSymbol: function() {
      return "index";
    }
  })(ordNumber)));
  var liftEffect32 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var lookup32 = /* @__PURE__ */ lookup2(ordString);
  var simpleData = [{
    label: "a",
    index: 0
  }, {
    label: "b",
    index: 1
  }, {
    label: "c",
    index: 2
  }];
  var threeLittleCirclesGreen = function(selector) {
    return runD3v2M(bind60(select27(selector))(function(container) {
      var tree3 = withChild(named2(SVG.value)("svg")([width36(400), height36(100), viewBox30("0 0 400 100"), id_20("three-circles-green-svg"), class_33("tree-api-example")]))(joinData2("circles")("circle")(simpleData)(function(d18) {
        return elem4(Circle2.value)([cx28(100 + d18.index * 100), cy28(50), radius26(25), fill34("green")]);
      }));
      return bind60(renderTree46(container)(tree3))(function(selections) {
        return liftEffect32(function __do3() {
          log2("=== Three Little Circles (Green) ===")();
          log2("")();
          log2("Data: ['a', 'b', 'c']")();
          log2("Result: 3 green circles")();
          log2("")();
          (function() {
            var v = lookup32("circles")(selections);
            if (v instanceof Just) {
              return log2("\u2713 Circles created via data join")();
            }
            ;
            if (v instanceof Nothing) {
              return log2("\u2717 Missing circles")();
            }
            ;
            throw new Error("Failed pattern match at D3.Viz.TreeAPI.ThreeLittleCirclesGreen (line 70, column 5 - line 72, column 49): " + [v.constructor.name]);
          })();
          log2("")();
          log2("The key concept: one circle per datum, positioned by index.")();
          log2("The datum content ('a', 'b', 'c') doesn't matter here -")();
          log2("what matters is that we have THREE pieces of data.")();
          return log2("")();
        });
      });
    }));
  };

  // output/Component.Tour.TourFoundations/index.js
  var show61 = /* @__PURE__ */ show(showNumber);
  var map60 = /* @__PURE__ */ map(functorArray);
  var discard48 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var pure58 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize28 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var renderDatasetTable = function(name16) {
    return function(points) {
      var renderRow = function(p2) {
        return tr_([td_([text2(show61(p2.x))]), td_([text2(show61(p2.y))])]);
      };
      return div2([classes(["dataset-table-container"])])([h4([classes(["dataset-table-title"])])([text2("Dataset " + name16)]), table([classes(["dataset-table"])])([thead_([tr_([th_([text2("x")]), th_([text2("y")])])]), tbody_(map60(renderRow)(points))])]);
    };
  };
  var handleAction27 = function(dictMonadAff) {
    var liftEffect51 = liftEffect(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    return function(v) {
      return discard48(liftEffect51(threeLittleCirclesGreen("#three-circles-green-viz")))(function() {
        return discard48(liftEffect51(threeLittleCirclesColored("#three-circles-colored-viz")))(function() {
          return discard48(liftEffect51(parabolaNoAxes("#parabola-no-axes-viz")))(function() {
            return discard48(liftEffect51(parabolaWithAxes("#parabola-with-axes-viz")))(function() {
              return discard48(liftEffect51(anscombesQuartet("#anscombes-quartet-viz")))(function() {
                return pure58(unit);
              });
            });
          });
        });
      });
    };
  };
  var datasetD = [{
    x: 8,
    y: 6.58
  }, {
    x: 8,
    y: 5.76
  }, {
    x: 8,
    y: 7.71
  }, {
    x: 8,
    y: 8.84
  }, {
    x: 8,
    y: 8.47
  }, {
    x: 8,
    y: 7.04
  }, {
    x: 8,
    y: 5.25
  }, {
    x: 19,
    y: 12.5
  }, {
    x: 8,
    y: 5.56
  }, {
    x: 8,
    y: 7.91
  }, {
    x: 8,
    y: 6.89
  }];
  var datasetC = [{
    x: 10,
    y: 7.46
  }, {
    x: 8,
    y: 6.77
  }, {
    x: 13,
    y: 12.74
  }, {
    x: 9,
    y: 7.11
  }, {
    x: 11,
    y: 7.81
  }, {
    x: 14,
    y: 8.84
  }, {
    x: 6,
    y: 6.08
  }, {
    x: 4,
    y: 5.39
  }, {
    x: 12,
    y: 8.15
  }, {
    x: 7,
    y: 6.42
  }, {
    x: 5,
    y: 5.73
  }];
  var datasetB = [{
    x: 10,
    y: 9.14
  }, {
    x: 8,
    y: 8.14
  }, {
    x: 13,
    y: 8.74
  }, {
    x: 9,
    y: 8.77
  }, {
    x: 11,
    y: 9.26
  }, {
    x: 14,
    y: 8.1
  }, {
    x: 6,
    y: 6.13
  }, {
    x: 4,
    y: 3.1
  }, {
    x: 12,
    y: 9.13
  }, {
    x: 7,
    y: 7.26
  }, {
    x: 5,
    y: 4.74
  }];
  var datasetA = [{
    x: 10,
    y: 8.04
  }, {
    x: 8,
    y: 6.95
  }, {
    x: 13,
    y: 7.58
  }, {
    x: 9,
    y: 8.81
  }, {
    x: 11,
    y: 8.33
  }, {
    x: 14,
    y: 9.96
  }, {
    x: 6,
    y: 7.24
  }, {
    x: 4,
    y: 4.26
  }, {
    x: 12,
    y: 10.84
  }, {
    x: 7,
    y: 4.82
  }, {
    x: 5,
    y: 5.68
  }];
  var render32 = function(v) {
    return div2([classes(["tutorial-page"])])([renderHeader2(TourFoundations.value), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("1. Foundations: Data to Visualization")]), p_([text2("The fundamental principle of data visualization is simple: start with data, create visual elements from that data. This page shows the progression from the most trivial example (three pieces of data \u2192 three circles) to a classic demonstration of why visualization matters (Anscombe's Quartet).")]), p_([text2("Each step adds one concept, building your understanding incrementally. If you're familiar with D3.js, the TreeAPI will feel natural but with type safety and composability.")])]), section([classes(["tutorial-section"]), id3("three-circles-green")])([h2([classes(["tutorial-section-title"])])([text2("1. Three Little Circles")]), p_([text2("The most minimal example: three pieces of data ['a', 'b', 'c'] \u2192 three green circles. The data doesn't need to be numbers - it can be anything. We just create one circle for each datum and use the index to position them horizontally.")]), div2([classes(["tutorial-viz-container"])])([div2([id3("three-circles-green-viz"), classes(["three-circles-green-viz"])])([])]), p([classes(["code-highlight"])])([text2("Key: "), code_([text2('joinData "circles" "circle" ["a", "b", "c"] $ \\d -> ...')])])]), section([classes(["tutorial-section"]), id3("three-circles-colored")])([h2([classes(["tutorial-section-title"])])([text2("2. Three Colored Circles")]), p_([text2("Same structure, different data: ['red', 'green', 'blue'] \u2192 three circles, each colored by its datum. This shows how attributes can be functions of the data - the fill color comes directly from the datum itself.")]), div2([classes(["tutorial-viz-container"])])([div2([id3("three-circles-colored-viz"), classes(["three-circles-colored-viz"])])([])]), p([classes(["code-highlight"])])([text2("Key: "), code_([text2("fill d.color")]), text2(" \u2014 attribute comes from datum")])]), section([classes(["tutorial-section"]), id3("parabola-no-axes")])([h2([classes(["tutorial-section-title"])])([text2("3. Data-Driven Positioning: Parabola")]), p_([text2("Ten circles forming a parabola. Now the y-position comes from the datum itself - we compute y = x\xB2 for each point. Still just green circles, but positioned by a mathematical relationship in the data.")]), div2([classes(["tutorial-viz-container"])])([div2([id3("parabola-no-axes-viz"), classes(["parabola-no-axes-viz"])])([])]), p([classes(["code-highlight"])])([text2("Key: "), code_([text2("let y = x * x")]), text2(" then "), code_([text2("cy (scaleY y)")])])]), section([classes(["tutorial-section"]), id3("parabola-with-axes")])([h2([classes(["tutorial-section-title"])])([text2("4. Adding Context: Axes and Scales")]), p_([text2("Same parabola, but now with axes to show the actual values. This introduces scales (mapping data space to pixel space) and axes (visual representation of those scales). These are fundamental tools for any real visualization.")]), div2([classes(["tutorial-viz-container"])])([div2([id3("parabola-with-axes-viz"), classes(["parabola-with-axes-viz"])])([])]), p([classes(["code-highlight"])])([text2("Key: "), code_([text2("axisBottom xScale")]), text2(" and "), code_([text2("axisLeft yScale")])])]), section([classes(["tutorial-section"]), id3("anscombes-quartet")])([h2([classes(["tutorial-section-title"])])([text2("5. Why Visualization Matters: Anscombe's Quartet")]), p_([text2("Four datasets with identical statistical properties (mean, variance, correlation) but completely different distributions. This is the classic demonstration of why you need to visualize data - summary statistics alone can be misleading.")]), p_([text2("The table shows how all four datasets have nearly identical statistics:")]), table([classes(["stats-table"])])([thead_([tr_([th_([text2("Dataset")]), th_([text2("Mean X")]), th_([text2("Mean Y")]), th_([text2("Var X")]), th_([text2("Var Y")]), th_([text2("Correlation")])])]), tbody_([tr_([td_([strong_([text2("A")])]), td_([text2("9.0")]), td_([text2("7.5")]), td_([text2("11.0")]), td_([text2("4.1")]), td_([text2("0.82")])]), tr_([td_([strong_([text2("B")])]), td_([text2("9.0")]), td_([text2("7.5")]), td_([text2("11.0")]), td_([text2("4.1")]), td_([text2("0.82")])]), tr_([td_([strong_([text2("C")])]), td_([text2("9.0")]), td_([text2("7.5")]), td_([text2("11.0")]), td_([text2("4.1")]), td_([text2("0.82")])]), tr_([td_([strong_([text2("D")])]), td_([text2("9.0")]), td_([text2("7.5")]), td_([text2("11.0")]), td_([text2("4.1")]), td_([text2("0.82")])])])]), p_([text2("Yet when visualized, the patterns are completely different: linear relationship (A), curved relationship (B), linear with outlier (C), and vertical line with outlier (D).")]), p_([text2("Here are the complete datasets - notice how different the patterns are when you see all the points:")]), div2([classes(["anscombe-data-tables"])])([renderDatasetTable("A")(datasetA), renderDatasetTable("B")(datasetB), renderDatasetTable("C")(datasetC), renderDatasetTable("D")(datasetD)]), div2([classes(["tutorial-viz-container"])])([div2([id3("anscombes-quartet-viz"), classes(["anscombes-quartet-viz"])])([])]), p_([text2("This example demonstrates why data visualization exists: numbers alone don't tell the story. You need to see the data to understand it.")])])])]);
  };
  var component28 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render32,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction27(dictMonadAff),
        initialize: new Just(Initialize28.value)
      })
    });
  };

  // output/Data.Graph.Algorithms/index.js
  var mapFlipped13 = /* @__PURE__ */ mapFlipped(functorArray);
  var toUnfoldable8 = /* @__PURE__ */ toUnfoldable4(unfoldableArray);
  var unions3 = /* @__PURE__ */ unions(foldableArray);
  var map61 = /* @__PURE__ */ map(functorArray);
  var toUnfoldable12 = /* @__PURE__ */ toUnfoldable3(unfoldableArray);
  var fromFoldable114 = /* @__PURE__ */ fromFoldable2(foldableArray);
  var maximum8 = /* @__PURE__ */ maximum(ordInt)(foldableArray);
  var toUnfoldable22 = /* @__PURE__ */ toUnfoldable2(unfoldableArray);
  var reachableFrom = function(dictOrd) {
    var unions1 = unions3(dictOrd);
    var lookup40 = lookup2(dictOrd);
    var difference5 = difference3(dictOrd);
    var union6 = union3(dictOrd);
    return function(start13) {
      return function(graph) {
        var go2 = function($copy_visited) {
          return function($copy_frontier) {
            var $tco_var_visited = $copy_visited;
            var $tco_done = false;
            var $tco_result;
            function $tco_loop(visited, frontier) {
              if (isEmpty2(frontier)) {
                $tco_done = true;
                return visited;
              }
              ;
              if (otherwise) {
                var neighbors = unions1(catMaybes(mapFlipped13(toUnfoldable8(frontier))(function(n) {
                  return lookup40(n)(graph.edges);
                })));
                var newNodes = difference5(neighbors)(visited);
                $tco_var_visited = union6(visited)(frontier);
                $copy_frontier = newNodes;
                return;
              }
              ;
              throw new Error("Failed pattern match at Data.Graph.Algorithms (line 41, column 5 - line 41, column 43): " + [visited.constructor.name, frontier.constructor.name]);
            }
            ;
            while (!$tco_done) {
              $tco_result = $tco_loop($tco_var_visited, $copy_frontier);
            }
            ;
            return $tco_result;
          };
        };
        return go2(empty8)(singleton10(start13));
      };
    };
  };
  var transitiveReduction = function(dictOrd) {
    var $$delete9 = $$delete4(dictOrd);
    var lookup40 = lookup2(dictOrd);
    var member10 = member2(dictOrd);
    var reachableFrom1 = reachableFrom(dictOrd);
    var filter7 = filter4(dictOrd);
    var fromFoldable211 = fromFoldable6(dictOrd)(foldableArray);
    return function(graph) {
      var isTransitive = function(source2) {
        return function(target7) {
          var intermediates = $$delete9(target7)(fromMaybe(empty8)(lookup40(source2)(graph.edges)));
          var reachableThroughIntermediate = any2(function(intermediate) {
            return member10(target7)(reachableFrom1(intermediate)(graph));
          })(toUnfoldable8(intermediates));
          return reachableThroughIntermediate;
        };
      };
      var reduceEdge = function(v) {
        return new Tuple(v.value0, filter7((function() {
          var $74 = isTransitive(v.value0);
          return function($75) {
            return !$74($75);
          };
        })())(v.value1));
      };
      return {
        nodes: graph.nodes,
        edges: fromFoldable211(map61(reduceEdge)(toUnfoldable12(graph.edges)))
      };
    };
  };
  var getAllEdges = function(dictOrd) {
    var lookup40 = lookup2(dictOrd);
    return function(graph) {
      return concat(mapFlipped13(graph.nodes)(function(source2) {
        var v = lookup40(source2)(graph.edges);
        if (v instanceof Nothing) {
          return [];
        }
        ;
        if (v instanceof Just) {
          return mapFlipped13(toUnfoldable8(v.value0))(function(target7) {
            return new Tuple(source2, target7);
          });
        }
        ;
        throw new Error("Failed pattern match at Data.Graph.Algorithms (line 177, column 5 - line 180, column 28): " + [v.constructor.name]);
      }));
    };
  };
  var getRemovedEdges = function(dictOrd) {
    var getAllEdges1 = getAllEdges(dictOrd);
    var Eq0 = dictOrd.Eq0();
    var difference5 = difference(eqTuple(Eq0)(Eq0));
    return function(original) {
      return function(reduced) {
        var reducedEdges = getAllEdges1(reduced);
        var originalEdges = getAllEdges1(original);
        return difference5(originalEdges)(reducedEdges);
      };
    };
  };
  var buildGraph = function(dictOrd) {
    var insert16 = insert(dictOrd);
    return function(tasks) {
      var addTask = function(acc) {
        return function(task) {
          return insert16(task.id)(new Tuple(task, fromFoldable114(task.depends)))(acc);
        };
      };
      var graphMap = foldl2(addTask)(empty3)(tasks);
      return fromMap2(graphMap);
    };
  };
  var getTopologicalOrder = function(dictOrd) {
    var buildGraph1 = buildGraph(dictOrd);
    var topologicalSort2 = topologicalSort(dictOrd);
    return function(tasks) {
      var graph = buildGraph1(tasks);
      return topologicalSort2(graph);
    };
  };
  var computeLayers = function(dictOrd) {
    var fromFoldable211 = fromFoldable6(dictOrd)(foldableArray);
    var getTopologicalOrder1 = getTopologicalOrder(dictOrd);
    var lookup40 = lookup2(dictOrd);
    var insert16 = insert(dictOrd);
    return function(tasks) {
      var taskMap = fromFoldable211(mapFlipped13(tasks)(function(t) {
        return new Tuple(t.id, t);
      }));
      var sortedIds = reverse2(getTopologicalOrder1(tasks));
      var processTask = function(accLayers) {
        return function(taskId) {
          var v = lookup40(taskId)(taskMap);
          if (v instanceof Nothing) {
            return accLayers;
          }
          ;
          if (v instanceof Just) {
            var layer = (function() {
              var $70 = $$null(v.value0.depends);
              if ($70) {
                return 0;
              }
              ;
              var depLayers = mapFlipped13(v.value0.depends)(function(depId) {
                return fromMaybe(0)(lookup40(depId)(accLayers));
              });
              var v1 = maximum8(depLayers);
              if (v1 instanceof Just) {
                return v1.value0 + 1 | 0;
              }
              ;
              if (v1 instanceof Nothing) {
                return 0;
              }
              ;
              throw new Error("Failed pattern match at Data.Graph.Algorithms (line 116, column 22 - line 118, column 36): " + [v1.constructor.name]);
            })();
            return insert16(taskId)(layer)(accLayers);
          }
          ;
          throw new Error("Failed pattern match at Data.Graph.Algorithms (line 105, column 7 - line 119, column 47): " + [v.constructor.name]);
        };
      };
      return foldl2(processTask)(empty3)(toUnfoldable22(sortedIds));
    };
  };
  var addLayers = function(dictOrd) {
    var computeLayers1 = computeLayers(dictOrd);
    var lookup40 = lookup2(dictOrd);
    return function(tasks) {
      var layers = computeLayers1(tasks);
      return mapFlipped13(tasks)(function(t) {
        return {
          id: t.id,
          layer: fromMaybe(0)(lookup40(t.id)(layers)),
          depends: t.depends
        };
      });
    };
  };

  // output/D3.Viz.FPFTW.TopologicalSort/index.js
  var cx29 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy29 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius27 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill35 = /* @__PURE__ */ fill3(toAttrStringString);
  var stroke25 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth25 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var class_34 = /* @__PURE__ */ class_2(toAttrStringString);
  var x35 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y35 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var textContent15 = /* @__PURE__ */ textContent(toAttrStringString);
  var textAnchor13 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var bind61 = /* @__PURE__ */ bind(bindMaybe);
  var pure59 = /* @__PURE__ */ pure(applicativeMaybe);
  var x111 = /* @__PURE__ */ x1(toAttrNumberNumber);
  var y111 = /* @__PURE__ */ y1(toAttrNumberNumber);
  var x212 = /* @__PURE__ */ x22(toAttrNumberNumber);
  var y212 = /* @__PURE__ */ y22(toAttrNumberNumber);
  var mapFlipped14 = /* @__PURE__ */ mapFlipped(functorArray);
  var fromFoldable46 = /* @__PURE__ */ fromFoldable6(ordString)(foldableArray);
  var addLayers2 = /* @__PURE__ */ addLayers(ordString);
  var lookup33 = /* @__PURE__ */ lookup2(ordString);
  var bind118 = /* @__PURE__ */ bind(bindD3v2M);
  var select28 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var maximum9 = /* @__PURE__ */ maximum(ordInt)(foldableArray);
  var show62 = /* @__PURE__ */ show(showInt);
  var width37 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height37 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox31 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var append116 = /* @__PURE__ */ append(semigroupArray);
  var renderTree47 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(ordUnit);
  var pure118 = /* @__PURE__ */ pure(applicativeD3v2M);
  var visualizeTask = function(totalWidth) {
    return function(totalHeight) {
      return function(layerHeight) {
        return function(tasksInLayerCount) {
          return function(indexInLayer) {
            return function(task) {
              var yPos = toNumber(task.layer) * layerHeight + 50;
              var layerWidth = totalWidth - 100;
              var xPos = (function() {
                var $44 = tasksInLayerCount > 1;
                if ($44) {
                  return toNumber(indexInLayer) * layerWidth / toNumber(tasksInLayerCount - 1 | 0) + 50;
                }
                ;
                return totalWidth / 2;
              })();
              return [elem4(Circle2.value)([cx29(xPos), cy29(yPos), radius27(25), fill35("#4CAF50"), stroke25("#2E7D32"), strokeWidth25(2), class_34("task-node")]), elem4(Text3.value)([x35(xPos), y35(yPos + 5), textContent15(task.name), textAnchor13("middle"), fill35("#fff"), class_34("task-label")])];
            };
          };
        };
      };
    };
  };
  var visualizeDependencyLink = function(totalWidth) {
    return function(totalHeight) {
      return function(layerHeight) {
        return function(allTasks) {
          return function(task) {
            return function(depId) {
              return bind61(find2(function(t) {
                return t.id === depId;
              })(allTasks))(function(depTask) {
                var tasksInTargetLayer = filter(function(t) {
                  return t.layer === depTask.layer;
                })(allTasks);
                var tasksInSourceLayer = filter(function(t) {
                  return t.layer === task.layer;
                })(allTasks);
                var targetY = toNumber(depTask.layer) * layerHeight + 50;
                var targetIndex = fromMaybe(0)(findIndex(function(t) {
                  return t.id === depTask.id;
                })(tasksInTargetLayer));
                var targetCount = length(tasksInTargetLayer);
                var sourceY = toNumber(task.layer) * layerHeight + 50;
                var sourceIndex = fromMaybe(0)(findIndex(function(t) {
                  return t.id === task.id;
                })(tasksInSourceLayer));
                var sourceCount = length(tasksInSourceLayer);
                var layerWidth = totalWidth - 100;
                var sourceX = (function() {
                  var $45 = sourceCount > 1;
                  if ($45) {
                    return toNumber(sourceIndex) * layerWidth / toNumber(sourceCount - 1 | 0) + 50;
                  }
                  ;
                  return totalWidth / 2;
                })();
                var targetX = (function() {
                  var $46 = targetCount > 1;
                  if ($46) {
                    return toNumber(targetIndex) * layerWidth / toNumber(targetCount - 1 | 0) + 50;
                  }
                  ;
                  return totalWidth / 2;
                })();
                return pure59(elem4(Line2.value)([x111(targetX), y111(targetY), x212(sourceX), y212(sourceY), stroke25("#bbb"), strokeWidth25(2), class_34("dependency-link")]));
              });
            };
          };
        };
      };
    };
  };
  var buildPipelineTasks = [{
    id: "clone",
    name: "Clone Repo",
    depends: []
  }, {
    id: "install",
    name: "Install Deps",
    depends: ["clone"]
  }, {
    id: "lint",
    name: "Lint",
    depends: ["install"]
  }, {
    id: "test",
    name: "Test",
    depends: ["install"]
  }, {
    id: "build",
    name: "Build",
    depends: ["lint", "test"]
  }, {
    id: "docker",
    name: "Docker Image",
    depends: ["build"]
  }, {
    id: "deploy",
    name: "Deploy",
    depends: ["docker"]
  }];
  var addLayersWithNames = function(tasks) {
    var taskNodes = mapFlipped14(tasks)(function(t) {
      return {
        id: t.id,
        depends: t.depends
      };
    });
    var nameMap = fromFoldable46(mapFlipped14(tasks)(function(t) {
      return new Tuple(t.id, t.name);
    }));
    var layered = addLayers2(taskNodes);
    return mapFlipped14(layered)(function(l) {
      return {
        id: l.id,
        name: fromMaybe(l.id)(lookup33(l.id)(nameMap)),
        layer: l.layer,
        depends: l.depends
      };
    });
  };
  var drawTopologicalSort = function(containerSelector) {
    return runD3v2M(bind118(select28(containerSelector))(function(container) {
      var layeredTasks = addLayersWithNames(buildPipelineTasks);
      var layerValues = mapFlipped14(layeredTasks)(function(v) {
        return v.layer;
      });
      var maxLayer = fromMaybe(0)(maximum9(layerValues));
      var layerHeight = (function() {
        var $47 = maxLayer > 0;
        if ($47) {
          return (500 - 100) / toNumber(maxLayer);
        }
        ;
        return 100;
      })();
      var layerLabels = mapFlipped14(range2(0)(maxLayer))(function(layer) {
        return elem4(Text3.value)([x35(20), y35(toNumber(layer) * layerHeight + 55), textContent15("L" + show62(layer)), textAnchor13("start"), fill35("#666"), class_34("layer-label")]);
      });
      var allNodes3 = concat(mapFlipped14(range2(0)(maxLayer))(function(layer) {
        var tasksInLayer = filter(function(t) {
          return t.layer === layer;
        })(layeredTasks);
        var count = length(tasksInLayer);
        return concat(mapWithIndex2(function(idx) {
          return function(task) {
            return visualizeTask(800)(500)(layerHeight)(count)(idx)(task);
          };
        })(tasksInLayer));
      }));
      var allLinks = concat(mapFlipped14(layeredTasks)(function(task) {
        return catMaybes(mapFlipped14(task.depends)(function(depId) {
          return visualizeDependencyLink(800)(500)(layerHeight)(layeredTasks)(task)(depId);
        }));
      }));
      var vizTree = withChildren(named2(SVG.value)("svg")([width37(800), height37(500), viewBox31("0 0 800 500"), class_34("topological-sort")]))(append116(allLinks)(append116(allNodes3)(layerLabels)));
      return bind118(renderTree47(container)(vizTree))(function() {
        return pure118(unit);
      });
    }));
  };

  // output/D3.Viz.FPFTW.TransitiveReduction/index.js
  var fromFoldable47 = /* @__PURE__ */ fromFoldable6(ordString)(foldableArray);
  var fromFoldable115 = /* @__PURE__ */ fromFoldable8(foldableArray)(ordString);
  var x36 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y36 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var textContent16 = /* @__PURE__ */ textContent(toAttrStringString);
  var textAnchor14 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var fill36 = /* @__PURE__ */ fill3(toAttrStringString);
  var class_35 = /* @__PURE__ */ class_2(toAttrStringString);
  var mapFlipped15 = /* @__PURE__ */ mapFlipped(functorArray);
  var cx30 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy30 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius28 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var stroke26 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth26 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var lookup34 = /* @__PURE__ */ lookup2(ordString);
  var getAllEdges2 = /* @__PURE__ */ getAllEdges(ordString);
  var bind62 = /* @__PURE__ */ bind(bindMaybe);
  var elem6 = /* @__PURE__ */ elem2(/* @__PURE__ */ eqTuple(eqString)(eqString));
  var pure60 = /* @__PURE__ */ pure(applicativeMaybe);
  var x112 = /* @__PURE__ */ x1(toAttrNumberNumber);
  var y112 = /* @__PURE__ */ y1(toAttrNumberNumber);
  var x213 = /* @__PURE__ */ x22(toAttrNumberNumber);
  var y213 = /* @__PURE__ */ y22(toAttrNumberNumber);
  var strokeOpacity5 = /* @__PURE__ */ strokeOpacity(toAttrNumberNumber);
  var append117 = /* @__PURE__ */ append(semigroupArray);
  var bind119 = /* @__PURE__ */ bind(bindD3v2M);
  var select29 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var transitiveReduction2 = /* @__PURE__ */ transitiveReduction(ordString);
  var getRemovedEdges2 = /* @__PURE__ */ getRemovedEdges(ordString);
  var width38 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height38 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox32 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var show63 = /* @__PURE__ */ show(showInt);
  var renderTree48 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(ordUnit);
  var pure119 = /* @__PURE__ */ pure(applicativeD3v2M);
  var exampleGraph = /* @__PURE__ */ (function() {
    return {
      nodes: ["A", "B", "C", "D", "E"],
      edges: fromFoldable47([new Tuple("A", fromFoldable115(["B", "C"])), new Tuple("B", fromFoldable115(["D"])), new Tuple("C", fromFoldable115(["D", "E"])), new Tuple("D", fromFoldable115(["E"])), new Tuple("E", empty8)])
    };
  })();
  var exampleGraphWithTransitive = /* @__PURE__ */ (function() {
    return {
      nodes: exampleGraph.nodes,
      edges: fromFoldable47([new Tuple("A", fromFoldable115(["B", "C", "D", "E"])), new Tuple("B", fromFoldable115(["D"])), new Tuple("C", fromFoldable115(["D", "E"])), new Tuple("D", fromFoldable115(["E"])), new Tuple("E", empty8)])
    };
  })();
  var circularLayout = function(centerX) {
    return function(centerY) {
      return function(circleRadius) {
        return function(nodes) {
          var positions = [{
            dx: 0,
            dy: -1
          }, {
            dx: 0.95,
            dy: -0.31
          }, {
            dx: 0.59,
            dy: 0.81
          }, {
            dx: -0.59,
            dy: 0.81
          }, {
            dx: -0.95,
            dy: -0.31
          }];
          return mapWithIndex2(function(i2) {
            return function(node) {
              var v = index(positions)(i2);
              if (v instanceof Just) {
                return {
                  id: node,
                  x: centerX + circleRadius * v.value0.dx,
                  y: centerY + circleRadius * v.value0.dy
                };
              }
              ;
              if (v instanceof Nothing) {
                return {
                  id: node,
                  x: centerX,
                  y: centerY
                };
              }
              ;
              throw new Error("Failed pattern match at D3.Viz.FPFTW.TransitiveReduction (line 76, column 7 - line 86, column 12): " + [v.constructor.name]);
            };
          })(nodes);
        };
      };
    };
  };
  var visualizeGraph = function(title4) {
    return function(graph) {
      return function(centerX) {
        return function(centerY) {
          return function(circleRadius) {
            return function(highlightRemoved) {
              return function(removedEdges) {
                var titleElement = elem4(Text3.value)([x36(centerX), y36(centerY - circleRadius - 30), textContent16(title4), textAnchor14("middle"), fill36("#333"), class_35("graph-title")]);
                var positions = circularLayout(centerX)(centerY)(circleRadius)(graph.nodes);
                var posMap = fromFoldable47(mapFlipped15(positions)(function(p2) {
                  return new Tuple(p2.id, p2);
                }));
                var nodeElements = mapFlipped15(positions)(function(pos) {
                  return withChildren(named2(Group2.value)("node-" + pos.id)([]))([elem4(Circle2.value)([cx30(pos.x), cy30(pos.y), radius28(20), fill36("#4A90E2"), stroke26("#2E5C8A"), strokeWidth26(2), class_35("graph-node")]), elem4(Text3.value)([x36(pos.x), y36(pos.y + 5), textContent16(pos.id), textAnchor14("middle"), fill36("#fff"), class_35("node-label")])]);
                });
                var getPos = function(nodeId) {
                  return lookup34(nodeId)(posMap);
                };
                var allEdges = getAllEdges2(graph);
                var edgeElements = catMaybes(mapFlipped15(allEdges)(function(v) {
                  return bind62(getPos(v.value0))(function(sourcePos) {
                    return bind62(getPos(v.value1))(function(targetPos) {
                      var isRemoved = highlightRemoved && elem6(new Tuple(v.value0, v.value1))(removedEdges);
                      return pure60(elem4(Line2.value)([x112(sourcePos.x), y112(sourcePos.y), x213(targetPos.x), y213(targetPos.y), stroke26((function() {
                        if (isRemoved) {
                          return "#E74C3C";
                        }
                        ;
                        return "#999";
                      })()), strokeWidth26((function() {
                        if (isRemoved) {
                          return 3;
                        }
                        ;
                        return 2;
                      })()), strokeOpacity5((function() {
                        if (isRemoved) {
                          return 0.7;
                        }
                        ;
                        return 1;
                      })()), class_35((function() {
                        if (isRemoved) {
                          return "edge removed-edge";
                        }
                        ;
                        return "edge";
                      })())]));
                    });
                  });
                }));
                return withChildren(named2(Group2.value)("graph-" + title4)([]))(append117([titleElement])(append117(edgeElements)(nodeElements)));
              };
            };
          };
        };
      };
    };
  };
  var drawTransitiveReduction = function(containerSelector) {
    return runD3v2M(bind119(select29(containerSelector))(function(container) {
      var reduced = transitiveReduction2(exampleGraphWithTransitive);
      var removedEdges = getRemovedEdges2(exampleGraphWithTransitive)(reduced);
      var edgeCount = function(original$prime) {
        return length(getAllEdges2(original$prime));
      };
      var vizTree = withChildren(named2(SVG.value)("svg")([width38(1e3), height38(400), viewBox32("0 0 1000 400"), class_35("transitive-reduction")]))([visualizeGraph("Original (" + (show63(edgeCount(exampleGraphWithTransitive)) + " edges)"))(exampleGraphWithTransitive)(250)(200)(120)(true)(removedEdges), visualizeGraph("Reduced (" + (show63(edgeCount(reduced)) + " edges)"))(reduced)(750)(200)(120)(false)([]), elem4(Text3.value)([x36(500), y36(200), textContent16("\u2192"), textAnchor14("middle"), fill36("#666"), class_35("transformation-arrow")])]);
      return bind119(renderTree48(container)(vizTree))(function() {
        return pure119(unit);
      });
    }));
  };

  // output/Component.Tour.TourGraphAlgorithms/index.js
  var discard49 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var pure61 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize29 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var render33 = function(v) {
    return div2([classes(["tutorial-page"])])([renderHeader2(TourGraphAlgorithms.value), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("Graph Algorithms: FP Wizardry")]), p_([text2("Graphs are everywhere in software: dependency trees, build systems, task schedulers, network routing, code analysis. This page demonstrates how "), strong_([text2("pure functional graph algorithms")]), text2(" combined with "), strong_([text2("declarative visualization")]), text2(" create powerful, elegant solutions to real-world problems.")]), p_([text2("We'll explore two classic algorithms that solve practical problems: topological sort (ordering tasks with dependencies) and transitive reduction (removing redundant edges). Both showcase the FP advantage: immutable transformations, pure functions, and easy-to-test logic.")])]), section([classes(["tutorial-section"]), id3("topological-sort-section")])([h2([classes(["tutorial-section-title"])])([text2("1. Topological Sort: Ordering Dependencies")]), p_([text2("Topological sort solves a fundamental problem: "), em_([text2('"In what order should I execute tasks that depend on each other?"')]), text2(" It's used in build systems (compile before link), package managers (install dependencies first), and task schedulers.")]), p_([text2("The algorithm takes a "), strong_([text2("directed acyclic graph (DAG)")]), text2(" and produces a "), strong_([text2("linear ordering")]), text2(" where every task comes after its dependencies. Below is a build pipeline with 7 tasks:")]), div2([id3("topological-sort"), classes(["viz-container"]), style("margin: 20px 0; text-align: center;")])([]), p_([text2("Notice how tasks are arranged in "), strong_([text2("layers")]), text2(" (L0, L1, L2, etc.). Each layer can execute in parallel since tasks in the same layer don't depend on each other. This is exactly what CI/CD systems do!")]), h3_([text2("The FP Win: Pure Graph Transformation")]), p_([text2("The topological sort implementation uses PureScript's "), code_([text2("Data.Graph")]), text2(" library with a purely functional algorithm:")]), pre([classes(["code-block"]), style("background: #f5f5f5; padding: 15px; border-radius: 5px; overflow-x: auto;")])([code_([text2("-- Build a Graph from tasks\nbuildTaskGraph :: Array Task -> Graph String Task\nbuildTaskGraph tasks = fromMap graphMap\n  where\n    graphMap = foldl addTask Map.empty tasks\n    addTask acc task =\n      Map.insert task.id\n        (Tuple task (List.fromFoldable task.depends))\n        acc\n\n-- Pure topological sort (from Data.Graph)\ngetTopologicalOrder :: Array Task -> List String\ngetTopologicalOrder tasks =\n  topologicalSort (buildTaskGraph tasks)\n\n-- Compute layers: tasks with no deps at layer 0,\n-- tasks depending on layer 0 at layer 1, etc.\ncomputeLayers :: Array Task -> Map String Int\ncomputeLayers tasks = foldl processTask Map.empty sortedIds\n  where\n    sortedIds = List.reverse $ getTopologicalOrder tasks")])]), p_([text2("Key advantages:")]), ul_([li_([strong_([text2("Immutable: ")]), text2("Graph transformations return new graphs, never mutate")]), li_([strong_([text2("Pure: ")]), text2("Same input always produces same output, easy to test")]), li_([strong_([text2("Composable: ")]), text2("Topological sort \u2192 layer computation \u2192 visualization pipeline")]), li_([strong_([text2("Type-safe: ")]), text2("Compiler ensures graph structure is valid")])])]), section([classes(["tutorial-section"]), id3("transitive-reduction-section")])([h2([classes(["tutorial-section-title"])])([text2("2. Transitive Reduction: Removing Redundant Edges")]), p_([text2("Transitive reduction solves another practical problem: "), em_([text2('"Which dependencies are redundant?"')]), text2(" In dependency graphs, some edges are "), strong_([text2("implied by transitivity")]), text2(". For example, if A depends on B, and B depends on C, then we don't need to explicitly state that A depends on C.")]), p_([text2("Removing transitive edges simplifies graphs, making them easier to understand and maintain. This is crucial for build systems, package managers, and code dependency analysis.")]), div2([id3("transitive-reduction"), classes(["viz-container"]), style("margin: 20px 0; text-align: center;")])([]), p_([text2("The visualization shows "), strong_([text2("before and after")]), text2(". Redundant edges are highlighted in "), span2([style("color: #E74C3C;")])([text2("red")]), text2(" on the left, and removed on the right. Notice how the reduced graph preserves all reachability (A can still reach E through C \u2192 E) but with fewer explicit edges.")]), h3_([text2("The Algorithm: Reachability Analysis")]), p_([text2("The transitive reduction algorithm checks each edge: if the target is reachable through an "), em_([text2("alternate path")]), text2(", the edge is redundant:")]), pre([classes(["code-block"]), style("background: #f5f5f5; padding: 15px; border-radius: 5px; overflow-x: auto;")])([code_([text2("-- Compute all nodes reachable from a given node\nreachableFrom :: String -> Graph -> Set String\nreachableFrom start graph = go Set.empty (Set.singleton start)\n  where\n    go visited frontier\n      | Set.isEmpty frontier = visited\n      | otherwise =\n          let neighbors = getNeighbors frontier\n              newNodes = Set.difference neighbors visited\n          in go (Set.union visited frontier) newNodes\n\n-- Remove transitive edges\ntransitiveReduction :: Graph -> Graph\ntransitiveReduction graph =\n  { nodes: graph.nodes\n  , edges: Map.mapWithKey reduceNode graph.edges\n  }\n  where\n    reduceNode source targets =\n      Set.filter (not <<< isTransitive source) targets\n\n    isTransitive source target =\n      -- Is target reachable through intermediate nodes?\n      let intermediates = Set.delete target targets\n      in Array.any (\\\\i -> Set.member target (reachableFrom i graph))\n           (Set.toUnfoldable intermediates)")])]), p_([text2("Key FP advantages:")]), ul_([li_([strong_([text2("Graph as value: ")]), text2("Original and reduced graphs coexist, easy to compare")]), li_([strong_([text2("Recursive traversal: ")]), text2("Reachability computed via tail-recursive function")]), li_([strong_([text2("Set operations: ")]), text2("Union, difference, membership checks are declarative and clear")]), li_([strong_([text2("Visualization-friendly: ")]), text2("Easy to highlight removed edges for before/after comparison")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Why FP Wins for Graph Algorithms")]), p_([text2("These examples demonstrate fundamental advantages of functional programming for graph algorithms:")]), ul_([li_([strong_([text2("Immutability enables comparison: ")]), text2("We can keep the original graph and the transformed graph, making before/after visualizations trivial.")]), li_([strong_([text2("Purity enables testing: ")]), text2("No hidden state, no side effects. Feed in a graph, get back a result. Test with edge cases, verify correctness.")]), li_([strong_([text2("Composition enables pipelines: ")]), text2("Topological sort \u2192 layer computation \u2192 layout \u2192 visualization. Each step is a pure function.")]), li_([strong_([text2("Types prevent bugs: ")]), text2("The compiler ensures you don't create cycles in a DAG, or reference non-existent nodes.")])]), p_([text2("Real-world applications:")]), ul_([li_([text2("Build systems: Bazel, Buck, Gradle all use topological sort for parallelization")]), li_([text2("Package managers: npm, cargo, pip use dependency resolution with cycle detection")]), li_([text2("Task schedulers: Apache Airflow, Luigi, Prefect order DAG execution")]), li_([text2("Code analysis: Import graphs, call graphs, module dependencies")])]), p_([text2("This is "), strong_([text2("functional programming wizardry")]), text2(": elegant algorithms solving hard problems, with visualization making the solutions immediately obvious.")])])]), footer([classes(["tutorial-footer"])])([p_([text2("Want more FP demonstrations? Check out "), a([href("#" + routeToPath(TourFPFTW.value))])([text2("FP For The Win")]), text2(" for examples with Maps, Sets, and functional patterns.")])])]);
  };
  var handleAction28 = function(dictMonadAff) {
    var liftAff3 = liftAff(monadAffHalogenM(dictMonadAff));
    var liftEffect51 = liftEffect(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    return function(v) {
      return discard49(liftAff3(delay(100)))(function() {
        return discard49(liftEffect51(drawTopologicalSort("#topological-sort")))(function() {
          return discard49(liftEffect51(drawTransitiveReduction("#transitive-reduction")))(function() {
            return pure61(unit);
          });
        });
      });
    };
  };
  var component29 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render33,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction28(dictMonadAff),
        initialize: new Just(Initialize29.value)
      })
    });
  };

  // output/D3.Viz.TreeAPI.ClusterViz/index.js
  var bind63 = /* @__PURE__ */ bind(bindList);
  var append23 = /* @__PURE__ */ append(semigroupList);
  var fromFoldable48 = /* @__PURE__ */ fromFoldable(foldableList);
  var show64 = /* @__PURE__ */ show(showNumber);
  var bind120 = /* @__PURE__ */ bind(bindD3v2M);
  var select30 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var fromFoldable116 = /* @__PURE__ */ fromFoldable(foldableTree);
  var discard50 = /* @__PURE__ */ discard(discardUnit);
  var discard112 = /* @__PURE__ */ discard50(bindD3v2M);
  var liftEffect33 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var show129 = /* @__PURE__ */ show(showInt);
  var width39 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height39 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox33 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var class_36 = /* @__PURE__ */ class_2(toAttrStringString);
  var d12 = /* @__PURE__ */ d4(toAttrStringString);
  var fill37 = /* @__PURE__ */ fill3(toAttrStringString);
  var stroke27 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth27 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var renderTree49 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D);
  var ordRecord8 = /* @__PURE__ */ ordRecord();
  var ordRecordCons7 = /* @__PURE__ */ ordRecordCons(ordRecordNil)();
  var ordRecordCons14 = /* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons7({
    reflectSymbol: function() {
      return "y";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "x";
    }
  })(ordNumber);
  var ordRecord14 = /* @__PURE__ */ ordRecord8(ordRecordCons14);
  var renderTree116 = /* @__PURE__ */ renderTree49(/* @__PURE__ */ ordRecord8(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons7({
    reflectSymbol: function() {
      return "target";
    }
  })(ordRecord14))()({
    reflectSymbol: function() {
      return "source";
    }
  })(ordRecord14)));
  var cx31 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy31 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius29 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var x37 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y37 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var textContent17 = /* @__PURE__ */ textContent(toAttrStringString);
  var fontSize9 = /* @__PURE__ */ fontSize2(toAttrNumberNumber);
  var textAnchor15 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var renderTree214 = /* @__PURE__ */ renderTree49(/* @__PURE__ */ ordRecord8(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordCons14)()({
    reflectSymbol: function() {
      return "value";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "name";
    }
  })(ordString))()({
    reflectSymbol: function() {
      return "height";
    }
  })(ordInt))()({
    reflectSymbol: function() {
      return "depth";
    }
  })(ordInt)));
  var bind213 = /* @__PURE__ */ bind(bindAff);
  var liftEffect111 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var makeLinks5 = function(tree$prime) {
    var makeLinksList = function(v) {
      var grandchildLinks = bind63(v.value1)(makeLinksList);
      var childLinks = bind63(v.value1)(function(v1) {
        return new Cons({
          source: {
            x: v.value0.x,
            y: v.value0.y
          },
          target: {
            x: v1.value0.x,
            y: v1.value0.y
          }
        }, Nil.value);
      });
      return append23(childLinks)(grandchildLinks);
    };
    return fromFoldable48(makeLinksList(tree$prime));
  };
  var linkPath2 = function(x1$prime) {
    return function(y1$prime) {
      return function(x2$prime) {
        return function(y2$prime) {
          var midY = (y1$prime + y2$prime) / 2;
          return "M" + (show64(x1$prime) + ("," + (show64(y1$prime) + (" C" + (show64(x1$prime) + ("," + (show64(midY) + (" " + (show64(x2$prime) + ("," + (show64(midY) + (" " + (show64(x2$prime) + ("," + show64(y2$prime)))))))))))))));
        };
      };
    };
  };
  var drawCluster = function(selector) {
    return function(flareTree) {
      return runD3v2M(bind120(select30(selector))(function(container) {
        var config = {
          minSeparation: defaultClusterConfig.minSeparation,
          size: {
            width: 750 - 2 * 40,
            height: 500 - 2 * 40
          }
        };
        var positioned = cluster(config)(flareTree);
        var nodes = fromFoldable116(positioned);
        var links = makeLinks5(positioned);
        return discard112(liftEffect33(log2("Rendering cluster (dendrogram): " + (show129(length(nodes)) + (" nodes, " + (show129(length(links)) + " links"))))))(function() {
          var linksTree = withChild(named2(SVG.value)("svg")([width39(750), height39(500), viewBox33("0 0 " + (show64(750) + (" " + show64(500)))), class_36("cluster-viz")]))(withChild(named2(Group2.value)("chartGroup")([class_36("tree-content")]))(withChild(named2(Group2.value)("linksGroup")([class_36("links")]))(joinData2("links")("path")(links)(function(link4) {
            return elem4(Path3.value)([d12(linkPath2(link4.source.x + 40)(link4.source.y + 40)(link4.target.x + 40)(link4.target.y + 40)), fill37("none"), stroke27("#999"), strokeWidth27(1.5), class_36("link")]);
          }))));
          return bind120(renderTree116(container)(linksTree))(function(linksSelections) {
            return bind120(liftEffect33(reselectD3v2("chartGroup")(linksSelections)))(function(chartGroupSel) {
              var nodesTree = withChild(named2(Group2.value)("nodesGroup")([class_36("nodes")]))(joinData2("nodeGroups")("g")(nodes)(function(node) {
                return withChildren(named2(Group2.value)("node-" + node.name)([class_36("node")]))([elem4(Circle2.value)([cx31(node.x + 40), cy31(node.y + 40), radius29(4), fill37("#69b3a2"), stroke27("#fff"), strokeWidth27(1.5)]), elem4(Text3.value)([x37(node.x + 40 + 8), y37(node.y + 40 + 4), textContent17(node.name), fontSize9(10), textAnchor15("start")])]);
              }));
              return bind120(renderTree214(chartGroupSel)(nodesTree))(function() {
                return liftEffect33(function __do3() {
                  log2("=== Cluster Layout (Dendrogram, Tree API) ===")();
                  log2("")();
                  log2("Flare visualization toolkit hierarchy (cluster/dendrogram)")();
                  return log2("")();
                });
              });
            });
          });
        });
      }));
    };
  };
  var clusterViz = function(selector) {
    return launchAff_(bind213(loadFlareData)(function(result) {
      if (result instanceof Left) {
        return liftEffect111(log2("Failed to load Flare data: " + result.value0));
      }
      ;
      if (result instanceof Right) {
        return liftEffect111(drawCluster(selector)(result.value0));
      }
      ;
      throw new Error("Failed pattern match at D3.Viz.TreeAPI.ClusterViz (line 154, column 3 - line 156, column 67): " + [result.constructor.name]);
    }));
  };

  // output/D3.Viz.TreeAPI.HorizontalTreeViz/index.js
  var map62 = /* @__PURE__ */ map(functorList);
  var bind64 = /* @__PURE__ */ bind(bindList);
  var append24 = /* @__PURE__ */ append(semigroupList);
  var fromFoldable49 = /* @__PURE__ */ fromFoldable(foldableList);
  var show65 = /* @__PURE__ */ show(showNumber);
  var bind121 = /* @__PURE__ */ bind(bindD3v2M);
  var select31 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var fromFoldable117 = /* @__PURE__ */ fromFoldable(foldableTree);
  var discard51 = /* @__PURE__ */ discard(discardUnit);
  var discard113 = /* @__PURE__ */ discard51(bindD3v2M);
  var liftEffect34 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var show130 = /* @__PURE__ */ show(showInt);
  var width40 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height40 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox34 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var class_37 = /* @__PURE__ */ class_2(toAttrStringString);
  var d13 = /* @__PURE__ */ d4(toAttrStringString);
  var fill38 = /* @__PURE__ */ fill3(toAttrStringString);
  var stroke28 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth28 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var renderTree50 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D);
  var ordRecord9 = /* @__PURE__ */ ordRecord();
  var ordRecordCons8 = /* @__PURE__ */ ordRecordCons(ordRecordNil)();
  var ordRecordCons15 = /* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons8({
    reflectSymbol: function() {
      return "y";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "x";
    }
  })(ordNumber);
  var ordRecord15 = /* @__PURE__ */ ordRecord9(ordRecordCons15);
  var renderTree117 = /* @__PURE__ */ renderTree50(/* @__PURE__ */ ordRecord9(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons8({
    reflectSymbol: function() {
      return "target";
    }
  })(ordRecord15))()({
    reflectSymbol: function() {
      return "source";
    }
  })(ordRecord15)));
  var cx32 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy32 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius30 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var x38 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y38 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var textContent18 = /* @__PURE__ */ textContent(toAttrStringString);
  var fontSize10 = /* @__PURE__ */ fontSize2(toAttrNumberNumber);
  var textAnchor16 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var renderTree215 = /* @__PURE__ */ renderTree50(/* @__PURE__ */ ordRecord9(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordCons15)()({
    reflectSymbol: function() {
      return "value";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "name";
    }
  })(ordString))()({
    reflectSymbol: function() {
      return "height";
    }
  })(ordInt))()({
    reflectSymbol: function() {
      return "depth";
    }
  })(ordInt)));
  var bind214 = /* @__PURE__ */ bind(bindAff);
  var liftEffect112 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var swapXY = function(v) {
    var swappedChildren = map62(swapXY)(v.value1);
    return new Node((function() {
      var $87 = {};
      for (var $88 in v.value0) {
        if ({}.hasOwnProperty.call(v.value0, $88)) {
          $87[$88] = v["value0"][$88];
        }
        ;
      }
      ;
      $87.x = v.value0.y;
      $87.y = v.value0.x;
      return $87;
    })(), swappedChildren);
  };
  var makeLinks6 = function(tree$prime) {
    var makeLinksList = function(v) {
      var grandchildLinks = bind64(v.value1)(makeLinksList);
      var childLinks = bind64(v.value1)(function(v1) {
        return new Cons({
          source: {
            x: v.value0.x,
            y: v.value0.y
          },
          target: {
            x: v1.value0.x,
            y: v1.value0.y
          }
        }, Nil.value);
      });
      return append24(childLinks)(grandchildLinks);
    };
    return fromFoldable49(makeLinksList(tree$prime));
  };
  var linkPath3 = function(x1$prime) {
    return function(y1$prime) {
      return function(x2$prime) {
        return function(y2$prime) {
          return "M" + (show65(x1$prime) + ("," + (show65(y1$prime) + ("C" + (show65((x1$prime + x2$prime) / 2) + ("," + (show65(y1$prime) + (" " + (show65((x1$prime + x2$prime) / 2) + ("," + (show65(y2$prime) + (" " + (show65(x2$prime) + ("," + show65(y2$prime)))))))))))))));
        };
      };
    };
  };
  var drawHorizontalTree = function(selector) {
    return function(flareTree) {
      return runD3v2M(bind121(select31(selector))(function(container) {
        var config = {
          layerScale: defaultTreeConfig.layerScale,
          minSeparation: defaultTreeConfig.minSeparation,
          separation: defaultTreeConfig.separation,
          size: {
            width: 500 - 2 * 40,
            height: 750 - 2 * 40
          }
        };
        var positioned = tree2(config)(flareTree);
        var horizontalTree = swapXY(positioned);
        var nodes = fromFoldable117(horizontalTree);
        var links = makeLinks6(horizontalTree);
        return discard113(liftEffect34(log2("Rendering horizontal tree: " + (show130(length(nodes)) + (" nodes, " + (show130(length(links)) + " links"))))))(function() {
          var linksTree = withChild(named2(SVG.value)("svg")([width40(750), height40(500), viewBox34("0 0 " + (show65(750) + (" " + show65(500)))), class_37("horizontal-tree-viz")]))(withChild(named2(Group2.value)("chartGroup")([class_37("tree-content")]))(withChild(named2(Group2.value)("linksGroup")([class_37("links")]))(joinData2("links")("path")(links)(function(link4) {
            return elem4(Path3.value)([d13(linkPath3(link4.source.x + 40)(link4.source.y + 40)(link4.target.x + 40)(link4.target.y + 40)), fill38("none"), stroke28("#999"), strokeWidth28(1.5), class_37("link")]);
          }))));
          return bind121(renderTree117(container)(linksTree))(function(linksSelections) {
            return bind121(liftEffect34(reselectD3v2("chartGroup")(linksSelections)))(function(chartGroupSel) {
              var nodesTree = withChild(named2(Group2.value)("nodesGroup")([class_37("nodes")]))(joinData2("nodeGroups")("g")(nodes)(function(node) {
                return withChildren(named2(Group2.value)("node-" + node.name)([class_37("node")]))([elem4(Circle2.value)([cx32(node.x + 40), cy32(node.y + 40), radius30(4), fill38("#69b3a2"), stroke28("#fff"), strokeWidth28(1.5)]), elem4(Text3.value)([x38(node.x + 40 + 8), y38(node.y + 40 + 4), textContent18(node.name), fontSize10(10), textAnchor16("start")])]);
              }));
              return bind121(renderTree215(chartGroupSel)(nodesTree))(function() {
                return liftEffect34(function __do3() {
                  log2("=== Horizontal Tree Layout (Tree API) ===")();
                  log2("")();
                  log2("Flare visualization toolkit hierarchy (horizontal)")();
                  return log2("")();
                });
              });
            });
          });
        });
      }));
    };
  };
  var horizontalTreeViz = function(selector) {
    return launchAff_(bind214(loadFlareData)(function(result) {
      if (result instanceof Left) {
        return liftEffect112(log2("Failed to load Flare data: " + result.value0));
      }
      ;
      if (result instanceof Right) {
        return liftEffect112(drawHorizontalTree(selector)(result.value0));
      }
      ;
      throw new Error("Failed pattern match at D3.Viz.TreeAPI.HorizontalTreeViz (line 164, column 3 - line 166, column 74): " + [result.constructor.name]);
    }));
  };

  // output/PSD3.Layout.Hierarchy.Pack/index.js
  var show66 = /* @__PURE__ */ show(showInt);
  var show131 = /* @__PURE__ */ show(showNumber);
  var elemIndex2 = /* @__PURE__ */ elemIndex(eqInt);
  var append118 = /* @__PURE__ */ append(semigroupArray);
  var map63 = /* @__PURE__ */ map(functorArray);
  var min8 = /* @__PURE__ */ min(ordNumber);
  var max9 = /* @__PURE__ */ max(ordNumber);
  var insert10 = /* @__PURE__ */ insert(ordInt);
  var fromFoldable50 = /* @__PURE__ */ fromFoldable6(ordInt)(foldableArray);
  var sortWith3 = /* @__PURE__ */ sortWith(ordNumber);
  var foldl14 = /* @__PURE__ */ foldl(foldableArray);
  var max12 = /* @__PURE__ */ max(ordInt);
  var mod7 = /* @__PURE__ */ mod(euclideanRingInt);
  var compare19 = /* @__PURE__ */ compare(ordInt);
  var compare110 = /* @__PURE__ */ compare(ordNumber);
  var lookup35 = /* @__PURE__ */ lookup2(ordInt);
  var show211 = /* @__PURE__ */ show(/* @__PURE__ */ showArray(showInt));
  var map116 = /* @__PURE__ */ map(functorMaybe);
  var apply5 = /* @__PURE__ */ apply(applyMaybe);
  var bind65 = /* @__PURE__ */ bind(bindMaybe);
  var pure62 = /* @__PURE__ */ pure(applicativeMaybe);
  var minimumBy2 = /* @__PURE__ */ minimumBy(foldableArray);
  var comparing2 = /* @__PURE__ */ comparing(ordNumber);
  var PackNode = /* @__PURE__ */ (function() {
    function PackNode2(value0) {
      this.value0 = value0;
    }
    ;
    PackNode2.create = function(value0) {
      return new PackNode2(value0);
    };
    return PackNode2;
  })();
  var NoCollision = /* @__PURE__ */ (function() {
    function NoCollision2() {
    }
    ;
    NoCollision2.value = new NoCollision2();
    return NoCollision2;
  })();
  var CollisionAt = /* @__PURE__ */ (function() {
    function CollisionAt2(value0) {
      this.value0 = value0;
    }
    ;
    CollisionAt2.create = function(value0) {
      return new CollisionAt2(value0);
    };
    return CollisionAt2;
  })();
  var shortenChainOnly = function(aId) {
    return function(jId) {
      return function(chain) {
        var v = elemIndex2(jId)(chain);
        var v1 = elemIndex2(aId)(chain);
        if (v1 instanceof Just && v instanceof Just) {
          var $140 = v.value0 > v1.value0;
          if ($140) {
            var before = take(v1.value0 + 1 | 0)(chain);
            var after = drop(v.value0)(chain);
            return append118(before)(after);
          }
          ;
          var $141 = v.value0 < v1.value0;
          if ($141) {
            return slice(v.value0)(v1.value0 + 1 | 0)(chain);
          }
          ;
          return chain;
        }
        ;
        return chain;
      };
    };
  };
  var scaleToSize = function(config) {
    return function(v) {
      var scaleNode = function(scale) {
        return function(parentX) {
          return function(parentY) {
            return function(v1) {
              var scaledY = parentY + scale * v1.value0.y;
              var scaledX = parentX + scale * v1.value0.x;
              var scaledR = scale * v1.value0.r;
              return new PackNode({
                data_: v1.value0.data_,
                depth: v1.value0.depth,
                height: v1.value0.height,
                value: v1.value0.value,
                x: scaledX,
                y: scaledY,
                r: scaledR,
                children: map63(scaleNode(scale)(scaledX)(scaledY))(v1.value0.children)
              });
            };
          };
        };
      };
      var k = min8(config.size.width)(config.size.height) / (2 * v.value0.r);
      var scaledRootR = k * v.value0.r;
      var centerY = config.size.height / 2;
      var centerX = config.size.width / 2;
      return new PackNode({
        data_: v.value0.data_,
        depth: v.value0.depth,
        height: v.value0.height,
        value: v.value0.value,
        x: centerX,
        y: centerY,
        r: scaledRootR,
        children: map63(scaleNode(k)(centerX)(centerY))(v.value0.children)
      });
    };
  };
  var place = function(b10) {
    return function(a2) {
      return function(c) {
        var dy4 = b10.y - a2.y;
        var dx = b10.x - a2.x;
        var d22 = dx * dx + dy4 * dy4;
        var $156 = d22 !== 0;
        if ($156) {
          var b22 = (b10.r + c.r) * (b10.r + c.r);
          var a22 = (a2.r + c.r) * (a2.r + c.r);
          var $157 = a22 > b22;
          if ($157) {
            var x47 = (d22 + b22 - a22) / (2 * d22);
            var y48 = sqrt(max9(0)(b22 / d22 - x47 * x47));
            return {
              x: b10.x - x47 * dx - y48 * dy4,
              y: b10.y - x47 * dy4 + y48 * dx,
              r: c.r
            };
          }
          ;
          var x47 = (d22 + a22 - b22) / (2 * d22);
          var y48 = sqrt(max9(0)(a22 / d22 - x47 * x47));
          return {
            x: a2.x + x47 * dx - y48 * dy4,
            y: a2.y + x47 * dy4 + y48 * dx,
            r: c.r
          };
        }
        ;
        return {
          x: a2.x + c.r,
          y: a2.y,
          r: c.r
        };
      };
    };
  };
  var insertInChain = function(aId) {
    return function(_bId) {
      return function(newId2) {
        return function(chain) {
          var v = elemIndex2(aId)(chain);
          if (v instanceof Nothing) {
            return chain;
          }
          ;
          if (v instanceof Just) {
            return fromMaybe(chain)(insertAt(v.value0 + 1 | 0)(newId2)(chain));
          }
          ;
          throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 160, column 3 - line 164, column 62): " + [v.constructor.name]);
        };
      };
    };
  };
  var insertBetween = function(aId) {
    return function(bId) {
      return function(newCircle) {
        return function(state3) {
          var newCircles = insert10(state3.nextId)(newCircle)(state3.circles);
          var newChain = insertInChain(aId)(bId)(state3.nextId)(state3.frontChain);
          return {
            circles: newCircles,
            frontChain: newChain,
            nextId: state3.nextId + 1 | 0
          };
        };
      };
    };
  };
  var initState = function(c0) {
    return function(c1) {
      return function(c2) {
        var c1$prime = {
          r: c1.r,
          x: c0.r,
          y: 0
        };
        var c0$prime = {
          r: c0.r,
          x: -c1.r,
          y: 0
        };
        var c2$prime = place(c1$prime)(c0$prime)(c2);
        var circles = fromFoldable50([new Tuple(0, c0$prime), new Tuple(1, c1$prime), new Tuple(2, c2$prime)]);
        return {
          circles,
          frontChain: [0, 2, 1],
          nextId: 3
        };
      };
    };
  };
  var hierarchy = function(v) {
    var go2 = function(node) {
      return function(depth) {
        if (node.children instanceof Nothing) {
          return new PackNode({
            data_: node.data_,
            depth,
            height: 0,
            value: fromMaybe(0)(node.value),
            children: [],
            x: 0,
            y: 0,
            r: 0
          });
        }
        ;
        if (node.children instanceof Just) {
          var childNodes2 = map63(function(v1) {
            return go2(v1)(depth + 1 | 0);
          })(node.children.value0);
          var sortedChildren = sortWith3(function(v1) {
            return -v1.value0.value;
          })(childNodes2);
          var sumValue = foldl14(function(acc) {
            return function(v1) {
              return acc + v1.value0.value;
            };
          })(0)(sortedChildren);
          var childHeights = map63(function(v1) {
            return v1.value0.height;
          })(sortedChildren);
          var maxChildHeight = foldl14(max12)(0)(childHeights);
          return new PackNode({
            data_: node.data_,
            depth,
            height: maxChildHeight + 1 | 0,
            value: sumValue,
            children: sortedChildren,
            x: 0,
            y: 0,
            r: 0
          });
        }
        ;
        throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 654, column 7 - line 686, column 16): " + [node.children.constructor.name]);
      };
    };
    return go2(v)(0);
  };
  var getNextId = function(nodeId) {
    return function(chain) {
      var v = elemIndex2(nodeId)(chain);
      if (v instanceof Nothing) {
        return Nothing.value;
      }
      ;
      if (v instanceof Just) {
        var nextIdx = mod7(v.value0 + 1 | 0)(length(chain));
        return index(chain)(nextIdx);
      }
      ;
      throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 126, column 3 - line 130, column 35): " + [v.constructor.name]);
    };
  };
  var getChainSegmentFrom = function(startId) {
    return function(chain) {
      var v = elemIndex2(startId)(chain);
      if (v instanceof Nothing) {
        return [];
      }
      ;
      if (v instanceof Just) {
        var before = take(v.value0)(chain);
        var after = drop(v.value0 + 1 | 0)(chain);
        return append118(after)(before);
      }
      ;
      throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 213, column 3 - line 221, column 24): " + [v.constructor.name]);
    };
  };
  var eqPackNode = function(dictEq) {
    var eq27 = eq(dictEq);
    return {
      eq: function(x47) {
        return function(y48) {
          return eq(eqArray(eqPackNode(dictEq)))(x47.value0.children)(y48.value0.children) && eq27(x47.value0.data_)(y48.value0.data_) && x47.value0.depth === y48.value0.depth && x47.value0.height === y48.value0.height && x47.value0.r === y48.value0.r && x47.value0.value === y48.value0.value && x47.value0.x === y48.value0.x && x47.value0.y === y48.value0.y;
        };
      }
    };
  };
  var ordPackNode = function(dictOrd) {
    var compare26 = compare(dictOrd);
    var eqPackNode1 = eqPackNode(dictOrd.Eq0());
    return {
      compare: function(x47) {
        return function(y48) {
          var v = compare(ordArray(ordPackNode(dictOrd)))(x47.value0.children)(y48.value0.children);
          if (v instanceof LT) {
            return LT.value;
          }
          ;
          if (v instanceof GT) {
            return GT.value;
          }
          ;
          var v1 = compare26(x47.value0.data_)(y48.value0.data_);
          if (v1 instanceof LT) {
            return LT.value;
          }
          ;
          if (v1 instanceof GT) {
            return GT.value;
          }
          ;
          var v2 = compare19(x47.value0.depth)(y48.value0.depth);
          if (v2 instanceof LT) {
            return LT.value;
          }
          ;
          if (v2 instanceof GT) {
            return GT.value;
          }
          ;
          var v3 = compare19(x47.value0.height)(y48.value0.height);
          if (v3 instanceof LT) {
            return LT.value;
          }
          ;
          if (v3 instanceof GT) {
            return GT.value;
          }
          ;
          var v4 = compare110(x47.value0.r)(y48.value0.r);
          if (v4 instanceof LT) {
            return LT.value;
          }
          ;
          if (v4 instanceof GT) {
            return GT.value;
          }
          ;
          var v5 = compare110(x47.value0.value)(y48.value0.value);
          if (v5 instanceof LT) {
            return LT.value;
          }
          ;
          if (v5 instanceof GT) {
            return GT.value;
          }
          ;
          var v6 = compare110(x47.value0.x)(y48.value0.x);
          if (v6 instanceof LT) {
            return LT.value;
          }
          ;
          if (v6 instanceof GT) {
            return GT.value;
          }
          ;
          return compare110(x47.value0.y)(y48.value0.y);
        };
      },
      Eq0: function() {
        return eqPackNode1;
      }
    };
  };
  var epsilon6 = 1e-6;
  var intersects = function(a2) {
    return function(b10) {
      var dy4 = b10.y - a2.y;
      var dx = b10.x - a2.x;
      var dr = a2.r + b10.r - epsilon6;
      return dr > 0 && dr * dr > dx * dx + dy4 * dy4;
    };
  };
  var findFirstCollision = function(idsToCheck) {
    return function(newCircle) {
      return function(circles) {
        return findMap(function(id5) {
          var v = lookup35(id5)(circles);
          if (v instanceof Just) {
            var $190 = intersects(v.value0)(newCircle);
            if ($190) {
              return new Just(id5);
            }
            ;
            return Nothing.value;
          }
          ;
          if (v instanceof Nothing) {
            return Nothing.value;
          }
          ;
          throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 227, column 5 - line 232, column 25): " + [v.constructor.name]);
        })(idsToCheck);
      };
    };
  };
  var walkChainForCollision = function(startId) {
    return function(newCircle) {
      return function(state3) {
        var idsToCheck = getChainSegmentFrom(startId)(state3.frontChain);
        var v = findFirstCollision(idsToCheck)(newCircle)(state3.circles);
        if (v instanceof Just) {
          return new CollisionAt(v.value0);
        }
        ;
        if (v instanceof Nothing) {
          return NoCollision.value;
        }
        ;
        throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 243, column 5 - line 245, column 29): " + [v.constructor.name]);
      };
    };
  };
  var tryPlaceCircleWithLimit = function($copy_maxRetries) {
    return function($copy_newCircle) {
      return function($copy_aId) {
        return function($copy_bId) {
          return function($copy_state) {
            var $tco_var_maxRetries = $copy_maxRetries;
            var $tco_var_newCircle = $copy_newCircle;
            var $tco_var_aId = $copy_aId;
            var $tco_var_bId = $copy_bId;
            var $tco_done = false;
            var $tco_result;
            function $tco_loop(maxRetries, newCircle, aId, bId, state3) {
              if (maxRetries <= 0) {
                var v = unsafePerformEffect(log2("\u274C RETRY LIMIT HIT! Failed to place circle r=" + show131(newCircle.r)));
                $tco_done = true;
                return insertBetween(aId)(bId)(newCircle)(state3);
              }
              ;
              if (otherwise) {
                var v = lookup35(bId)(state3.circles);
                var v1 = lookup35(aId)(state3.circles);
                if (v1 instanceof Just && v instanceof Just) {
                  var positioned = place(v.value0)(v1.value0)(newCircle);
                  var v2 = unsafePerformEffect(log2("  Try r=" + (show131(newCircle.r) + (" at (" + (show66(aId) + ("," + (show66(bId) + (")" + (" -> pos=(" + (show131(positioned.x) + ("," + (show131(positioned.y) + (")" + (" [retries left: " + (show66(maxRetries) + "]")))))))))))))));
                  var collisionResult = walkChainForCollision(bId)(positioned)(state3);
                  if (collisionResult instanceof NoCollision) {
                    var v3 = unsafePerformEffect(log2("    \u2705 NO COLLISION - placed successfully"));
                    $tco_done = true;
                    return insertBetween(aId)(bId)(positioned)(state3);
                  }
                  ;
                  if (collisionResult instanceof CollisionAt) {
                    var v3 = unsafePerformEffect(log2("    \u274C COLLISION at circle " + (show66(collisionResult.value0) + (" - shortening chain and retrying with (" + (show66(aId) + ("," + (show66(collisionResult.value0) + ")")))))));
                    var shortenedChain = shortenChainOnly(aId)(collisionResult.value0)(state3.frontChain);
                    var v4 = unsafePerformEffect(log2("       Chain before: " + show211(state3.frontChain)));
                    var v5 = unsafePerformEffect(log2("       Chain after:  " + show211(shortenedChain)));
                    var stateWithShortenedChain = {
                      circles: state3.circles,
                      nextId: state3.nextId,
                      frontChain: shortenedChain
                    };
                    $tco_var_maxRetries = maxRetries - 1 | 0;
                    $tco_var_newCircle = newCircle;
                    $tco_var_aId = aId;
                    $tco_var_bId = collisionResult.value0;
                    $copy_state = stateWithShortenedChain;
                    return;
                  }
                  ;
                  throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 345, column 13 - line 364, column 101): " + [collisionResult.constructor.name]);
                }
                ;
                $tco_done = true;
                return state3;
              }
              ;
              throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 321, column 1 - line 321, column 91): " + [maxRetries.constructor.name, newCircle.constructor.name, aId.constructor.name, bId.constructor.name, state3.constructor.name]);
            }
            ;
            while (!$tco_done) {
              $tco_result = $tco_loop($tco_var_maxRetries, $tco_var_newCircle, $tco_var_aId, $tco_var_bId, $copy_state);
            }
            ;
            return $tco_result;
          };
        };
      };
    };
  };
  var tryPlaceCircle = /* @__PURE__ */ tryPlaceCircleWithLimit(100);
  var epsilon3 = 1e-9;
  var enclosesWeak = function(a2) {
    return function(b10) {
      var dy4 = b10.y - a2.y;
      var dx = b10.x - a2.x;
      var dr = a2.r - b10.r + max9(a2.r)(max9(b10.r)(1)) * epsilon3;
      return dr > 0 && dr * dr > dx * dx + dy4 * dy4;
    };
  };
  var enclosesWeakAll = function(a2) {
    return function(bs) {
      return all2(enclosesWeak(a2))(bs);
    };
  };
  var enclosesNot = function(a2) {
    return function(b10) {
      var dy4 = b10.y - a2.y;
      var dx = b10.x - a2.x;
      var dr = a2.r - b10.r;
      return dr < 0 || dr * dr < dx * dx + dy4 * dy4;
    };
  };
  var encloseBasis3 = function(a2) {
    return function(b10) {
      return function(c) {
        var d1 = a2.x * a2.x + a2.y * a2.y - a2.r * a2.r;
        var d22 = d1 - b10.x * b10.x - b10.y * b10.y + b10.r * b10.r;
        var d32 = d1 - c.x * c.x - c.y * c.y + c.r * c.r;
        var c3 = c.r - a2.r;
        var c2 = b10.r - a2.r;
        var b32 = a2.y - c.y;
        var b22 = a2.y - b10.y;
        var a3 = a2.x - c.x;
        var a22 = a2.x - b10.x;
        var ab = a3 * b22 - a22 * b32;
        var xa = (b22 * d32 - b32 * d22) / (ab * 2) - a2.x;
        var xb = (b32 * c2 - b22 * c3) / ab;
        var ya = (a3 * d22 - a22 * d32) / (ab * 2) - a2.y;
        var bigC = xa * xa + ya * ya - a2.r * a2.r;
        var yb = (a22 * c3 - a3 * c2) / ab;
        var bigA = xb * xb + yb * yb - 1;
        var bigB = 2 * (a2.r + xa * xb + ya * yb);
        var r = (function() {
          var $205 = abs(bigA) > epsilon6;
          if ($205) {
            return -(bigB + sqrt(bigB * bigB - 4 * bigA * bigC)) / (2 * bigA);
          }
          ;
          return -bigC / bigB;
        })();
        return {
          x: a2.x + xa + xb * r,
          y: a2.y + ya + yb * r,
          r
        };
      };
    };
  };
  var encloseBasis2 = function(a2) {
    return function(b10) {
      var y217 = b10.y - a2.y;
      var x217 = b10.x - a2.x;
      var r21 = b10.r - a2.r;
      var l = sqrt(x217 * x217 + y217 * y217);
      return {
        x: (a2.x + b10.x + x217 / l * r21) / 2,
        y: (a2.y + b10.y + y217 / l * r21) / 2,
        r: (l + a2.r + b10.r) / 2
      };
    };
  };
  var extendBasis = function(basis2) {
    return function(p2) {
      if (enclosesWeakAll(p2)(basis2)) {
        return [p2];
      }
      ;
      if (otherwise) {
        var n = length(basis2);
        var findTwoCircleBasis = function($copy_i) {
          var $tco_done = false;
          var $tco_result;
          function $tco_loop(i2) {
            if (i2 >= n) {
              $tco_done = true;
              return Nothing.value;
            }
            ;
            if (otherwise) {
              var v2 = index(basis2)(i2);
              if (v2 instanceof Just) {
                var candidate = encloseBasis2(v2.value0)(p2);
                var $210 = enclosesNot(p2)(v2.value0) && enclosesWeakAll(candidate)(basis2);
                if ($210) {
                  $tco_done = true;
                  return new Just([v2.value0, p2]);
                }
                ;
                $copy_i = i2 + 1 | 0;
                return;
              }
              ;
              if (v2 instanceof Nothing) {
                $copy_i = i2 + 1 | 0;
                return;
              }
              ;
              throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 538, column 11 - line 544, column 50): " + [v2.constructor.name]);
            }
            ;
            throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 534, column 5 - line 534, column 54): " + [i2.constructor.name]);
          }
          ;
          while (!$tco_done) {
            $tco_result = $tco_loop($copy_i);
          }
          ;
          return $tco_result;
        };
        var findInnerPair = function($copy_i) {
          return function($copy_j) {
            var $tco_var_i = $copy_i;
            var $tco_done1 = false;
            var $tco_result;
            function $tco_loop(i2, j) {
              if (j >= n) {
                $tco_done1 = true;
                return Nothing.value;
              }
              ;
              if (otherwise) {
                var v2 = index(basis2)(j);
                var v12 = index(basis2)(i2);
                if (v12 instanceof Just && v2 instanceof Just) {
                  var cjp = encloseBasis2(v2.value0)(p2);
                  var cip = encloseBasis2(v12.value0)(p2);
                  var cij = encloseBasis2(v12.value0)(v2.value0);
                  var candidate = encloseBasis3(v12.value0)(v2.value0)(p2);
                  var $216 = enclosesNot(cij)(p2) && (enclosesNot(cip)(v2.value0) && (enclosesNot(cjp)(v12.value0) && enclosesWeakAll(candidate)(basis2)));
                  if ($216) {
                    $tco_done1 = true;
                    return new Just([v12.value0, v2.value0, p2]);
                  }
                  ;
                  $tco_var_i = i2;
                  $copy_j = j + 1 | 0;
                  return;
                }
                ;
                $tco_var_i = i2;
                $copy_j = j + 1 | 0;
                return;
              }
              ;
              throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 554, column 5 - line 554, column 56): " + [i2.constructor.name, j.constructor.name]);
            }
            ;
            while (!$tco_done1) {
              $tco_result = $tco_loop($tco_var_i, $copy_j);
            }
            ;
            return $tco_result;
          };
        };
        var findThreeCircleBasis = function($copy_i) {
          var $tco_done2 = false;
          var $tco_result;
          function $tco_loop(i2) {
            if (i2 >= (n - 1 | 0)) {
              $tco_done2 = true;
              return Nothing.value;
            }
            ;
            if (otherwise) {
              var v2 = findInnerPair(i2)(i2 + 1 | 0);
              if (v2 instanceof Just) {
                $tco_done2 = true;
                return new Just(v2.value0);
              }
              ;
              if (v2 instanceof Nothing) {
                $copy_i = i2 + 1 | 0;
                return;
              }
              ;
              throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 550, column 11 - line 552, column 52): " + [v2.constructor.name]);
            }
            ;
            throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 546, column 5 - line 546, column 56): " + [i2.constructor.name]);
          }
          ;
          while (!$tco_done2) {
            $tco_result = $tco_loop($copy_i);
          }
          ;
          return $tco_result;
        };
        var v = findTwoCircleBasis(0);
        if (v instanceof Just) {
          return v.value0;
        }
        ;
        if (v instanceof Nothing) {
          var v1 = findThreeCircleBasis(0);
          if (v1 instanceof Just) {
            return v1.value0;
          }
          ;
          if (v1 instanceof Nothing) {
            return basis2;
          }
          ;
          throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 528, column 11 - line 530, column 29): " + [v1.constructor.name]);
        }
        ;
        throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 525, column 7 - line 530, column 29): " + [v.constructor.name]);
      }
      ;
      throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 521, column 1 - line 521, column 54): " + [basis2.constructor.name, p2.constructor.name]);
    };
  };
  var encloseBasis1 = function(a2) {
    return {
      x: a2.x,
      y: a2.y,
      r: a2.r
    };
  };
  var encloseBasis = function(basis2) {
    var v = length(basis2);
    if (v === 1) {
      return fromMaybe({
        x: 0,
        y: 0,
        r: 0
      })(map116(encloseBasis1)(index(basis2)(0)));
    }
    ;
    if (v === 2) {
      return fromMaybe({
        x: 0,
        y: 0,
        r: 0
      })(apply5(map116(encloseBasis2)(index(basis2)(0)))(index(basis2)(1)));
    }
    ;
    if (v === 3) {
      return fromMaybe({
        x: 0,
        y: 0,
        r: 0
      })(apply5(apply5(map116(encloseBasis3)(index(basis2)(0)))(index(basis2)(1)))(index(basis2)(2)));
    }
    ;
    return {
      x: 0,
      y: 0,
      r: 0
    };
  };
  var packEnclose = function(circles) {
    var n = length(circles);
    var go2 = function($copy_i) {
      return function($copy_basis) {
        return function($copy_maybeE) {
          var $tco_var_i = $copy_i;
          var $tco_var_basis = $copy_basis;
          var $tco_done = false;
          var $tco_result;
          function $tco_loop(i2, basis2, maybeE) {
            if (i2 >= n) {
              if (maybeE instanceof Just) {
                $tco_done = true;
                return maybeE.value0;
              }
              ;
              if (maybeE instanceof Nothing) {
                $tco_done = true;
                return {
                  x: 0,
                  y: 0,
                  r: 0
                };
              }
              ;
              throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 579, column 11 - line 581, column 48): " + [maybeE.constructor.name]);
            }
            ;
            if (otherwise) {
              var v = index(circles)(i2);
              if (v instanceof Nothing) {
                $tco_var_i = i2 + 1 | 0;
                $tco_var_basis = basis2;
                $copy_maybeE = maybeE;
                return;
              }
              ;
              if (v instanceof Just) {
                if (maybeE instanceof Just && enclosesWeak(maybeE.value0)(v.value0)) {
                  $tco_var_i = i2 + 1 | 0;
                  $tco_var_basis = basis2;
                  $copy_maybeE = maybeE;
                  return;
                }
                ;
                var newBasis = extendBasis(basis2)(v.value0);
                var newE = encloseBasis(newBasis);
                $tco_var_i = 0;
                $tco_var_basis = newBasis;
                $copy_maybeE = new Just(newE);
                return;
              }
              ;
              throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 583, column 11 - line 592, column 47): " + [v.constructor.name]);
            }
            ;
            throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 576, column 5 - line 576, column 56): " + [i2.constructor.name, basis2.constructor.name, maybeE.constructor.name]);
          }
          ;
          while (!$tco_done) {
            $tco_result = $tco_loop($tco_var_i, $tco_var_basis, $copy_maybeE);
          }
          ;
          return $tco_result;
        };
      };
    };
    return go2(0)([])(Nothing.value);
  };
  var defaultPackConfig = /* @__PURE__ */ (function() {
    return {
      size: {
        width: 1,
        height: 1
      },
      padding: 0,
      radius: Nothing.value
    };
  })();
  var calculateScore = function(a2) {
    return function(b10) {
      var ab = a2.r + b10.r;
      var dx = (a2.x * b10.r + b10.x * a2.r) / ab;
      var dy4 = (a2.y * b10.r + b10.y * a2.r) / ab;
      return dx * dx + dy4 * dy4;
    };
  };
  var scoreNode = function(nodeId) {
    return function(state3) {
      return bind65(lookup35(nodeId)(state3.circles))(function(node) {
        return bind65(getNextId(nodeId)(state3.frontChain))(function(nextId) {
          return bind65(lookup35(nextId)(state3.circles))(function(next2) {
            return pure62({
              nodeId,
              score: calculateScore(node)(next2)
            });
          });
        });
      });
    };
  };
  var findBestPair = function(state3) {
    var scored = mapMaybe(function(nodeId) {
      return scoreNode(nodeId)(state3);
    })(state3.frontChain);
    var bestNode = minimumBy2(comparing2(function(v) {
      return v.score;
    }))(scored);
    if (bestNode instanceof Nothing) {
      return Nothing.value;
    }
    ;
    if (bestNode instanceof Just) {
      return bind65(getNextId(bestNode.value0.nodeId)(state3.frontChain))(function(nextId) {
        return pure62(new Tuple(bestNode.value0.nodeId, nextId));
      });
    }
    ;
    throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 151, column 5 - line 155, column 40): " + [bestNode.constructor.name]);
  };
  var assignRadii = function(config) {
    return function(v) {
      if (v.value0.children.length === 0) {
        var r = (function() {
          if (config.radius instanceof Just) {
            return config.radius.value0(v.value0.data_);
          }
          ;
          if (config.radius instanceof Nothing) {
            return sqrt(v.value0.value);
          }
          ;
          throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 720, column 15 - line 722, column 39): " + [config.radius.constructor.name]);
        })();
        return new PackNode({
          data_: v.value0.data_,
          depth: v.value0.depth,
          height: v.value0.height,
          value: v.value0.value,
          children: v.value0.children,
          x: v.value0.x,
          y: v.value0.y,
          r: max9(0)(r)
        });
      }
      ;
      return new PackNode({
        data_: v.value0.data_,
        depth: v.value0.depth,
        height: v.value0.height,
        value: v.value0.value,
        x: v.value0.x,
        y: v.value0.y,
        r: v.value0.r,
        children: map63(assignRadii(config))(v.value0.children)
      });
    };
  };
  var addCircle = function(newCircle) {
    return function(state3) {
      var v = unsafePerformEffect(log2("\n\u27A4 Adding circle r=" + (show131(newCircle.r) + (" (total circles so far: " + (show66(size2(state3.circles)) + ")")))));
      var v1 = unsafePerformEffect(log2("  Current front chain: " + show211(state3.frontChain)));
      var v2 = findBestPair(state3);
      if (v2 instanceof Nothing) {
        return state3;
      }
      ;
      if (v2 instanceof Just) {
        var v3 = unsafePerformEffect(log2("  Best pair: (" + (show66(v2.value0.value0) + ("," + (show66(v2.value0.value1) + ")")))));
        var result = tryPlaceCircle(newCircle)(v2.value0.value0)(v2.value0.value1)(state3);
        return result;
      }
      ;
      throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 379, column 5 - line 386, column 18): " + [v2.constructor.name]);
    };
  };
  var packSiblingsMap = function(inputCircles) {
    var n = length(inputCircles);
    var $250 = n === 0;
    if ($250) {
      return {
        circles: [],
        radius: 0
      };
    }
    ;
    var $251 = n === 1;
    if ($251) {
      var v = index(inputCircles)(0);
      if (v instanceof Just) {
        return {
          circles: [{
            r: v.value0.r,
            x: 0,
            y: 0
          }],
          radius: v.value0.r
        };
      }
      ;
      if (v instanceof Nothing) {
        return {
          circles: [],
          radius: 0
        };
      }
      ;
      throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Pack (line 396, column 7 - line 398, column 48): " + [v.constructor.name]);
    }
    ;
    var $254 = n === 2;
    if ($254) {
      var v = index(inputCircles)(1);
      var v1 = index(inputCircles)(0);
      if (v1 instanceof Just && v instanceof Just) {
        var c1$prime = {
          r: v.value0.r,
          x: v1.value0.r,
          y: 0
        };
        var c0$prime = {
          r: v1.value0.r,
          x: -v.value0.r,
          y: 0
        };
        return {
          circles: [c0$prime, c1$prime],
          radius: v1.value0.r + v.value0.r
        };
      }
      ;
      return {
        circles: [],
        radius: 0
      };
    }
    ;
    var v = index(inputCircles)(2);
    var v1 = index(inputCircles)(1);
    var v2 = index(inputCircles)(0);
    if (v2 instanceof Just && (v1 instanceof Just && v instanceof Just)) {
      var remaining = drop(3)(inputCircles);
      var initialState4 = initState(v2.value0)(v1.value0)(v.value0);
      var finalState = foldl14(flip(addCircle))(initialState4)(remaining);
      var positioned = mapMaybe(function(i2) {
        return lookup35(i2)(finalState.circles);
      })(range2(0)(n - 1 | 0));
      var enclosing = packEnclose(positioned);
      var translated = map63(function(c) {
        return {
          r: c.r,
          x: c.x - enclosing.x,
          y: c.y - enclosing.y
        };
      })(positioned);
      return {
        circles: translated,
        radius: enclosing.r
      };
    }
    ;
    return {
      circles: [],
      radius: 0
    };
  };
  var packChildren = function(k) {
    return function(config) {
      return function(v) {
        var updateNodePosition = function(v1) {
          return function(c) {
            return new PackNode({
              data_: v1.value0.data_,
              depth: v1.value0.depth,
              height: v1.value0.height,
              value: v1.value0.value,
              children: v1.value0.children,
              r: v1.value0.r,
              x: c.x,
              y: c.y
            });
          };
        };
        var removePadding = function(p2) {
          return function(c) {
            return {
              x: c.x,
              y: c.y,
              r: c.r - p2
            };
          };
        };
        var nodeToCircle = function(v1) {
          return {
            x: v1.value0.x,
            y: v1.value0.y,
            r: v1.value0.r
          };
        };
        var addPadding = function(p2) {
          return function(c) {
            return {
              x: c.x,
              y: c.y,
              r: c.r + p2
            };
          };
        };
        if (v.value0.children.length === 0) {
          return new PackNode(v.value0);
        }
        ;
        var paddingScaled = config.padding * k;
        var packedKids = map63(packChildren(k)(config))(v.value0.children);
        var inputCircles = map63((function() {
          var $277 = addPadding(paddingScaled);
          return function($278) {
            return $277(nodeToCircle($278));
          };
        })())(packedKids);
        var packed = packSiblingsMap(inputCircles);
        var circlesWithoutPadding = map63(removePadding(paddingScaled))(packed.circles);
        var updatedKids = zipWith(updateNodePosition)(packedKids)(circlesWithoutPadding);
        var nodeWithR = {
          data_: v.value0.data_,
          depth: v.value0.depth,
          height: v.value0.height,
          value: v.value0.value,
          x: v.value0.x,
          y: v.value0.y,
          r: packed.radius + paddingScaled,
          children: updatedKids
        };
        return new PackNode(nodeWithR);
      };
    };
  };
  var pack = function(config) {
    return function(root3) {
      var withRadii = assignRadii(config)(root3);
      var firstPack = packChildren(1)({
        size: config.size,
        radius: config.radius,
        padding: 0
      })(withRadii);
      var k = firstPack.value0.r / min8(config.size.width)(config.size.height);
      var packed = packChildren(k)(config)(withRadii);
      var scaled = scaleToSize(config)(packed);
      return scaled;
    };
  };

  // output/D3.Viz.TreeAPI.PackViz/index.js
  var map64 = /* @__PURE__ */ map(functorMaybe);
  var map117 = /* @__PURE__ */ map(functorArray);
  var append25 = /* @__PURE__ */ append(semigroupArray);
  var bind66 = /* @__PURE__ */ bind(bindArray);
  var mod8 = /* @__PURE__ */ mod(euclideanRingInt);
  var bind122 = /* @__PURE__ */ bind(bindD3v2M);
  var select32 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var discard52 = /* @__PURE__ */ discard(discardUnit);
  var discard114 = /* @__PURE__ */ discard52(bindD3v2M);
  var liftEffect35 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var show67 = /* @__PURE__ */ show(showInt);
  var width41 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height41 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox35 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var show132 = /* @__PURE__ */ show(showNumber);
  var class_38 = /* @__PURE__ */ class_2(toAttrStringString);
  var transform15 = /* @__PURE__ */ transform2(toAttrStringString);
  var radius31 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill39 = /* @__PURE__ */ fill3(toAttrStringString);
  var fillOpacity7 = /* @__PURE__ */ fillOpacity(toAttrNumberNumber);
  var stroke29 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth29 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var textContent19 = /* @__PURE__ */ textContent(toAttrStringString);
  var textAnchor17 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var y39 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var fontSize11 = /* @__PURE__ */ fontSize2(toAttrNumberNumber);
  var renderTree51 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(/* @__PURE__ */ ordPackNode(ordString));
  var bind215 = /* @__PURE__ */ bind(bindAff);
  var liftEffect113 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var toHierarchyData = function(node) {
    return {
      data_: getName2(node),
      value: new Just(getValue2(node)),
      children: map64(map117(toHierarchyData))(getChildren2(node))
    };
  };
  var getAllNodes = function(v) {
    var $41 = length(v.value0.children) === 0;
    if ($41) {
      return [v];
    }
    ;
    return append25([v])(bind66(v.value0.children)(getAllNodes));
  };
  var colors = ["#e7ba52", "#c7c7c7", "#aec7e8", "#1f77b4", "#9467bd", "#8c564b", "#e377c2", "#7f7f7f", "#bcbd22", "#17becf"];
  var getColor = function(depth) {
    var idx = mod8(depth)(length(colors));
    var v = index(colors)(idx);
    if (v instanceof Just) {
      return v.value0;
    }
    ;
    if (v instanceof Nothing) {
      return "#cccccc";
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.TreeAPI.PackViz (line 40, column 6 - line 42, column 28): " + [v.constructor.name]);
  };
  var drawPack = function(selector) {
    return function(flareData) {
      return runD3v2M(bind122(select32(selector))(function(container) {
        var centerX = 700 / 2;
        var centerY = 700 / 2;
        var hierData = toHierarchyData(flareData);
        var packRoot = hierarchy(hierData);
        var config = {
          radius: defaultPackConfig.radius,
          size: {
            width: 700,
            height: 700
          },
          padding: 2
        };
        var packed = pack(config)(packRoot);
        var nodes = getAllNodes(packed);
        return discard114(liftEffect35(log2("Rendering circle pack: " + (show67(length(nodes)) + " circles"))))(function() {
          var tree3 = withChild(named2(SVG.value)("svg")([width41(700), height41(700), viewBox35("0 0 " + (show132(700) + (" " + show132(700)))), class_38("pack-viz")]))(withChild(named2(Group2.value)("chartGroup")([class_38("pack-content")]))(joinData2("circles")("g")(nodes)(function(v) {
            return withChildren(named2(Group2.value)("circle-" + v.value0.data_)([class_38("node"), transform15("translate(" + (show132(v.value0.x) + ("," + (show132(v.value0.y) + ")"))))]))([elem4(Circle2.value)([radius31(v.value0.r), fill39(getColor(v.value0.depth)), fillOpacity7(0.7), stroke29("#fff"), strokeWidth29(1)]), elem4(Text3.value)([textContent19(v.value0.data_), textAnchor17("middle"), y39(4), fontSize11((function() {
              var $46 = v.value0.r > 20;
              if ($46) {
                return 10;
              }
              ;
              return 8;
            })()), fillOpacity7((function() {
              var $47 = v.value0.r > 15;
              if ($47) {
                return 1;
              }
              ;
              return 0;
            })())])]);
          })));
          return bind122(renderTree51(container)(tree3))(function() {
            return liftEffect35(function __do3() {
              log2("=== Circle Packing Layout (Tree API) ===")();
              log2("")();
              log2("Flare visualization toolkit hierarchy (circle packing)")();
              return log2("")();
            });
          });
        });
      }));
    };
  };
  var packViz = function(selector) {
    return launchAff_(bind215(loadDataFile(FlareJSON.value))(function(result) {
      if (result instanceof Left) {
        return liftEffect113(log2("Failed to load Flare data: " + result.value0));
      }
      ;
      if (result instanceof Right) {
        var hierData = parseFlareJson(result.value0);
        return liftEffect113(drawPack(selector)(hierData));
      }
      ;
      throw new Error("Failed pattern match at D3.Viz.TreeAPI.PackViz (line 129, column 3 - line 133, column 46): " + [result.constructor.name]);
    }));
  };

  // output/PSD3.Layout.Hierarchy.Partition/index.js
  var map65 = /* @__PURE__ */ map(functorArray);
  var compare20 = /* @__PURE__ */ compare(ordInt);
  var compare111 = /* @__PURE__ */ compare(ordNumber);
  var add5 = /* @__PURE__ */ add(semiringNumber);
  var map118 = /* @__PURE__ */ map(functorMaybe);
  var max10 = /* @__PURE__ */ max(ordInt);
  var PartNode = /* @__PURE__ */ (function() {
    function PartNode2(value0) {
      this.value0 = value0;
    }
    ;
    PartNode2.create = function(value0) {
      return new PartNode2(value0);
    };
    return PartNode2;
  })();
  var eqPartitionNode = function(dictEq) {
    var eq27 = eq(dictEq);
    return {
      eq: function(x47) {
        return function(y48) {
          return eq(eqArray(eqPartitionNode(dictEq)))(x47.value0.children)(y48.value0.children) && eq27(x47.value0.data_)(y48.value0.data_) && x47.value0.depth === y48.value0.depth && x47.value0.height === y48.value0.height && x47.value0.value === y48.value0.value && x47.value0.x0 === y48.value0.x0 && x47.value0.x1 === y48.value0.x1 && x47.value0.y0 === y48.value0.y0 && x47.value0.y1 === y48.value0.y1;
        };
      }
    };
  };
  var ordPartitionNode = function(dictOrd) {
    var compare26 = compare(dictOrd);
    var eqPartitionNode1 = eqPartitionNode(dictOrd.Eq0());
    return {
      compare: function(x47) {
        return function(y48) {
          var v = compare(ordArray(ordPartitionNode(dictOrd)))(x47.value0.children)(y48.value0.children);
          if (v instanceof LT) {
            return LT.value;
          }
          ;
          if (v instanceof GT) {
            return GT.value;
          }
          ;
          var v1 = compare26(x47.value0.data_)(y48.value0.data_);
          if (v1 instanceof LT) {
            return LT.value;
          }
          ;
          if (v1 instanceof GT) {
            return GT.value;
          }
          ;
          var v2 = compare20(x47.value0.depth)(y48.value0.depth);
          if (v2 instanceof LT) {
            return LT.value;
          }
          ;
          if (v2 instanceof GT) {
            return GT.value;
          }
          ;
          var v3 = compare20(x47.value0.height)(y48.value0.height);
          if (v3 instanceof LT) {
            return LT.value;
          }
          ;
          if (v3 instanceof GT) {
            return GT.value;
          }
          ;
          var v4 = compare111(x47.value0.value)(y48.value0.value);
          if (v4 instanceof LT) {
            return LT.value;
          }
          ;
          if (v4 instanceof GT) {
            return GT.value;
          }
          ;
          var v5 = compare111(x47.value0.x0)(y48.value0.x0);
          if (v5 instanceof LT) {
            return LT.value;
          }
          ;
          if (v5 instanceof GT) {
            return GT.value;
          }
          ;
          var v6 = compare111(x47.value0.x1)(y48.value0.x1);
          if (v6 instanceof LT) {
            return LT.value;
          }
          ;
          if (v6 instanceof GT) {
            return GT.value;
          }
          ;
          var v7 = compare111(x47.value0.y0)(y48.value0.y0);
          if (v7 instanceof LT) {
            return LT.value;
          }
          ;
          if (v7 instanceof GT) {
            return GT.value;
          }
          ;
          return compare111(x47.value0.y1)(y48.value0.y1);
        };
      },
      Eq0: function() {
        return eqPartitionNode1;
      }
    };
  };
  var roundNode = function(v) {
    return new PartNode({
      data_: v.value0.data_,
      depth: v.value0.depth,
      height: v.value0.height,
      value: v.value0.value,
      x0: floor(v.value0.x0),
      y0: floor(v.value0.y0),
      x1: ceil(v.value0.x1),
      y1: ceil(v.value0.y1),
      children: map65(roundNode)(v.value0.children)
    });
  };
  var positionChild = function(k) {
    return function(y0) {
      return function(y116) {
        return function(acc) {
          return function(v) {
            var x1$prime = acc.currentX + v.value0.value * k;
            var positioned = new PartNode({
              data_: v.value0.data_,
              depth: v.value0.depth,
              height: v.value0.height,
              value: v.value0.value,
              children: v.value0.children,
              x0: acc.currentX,
              y0,
              x1: x1$prime,
              y1: y116
            });
            return {
              positioned: snoc(acc.positioned)(positioned),
              currentX: x1$prime
            };
          };
        };
      };
    };
  };
  var hierarchy2 = /* @__PURE__ */ (function() {
    var go2 = function(depth) {
      return function(v) {
        var kids = fromMaybe([])(map118(map65(go2(depth + 1 | 0)))(v.children));
        var childValues = map65(function(v1) {
          return v1.value0.value;
        })(kids);
        var sumChildValues = foldl2(add5)(0)(childValues);
        var nodeValue = (function() {
          if (v.value instanceof Just) {
            return v.value.value0;
          }
          ;
          if (v.value instanceof Nothing) {
            var $97 = $$null(kids);
            if ($97) {
              return 0;
            }
            ;
            return sumChildValues;
          }
          ;
          throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Partition (line 94, column 21 - line 96, column 69): " + [v.value.constructor.name]);
        })();
        var childHeights = map65(function(v1) {
          return v1.value0.height;
        })(kids);
        var maxChildHeight = foldl2(max10)(0)(childHeights);
        var nodeHeight = (function() {
          var $100 = $$null(kids);
          if ($100) {
            return 0;
          }
          ;
          return maxChildHeight + 1 | 0;
        })();
        return new PartNode({
          data_: v.data_,
          depth,
          height: nodeHeight,
          value: nodeValue,
          children: kids,
          x0: 0,
          y0: 0,
          x1: 0,
          y1: 0
        });
      };
    };
    return go2(0);
  })();
  var dice = function(children3) {
    return function(x0) {
      return function(y0) {
        return function(x116) {
          return function(y116) {
            var totalValue = foldl2(function(acc) {
              return function(v) {
                return acc + v.value0.value;
              };
            })(0)(children3);
            var k = (function() {
              var $103 = totalValue > 0;
              if ($103) {
                return (x116 - x0) / totalValue;
              }
              ;
              return 0;
            })();
            var result = foldl2(positionChild(k)(y0)(y116))({
              positioned: [],
              currentX: x0
            })(children3);
            return result.positioned;
          };
        };
      };
    };
  };
  var positionNode = function(config) {
    return function(dy4) {
      return function(n) {
        return function(v) {
          var y1$prime = v.value0.y1 - config.padding;
          var x1$prime = v.value0.x1 - config.padding;
          var positionedChildren = (function() {
            var $108 = $$null(v.value0.children);
            if ($108) {
              return v.value0.children;
            }
            ;
            var childY1 = dy4 * toNumber(v.value0.depth + 2 | 0) / toNumber(n);
            var childY0 = dy4 * toNumber(v.value0.depth + 1 | 0) / toNumber(n);
            var dicedChildren = dice(v.value0.children)(v.value0.x0)(childY0)(v.value0.x1)(childY1);
            var recursed = map65(positionNode(config)(dy4)(n))(dicedChildren);
            return recursed;
          })();
          var v1 = (function() {
            var $109 = x1$prime < v.value0.x0;
            if ($109) {
              return {
                x0: (v.value0.x0 + x1$prime) / 2,
                x1: (v.value0.x0 + x1$prime) / 2
              };
            }
            ;
            return {
              x0: v.value0.x0,
              x1: x1$prime
            };
          })();
          var v2 = (function() {
            var $111 = y1$prime < v.value0.y0;
            if ($111) {
              return {
                y0: (v.value0.y0 + y1$prime) / 2,
                y1: (v.value0.y0 + y1$prime) / 2
              };
            }
            ;
            return {
              y0: v.value0.y0,
              y1: y1$prime
            };
          })();
          return new PartNode({
            data_: v.value0.data_,
            depth: v.value0.depth,
            height: v.value0.height,
            value: v.value0.value,
            children: positionedChildren,
            x0: v1.x0,
            y0: v2.y0,
            x1: v1.x1,
            y1: v2.y1
          });
        };
      };
    };
  };
  var partition3 = function(config) {
    return function(root3) {
      var n = root3.value0.height + 1 | 0;
      var initialRoot = new PartNode({
        data_: root3.value0.data_,
        depth: root3.value0.depth,
        height: root3.value0.height,
        value: root3.value0.value,
        children: root3.value0.children,
        x0: config.padding,
        y0: config.padding,
        x1: config.size.width,
        y1: config.size.height / toNumber(n)
      });
      var positioned = positionNode(config)(config.size.height)(n)(initialRoot);
      var rounded = (function() {
        if (config.round) {
          return roundNode(positioned);
        }
        ;
        return positioned;
      })();
      return rounded;
    };
  };
  var defaultPartitionConfig = {
    size: {
      width: 1,
      height: 1
    },
    padding: 0,
    round: false
  };

  // output/D3.Viz.TreeAPI.PartitionViz/index.js
  var map66 = /* @__PURE__ */ map(functorMaybe);
  var map119 = /* @__PURE__ */ map(functorArray);
  var append26 = /* @__PURE__ */ append(semigroupArray);
  var bind67 = /* @__PURE__ */ bind(bindArray);
  var mod9 = /* @__PURE__ */ mod(euclideanRingInt);
  var bind123 = /* @__PURE__ */ bind(bindD3v2M);
  var select33 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var discard53 = /* @__PURE__ */ discard(discardUnit)(bindD3v2M);
  var liftEffect36 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var show68 = /* @__PURE__ */ show(showInt);
  var width42 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height42 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox36 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var show133 = /* @__PURE__ */ show(showNumber);
  var class_39 = /* @__PURE__ */ class_2(toAttrStringString);
  var x39 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y40 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var fill40 = /* @__PURE__ */ fill3(toAttrStringString);
  var fillOpacity8 = /* @__PURE__ */ fillOpacity(toAttrNumberNumber);
  var stroke30 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth30 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var textContent20 = /* @__PURE__ */ textContent(toAttrStringString);
  var textAnchor18 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var fontSize12 = /* @__PURE__ */ fontSize2(toAttrNumberNumber);
  var renderTree52 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(/* @__PURE__ */ ordPartitionNode(ordString));
  var bind216 = /* @__PURE__ */ bind(bindAff);
  var liftEffect114 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var toHierarchyData2 = function(node) {
    return {
      data_: getName2(node),
      value: new Just(getValue2(node)),
      children: map66(map119(toHierarchyData2))(getChildren2(node))
    };
  };
  var getAllNodes2 = function(v) {
    var $42 = length(v.value0.children) === 0;
    if ($42) {
      return [v];
    }
    ;
    return append26([v])(bind67(v.value0.children)(getAllNodes2));
  };
  var colors2 = ["#e7ba52", "#c7c7c7", "#aec7e8", "#1f77b4", "#9467bd"];
  var getColor2 = function(depth) {
    var v = index(colors2)(mod9(depth)(length(colors2)));
    if (v instanceof Just) {
      return v.value0;
    }
    ;
    if (v instanceof Nothing) {
      return "#cccccc";
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.TreeAPI.PartitionViz (line 34, column 18 - line 36, column 23): " + [v.constructor.name]);
  };
  var drawPartition = function(selector) {
    return function(flareData) {
      return runD3v2M(bind123(select33(selector))(function(container) {
        var hierData = toHierarchyData2(flareData);
        var partRoot = hierarchy2(hierData);
        var config = {
          round: defaultPartitionConfig.round,
          size: {
            width: 750,
            height: 500
          },
          padding: 1
        };
        var partitioned = partition3(config)(partRoot);
        var nodes = getAllNodes2(partitioned);
        return discard53(liftEffect36(log2("Rendering partition: " + (show68(length(nodes)) + " rectangles"))))(function() {
          var tree3 = withChild(named2(SVG.value)("svg")([width42(750), height42(500), viewBox36("0 0 " + (show133(750) + (" " + show133(500)))), class_39("partition-viz")]))(joinData2("rects")("g")(nodes)(function(v) {
            return withChildren(named2(Group2.value)("rect-" + v.value0.data_)([class_39("node")]))([elem4(Rect2.value)([x39(v.value0.x0), y40(v.value0.y0), width42(v.value0.x1 - v.value0.x0), height42(v.value0.y1 - v.value0.y0), fill40(getColor2(v.value0.depth)), fillOpacity8(0.7), stroke30("#fff"), strokeWidth30(1)]), elem4(Text3.value)([x39((v.value0.x0 + v.value0.x1) / 2), y40((v.value0.y0 + v.value0.y1) / 2), textContent20(v.value0.data_), textAnchor18("middle"), fontSize12(9), fillOpacity8((function() {
              var $47 = v.value0.x1 - v.value0.x0 > 30 && v.value0.y1 - v.value0.y0 > 15;
              if ($47) {
                return 1;
              }
              ;
              return 0;
            })())])]);
          }));
          return bind123(renderTree52(container)(tree3))(function() {
            return liftEffect36(log2("=== Partition Layout (Icicle) ===="));
          });
        });
      }));
    };
  };
  var partitionViz = function(selector) {
    return launchAff_(bind216(loadDataFile(FlareJSON.value))(function(result) {
      if (result instanceof Left) {
        return liftEffect114(log2("Failed to load Flare data: " + result.value0));
      }
      ;
      if (result instanceof Right) {
        return liftEffect114(drawPartition(selector)(parseFlareJson(result.value0)));
      }
      ;
      throw new Error("Failed pattern match at D3.Viz.TreeAPI.PartitionViz (line 115, column 3 - line 117, column 88): " + [result.constructor.name]);
    }));
  };

  // output/D3.Viz.TreeAPI.RadialTreeViz/index.js
  var show69 = /* @__PURE__ */ show(showNumber);
  var map67 = /* @__PURE__ */ map(functorList);
  var bind68 = /* @__PURE__ */ bind(bindList);
  var append119 = /* @__PURE__ */ append(semigroupList);
  var fromFoldable51 = /* @__PURE__ */ fromFoldable(foldableList);
  var bind124 = /* @__PURE__ */ bind(bindD3v2M);
  var select34 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var fromFoldable118 = /* @__PURE__ */ fromFoldable(foldableTree);
  var discard54 = /* @__PURE__ */ discard(discardUnit);
  var discard115 = /* @__PURE__ */ discard54(bindD3v2M);
  var liftEffect37 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var show134 = /* @__PURE__ */ show(showInt);
  var width43 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height43 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox37 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var class_40 = /* @__PURE__ */ class_2(toAttrStringString);
  var transform16 = /* @__PURE__ */ transform2(toAttrStringString);
  var d14 = /* @__PURE__ */ d4(toAttrStringString);
  var fill41 = /* @__PURE__ */ fill3(toAttrStringString);
  var stroke31 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth31 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var renderTree53 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D);
  var ordRecord10 = /* @__PURE__ */ ordRecord();
  var ordRecordCons9 = /* @__PURE__ */ ordRecordCons(ordRecordNil)();
  var ordRecordCons16 = /* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons9({
    reflectSymbol: function() {
      return "y";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "x";
    }
  })(ordNumber);
  var ordRecord16 = /* @__PURE__ */ ordRecord10(ordRecordCons16);
  var renderTree118 = /* @__PURE__ */ renderTree53(/* @__PURE__ */ ordRecord10(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons9({
    reflectSymbol: function() {
      return "target";
    }
  })(ordRecord16))()({
    reflectSymbol: function() {
      return "source";
    }
  })(ordRecord16)));
  var cx33 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy33 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius32 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var x40 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y41 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var textContent21 = /* @__PURE__ */ textContent(toAttrStringString);
  var fontSize13 = /* @__PURE__ */ fontSize2(toAttrNumberNumber);
  var textAnchor19 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var renderTree216 = /* @__PURE__ */ renderTree53(/* @__PURE__ */ ordRecord10(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordCons16)()({
    reflectSymbol: function() {
      return "value";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "name";
    }
  })(ordString))()({
    reflectSymbol: function() {
      return "height";
    }
  })(ordInt))()({
    reflectSymbol: function() {
      return "depth";
    }
  })(ordInt)));
  var bind217 = /* @__PURE__ */ bind(bindAff);
  var liftEffect115 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var radialPoint = function(node) {
    return function(w) {
      return function(h) {
        var minDim = (function() {
          var $88 = w < h;
          if ($88) {
            return w;
          }
          ;
          return h;
        })();
        var rad = node.y / h * (minDim / 2) * 0.85;
        var angle = node.x / w * 2 * pi - pi / 2;
        return {
          x: rad * cos(angle),
          y: rad * sin(angle)
        };
      };
    };
  };
  var radialLinkPath = function(x116) {
    return function(y116) {
      return function(x217) {
        return function(y217) {
          var radius210 = sqrt(x217 * x217 + y217 * y217);
          var radius1 = sqrt(x116 * x116 + y116 * y116);
          var midRadius = (radius1 + radius210) / 2;
          var angle2 = atan2(y217)(x217);
          var cp2x = midRadius * cos(angle2);
          var cp2y = midRadius * sin(angle2);
          var angle1 = atan2(y116)(x116);
          var cp1x = midRadius * cos(angle1);
          var cp1y = midRadius * sin(angle1);
          return "M" + (show69(x116) + ("," + (show69(y116) + ("C" + (show69(cp1x) + ("," + (show69(cp1y) + (" " + (show69(cp2x) + ("," + (show69(cp2y) + (" " + (show69(x217) + ("," + show69(y217)))))))))))))));
        };
      };
    };
  };
  var projectRadial = function(w) {
    return function(h) {
      return function(v) {
        var projectedChildren = map67(projectRadial(w)(h))(v.value1);
        var projected = radialPoint(v.value0)(w)(h);
        return new Node((function() {
          var $92 = {};
          for (var $93 in v.value0) {
            if ({}.hasOwnProperty.call(v.value0, $93)) {
              $92[$93] = v["value0"][$93];
            }
            ;
          }
          ;
          $92.x = projected.x;
          $92.y = projected.y;
          return $92;
        })(), projectedChildren);
      };
    };
  };
  var makeLinks7 = function(tree$prime) {
    var makeLinksList = function(v) {
      var grandchildLinks = bind68(v.value1)(makeLinksList);
      var childLinks = bind68(v.value1)(function(v1) {
        return new Cons({
          source: {
            x: v.value0.x,
            y: v.value0.y
          },
          target: {
            x: v1.value0.x,
            y: v1.value0.y
          }
        }, Nil.value);
      });
      return append119(childLinks)(grandchildLinks);
    };
    return fromFoldable51(makeLinksList(tree$prime));
  };
  var drawRadialTree = function(selector) {
    return function(flareTree) {
      return runD3v2M(bind124(select34(selector))(function(container) {
        var centerX = 700 / 2;
        var centerY = 700 / 2;
        var config = {
          layerScale: defaultTreeConfig.layerScale,
          minSeparation: defaultTreeConfig.minSeparation,
          separation: defaultTreeConfig.separation,
          size: {
            width: 700,
            height: 700
          }
        };
        var positioned = tree2(config)(flareTree);
        var radialTree = projectRadial(700)(700)(positioned);
        var nodes = fromFoldable118(radialTree);
        var links = makeLinks7(radialTree);
        return discard115(liftEffect37(log2("Rendering radial tree: " + (show134(length(nodes)) + (" nodes, " + (show134(length(links)) + " links"))))))(function() {
          var linksTree = withChild(named2(SVG.value)("svg")([width43(700), height43(700), viewBox37("0 0 " + (show69(700) + (" " + show69(700)))), class_40("radial-tree-viz")]))(withChild(named2(Group2.value)("chartGroup")([class_40("tree-content"), transform16("translate(" + (show69(centerX) + ("," + (show69(centerY) + ")"))))]))(withChild(named2(Group2.value)("linksGroup")([class_40("links")]))(joinData2("links")("path")(links)(function(link4) {
            return elem4(Path3.value)([d14(radialLinkPath(link4.source.x)(link4.source.y)(link4.target.x)(link4.target.y)), fill41("none"), stroke31("#999"), strokeWidth31(1.5), class_40("link")]);
          }))));
          return bind124(renderTree118(container)(linksTree))(function(linksSelections) {
            return bind124(liftEffect37(reselectD3v2("chartGroup")(linksSelections)))(function(chartGroupSel) {
              var nodesTree = withChild(named2(Group2.value)("nodesGroup")([class_40("nodes")]))(joinData2("nodeGroups")("g")(nodes)(function(node) {
                return withChildren(named2(Group2.value)("node-" + node.name)([class_40("node")]))([elem4(Circle2.value)([cx33(node.x), cy33(node.y), radius32(3), fill41("#69b3a2"), stroke31("#fff"), strokeWidth31(1.5)]), elem4(Text3.value)([x40(node.x), y41(node.y), textContent21(node.name), fontSize13(9), textAnchor19("start"), transform16("translate(6, 3)")])]);
              }));
              return bind124(renderTree216(chartGroupSel)(nodesTree))(function() {
                return liftEffect37(function __do3() {
                  log2("=== Radial Tree Layout (Tree API) ===")();
                  log2("")();
                  log2("Flare visualization toolkit hierarchy (radial)")();
                  return log2("")();
                });
              });
            });
          });
        });
      }));
    };
  };
  var radialTreeViz = function(selector) {
    return launchAff_(bind217(loadFlareData)(function(result) {
      if (result instanceof Left) {
        return liftEffect115(log2("Failed to load Flare data: " + result.value0));
      }
      ;
      if (result instanceof Right) {
        return liftEffect115(drawRadialTree(selector)(result.value0));
      }
      ;
      throw new Error("Failed pattern match at D3.Viz.TreeAPI.RadialTreeViz (line 201, column 3 - line 203, column 70): " + [result.constructor.name]);
    }));
  };

  // output/D3.Viz.TreeAPI.SunburstViz/index.js
  var map68 = /* @__PURE__ */ map(functorMaybe);
  var map120 = /* @__PURE__ */ map(functorArray);
  var append27 = /* @__PURE__ */ append(semigroupArray);
  var bind69 = /* @__PURE__ */ bind(bindArray);
  var mod10 = /* @__PURE__ */ mod(euclideanRingInt);
  var show70 = /* @__PURE__ */ show(showNumber);
  var show135 = /* @__PURE__ */ show(showInt);
  var bind125 = /* @__PURE__ */ bind(bindD3v2M);
  var select35 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var discard55 = /* @__PURE__ */ discard(discardUnit)(bindD3v2M);
  var liftEffect38 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var width44 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height44 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox38 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var class_41 = /* @__PURE__ */ class_2(toAttrStringString);
  var d15 = /* @__PURE__ */ d4(toAttrStringString);
  var fill42 = /* @__PURE__ */ fill3(toAttrStringString);
  var fillOpacity9 = /* @__PURE__ */ fillOpacity(toAttrNumberNumber);
  var stroke32 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth32 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var renderTree54 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(/* @__PURE__ */ ordPartitionNode(ordString));
  var bind218 = /* @__PURE__ */ bind(bindAff);
  var liftEffect116 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var toHierarchyData3 = function(node) {
    return {
      data_: getName2(node),
      value: new Just(getValue2(node)),
      children: map68(map120(toHierarchyData3))(getChildren2(node))
    };
  };
  var getAllNodes3 = function(v) {
    var $40 = length(v.value0.children) === 0;
    if ($40) {
      return [v];
    }
    ;
    return append27([v])(bind69(v.value0.children)(getAllNodes3));
  };
  var colors3 = ["#e7ba52", "#c7c7c7", "#aec7e8", "#1f77b4", "#9467bd"];
  var getColor3 = function(depth) {
    var v = index(colors3)(mod10(depth)(length(colors3)));
    if (v instanceof Just) {
      return v.value0;
    }
    ;
    if (v instanceof Nothing) {
      return "#cccccc";
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.TreeAPI.SunburstViz (line 35, column 18 - line 37, column 23): " + [v.constructor.name]);
  };
  var arcPath = function(x0_) {
    return function(y0_) {
      return function(x1_) {
        return function(y1_) {
          return function(radius39) {
            var startAngle = x0_ * 2 * pi;
            var outerRadius = y1_ * radius39;
            var x102 = cos(startAngle) * outerRadius;
            var y102 = sin(startAngle) * outerRadius;
            var innerRadius = y0_ * radius39;
            var x00 = cos(startAngle) * innerRadius;
            var y00 = sin(startAngle) * innerRadius;
            var endAngle = x1_ * 2 * pi;
            var largeArc = (function() {
              var $44 = endAngle - startAngle > pi;
              if ($44) {
                return 1;
              }
              ;
              return 0;
            })();
            var x01 = cos(endAngle) * innerRadius;
            var x116 = cos(endAngle) * outerRadius;
            var y01 = sin(endAngle) * innerRadius;
            var y116 = sin(endAngle) * outerRadius;
            return "M" + (show70(x102) + ("," + (show70(y102) + ("A" + (show70(outerRadius) + ("," + (show70(outerRadius) + (" 0 " + (show135(largeArc) + (" 1 " + (show70(x116) + ("," + (show70(y116) + ("L" + (show70(x01) + ("," + (show70(y01) + ("A" + (show70(innerRadius) + ("," + (show70(innerRadius) + (" 0 " + (show135(largeArc) + (" 0 " + (show70(x00) + ("," + (show70(y00) + "Z")))))))))))))))))))))))))));
          };
        };
      };
    };
  };
  var drawSunburst = function(selector) {
    return function(flareData) {
      return runD3v2M(bind125(select35(selector))(function(container) {
        var radius39 = 700 / 2;
        var hierData = toHierarchyData3(flareData);
        var partRoot = hierarchy2(hierData);
        var config = {
          round: defaultPartitionConfig.round,
          size: {
            width: 1,
            height: 1
          },
          padding: 1e-3
        };
        var partitioned = partition3(config)(partRoot);
        var allNodes3 = getAllNodes3(partitioned);
        var nodes = filter(function(v) {
          return v.value0.depth > 0;
        })(allNodes3);
        return discard55(liftEffect38(log2("Rendering sunburst: " + (show135(length(nodes)) + " arcs"))))(function() {
          var tree3 = withChild(named2(SVG.value)("svg")([width44(700), height44(700), viewBox38(show70(-radius39) + (" " + (show70(-radius39) + (" " + (show70(700) + (" " + show70(700))))))), class_41("sunburst-viz")]))(joinData2("arcs")("g")(nodes)(function(v) {
            return withChild(named2(Group2.value)("arc-" + v.value0.data_)([class_41("node")]))(elem4(Path3.value)([d15(arcPath(v.value0.x0)(v.value0.y0)(v.value0.x1)(v.value0.y1)(radius39)), fill42(getColor3(v.value0.depth)), fillOpacity9(0.7), stroke32("#fff"), strokeWidth32(1)]));
          }));
          return bind125(renderTree54(container)(tree3))(function() {
            return liftEffect38(log2("=== Sunburst Diagram ===="));
          });
        });
      }));
    };
  };
  var sunburstViz = function(selector) {
    return launchAff_(bind218(loadDataFile(FlareJSON.value))(function(result) {
      if (result instanceof Left) {
        return liftEffect116(log2("Failed to load Flare data: " + result.value0));
      }
      ;
      if (result instanceof Right) {
        return liftEffect116(drawSunburst(selector)(parseFlareJson(result.value0)));
      }
      ;
      throw new Error("Failed pattern match at D3.Viz.TreeAPI.SunburstViz (line 140, column 3 - line 142, column 87): " + [result.constructor.name]);
    }));
  };

  // output/PSD3.Layout.Hierarchy.Types/index.js
  var VNode = /* @__PURE__ */ (function() {
    function VNode2(value0) {
      this.value0 = value0;
    }
    ;
    VNode2.create = function(value0) {
      return new VNode2(value0);
    };
    return VNode2;
  })();
  var HNode = /* @__PURE__ */ (function() {
    function HNode2(value0) {
      this.value0 = value0;
    }
    ;
    HNode2.create = function(value0) {
      return new HNode2(value0);
    };
    return HNode2;
  })();
  var getValue3 = function(v) {
    return v.value0.value;
  };

  // output/PSD3.Layout.Hierarchy.Core/index.js
  var map69 = /* @__PURE__ */ map(functorArray);
  var foldl15 = /* @__PURE__ */ foldl(foldableArray);
  var maximum10 = /* @__PURE__ */ maximum(ordInt)(foldableArray);
  var sum4 = function(v) {
    return function(valueAccessor) {
      var $22 = $$null(v.value0.children);
      if ($22) {
        return new VNode({
          data_: v.value0.data_,
          depth: v.value0.depth,
          height: v.value0.height,
          parent: Nothing.value,
          children: [],
          value: valueAccessor(v.value0.data_)
        });
      }
      ;
      var ownValue = valueAccessor(v.value0.data_);
      var childrenValued = map69(function(child) {
        return sum4(child)(valueAccessor);
      })(v.value0.children);
      var childrenSum = foldl15(function(acc) {
        return function(child) {
          return acc + getValue3(child);
        };
      })(0)(childrenValued);
      var totalValue = ownValue + childrenSum;
      return new VNode({
        data_: v.value0.data_,
        depth: v.value0.depth,
        height: v.value0.height,
        parent: Nothing.value,
        children: childrenValued,
        value: totalValue
      });
    };
  };
  var getHeight = function(v) {
    return v.value0.height;
  };
  var hierarchy3 = function(rootData) {
    return function(childrenAccessor) {
      var computeHeights = function(v) {
        var $31 = $$null(v.value0.children);
        if ($31) {
          return new HNode({
            data_: v.value0.data_,
            depth: v.value0.depth,
            parent: v.value0.parent,
            children: v.value0.children,
            height: 0
          });
        }
        ;
        var childrenWithHeights = map69(computeHeights)(v.value0.children);
        var childHeights = map69(getHeight)(childrenWithHeights);
        var maxChildHeight = fromMaybe(0)(maximum10(childHeights));
        return new HNode({
          data_: v.value0.data_,
          depth: v.value0.depth,
          parent: v.value0.parent,
          children: childrenWithHeights,
          height: maxChildHeight + 1 | 0
        });
      };
      var buildNode = function(parentRef) {
        return function(currentDepth) {
          return function(nodeData) {
            var v = childrenAccessor(nodeData);
            if (v instanceof Nothing) {
              return new HNode({
                data_: nodeData,
                depth: currentDepth,
                height: 0,
                parent: parentRef,
                children: []
              });
            }
            ;
            if (v instanceof Just) {
              var thisNode = new HNode({
                data_: nodeData,
                depth: currentDepth,
                height: 0,
                parent: parentRef,
                children: []
              });
              var builtChildren = map69(buildNode(new Just(thisNode))(currentDepth + 1 | 0))(v.value0);
              var nodeWithChildren = new HNode({
                data_: nodeData,
                depth: currentDepth,
                height: 0,
                parent: parentRef,
                children: builtChildren
              });
              return nodeWithChildren;
            }
            ;
            throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Core (line 25, column 7 - line 60, column 29): " + [v.constructor.name]);
          };
        };
      };
      return computeHeights(buildNode(Nothing.value)(0)(rootData));
    };
  };

  // output/PSD3.Layout.Hierarchy.Treemap/index.js
  var map70 = /* @__PURE__ */ map(functorArray);
  var foldl16 = /* @__PURE__ */ foldl(foldableArray);
  var append120 = /* @__PURE__ */ append(semigroupArray);
  var compare21 = /* @__PURE__ */ compare(ordInt);
  var compare112 = /* @__PURE__ */ compare(ordNumber);
  var max11 = /* @__PURE__ */ max(ordNumber);
  var min9 = /* @__PURE__ */ min(ordNumber);
  var TNode = /* @__PURE__ */ (function() {
    function TNode2(value0) {
      this.value0 = value0;
    }
    ;
    TNode2.create = function(value0) {
      return new TNode2(value0);
    };
    return TNode2;
  })();
  var toTreemapNode = function(v) {
    return new TNode({
      data_: v.value0.data_,
      depth: v.value0.depth,
      height: v.value0.height,
      value: v.value0.value,
      children: map70(toTreemapNode)(v.value0.children),
      x0: 0,
      y0: 0,
      x1: 0,
      y1: 0
    });
  };
  var slice4 = function(v) {
    return function(x0) {
      return function(y0) {
        return function(x116) {
          return function(y116) {
            var k = (function() {
              var $91 = v.value0.value !== 0;
              if ($91) {
                return (y116 - y0) / v.value0.value;
              }
              ;
              return 0;
            })();
            var positioned = foldl16(function(acc) {
              return function(child) {
                var height53 = child.value0.value * k;
                var positionedChild = new TNode({
                  data_: child.value0.data_,
                  depth: child.value0.depth,
                  height: child.value0.height,
                  value: child.value0.value,
                  children: child.value0.children,
                  x0,
                  x1: x116,
                  y0: acc.y,
                  y1: acc.y + height53
                });
                return {
                  children: snoc(acc.children)(positionedChild),
                  y: acc.y + height53
                };
              };
            })({
              children: [],
              y: y0
            })(v.value0.children);
            return new TNode({
              data_: v.value0.data_,
              depth: v.value0.depth,
              height: v.value0.height,
              value: v.value0.value,
              x0: v.value0.x0,
              y0: v.value0.y0,
              x1: v.value0.x1,
              y1: v.value0.y1,
              children: positioned.children
            });
          };
        };
      };
    };
  };
  var positionTree = function(config) {
    return function(v) {
      return function(paddingStack) {
        var p2 = (function() {
          var v1 = index(paddingStack)(v.value0.depth);
          if (v1 instanceof Just) {
            return v1.value0;
          }
          ;
          if (v1 instanceof Nothing) {
            return 0;
          }
          ;
          throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Treemap (line 112, column 9 - line 114, column 21): " + [v1.constructor.name]);
        })();
        var x0 = v.value0.x0 + p2;
        var x116 = v.value0.x1 - p2;
        var x0$prime = (function() {
          var $102 = x116 < x0;
          if ($102) {
            return (x0 + x116) / 2;
          }
          ;
          return x0;
        })();
        var x1$prime = (function() {
          var $103 = x116 < x0;
          if ($103) {
            return (x0 + x116) / 2;
          }
          ;
          return x116;
        })();
        var y0 = v.value0.y0 + p2;
        var y116 = v.value0.y1 - p2;
        var y0$prime = (function() {
          var $104 = y116 < y0;
          if ($104) {
            return (y0 + y116) / 2;
          }
          ;
          return y0;
        })();
        var y1$prime = (function() {
          var $105 = y116 < y0;
          if ($105) {
            return (y0 + y116) / 2;
          }
          ;
          return y116;
        })();
        var nodeWithPadding = new TNode({
          data_: v.value0.data_,
          depth: v.value0.depth,
          height: v.value0.height,
          value: v.value0.value,
          children: v.value0.children,
          x0: x0$prime,
          y0: y0$prime,
          x1: x1$prime,
          y1: y1$prime
        });
        var $106 = $$null(v.value0.children);
        if ($106) {
          return nodeWithPadding;
        }
        ;
        var innerPad = config.paddingInner / 2;
        var newPaddingStack = append120(paddingStack)([innerPad]);
        var childY1 = y1$prime - config.paddingBottom + innerPad;
        var childY0 = y0$prime + config.paddingTop - innerPad;
        var childY0$prime = (function() {
          var $107 = childY1 < childY0;
          if ($107) {
            return (childY0 + childY1) / 2;
          }
          ;
          return childY0;
        })();
        var childY1$prime = (function() {
          var $108 = childY1 < childY0;
          if ($108) {
            return (childY0 + childY1) / 2;
          }
          ;
          return childY1;
        })();
        var childX1 = x1$prime - config.paddingRight + innerPad;
        var childX0 = x0$prime + config.paddingLeft - innerPad;
        var childX0$prime = (function() {
          var $109 = childX1 < childX0;
          if ($109) {
            return (childX0 + childX1) / 2;
          }
          ;
          return childX0;
        })();
        var childX1$prime = (function() {
          var $110 = childX1 < childX0;
          if ($110) {
            return (childX0 + childX1) / 2;
          }
          ;
          return childX1;
        })();
        var nodeWithTiledChildren = config.tile(nodeWithPadding)(childX0$prime)(childY0$prime)(childX1$prime)(childY1$prime);
        var finalChildren = map70(function(child) {
          return positionTree(config)(child)(newPaddingStack);
        })(nodeWithTiledChildren.value0.children);
        return new TNode({
          data_: nodeWithTiledChildren.value0.data_,
          depth: nodeWithTiledChildren.value0.depth,
          height: nodeWithTiledChildren.value0.height,
          value: nodeWithTiledChildren.value0.value,
          x0: nodeWithTiledChildren.value0.x0,
          y0: nodeWithTiledChildren.value0.y0,
          x1: nodeWithTiledChildren.value0.x1,
          y1: nodeWithTiledChildren.value0.y1,
          children: finalChildren
        });
      };
    };
  };
  var treemap = function(config) {
    return function(valuedRoot) {
      var root3 = toTreemapNode(valuedRoot);
      var rootWithBounds = new TNode({
        data_: root3.value0.data_,
        depth: root3.value0.depth,
        height: root3.value0.height,
        value: root3.value0.value,
        children: root3.value0.children,
        x0: 0,
        y0: 0,
        x1: config.size.width,
        y1: config.size.height
      });
      var positioned = positionTree(config)(rootWithBounds)([]);
      return positioned;
    };
  };
  var phi = /* @__PURE__ */ (function() {
    return (1 + sqrt(5)) / 2;
  })();
  var eqTreemapNode = function(dictEq) {
    var eq27 = eq(dictEq);
    return {
      eq: function(x47) {
        return function(y48) {
          return eq(eqArray(eqTreemapNode(dictEq)))(x47.value0.children)(y48.value0.children) && eq27(x47.value0.data_)(y48.value0.data_) && x47.value0.depth === y48.value0.depth && x47.value0.height === y48.value0.height && x47.value0.value === y48.value0.value && x47.value0.x0 === y48.value0.x0 && x47.value0.x1 === y48.value0.x1 && x47.value0.y0 === y48.value0.y0 && x47.value0.y1 === y48.value0.y1;
        };
      }
    };
  };
  var ordTreemapNode = function(dictOrd) {
    var compare26 = compare(dictOrd);
    var eqTreemapNode1 = eqTreemapNode(dictOrd.Eq0());
    return {
      compare: function(x47) {
        return function(y48) {
          var v = compare(ordArray(ordTreemapNode(dictOrd)))(x47.value0.children)(y48.value0.children);
          if (v instanceof LT) {
            return LT.value;
          }
          ;
          if (v instanceof GT) {
            return GT.value;
          }
          ;
          var v1 = compare26(x47.value0.data_)(y48.value0.data_);
          if (v1 instanceof LT) {
            return LT.value;
          }
          ;
          if (v1 instanceof GT) {
            return GT.value;
          }
          ;
          var v2 = compare21(x47.value0.depth)(y48.value0.depth);
          if (v2 instanceof LT) {
            return LT.value;
          }
          ;
          if (v2 instanceof GT) {
            return GT.value;
          }
          ;
          var v3 = compare21(x47.value0.height)(y48.value0.height);
          if (v3 instanceof LT) {
            return LT.value;
          }
          ;
          if (v3 instanceof GT) {
            return GT.value;
          }
          ;
          var v4 = compare112(x47.value0.value)(y48.value0.value);
          if (v4 instanceof LT) {
            return LT.value;
          }
          ;
          if (v4 instanceof GT) {
            return GT.value;
          }
          ;
          var v5 = compare112(x47.value0.x0)(y48.value0.x0);
          if (v5 instanceof LT) {
            return LT.value;
          }
          ;
          if (v5 instanceof GT) {
            return GT.value;
          }
          ;
          var v6 = compare112(x47.value0.x1)(y48.value0.x1);
          if (v6 instanceof LT) {
            return LT.value;
          }
          ;
          if (v6 instanceof GT) {
            return GT.value;
          }
          ;
          var v7 = compare112(x47.value0.y0)(y48.value0.y0);
          if (v7 instanceof LT) {
            return LT.value;
          }
          ;
          if (v7 instanceof GT) {
            return GT.value;
          }
          ;
          return compare112(x47.value0.y1)(y48.value0.y1);
        };
      },
      Eq0: function() {
        return eqTreemapNode1;
      }
    };
  };
  var dice2 = function(v) {
    return function(x0) {
      return function(y0) {
        return function(x116) {
          return function(y116) {
            var k = (function() {
              var $137 = v.value0.value !== 0;
              if ($137) {
                return (x116 - x0) / v.value0.value;
              }
              ;
              return 0;
            })();
            var positioned = foldl16(function(acc) {
              return function(child) {
                var width53 = child.value0.value * k;
                var positionedChild = new TNode({
                  data_: child.value0.data_,
                  depth: child.value0.depth,
                  height: child.value0.height,
                  value: child.value0.value,
                  children: child.value0.children,
                  x0: acc.x,
                  x1: acc.x + width53,
                  y0,
                  y1: y116
                });
                return {
                  children: snoc(acc.children)(positionedChild),
                  x: acc.x + width53
                };
              };
            })({
              children: [],
              x: x0
            })(v.value0.children);
            return new TNode({
              data_: v.value0.data_,
              depth: v.value0.depth,
              height: v.value0.height,
              value: v.value0.value,
              x0: v.value0.x0,
              y0: v.value0.y0,
              x1: v.value0.x1,
              y1: v.value0.y1,
              children: positioned.children
            });
          };
        };
      };
    };
  };
  var squarifyRatio = function(ratio) {
    return function(v) {
      return function(initX0) {
        return function(initY0) {
          return function(initX1) {
            return function(initY1) {
              var n = length(v.value0.children);
              var go2 = function($copy_i0) {
                return function($copy_i1) {
                  return function($copy_x0) {
                    return function($copy_y0) {
                      return function($copy_x1) {
                        return function($copy_y1) {
                          return function($copy_remainingValue) {
                            return function($copy_acc) {
                              var $tco_var_i0 = $copy_i0;
                              var $tco_var_i1 = $copy_i1;
                              var $tco_var_x0 = $copy_x0;
                              var $tco_var_y0 = $copy_y0;
                              var $tco_var_x1 = $copy_x1;
                              var $tco_var_y1 = $copy_y1;
                              var $tco_var_remainingValue = $copy_remainingValue;
                              var $tco_done = false;
                              var $tco_result;
                              function $tco_loop(i0, i1, x0, y0, x116, y116, remainingValue, acc) {
                                var $150 = i0 >= n;
                                if ($150) {
                                  $tco_done = true;
                                  return acc;
                                }
                                ;
                                var findNonEmpty = function($copy_idx) {
                                  return function($copy_sv) {
                                    var $tco_var_idx = $copy_idx;
                                    var $tco_done1 = false;
                                    var $tco_result2;
                                    function $tco_loop2(idx, sv) {
                                      var $151 = idx >= n;
                                      if ($151) {
                                        $tco_done1 = true;
                                        return {
                                          i1: idx,
                                          sumValue: sv
                                        };
                                      }
                                      ;
                                      var v12 = (function() {
                                        var v2 = index(v.value0.children)(idx);
                                        if (v2 instanceof Just) {
                                          return v2.value0;
                                        }
                                        ;
                                        if (v2 instanceof Nothing) {
                                          return new TNode(v.value0);
                                        }
                                        ;
                                        throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Treemap (line 333, column 33 - line 335, column 44): " + [v2.constructor.name]);
                                      })();
                                      var $155 = v12.value0.value !== 0;
                                      if ($155) {
                                        $tco_done1 = true;
                                        return {
                                          i1: idx + 1 | 0,
                                          sumValue: v12.value0.value
                                        };
                                      }
                                      ;
                                      $tco_var_idx = idx + 1 | 0;
                                      $copy_sv = sv;
                                      return;
                                    }
                                    ;
                                    while (!$tco_done1) {
                                      $tco_result2 = $tco_loop2($tco_var_idx, $copy_sv);
                                    }
                                    ;
                                    return $tco_result2;
                                  };
                                };
                                var firstNode = findNonEmpty(i1)(0);
                                var dy4 = y116 - y0;
                                var dx = x116 - x0;
                                var alpha = max11(dy4 / dx)(dx / dy4) / (remainingValue * ratio);
                                var beta0 = firstNode.sumValue * firstNode.sumValue * alpha;
                                var tryAdd = function($copy_idx) {
                                  return function($copy_sumVal) {
                                    return function($copy_minVal) {
                                      return function($copy_maxVal) {
                                        return function($copy_minRat) {
                                          var $tco_var_idx = $copy_idx;
                                          var $tco_var_sumVal = $copy_sumVal;
                                          var $tco_var_minVal = $copy_minVal;
                                          var $tco_var_maxVal = $copy_maxVal;
                                          var $tco_done2 = false;
                                          var $tco_result2;
                                          function $tco_loop2(idx, sumVal, minVal, maxVal, minRat) {
                                            var $157 = idx >= n;
                                            if ($157) {
                                              $tco_done2 = true;
                                              return {
                                                i1: idx,
                                                sumValue: sumVal,
                                                minRatio: minRat
                                              };
                                            }
                                            ;
                                            var v12 = (function() {
                                              var v2 = index(v.value0.children)(idx);
                                              if (v2 instanceof Just) {
                                                return v2.value0;
                                              }
                                              ;
                                              if (v2 instanceof Nothing) {
                                                return new TNode(v.value0);
                                              }
                                              ;
                                              throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Treemap (line 356, column 31 - line 358, column 42): " + [v2.constructor.name]);
                                            })();
                                            var newSum = sumVal + v12.value0.value;
                                            var newMin = min9(minVal)(v12.value0.value);
                                            var newMax = max11(maxVal)(v12.value0.value);
                                            var newBeta = newSum * newSum * alpha;
                                            var newRatio = max11(newMax / newBeta)(newBeta / newMin);
                                            var $161 = newRatio > minRat;
                                            if ($161) {
                                              $tco_done2 = true;
                                              return {
                                                i1: idx,
                                                sumValue: sumVal,
                                                minRatio: minRat
                                              };
                                            }
                                            ;
                                            $tco_var_idx = idx + 1 | 0;
                                            $tco_var_sumVal = newSum;
                                            $tco_var_minVal = newMin;
                                            $tco_var_maxVal = newMax;
                                            $copy_minRat = newRatio;
                                            return;
                                          }
                                          ;
                                          while (!$tco_done2) {
                                            $tco_result2 = $tco_loop2($tco_var_idx, $tco_var_sumVal, $tco_var_minVal, $tco_var_maxVal, $copy_minRat);
                                          }
                                          ;
                                          return $tco_result2;
                                        };
                                      };
                                    };
                                  };
                                };
                                var v1 = (function() {
                                  var v2 = index(v.value0.children)(firstNode.i1 - 1 | 0);
                                  if (v2 instanceof Just) {
                                    return v2.value0;
                                  }
                                  ;
                                  if (v2 instanceof Nothing) {
                                    return new TNode(v.value0);
                                  }
                                  ;
                                  throw new Error("Failed pattern match at PSD3.Layout.Hierarchy.Treemap (line 370, column 30 - line 372, column 36): " + [v2.constructor.name]);
                                })();
                                var isDice = dx < dy4;
                                var initial = tryAdd(firstNode.i1)(firstNode.sumValue)(v1.value0.value)(v1.value0.value)(max11(v1.value0.value / beta0)(beta0 / v1.value0.value));
                                var rowChildren = slice(i0)(initial.i1)(v.value0.children);
                                var rowNode = new TNode({
                                  data_: v.value0.data_,
                                  depth: v.value0.depth,
                                  height: v.value0.height,
                                  x0: v.value0.x0,
                                  y0: v.value0.y0,
                                  x1: v.value0.x1,
                                  y1: v.value0.y1,
                                  children: rowChildren,
                                  value: initial.sumValue
                                });
                                var positioned = (function() {
                                  if (isDice) {
                                    var newY0 = (function() {
                                      var $167 = remainingValue !== 0;
                                      if ($167) {
                                        return y0 + dy4 * initial.sumValue / remainingValue;
                                      }
                                      ;
                                      return y116;
                                    })();
                                    var v2 = dice2(rowNode)(x0)(y0)(x116)(newY0);
                                    return {
                                      children: v2.value0.children,
                                      nextX0: x0,
                                      nextY0: newY0,
                                      nextX1: x116,
                                      nextY1: y116
                                    };
                                  }
                                  ;
                                  var newX0 = (function() {
                                    var $170 = remainingValue !== 0;
                                    if ($170) {
                                      return x0 + dx * initial.sumValue / remainingValue;
                                    }
                                    ;
                                    return x116;
                                  })();
                                  var v2 = slice4(rowNode)(x0)(y0)(newX0)(y116);
                                  return {
                                    children: v2.value0.children,
                                    nextX0: newX0,
                                    nextY0: y0,
                                    nextX1: x116,
                                    nextY1: y116
                                  };
                                })();
                                $tco_var_i0 = initial.i1;
                                $tco_var_i1 = initial.i1;
                                $tco_var_x0 = positioned.nextX0;
                                $tco_var_y0 = positioned.nextY0;
                                $tco_var_x1 = positioned.nextX1;
                                $tco_var_y1 = positioned.nextY1;
                                $tco_var_remainingValue = remainingValue - initial.sumValue;
                                $copy_acc = append120(acc)(positioned.children);
                                return;
                              }
                              ;
                              while (!$tco_done) {
                                $tco_result = $tco_loop($tco_var_i0, $tco_var_i1, $tco_var_x0, $tco_var_y0, $tco_var_x1, $tco_var_y1, $tco_var_remainingValue, $copy_acc);
                              }
                              ;
                              return $tco_result;
                            };
                          };
                        };
                      };
                    };
                  };
                };
              };
              return {
                children: go2(0)(0)(initX0)(initY0)(initX1)(initY1)(v.value0.value)([]),
                x0: initX0,
                y0: initY0
              };
            };
          };
        };
      };
    };
  };
  var squarify = function(ratio) {
    return function(v) {
      return function(x0) {
        return function(y0) {
          return function(x116) {
            return function(y116) {
              var result = squarifyRatio(ratio)(new TNode(v.value0))(x0)(y0)(x116)(y116);
              return new TNode({
                data_: v.value0.data_,
                depth: v.value0.depth,
                height: v.value0.height,
                value: v.value0.value,
                x0: v.value0.x0,
                y0: v.value0.y0,
                x1: v.value0.x1,
                y1: v.value0.y1,
                children: result.children
              });
            };
          };
        };
      };
    };
  };
  var defaultTreemapConfig = {
    size: {
      width: 1,
      height: 1
    },
    tile: /* @__PURE__ */ squarify(phi),
    round: false,
    paddingInner: 0,
    paddingOuter: 0,
    paddingTop: 0,
    paddingRight: 0,
    paddingBottom: 0,
    paddingLeft: 0
  };

  // output/D3.Viz.TreeAPI.TreemapViz/index.js
  var map71 = /* @__PURE__ */ map(functorArray);
  var bind70 = /* @__PURE__ */ bind(bindArray);
  var mod11 = /* @__PURE__ */ mod(euclideanRingInt);
  var bind126 = /* @__PURE__ */ bind(bindD3v2M);
  var select36 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var discard56 = /* @__PURE__ */ discard(discardUnit)(bindD3v2M);
  var liftEffect39 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var show71 = /* @__PURE__ */ show(showInt);
  var width45 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height45 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox39 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var show136 = /* @__PURE__ */ show(showNumber);
  var class_42 = /* @__PURE__ */ class_2(toAttrStringString);
  var x41 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y42 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var fill43 = /* @__PURE__ */ fill3(toAttrStringString);
  var fillOpacity10 = /* @__PURE__ */ fillOpacity(toAttrNumberNumber);
  var stroke33 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth33 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var textContent22 = /* @__PURE__ */ textContent(toAttrStringString);
  var textAnchor20 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var fontSize14 = /* @__PURE__ */ fontSize2(toAttrNumberNumber);
  var renderTree55 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(/* @__PURE__ */ ordTreemapNode(ordString));
  var bind219 = /* @__PURE__ */ bind(bindAff);
  var liftEffect117 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var mapValuedNode = function(f) {
    return function(v) {
      return new VNode({
        data_: f(v.value0.data_),
        depth: v.value0.depth,
        height: v.value0.height,
        parent: Nothing.value,
        children: map71(mapValuedNode(f))(v.value0.children),
        value: v.value0.value
      });
    };
  };
  var getLeaves = function(v) {
    var $44 = length(v.value0.children) === 0;
    if ($44) {
      return [v];
    }
    ;
    return bind70(v.value0.children)(getLeaves);
  };
  var colors4 = ["#e7ba52", "#c7c7c7", "#aec7e8", "#1f77b4", "#9467bd"];
  var getColor4 = function(depth) {
    var v = index(colors4)(mod11(depth)(length(colors4)));
    if (v instanceof Just) {
      return v.value0;
    }
    ;
    if (v instanceof Nothing) {
      return "#cccccc";
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.TreeAPI.TreemapViz (line 28, column 18 - line 30, column 23): " + [v.constructor.name]);
  };
  var drawTreemap = function(selector) {
    return function(flareData) {
      return runD3v2M(bind126(select36(selector))(function(container) {
        var h = hierarchy3(flareData)(getChildren2);
        var valued = sum4(h)(getValue2);
        var stringValued = mapValuedNode(getName2)(valued);
        var config = {
          paddingBottom: defaultTreemapConfig.paddingBottom,
          paddingInner: defaultTreemapConfig.paddingInner,
          paddingLeft: defaultTreemapConfig.paddingLeft,
          paddingOuter: defaultTreemapConfig.paddingOuter,
          paddingRight: defaultTreemapConfig.paddingRight,
          paddingTop: defaultTreemapConfig.paddingTop,
          round: defaultTreemapConfig.round,
          size: {
            width: 750,
            height: 500
          },
          tile: squarify(phi)
        };
        var layout = treemap(config)(stringValued);
        var leaves = getLeaves(layout);
        return discard56(liftEffect39(log2("Rendering treemap: " + (show71(length(leaves)) + " rectangles"))))(function() {
          var tree3 = withChild(named2(SVG.value)("svg")([width45(750), height45(500), viewBox39("0 0 " + (show136(750) + (" " + show136(500)))), class_42("treemap-viz")]))(joinData2("rects")("g")(leaves)(function(v) {
            return withChildren(named2(Group2.value)("rect-" + v.value0.data_)([class_42("node")]))([elem4(Rect2.value)([x41(v.value0.x0), y42(v.value0.y0), width45(v.value0.x1 - v.value0.x0), height45(v.value0.y1 - v.value0.y0), fill43(getColor4(v.value0.depth)), fillOpacity10(0.6), stroke33("#fff"), strokeWidth33(1)]), elem4(Text3.value)([x41((v.value0.x0 + v.value0.x1) / 2), y42((v.value0.y0 + v.value0.y1) / 2), textContent22(v.value0.data_), textAnchor20("middle"), fontSize14(9), fillOpacity10((function() {
              var $49 = v.value0.x1 - v.value0.x0 > 30 && v.value0.y1 - v.value0.y0 > 15;
              if ($49) {
                return 1;
              }
              ;
              return 0;
            })())])]);
          }));
          return bind126(renderTree55(container)(tree3))(function() {
            return liftEffect39(log2("=== Treemap Layout (Tree API) ==="));
          });
        });
      }));
    };
  };
  var treemapViz = function(selector) {
    return launchAff_(bind219(loadDataFile(FlareJSON.value))(function(result) {
      if (result instanceof Left) {
        return liftEffect117(log2("Failed to load Flare data: " + result.value0));
      }
      ;
      if (result instanceof Right) {
        return liftEffect117(drawTreemap(selector)(parseFlareJson(result.value0)));
      }
      ;
      throw new Error("Failed pattern match at D3.Viz.TreeAPI.TreemapViz (line 120, column 3 - line 122, column 86): " + [result.constructor.name]);
    }));
  };

  // output/Component.Tour.TourHierarchies/index.js
  var discard57 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var pure63 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize30 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var render34 = function(v) {
    return div2([classes(["tutorial-page"])])([renderHeader2(TourHierarchies.value), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("3. Hierarchical Layouts")]), p_([text2("Hierarchical data structures are everywhere in computing: file systems, organizational charts, taxonomies, JSON documents, and abstract syntax trees. Different visualization layouts reveal different aspects of the same hierarchical data.")]), p_([text2("This page demonstrates different ways to visualize hierarchical datasets. Use the links below to explore each layout type and see how each representation emphasizes different relationships in the data.")])]), section([classes(["tutorial-section"]), id3("node-link")])([h2([classes(["tutorial-section-title"])])([text2("1. Node-Link Diagrams (Trees and Dendrograms)")]), p_([text2("Node-link diagrams show hierarchies as connected nodes, with parent-child relationships represented by links. These layouts can be oriented horizontally, vertically, or radially.")]), h3_([text2("Vertical Tidy Tree")]), p_([text2("Root at the top, grows downward. Compact tidy tree layout using the Reingold-Tilford algorithm. Common in organizational charts.")]), div2([id3("tree-viz"), classes(["viz-container"])])([]), h3_([text2("Horizontal Tidy Tree")]), p_([text2("Root on the left, grows to the right. Efficient use of horizontal space.")]), div2([id3("horizontal-tree-viz"), classes(["viz-container"])])([]), h3_([text2("Radial Tidy Tree")]), p_([text2("Emanates from center in a circular layout. Space-efficient for large hierarchies.")]), div2([id3("radial-tree-viz"), classes(["viz-container"])])([]), h3_([text2("Dendrograms (Cluster Diagrams)")]), p_([text2("Dendrogram layouts place all leaf nodes at the same level, creating a uniform appearance useful for comparing leaf nodes.")]), div2([id3("cluster-viz"), classes(["viz-container"])])([]), p_([text2("We also have an interactive demo showing "), a([href("#" + routeToPath(AnimatedTreeCluster.value))])([text2("animated transitions between Tree and Cluster layouts")]), text2(" that demonstrates how the same data looks different with these two algorithms.")])]), section([classes(["tutorial-section"]), id3("adjacency")])([h2([classes(["tutorial-section-title"])])([text2("2. Adjacency Diagrams (Icicle/Sunburst)")]), p_([text2("Adjacency diagrams show hierarchy through relative placement of rectangles or arcs. They're space-efficient and can encode quantitative values through area.")]), h3_([text2("Icicle Diagram (Partition)")]), p_([text2("Rectangular subdivisions showing hierarchy through relative placement. Each level of the hierarchy is a horizontal band, with children subdividing their parent's width. Area encodes quantitative values.")]), div2([id3("partition-viz"), classes(["viz-container"])])([]), h3_([text2("Sunburst Diagram")]), p_([text2("The radial equivalent of icicle diagrams. The root is at the center, and each ring represents a level of the hierarchy. Angular width represents quantitative value or number of children.")]), div2([id3("sunburst-viz"), classes(["viz-container"])])([])]), section([classes(["tutorial-section"]), id3("enclosure")])([h2([classes(["tutorial-section-title"])])([text2("3. Enclosure Diagrams (Treemap and Circle Packing)")]), p_([text2("Enclosure diagrams show hierarchy through containment, where parent elements completely enclose their children. These layouts efficiently use space and make quantitative comparisons easy.")]), h3_([text2("Treemap")]), p_([text2("Space-efficient rectangular subdivisions where area is proportional to value. Treemaps show hierarchy through nesting and excel at displaying large amounts of hierarchical data in a compact space. The recursive subdivision algorithm creates rectangles whose area represents quantitative values.")]), div2([id3("treemap-viz"), classes(["viz-container"])])([]), h3_([text2("Circle Packing")]), p_([text2("Tightly nested circles showing hierarchy through containment. Area encodes values, and the circular layout readily shows topology. The packing algorithm positions circles to minimize wasted space while maintaining clear hierarchical relationships.")]), div2([id3("pack-viz"), classes(["viz-container"])])([])]), section([classes(["tutorial-section"]), id3("edge-bundling")])([h2([classes(["tutorial-section-title"])])([text2("4. Hierarchical Edge Bundling")]), p_([text2("Edge bundling is a technique for reducing visual clutter in graphs with many edges. Edges are bundled together along the hierarchical structure, creating visually appealing flow patterns that reveal high-level connectivity patterns.")]), p_([text2("This technique is particularly effective for visualizing dependencies, relationships, or flows in large hierarchical datasets like software dependencies, communication networks, or biological pathways.")]), p_([em_([text2("[Edge bundling not yet implemented in TreeAPI - coming soon]")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Interactive Exploration")]), p_([text2("To see a working example of hierarchical layouts with interactive switching between tree and cluster algorithms, visit the "), a([href("#" + routeToPath(AnimatedTreeCluster.value))])([text2("Animated Tree \u2194 Cluster demo")]), text2(" which shows smooth transitions between different layouts of the same hierarchical data.")]), p_([text2("More hierarchical layout examples will be added to the "), a([href("#" + routeToPath(Gallery.value))])([text2("Examples Gallery")]), text2(" as they are implemented in TreeAPI.")])])])]);
  };
  var handleAction29 = function(dictMonadAff) {
    var liftEffect51 = liftEffect(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    return function(v) {
      return discard57(liftEffect51(treeViz("#tree-viz")))(function() {
        return discard57(liftEffect51(horizontalTreeViz("#horizontal-tree-viz")))(function() {
          return discard57(liftEffect51(radialTreeViz("#radial-tree-viz")))(function() {
            return discard57(liftEffect51(clusterViz("#cluster-viz")))(function() {
              return discard57(liftEffect51(partitionViz("#partition-viz")))(function() {
                return discard57(liftEffect51(sunburstViz("#sunburst-viz")))(function() {
                  return discard57(liftEffect51(treemapViz("#treemap-viz")))(function() {
                    return discard57(liftEffect51(packViz("#pack-viz")))(function() {
                      return pure63(unit);
                    });
                  });
                });
              });
            });
          });
        });
      });
    };
  };
  var component30 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render34,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction29(dictMonadAff),
        initialize: new Just(Initialize30.value)
      })
    });
  };

  // output/Component.Tour.TourIndex/index.js
  var pure64 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize31 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var renderCard2 = function(route) {
    return function(title4) {
      return function(description) {
        return a([classes(["howto-card"]), href("#" + routeToPath(route))])([h3([classes(["howto-card__title"])])([text2(title4)]), p([classes(["howto-card__description"])])([text2(description)])]);
      };
    };
  };
  var render35 = function(v) {
    return div2([classes(["docs-page", "tour-index"])])([render5({
      logoSize: Large.value,
      quadrant: NoQuadrant.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), section([classes(["docs-hero"])])([div2([classes(["docs-hero-content"])])([h1([classes(["docs-hero-title"])])([text2("Tour")]), p([classes(["docs-hero-description"])])([text2("A progressive tour of PSD3's capabilities. Start with foundations and build up to complex interactive visualizations.")])])]), section([classes(["docs-section"])])([h2([classes(["docs-section-title"])])([text2("Getting Started")]), div2([classes(["howto-card-grid"])])([renderCard2(TourFoundations.value)("Foundations")("Three circles, matrix, parabola, bar chart. The building blocks."), renderCard2(TourProfessional.value)("Typical Charts")("Multiline, grouped bar, radial stacked. Professional-grade visualizations."), renderCard2(TourFlow.value)("Data Flow")("Chord and Sankey diagrams. Visualizing flows and relationships.")])]), section([classes(["docs-section"])])([h2([classes(["docs-section-title"])])([text2("Structure & Motion")]), div2([classes(["howto-card-grid"])])([renderCard2(TourHierarchies.value)("Hierarchies")("Tree layouts, treemap, pack, icicle. All hierarchical visualizations."), renderCard2(TourMotion.value)("Motion & Transitions")("Smooth animations between states. Bringing visualizations to life.")])]), section([classes(["docs-section"])])([h2([classes(["docs-section-title"])])([text2("Advanced Topics")]), div2([classes(["howto-card-grid"])])([renderCard2(TourInterpreters.value)("Alternative Interpreters")("Mermaid diagrams, English descriptions, and code generators."), renderCard2(TourFPFTW.value)("FP For The Win")("Maps, Sets, contravariant attributes. Leveraging functional programming."), renderCard2(TourGraphAlgorithms.value)("Graph Algorithms")("Topological sort, transitive reduction. Graph theory in action."), renderCard2(TourLesMisGUP.value)("General Update Pattern")("Dynamic data updates with smooth transitions. The heart of D3.")])])]);
  };
  var handleAction30 = function(v) {
    return pure64(unit);
  };
  var component31 = /* @__PURE__ */ (function() {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render35,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction30,
        initialize: new Just(Initialize31.value)
      })
    });
  })();

  // output/D3.Viz.TreeAPI.InterpreterDemo/index.js
  var width46 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height46 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox40 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var class_43 = /* @__PURE__ */ class_2(toAttrStringString);
  var cx34 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy34 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius33 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill44 = /* @__PURE__ */ fill3(toAttrStringString);
  var x42 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y43 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var threeLittleCircles2 = /* @__PURE__ */ (function() {
    return withChild(named2(SVG.value)("svg")([width46(300), height46(100), viewBox40("0 0 300 100")]))(withChildren(named2(Group2.value)("circles")([class_43("circles-group")]))([elem4(Circle2.value)([cx34(50), cy34(50), radius33(20), fill44("red")]), elem4(Circle2.value)([cx34(150), cy34(50), radius33(20), fill44("green")]), elem4(Circle2.value)([cx34(250), cy34(50), radius33(20), fill44("blue")])]));
  })();
  var simpleBarChartNoJoin = /* @__PURE__ */ (function() {
    return withChild(named2(SVG.value)("svg")([width46(400), height46(200), viewBox40("0 0 400 200"), class_43("bar-chart")]))(withChildren(named2(Group2.value)("bars")([class_43("bars-group")]))([elem4(Rect2.value)([x42(20), y43(130), width46(50), height46(50), fill44("steelblue")]), elem4(Rect2.value)([x42(90), y43(55), width46(50), height46(125), fill44("steelblue")]), elem4(Rect2.value)([x42(160), y43(105), width46(50), height46(75), fill44("steelblue")]), elem4(Rect2.value)([x42(230), y43(30), width46(50), height46(150), fill44("steelblue")]), elem4(Rect2.value)([x42(300), y43(80), width46(50), height46(100), fill44("steelblue")])]));
  })();
  var nestedStructure = /* @__PURE__ */ (function() {
    return withChild(named2(SVG.value)("svg")([width46(200), height46(200), viewBox40("0 0 200 200")]))(withChild(named2(Group2.value)("outer")([]))(withChildren(named2(Group2.value)("inner")([]))([elem4(Circle2.value)([cx34(100), cy34(100), radius33(50), fill44("purple")]), elem4(Text3.value)([x42(100), y43(105), textContent(toAttrStringString)("Hello!"), fill44("white")])])));
  })();

  // output/PSD3.Shared.Mermaid/foreign.js
  var logMessage = (msg) => () => {
    console.log(msg);
  };
  var renderMermaidDiagrams_ = () => {
    console.log("FFI: renderMermaidDiagrams_ effect executing");
    requestAnimationFrame(() => {
      console.log("FFI: requestAnimationFrame callback executing");
      try {
        if (typeof window.mermaid === "undefined" || typeof window.mermaid.render !== "function") {
          console.log("Mermaid not loaded/initialized yet, will retry...");
          setTimeout(() => renderMermaidDiagrams_()(), 500);
          return;
        }
        console.log("Mermaid is loaded, looking for diagram elements...");
        const elements = document.querySelectorAll(".mermaid:not([data-rendered])");
        console.log(`Found ${elements.length} Mermaid diagram elements`);
        if (elements.length === 0) {
          console.log("No unrendered Mermaid diagrams found");
          return;
        }
        console.log(`Processing ${elements.length} Mermaid diagrams...`);
        elements.forEach(async (element3, index5) => {
          try {
            console.log(`Processing diagram ${index5 + 1}...`);
            element3.setAttribute("data-rendered", "true");
            let graphDefinition = element3.textContent || element3.innerText;
            console.log(`Diagram ${index5 + 1} text length: ${graphDefinition.length}`);
            const id5 = "mermaid-" + Math.random().toString(36).substr(2, 9);
            const { svg: svg2 } = await window.mermaid.render(id5, graphDefinition);
            element3.innerHTML = svg2;
            console.log(`\u2713 Rendered Mermaid diagram ${index5 + 1}: ${id5}`);
          } catch (error4) {
            console.error(`\u2717 Failed to render Mermaid diagram ${index5 + 1}:`, error4);
            element3.innerHTML = '<div style="color: red; padding: 1rem; border: 1px solid red;">Failed to render diagram: ' + error4.message + "</div>";
          }
        });
      } catch (error4) {
        console.error("Error in requestAnimationFrame callback:", error4);
      }
    });
    console.log("FFI: requestAnimationFrame scheduled");
  };

  // output/PSD3.Shared.Mermaid/index.js
  var discard58 = /* @__PURE__ */ discard(discardUnit);
  var append28 = /* @__PURE__ */ append(semigroupArray);
  var triggerMermaidRendering = function(dictMonadEffect) {
    var liftEffect51 = liftEffect(dictMonadEffect);
    return discard58(dictMonadEffect.Monad0().Bind1())(liftEffect51(logMessage("PureScript: triggerMermaidRendering called")))(function() {
      return liftEffect51(renderMermaidDiagrams_);
    });
  };
  var mermaidDiagram = function(code2) {
    return function(className2) {
      return div2([classes(append28(["mermaid-container"])((function() {
        if (className2 instanceof Nothing) {
          return [];
        }
        ;
        if (className2 instanceof Just) {
          return [className2.value0];
        }
        ;
        throw new Error("Failed pattern match at PSD3.Shared.Mermaid (line 22, column 9 - line 24, column 43): " + [className2.constructor.name]);
      })()))])([div2([classes(["mermaid"])])([text2(code2)])]);
    };
  };

  // output/Control.Monad.Writer/index.js
  var unwrap8 = /* @__PURE__ */ unwrap();
  var runWriter = function($5) {
    return unwrap8(runWriterT($5));
  };

  // output/PSD3v2.Interpreter.English/index.js
  var show72 = /* @__PURE__ */ show(showNumber);
  var show137 = /* @__PURE__ */ show(showBoolean);
  var discard59 = /* @__PURE__ */ discard(discardUnit)(/* @__PURE__ */ bindWriterT(semigroupString)(bindIdentity));
  var tell2 = /* @__PURE__ */ tell(/* @__PURE__ */ monadTellWriterT(monoidString)(monadIdentity));
  var applicativeWriterT2 = /* @__PURE__ */ applicativeWriterT(monoidString)(applicativeIdentity);
  var when5 = /* @__PURE__ */ when(applicativeWriterT2);
  var for_3 = /* @__PURE__ */ for_(applicativeWriterT2)(foldableArray);
  var show212 = /* @__PURE__ */ show(showInt);
  var showElemType = function(v) {
    if (v instanceof SVG) {
      return "SVG container";
    }
    ;
    if (v instanceof Group2) {
      return "group";
    }
    ;
    if (v instanceof Circle2) {
      return "circle";
    }
    ;
    if (v instanceof Rect2) {
      return "rectangle";
    }
    ;
    if (v instanceof Path3) {
      return "path";
    }
    ;
    if (v instanceof Line2) {
      return "line";
    }
    ;
    if (v instanceof Text3) {
      return "text";
    }
    ;
    if (v instanceof Div2) {
      return "div";
    }
    ;
    if (v instanceof Span2) {
      return "span";
    }
    ;
    if (v instanceof Table2) {
      return "table";
    }
    ;
    if (v instanceof Tbody) {
      return "table body";
    }
    ;
    if (v instanceof Thead) {
      return "table head";
    }
    ;
    if (v instanceof Tr2) {
      return "table row";
    }
    ;
    if (v instanceof Td2) {
      return "table cell";
    }
    ;
    if (v instanceof Th) {
      return "table header";
    }
    ;
    throw new Error("Failed pattern match at PSD3v2.Interpreter.English (line 84, column 1 - line 84, column 38): " + [v.constructor.name]);
  };
  var showAttrValue = function(v) {
    if (v instanceof StringValue) {
      return '"' + (v.value0 + '"');
    }
    ;
    if (v instanceof NumberValue) {
      return show72(v.value0);
    }
    ;
    if (v instanceof BooleanValue) {
      return show137(v.value0);
    }
    ;
    throw new Error("Failed pattern match at PSD3v2.Interpreter.English (line 106, column 1 - line 106, column 42): " + [v.constructor.name]);
  };
  var showAttrName = function(v) {
    return v;
  };
  var indent = function(v) {
    if (v === 0) {
      return "";
    }
    ;
    return "  " + indent(v - 1 | 0);
  };
  var describeAttribute = function(v) {
    if (v instanceof StaticAttr) {
      return "Set " + (showAttrName(v.value0) + (" to " + showAttrValue(v.value1)));
    }
    ;
    if (v instanceof DataAttr) {
      return "Set " + (showAttrName(v.value0) + " based on data (dynamic)");
    }
    ;
    if (v instanceof IndexedAttr) {
      return "Set " + (showAttrName(v.value0) + " based on data and index (dynamic)");
    }
    ;
    throw new Error("Failed pattern match at PSD3v2.Interpreter.English (line 73, column 1 - line 73, column 61): " + [v.constructor.name]);
  };
  var describeTree = function(tree3) {
    return function(level) {
      if (tree3 instanceof Node3) {
        return discard59((function() {
          if (tree3.value0.name instanceof Just) {
            return tell2(indent(level) + ("Create a " + (showElemType(tree3.value0.elemType) + (' named "' + (tree3.value0.name.value0 + '"')))));
          }
          ;
          if (tree3.value0.name instanceof Nothing) {
            return tell2(indent(level) + ("Create a " + showElemType(tree3.value0.elemType)));
          }
          ;
          throw new Error("Failed pattern match at PSD3v2.Interpreter.English (line 25, column 5 - line 27, column 77): " + [tree3.value0.name.constructor.name]);
        })())(function() {
          return discard59(when5(!$$null(tree3.value0.attrs))(discard59(tell2(" with attributes:\n"))(function() {
            return for_3(tree3.value0.attrs)(function(attr3) {
              return tell2(indent(level + 1 | 0) + (describeAttribute(attr3) + "\n"));
            });
          })))(function() {
            return when5(!$$null(tree3.value0.children))(discard59(tell2(indent(level) + ("Then add " + (show212(length(tree3.value0.children)) + " child element(s):\n"))))(function() {
              return for_3(tree3.value0.children)(function(child) {
                return describeTree(child)(level + 1 | 0);
              });
            }));
          });
        });
      }
      ;
      if (tree3 instanceof Join2) {
        return discard59(tell2(indent(level) + ("For each of " + (show212(length(tree3.value0.joinData)) + " data items, "))))(function() {
          return discard59(tell2("create a " + (tree3.value0.key + (' (join named "' + (tree3.value0.name + '")')))))(function() {
            return discard59(tell2(" using data-driven attributes\n"))(function() {
              return tell2(indent(level + 1 | 0) + "(Template function defined for creating elements from data)\n");
            });
          });
        });
      }
      ;
      if (tree3 instanceof NestedJoin) {
        return discard59(tell2(indent(level) + ("For each of " + (show212(length(tree3.value0.joinData)) + " nested data items, "))))(function() {
          return discard59(tell2("create a " + (tree3.value0.key + (' (nested join named "' + (tree3.value0.name + '")')))))(function() {
            return discard59(tell2(" using data-driven attributes\n"))(function() {
              return tell2(indent(level + 1 | 0) + "(Nested template function defined)\n");
            });
          });
        });
      }
      ;
      if (tree3 instanceof SceneJoin) {
        return discard59(tell2(indent(level) + ("For each of " + (show212(length(tree3.value0.joinData)) + " data items, "))))(function() {
          return discard59(tell2("create/update/remove " + (tree3.value0.key + (' (scene join named "' + (tree3.value0.name + '")')))))(function() {
            return discard59(tell2(" with General Update Pattern:\n"))(function() {
              return discard59(when5(isJust(tree3.value0.enterBehavior))(tell2(indent(level + 1 | 0) + "- Enter: elements appear with initial attributes and transition\n")))(function() {
                return discard59(when5(isJust(tree3.value0.updateBehavior))(tell2(indent(level + 1 | 0) + "- Update: elements transition to new state\n")))(function() {
                  return discard59(when5(isJust(tree3.value0.exitBehavior))(tell2(indent(level + 1 | 0) + "- Exit: elements transition out then removed\n")))(function() {
                    return tell2(indent(level + 1 | 0) + "(Template function defined for creating elements from data)\n");
                  });
                });
              });
            });
          });
        });
      }
      ;
      if (tree3 instanceof SceneNestedJoin) {
        return discard59(tell2(indent(level) + ("For each of " + (show212(length(tree3.value0.joinData)) + " nested data items, "))))(function() {
          return discard59(tell2("decompose and create/update/remove " + (tree3.value0.key + (' (scene nested join named "' + (tree3.value0.name + '")')))))(function() {
            return discard59(tell2(" with General Update Pattern:\n"))(function() {
              return discard59(when5(isJust(tree3.value0.enterBehavior))(tell2(indent(level + 1 | 0) + "- Enter: elements appear with initial attributes and transition\n")))(function() {
                return discard59(when5(isJust(tree3.value0.updateBehavior))(tell2(indent(level + 1 | 0) + "- Update: elements transition to new state\n")))(function() {
                  return discard59(when5(isJust(tree3.value0.exitBehavior))(tell2(indent(level + 1 | 0) + "- Exit: elements transition out then removed\n")))(function() {
                    return tell2(indent(level + 1 | 0) + "(Decompose and template functions defined)\n");
                  });
                });
              });
            });
          });
        });
      }
      ;
      throw new Error("Failed pattern match at PSD3v2.Interpreter.English (line 23, column 27 - line 70, column 80): " + [tree3.constructor.name]);
    };
  };
  var runEnglish = function(tree3) {
    return snd(runWriter(describeTree(tree3)(0)));
  };

  // output/PSD3v2.Interpreter.MetaAST/index.js
  var map72 = /* @__PURE__ */ map(functorArray);
  var show73 = /* @__PURE__ */ show(showInt);
  var intercalate6 = /* @__PURE__ */ intercalate2(monoidString);
  var show138 = /* @__PURE__ */ show(showBoolean);
  var NodeAST = /* @__PURE__ */ (function() {
    function NodeAST2(value0) {
      this.value0 = value0;
    }
    ;
    NodeAST2.create = function(value0) {
      return new NodeAST2(value0);
    };
    return NodeAST2;
  })();
  var JoinAST = /* @__PURE__ */ (function() {
    function JoinAST2(value0) {
      this.value0 = value0;
    }
    ;
    JoinAST2.create = function(value0) {
      return new JoinAST2(value0);
    };
    return JoinAST2;
  })();
  var NestedJoinAST = /* @__PURE__ */ (function() {
    function NestedJoinAST2(value0) {
      this.value0 = value0;
    }
    ;
    NestedJoinAST2.create = function(value0) {
      return new NestedJoinAST2(value0);
    };
    return NestedJoinAST2;
  })();
  var SceneJoinAST = /* @__PURE__ */ (function() {
    function SceneJoinAST2(value0) {
      this.value0 = value0;
    }
    ;
    SceneJoinAST2.create = function(value0) {
      return new SceneJoinAST2(value0);
    };
    return SceneJoinAST2;
  })();
  var SceneNestedJoinAST = /* @__PURE__ */ (function() {
    function SceneNestedJoinAST2(value0) {
      this.value0 = value0;
    }
    ;
    SceneNestedJoinAST2.create = function(value0) {
      return new SceneNestedJoinAST2(value0);
    };
    return SceneNestedJoinAST2;
  })();
  var showElemType2 = function(v) {
    if (v instanceof SVG) {
      return "SVG";
    }
    ;
    if (v instanceof Group2) {
      return "Group";
    }
    ;
    if (v instanceof Circle2) {
      return "Circle";
    }
    ;
    if (v instanceof Rect2) {
      return "Rect";
    }
    ;
    if (v instanceof Path3) {
      return "Path";
    }
    ;
    if (v instanceof Line2) {
      return "Line";
    }
    ;
    if (v instanceof Text3) {
      return "Text";
    }
    ;
    if (v instanceof Div2) {
      return "Div";
    }
    ;
    if (v instanceof Span2) {
      return "Span";
    }
    ;
    if (v instanceof Table2) {
      return "Table";
    }
    ;
    if (v instanceof Tbody) {
      return "Tbody";
    }
    ;
    if (v instanceof Thead) {
      return "Thead";
    }
    ;
    if (v instanceof Tr2) {
      return "Tr";
    }
    ;
    if (v instanceof Td2) {
      return "Td";
    }
    ;
    if (v instanceof Th) {
      return "Th";
    }
    ;
    throw new Error("Failed pattern match at PSD3v2.Interpreter.MetaAST (line 185, column 1 - line 185, column 38): " + [v.constructor.name]);
  };
  var toAST = function(tree3) {
    if (tree3 instanceof Node3) {
      return new NodeAST({
        name: tree3.value0.name,
        elemType: showElemType2(tree3.value0.elemType),
        attrCount: length(tree3.value0.attrs),
        children: map72(toAST)(tree3.value0.children)
      });
    }
    ;
    if (tree3 instanceof Join2) {
      return new JoinAST({
        name: tree3.value0.name,
        key: tree3.value0.key,
        dataCount: length(tree3.value0.joinData),
        hasTemplate: true
      });
    }
    ;
    if (tree3 instanceof NestedJoin) {
      return new NestedJoinAST({
        name: tree3.value0.name,
        key: tree3.value0.key,
        dataCount: length(tree3.value0.joinData),
        hasTemplate: true
      });
    }
    ;
    if (tree3 instanceof SceneJoin) {
      return new SceneJoinAST({
        name: tree3.value0.name,
        key: tree3.value0.key,
        dataCount: length(tree3.value0.joinData),
        hasEnter: (function() {
          if (tree3.value0.enterBehavior instanceof Just) {
            return true;
          }
          ;
          if (tree3.value0.enterBehavior instanceof Nothing) {
            return false;
          }
          ;
          throw new Error("Failed pattern match at PSD3v2.Interpreter.MetaAST (line 89, column 19 - line 91, column 27): " + [tree3.value0.enterBehavior.constructor.name]);
        })(),
        hasUpdate: (function() {
          if (tree3.value0.updateBehavior instanceof Just) {
            return true;
          }
          ;
          if (tree3.value0.updateBehavior instanceof Nothing) {
            return false;
          }
          ;
          throw new Error("Failed pattern match at PSD3v2.Interpreter.MetaAST (line 92, column 20 - line 94, column 27): " + [tree3.value0.updateBehavior.constructor.name]);
        })(),
        hasExit: (function() {
          if (tree3.value0.exitBehavior instanceof Just) {
            return true;
          }
          ;
          if (tree3.value0.exitBehavior instanceof Nothing) {
            return false;
          }
          ;
          throw new Error("Failed pattern match at PSD3v2.Interpreter.MetaAST (line 95, column 18 - line 97, column 27): " + [tree3.value0.exitBehavior.constructor.name]);
        })(),
        hasTemplate: true
      });
    }
    ;
    if (tree3 instanceof SceneNestedJoin) {
      return new SceneNestedJoinAST({
        name: tree3.value0.name,
        key: tree3.value0.key,
        dataCount: length(tree3.value0.joinData),
        hasEnter: (function() {
          if (tree3.value0.enterBehavior instanceof Just) {
            return true;
          }
          ;
          if (tree3.value0.enterBehavior instanceof Nothing) {
            return false;
          }
          ;
          throw new Error("Failed pattern match at PSD3v2.Interpreter.MetaAST (line 106, column 19 - line 108, column 27): " + [tree3.value0.enterBehavior.constructor.name]);
        })(),
        hasUpdate: (function() {
          if (tree3.value0.updateBehavior instanceof Just) {
            return true;
          }
          ;
          if (tree3.value0.updateBehavior instanceof Nothing) {
            return false;
          }
          ;
          throw new Error("Failed pattern match at PSD3v2.Interpreter.MetaAST (line 109, column 20 - line 111, column 27): " + [tree3.value0.updateBehavior.constructor.name]);
        })(),
        hasExit: (function() {
          if (tree3.value0.exitBehavior instanceof Just) {
            return true;
          }
          ;
          if (tree3.value0.exitBehavior instanceof Nothing) {
            return false;
          }
          ;
          throw new Error("Failed pattern match at PSD3v2.Interpreter.MetaAST (line 112, column 18 - line 114, column 27): " + [tree3.value0.exitBehavior.constructor.name]);
        })(),
        hasTemplate: true
      });
    }
    ;
    throw new Error("Failed pattern match at PSD3v2.Interpreter.MetaAST (line 59, column 14 - line 116, column 8): " + [tree3.constructor.name]);
  };
  var prettyPrintAST = function(ast) {
    var power = function(v) {
      return function(v1) {
        if (v1 === 0) {
          return "";
        }
        ;
        return v + power(v)(v1 - 1 | 0);
      };
    };
    var indent2 = function(n) {
      return power("  ")(n);
    };
    var prettyPrint = function(tree3) {
      return function(level) {
        if (tree3 instanceof NodeAST) {
          var nameStr = (function() {
            if (tree3.value0.name instanceof Just) {
              return '"' + (tree3.value0.name.value0 + '"');
            }
            ;
            if (tree3.value0.name instanceof Nothing) {
              return "anonymous";
            }
            ;
            throw new Error("Failed pattern match at PSD3v2.Interpreter.MetaAST (line 125, column 23 - line 127, column 37): " + [tree3.value0.name.constructor.name]);
          })();
          var childrenStr = (function() {
            var $85 = length(tree3.value0.children) > 0;
            if ($85) {
              return "\n" + (indent2(level + 1 | 0) + (", children: " + (show73(length(tree3.value0.children)) + (" nodes\n" + intercalate6("\n")(map72(function(c) {
                return prettyPrint(c)(level + 2 | 0);
              })(tree3.value0.children))))));
            }
            ;
            return "";
          })();
          return indent2(level) + ("NodeAST\n" + (indent2(level + 1 | 0) + ("{ name: " + (nameStr + ("\n" + (indent2(level + 1 | 0) + (", elemType: " + (tree3.value0.elemType + ("\n" + (indent2(level + 1 | 0) + (", attrCount: " + (show73(tree3.value0.attrCount) + (childrenStr + ("\n" + (indent2(level) + "}")))))))))))))));
        }
        ;
        if (tree3 instanceof JoinAST) {
          return indent2(level) + ("JoinAST\n" + (indent2(level + 1 | 0) + ('{ name: "' + (tree3.value0.name + ('"\n' + (indent2(level + 1 | 0) + (', key: "' + (tree3.value0.key + ('"\n' + (indent2(level + 1 | 0) + (", dataCount: " + (show73(tree3.value0.dataCount) + ("\n" + (indent2(level + 1 | 0) + (", hasTemplate: " + (show138(tree3.value0.hasTemplate) + ("\n" + (indent2(level) + "}"))))))))))))))))));
        }
        ;
        if (tree3 instanceof NestedJoinAST) {
          return indent2(level) + ("NestedJoinAST\n" + (indent2(level + 1 | 0) + ('{ name: "' + (tree3.value0.name + ('"\n' + (indent2(level + 1 | 0) + (', key: "' + (tree3.value0.key + ('"\n' + (indent2(level + 1 | 0) + (", dataCount: " + (show73(tree3.value0.dataCount) + ("\n" + (indent2(level + 1 | 0) + (", hasTemplate: " + (show138(tree3.value0.hasTemplate) + ("\n" + (indent2(level) + "}"))))))))))))))))));
        }
        ;
        if (tree3 instanceof SceneJoinAST) {
          return indent2(level) + ("SceneJoinAST\n" + (indent2(level + 1 | 0) + ('{ name: "' + (tree3.value0.name + ('"\n' + (indent2(level + 1 | 0) + (', key: "' + (tree3.value0.key + ('"\n' + (indent2(level + 1 | 0) + (", dataCount: " + (show73(tree3.value0.dataCount) + ("\n" + (indent2(level + 1 | 0) + (", hasEnter: " + (show138(tree3.value0.hasEnter) + ("\n" + (indent2(level + 1 | 0) + (", hasUpdate: " + (show138(tree3.value0.hasUpdate) + ("\n" + (indent2(level + 1 | 0) + (", hasExit: " + (show138(tree3.value0.hasExit) + ("\n" + (indent2(level + 1 | 0) + (", hasTemplate: " + (show138(tree3.value0.hasTemplate) + ("\n" + (indent2(level) + "}"))))))))))))))))))))))))))))));
        }
        ;
        if (tree3 instanceof SceneNestedJoinAST) {
          return indent2(level) + ("SceneNestedJoinAST\n" + (indent2(level + 1 | 0) + ('{ name: "' + (tree3.value0.name + ('"\n' + (indent2(level + 1 | 0) + (', key: "' + (tree3.value0.key + ('"\n' + (indent2(level + 1 | 0) + (", dataCount: " + (show73(tree3.value0.dataCount) + ("\n" + (indent2(level + 1 | 0) + (", hasEnter: " + (show138(tree3.value0.hasEnter) + ("\n" + (indent2(level + 1 | 0) + (", hasUpdate: " + (show138(tree3.value0.hasUpdate) + ("\n" + (indent2(level + 1 | 0) + (", hasExit: " + (show138(tree3.value0.hasExit) + ("\n" + (indent2(level + 1 | 0) + (", hasTemplate: " + (show138(tree3.value0.hasTemplate) + ("\n" + (indent2(level) + "}"))))))))))))))))))))))))))))));
        }
        ;
        throw new Error("Failed pattern match at PSD3v2.Interpreter.MetaAST (line 123, column 30 - line 175, column 31): " + [tree3.constructor.name]);
      };
    };
    return prettyPrint(ast)(0);
  };

  // output/Component.Tour.TourInterpreters/index.js
  var show74 = /* @__PURE__ */ show(showInt);
  var append121 = /* @__PURE__ */ append(semigroupArray);
  var cx35 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy35 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius34 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill45 = /* @__PURE__ */ fill3(toAttrStringString);
  var stroke34 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth34 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var x43 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y44 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var textContent23 = /* @__PURE__ */ textContent(toAttrStringString);
  var textAnchor21 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var x113 = /* @__PURE__ */ x1(toAttrNumberNumber);
  var y113 = /* @__PURE__ */ y1(toAttrNumberNumber);
  var x214 = /* @__PURE__ */ x22(toAttrNumberNumber);
  var y214 = /* @__PURE__ */ y22(toAttrNumberNumber);
  var width47 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height47 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox41 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var transform17 = /* @__PURE__ */ transform2(toAttrStringString);
  var discard60 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var bind71 = /* @__PURE__ */ bind(bindD3v2M);
  var select37 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var renderTree56 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(ordUnit);
  var pure65 = /* @__PURE__ */ pure(applicativeD3v2M);
  var bind127 = /* @__PURE__ */ bind(bindHalogenM);
  var modify_17 = /* @__PURE__ */ modify_2(monadStateHalogenM);
  var pure120 = /* @__PURE__ */ pure(applicativeHalogenM);
  var ExThreeLittleCircles = /* @__PURE__ */ (function() {
    function ExThreeLittleCircles2() {
    }
    ;
    ExThreeLittleCircles2.value = new ExThreeLittleCircles2();
    return ExThreeLittleCircles2;
  })();
  var ExBarChart = /* @__PURE__ */ (function() {
    function ExBarChart2() {
    }
    ;
    ExBarChart2.value = new ExBarChart2();
    return ExBarChart2;
  })();
  var ExNestedStructure = /* @__PURE__ */ (function() {
    function ExNestedStructure2() {
    }
    ;
    ExNestedStructure2.value = new ExNestedStructure2();
    return ExNestedStructure2;
  })();
  var Initialize32 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var SelectExample = /* @__PURE__ */ (function() {
    function SelectExample3(value0) {
      this.value0 = value0;
    }
    ;
    SelectExample3.create = function(value0) {
      return new SelectExample3(value0);
    };
    return SelectExample3;
  })();
  var eqExampleSelection = {
    eq: function(x310) {
      return function(y310) {
        if (x310 instanceof ExThreeLittleCircles && y310 instanceof ExThreeLittleCircles) {
          return true;
        }
        ;
        if (x310 instanceof ExBarChart && y310 instanceof ExBarChart) {
          return true;
        }
        ;
        if (x310 instanceof ExNestedStructure && y310 instanceof ExNestedStructure) {
          return true;
        }
        ;
        return false;
      };
    }
  };
  var eq11 = /* @__PURE__ */ eq(eqExampleSelection);
  var interpreterFlowDiagram = '\ngraph TB\n    Code["PureScript Visualization Code<br/>(TreeAPI DSL)"]\n\n    Code --> D3["D3/DOM Interpreter"]\n    Code --> English["English Description Interpreter"]\n    Code --> Mermaid["Mermaid Diagram Interpreter"]\n    Code --> Meta["Meta/AST Interpreter"]\n\n    D3 --> Output1["HTML & SVG<br/>Interactive Visualizations"]\n    English --> Output2["Natural Language Description<br/>How the viz is built"]\n    Mermaid --> Output3["Mermaid Syntax<br/>\u2192 AST Flowchart Diagram"]\n    Meta --> Output4["PureScript Data Structure<br/>\u2192 Visual Tree Diagram<br/>(Future: WYSIWYG Editor!)"]\n\n    style Code fill:#e1f5ff,stroke:#4a90e2,stroke-width:3px\n    style D3 fill:#d4edda,stroke:#28a745,stroke-width:2px\n    style English fill:#fff3cd,stroke:#ffc107,stroke-width:2px\n    style Mermaid fill:#f8d7da,stroke:#dc3545,stroke-width:2px\n    style Meta fill:#e7d4f5,stroke:#9b4ae2,stroke-width:2px\n    style Output1 fill:#d4edda,stroke:#28a745,stroke-width:2px\n    style Output2 fill:#fff3cd,stroke:#ffc107,stroke-width:2px\n    style Output3 fill:#f8d7da,stroke:#dc3545,stroke-width:2px\n    style Output4 fill:#e7d4f5,stroke:#9b4ae2,stroke-width:2px\n';
  var render36 = function(state3) {
    return div2([classes(["tutorial-page"])])([renderHeader2(TourInterpreters.value), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("6. Alternative Interpreters")]), p_([text2("TreeAPI is a grammar, not just an API. The same visualization code can be interpreted in multiple ways, each serving a different purpose:")]), div2([style("margin: 30px 0; background: #f9f9f9; padding: 20px; border-radius: 8px;")])([h3([style("margin-top: 0; text-align: center; color: #555;")])([text2("The Interpreter Pattern: One Code, Multiple Outputs")]), mermaidDiagram(interpreterFlowDiagram)(new Just("interpreter-overview"))]), p_([text2("Below, we demonstrate each interpreter using different examples. Choose an example to see how each interpreter handles increasing complexity:")]), div2([classes(["example-selector"]), style("margin: 20px 0; text-align: center;")])([button([classes(["example-button", (function() {
      var $63 = eq11(state3.selectedExample)(ExThreeLittleCircles.value);
      if ($63) {
        return "active";
      }
      ;
      return "";
    })()]), onClick(function(v) {
      return new SelectExample(ExThreeLittleCircles.value);
    })])([text2("Three Little Circles")]), button([classes(["example-button", (function() {
      var $64 = eq11(state3.selectedExample)(ExBarChart.value);
      if ($64) {
        return "active";
      }
      ;
      return "";
    })()]), onClick(function(v) {
      return new SelectExample(ExBarChart.value);
    })])([text2("Bar Chart (Data Join)")]), button([classes(["example-button", (function() {
      var $65 = eq11(state3.selectedExample)(ExNestedStructure.value);
      if ($65) {
        return "active";
      }
      ;
      return "";
    })()]), onClick(function(v) {
      return new SelectExample(ExNestedStructure.value);
    })])([text2("Nested Structure")])]), div2([id3("d3-output"), classes(["viz-container"]), style("text-align: center; margin: 20px 0;")])([]), p_([text2("This demonstrates that TreeAPI separates ")]), em_([text2("structure")]), text2(" (what operations we want) from "), em_([text2("interpretation")]), text2(" (how they execute). Each interpreter below shows a different view of the same code.")]), section([classes(["tutorial-section"]), id3("english")])([h2([classes(["tutorial-section-title"])])([text2("1. English Description Interpreter")]), p_([text2("This interpreter translates the TreeAPI code into plain English, describing HOW the visualization is built (not what it looks like). Perfect for documentation and understanding code structure.")]), pre([classes(["code-output"]), style("background: #f5f5f5; padding: 15px; border-radius: 5px; overflow-x: auto; color: #333;")])([text2(state3.englishDesc)])]), section([classes(["tutorial-section"]), id3("mermaid")])([h2([classes(["tutorial-section-title"])])([text2("2. Mermaid Diagram Interpreter")]), p_([text2("This interpreter generates Mermaid diagram syntax, representing the visualization structure as a flowchart. Perfect for documentation and architectural overviews. "), strong_([text2("Below we feed this generated code back into Mermaid to prove it works!")])]), div2([style("margin: 20px 0;")])([h3([style("margin-top: 0; font-size: 14px; color: #666;")])([text2("Generated Mermaid Code:")]), pre([classes(["code-output"]), style("background: #f5f5f5; padding: 15px; border-radius: 5px; overflow-x: auto; color: #333; margin: 0 0 20px 0; max-height: 200px; overflow-y: auto;")])([text2(state3.mermaidCode)]), h3([style("margin-top: 0; font-size: 14px; color: #666;")])([text2("Rendered Diagram (Inception!):")]), mermaidDiagram(state3.mermaidCode)(Nothing.value)]), p_([text2("Visit the "), a([href("#" + routeToPath(MermaidTreeDemo.value))])([text2("Mermaid Tree Visualizer")]), text2(" to see more interactive Mermaid diagrams.")])]), section([classes(["tutorial-section"]), id3("meta-tree")])([h2([classes(["tutorial-section-title"])])([text2("3. Meta/AST Interpreter - Code as Data")]), p_([text2("This interpreter produces a PureScript data structure representation of the tree itself. It demonstrates that the visualization code IS data that can be inspected and manipulated. "), strong_([text2("Below we visualize the AST structure itself using TreeAPI - pure inception!")])]), div2([style("display: flex; gap: 20px; margin: 20px 0;")])([div2([style("flex: 1;")])([h3([style("margin-top: 0; font-size: 14px; color: #666;")])([text2("Generated AST Code:")]), pre([classes(["code-output"]), style("background: #f5f5f5; padding: 15px; border-radius: 5px; overflow-x: auto; font-size: 12px; color: #333; margin: 0; max-height: 400px;")])([text2(state3.astCode)])]), div2([style("flex: 1;")])([h3([style("margin-top: 0; font-size: 14px; color: #666;")])([text2("Visualized AST Tree (Inception!):")]), div2([id3("ast-viz-output"), classes(["viz-container"]), style("border: 1px solid #ddd; border-radius: 5px; background: white;")])([])])]), p_([text2("This is particularly powerful because it:")]), ul_([li_([text2("Visualizes code as data - the DSL is itself manipulable data")]), li_([text2("Shows the tree structure explicitly as PureScript types")]), li_([text2("Enables metaprogramming - you can write code that analyzes or transforms visualizations")]), li_([text2("Demonstrates self-hosting - the system can describe itself")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("The Power of Multiple Interpreters")]), p_([text2("The Finally Tagless pattern gives us remarkable flexibility. By writing our visualization code once in a polymorphic style, we can interpret it in multiple ways without changing the source. This enables:")]), ul_([li_([text2("Better documentation - generate explanations alongside visualizations")]), li_([text2("Multi-target output - produce SVG, Canvas, or code in different languages")]), li_([text2("Meta-programming - analyze and transform visualization code programmatically")]), li_([text2("Testing - verify behavior using alternative interpreters")]), li_([text2("Optimization - choose the best interpreter for different contexts")])]), p_([text2("This approach demonstrates that data visualization can benefit from advanced programming language techniques, bringing type safety, composability, and flexibility to a domain traditionally dominated by imperative JavaScript code.")])])])]);
  };
  var getExampleTree = function(v) {
    if (v instanceof ExThreeLittleCircles) {
      return threeLittleCircles2;
    }
    ;
    if (v instanceof ExBarChart) {
      return simpleBarChartNoJoin;
    }
    ;
    if (v instanceof ExNestedStructure) {
      return nestedStructure;
    }
    ;
    throw new Error("Failed pattern match at Component.Tour.TourInterpreters (line 252, column 1 - line 252, column 50): " + [v.constructor.name]);
  };
  var astToTreeVisualization = function(ast) {
    var renderASTNode = function(node) {
      return function(xPos) {
        return function(level) {
          if (node instanceof NodeAST) {
            var label5 = (function() {
              if (node.value0.name instanceof Just) {
                return node.value0.elemType + (": " + node.value0.name.value0);
              }
              ;
              if (node.value0.name instanceof Nothing) {
                return node.value0.elemType;
              }
              ;
              throw new Error("Failed pattern match at Component.Tour.TourInterpreters (line 79, column 21 - line 81, column 34): " + [node.value0.name.constructor.name]);
            })();
            var childCount = length(node.value0.children);
            var startX = xPos - 120 * (toNumber(childCount) - 1) / 2;
            return withChildren(named2(Group2.value)("node-" + show74(level))([]))(append121([elem4(Circle2.value)([cx35(xPos), cy35(toNumber(level) * 80), radius34(30), fill45("#4A90E2"), stroke34("#2E5C8A"), strokeWidth34(2)]), elem4(Text3.value)([x43(xPos), y44(toNumber(level) * 80 + 5), textContent23(label5), textAnchor21("middle"), fill45("white")]), elem4(Text3.value)([x43(xPos), y44(toNumber(level) * 80 + 45), textContent23("attrs: " + show74(node.value0.attrCount)), textAnchor21("middle"), fill45("#666")])])(append121(mapWithIndex2(function(i2) {
              return function(v) {
                var childY = toNumber(level + 1 | 0) * 80;
                var childX = startX + toNumber(i2) * 120;
                return elem4(Line2.value)([x113(xPos), y113(toNumber(level) * 80 + 30), x214(childX), y214(childY - 30), stroke34("#999"), strokeWidth34(1.5)]);
              };
            })(node.value0.children))(mapWithIndex2(function(i2) {
              return function(child) {
                var childX = startX + toNumber(i2) * 120;
                return renderASTNode(child)(childX)(level + 1 | 0);
              };
            })(node.value0.children))));
          }
          ;
          if (node instanceof JoinAST) {
            return withChildren(named2(Group2.value)("join-" + show74(level))([]))([elem4(Circle2.value)([cx35(xPos), cy35(toNumber(level) * 80), radius34(30), fill45("#E27A4A"), stroke34("#8A472E"), strokeWidth34(2)]), elem4(Text3.value)([x43(xPos), y44(toNumber(level) * 80 + 5), textContent23("Join: " + node.value0.name), textAnchor21("middle"), fill45("white")]), elem4(Text3.value)([x43(xPos), y44(toNumber(level) * 80 + 45), textContent23("data: " + show74(node.value0.dataCount)), textAnchor21("middle"), fill45("#666")])]);
          }
          ;
          if (node instanceof NestedJoinAST) {
            return withChildren(named2(Group2.value)("nested-join-" + show74(level))([]))([elem4(Circle2.value)([cx35(xPos), cy35(toNumber(level) * 80), radius34(30), fill45("#9B4AE2"), stroke34("#5C2E8A"), strokeWidth34(2)]), elem4(Text3.value)([x43(xPos), y44(toNumber(level) * 80 + 5), textContent23("NestedJoin: " + node.value0.name), textAnchor21("middle"), fill45("white")]), elem4(Text3.value)([x43(xPos), y44(toNumber(level) * 80 + 45), textContent23("data: " + show74(node.value0.dataCount)), textAnchor21("middle"), fill45("#666")])]);
          }
          ;
          if (node instanceof SceneJoinAST) {
            return withChildren(named2(Group2.value)("scene-join-" + show74(level))([]))([elem4(Circle2.value)([cx35(xPos), cy35(toNumber(level) * 80), radius34(30), fill45("#4AE2A4"), stroke34("#2E8A5C"), strokeWidth34(2)]), elem4(Text3.value)([x43(xPos), y44(toNumber(level) * 80 + 5), textContent23("SceneJoin: " + node.value0.name), textAnchor21("middle"), fill45("white")]), elem4(Text3.value)([x43(xPos), y44(toNumber(level) * 80 + 45), textContent23("data: " + (show74(node.value0.dataCount) + (" {" + ((function() {
              if (node.value0.hasEnter) {
                return "E";
              }
              ;
              return "";
            })() + ((function() {
              if (node.value0.hasUpdate) {
                return "U";
              }
              ;
              return "";
            })() + ((function() {
              if (node.value0.hasExit) {
                return "X";
              }
              ;
              return "";
            })() + "}")))))), textAnchor21("middle"), fill45("#666")])]);
          }
          ;
          if (node instanceof SceneNestedJoinAST) {
            return withChildren(named2(Group2.value)("scene-nested-join-" + show74(level))([]))([elem4(Circle2.value)([cx35(xPos), cy35(toNumber(level) * 80), radius34(30), fill45("#E2A44A"), stroke34("#8A5C2E"), strokeWidth34(2)]), elem4(Text3.value)([x43(xPos), y44(toNumber(level) * 80 + 5), textContent23("SceneNestedJoin: " + node.value0.name), textAnchor21("middle"), fill45("white")]), elem4(Text3.value)([x43(xPos), y44(toNumber(level) * 80 + 45), textContent23("data: " + (show74(node.value0.dataCount) + (" {" + ((function() {
              if (node.value0.hasEnter) {
                return "E";
              }
              ;
              return "";
            })() + ((function() {
              if (node.value0.hasUpdate) {
                return "U";
              }
              ;
              return "";
            })() + ((function() {
              if (node.value0.hasExit) {
                return "X";
              }
              ;
              return "";
            })() + "}")))))), textAnchor21("middle"), fill45("#666")])]);
          }
          ;
          throw new Error("Failed pattern match at Component.Tour.TourInterpreters (line 77, column 37 - line 249, column 14): " + [node.constructor.name]);
        };
      };
    };
    return withChild(named2(SVG.value)("svg")([width47(600), height47(400), viewBox41("0 0 600 400")]))(withChild(named2(Group2.value)("ast-tree")([transform17("translate(300, 50)")]))(renderASTNode(ast)(0)(0)));
  };
  var renderExample = function(dictMonadAff) {
    var monadEffectHalogenM2 = monadEffectHalogenM(dictMonadAff.MonadEffect0());
    var liftEffect51 = liftEffect(monadEffectHalogenM2);
    var triggerMermaidRendering8 = triggerMermaidRendering(monadEffectHalogenM2);
    return function(selection2) {
      var tree3 = getExampleTree(selection2);
      return discard60(liftEffect51(runD3v2M(bind71(select37("#d3-output"))(function(container) {
        return bind71(renderTree56(container)(tree3))(function() {
          return pure65(unit);
        });
      }))))(function() {
        var english = runEnglish(tree3);
        return bind127(liftEffect51(runMermaidTree(tree3)))(function(mermaid) {
          var ast = toAST(tree3);
          var astPretty = prettyPrintAST(ast);
          var astTree = astToTreeVisualization(ast);
          return discard60(liftEffect51(runD3v2M(bind71(select37("#ast-viz-output"))(function(astContainer) {
            return bind71(renderTree56(astContainer)(astTree))(function() {
              return pure65(unit);
            });
          }))))(function() {
            return discard60(modify_17(function(v) {
              var $99 = {};
              for (var $100 in v) {
                if ({}.hasOwnProperty.call(v, $100)) {
                  $99[$100] = v[$100];
                }
                ;
              }
              ;
              $99.englishDesc = english;
              $99.mermaidCode = mermaid;
              $99.astCode = astPretty;
              return $99;
            }))(function() {
              return discard60(triggerMermaidRendering8)(function() {
                return pure120(unit);
              });
            });
          });
        });
      });
    };
  };
  var handleAction31 = function(dictMonadAff) {
    var liftAff3 = liftAff(monadAffHalogenM(dictMonadAff));
    var renderExample1 = renderExample(dictMonadAff);
    return function(v) {
      if (v instanceof Initialize32) {
        return discard60(liftAff3(delay(100)))(function() {
          return renderExample1(ExThreeLittleCircles.value);
        });
      }
      ;
      if (v instanceof SelectExample) {
        return discard60(modify_17(function(v1) {
          var $103 = {};
          for (var $104 in v1) {
            if ({}.hasOwnProperty.call(v1, $104)) {
              $103[$104] = v1[$104];
            }
            ;
          }
          ;
          $103.selectedExample = v.value0;
          return $103;
        }))(function() {
          return renderExample1(v.value0);
        });
      }
      ;
      throw new Error("Failed pattern match at Component.Tour.TourInterpreters (line 295, column 16 - line 308, column 28): " + [v.constructor.name]);
    };
  };
  var component32 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return {
          englishDesc: "",
          mermaidCode: "",
          astCode: "",
          selectedExample: ExThreeLittleCircles.value
        };
      },
      render: render36,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction31(dictMonadAff),
        initialize: new Just(Initialize32.value)
      })
    });
  };

  // output/Component.Tour.TourLesMisGUP/index.js
  var discard61 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var bind72 = /* @__PURE__ */ bind(bindHalogenM);
  var fromFoldable52 = /* @__PURE__ */ fromFoldable8(foldableArray)(ordString);
  var modify_18 = /* @__PURE__ */ modify_2(monadStateHalogenM);
  var get21 = /* @__PURE__ */ get(monadStateHalogenM);
  var bind128 = /* @__PURE__ */ bind(bindD3v2SimM);
  var pure66 = /* @__PURE__ */ pure(applicativeD3v2SimM);
  var pure121 = /* @__PURE__ */ pure(applicativeHalogenM);
  var show75 = /* @__PURE__ */ show(showInt);
  var Initialize33 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var FilterNodes4 = /* @__PURE__ */ (function() {
    function FilterNodes5(value0) {
      this.value0 = value0;
    }
    ;
    FilterNodes5.create = function(value0) {
      return new FilterNodes5(value0);
    };
    return FilterNodes5;
  })();
  var render37 = function(v) {
    return div2([classes(["tutorial-page"])])([renderHeader2(TourLesMisGUP.value), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("General Update Pattern: Dynamic Graphs")]), p_([text2("The "), strong_([text2("General Update Pattern (GUP)")]), text2(" is D3's approach to handling changing data. When your dataset changes, you need to:")]), ul_([li_([strong_([text2("Enter: ")]), text2("Create new elements for new data")]), li_([strong_([text2("Update: ")]), text2("Modify existing elements for persisting data")]), li_([strong_([text2("Exit: ")]), text2("Remove old elements for deleted data")])]), p_([text2("Below, watch as nodes randomly enter and exit the graph every few seconds. The TreeAPI handles all the complexity automatically:")])]), section([classes(["tutorial-section"]), id3("lesmis-gup-demo")])([h2([classes(["tutorial-section-title"])])([text2("Try the Pattern Yourself")]), p_([text2("Click the buttons below to filter nodes by group. Watch how nodes enter (appear), update (stay), and exit (disappear):")]), div2([classes(["button-group"]), style("text-align: center; margin: 20px 0;")])([button([classes(["control-button"]), onClick(function(v1) {
      return new FilterNodes4(0);
    })])([text2("All Nodes (77)")]), button([classes(["control-button"]), onClick(function(v1) {
      return new FilterNodes4(5);
    })])([text2("Group \u2265 5")]), button([classes(["control-button"]), onClick(function(v1) {
      return new FilterNodes4(8);
    })])([text2("Group \u2265 8")])]), div2([id3("lesmis-gup-viz"), classes(["viz-container"]), style("margin: 20px 0; text-align: center; min-height: 600px;")])([]), p_([text2("Notice how:")]), ul_([li_([strong_([text2("Entering nodes")]), text2(" appear at phylotaxis (spiral) positions and animate into place")]), li_([strong_([text2("Staying nodes")]), text2(" maintain their positions and group colors")]), li_([strong_([text2("Exiting nodes")]), text2(" and their links are removed from the simulation")]), li_([strong_([text2("Links")]), text2(" are automatically filtered to only connect visible nodes")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("How TreeAPI Handles GUP")]), p_([text2("With traditional D3, you manually handle enter/update/exit with verbose code. With TreeAPI, you just call "), code_([text2("joinData")]), text2(" and get three selections back:")]), pre([classes(["code-block"]), style("background: #f5f5f5; padding: 15px; border-radius: 5px; overflow-x: auto;")])([code_([text2('-- Join new data with existing elements\nJoinResult { enter, update, exit } <- joinData newNodes "circle" nodeGroup\n\n-- ENTER: Create new elements (green initially)\nenterNodes <- renderData Circle\n  [ fill "green", radius 5.0, ... ]\n  enter\n\n-- Transition enter nodes to final color\nwithTransition enterTransition enterNodes\n  [ fill \\\\n -> groupColor n.group ]\n\n-- UPDATE: Update existing elements\nsetAttrs [ fill \\\\n -> groupColor n.group ] update\n\n-- EXIT: Transition out and remove\nsetAttrsExit [ fill "brown" ] exit\nwithTransitionExit exitTransition exit []')])]), p_([text2("The TreeAPI:")]), ul_([li_([text2("Automatically tracks which elements correspond to which data (via key function)")]), li_([text2("Separates new data (enter), existing data (update), and removed data (exit)")]), li_([text2("Handles transitions and removals declaratively")]), li_([text2("Updates the simulation state to match the new graph structure")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Why GUP Matters")]), p_([text2("The General Update Pattern is essential for real-world visualizations:")]), ul_([li_([strong_([text2("Streaming data: ")]), text2("Real-time dashboards where data arrives continuously")]), li_([strong_([text2("User interactions: ")]), text2("Filtering, searching, or drilling down changes what's displayed")]), li_([strong_([text2("Animations: ")]), text2("Smooth transitions make changes comprehensible instead of jarring")]), li_([strong_([text2("Code clarity: ")]), text2("Declarative approach is easier to understand and maintain")])]), p_([text2("This pattern works for any visualization - bar charts, network graphs, maps, timelines. Master it once, use it everywhere.")])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Explore More")]), p_([text2("See the full-featured version with manual controls, grid layout, and phylotaxis at "), a([href("#" + routeToPath(LesMisGUPTree.value))])([text2("Les Mis\xE9rables GUP Tree")]), text2(".")]), p_([text2("Or continue the tour to see more advanced examples in "), a([href("#" + routeToPath(TourShowcase.value))])([text2("Showcase")]), text2(".")])])])]);
  };
  var forces8 = /* @__PURE__ */ (function() {
    return {
      manyBodyNeg: createForce("many body negative")(new RegularForce(ForceManyBody.value))(allNodes)([strengthVal(-100)]),
      collision: createForce("collision")(new RegularForce(ForceCollide.value))(allNodes)([radiusVal(6)]),
      center: createForce("center")(new RegularForce(ForceCenter.value))(allNodes)([xVal(0), yVal(0), strengthVal(0.1)]),
      links: createLinkForce(allNodes)([])
    };
  })();
  var handleAction32 = function(dictMonadAff) {
    var log9 = log3(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    var liftAff3 = liftAff(monadAffHalogenM(dictMonadAff));
    return function(v) {
      if (v instanceof Initialize33) {
        return discard61(log9("TourLesMisGUP: Initializing"))(function() {
          return discard61(liftAff3(delay(100)))(function() {
            return bind72(liftAff3(get3(string)("./data/miserables.json")))(function(lesMisResponse) {
              return discard61((function() {
                if (lesMisResponse instanceof Left) {
                  return log9("Failed to load Les Mis\xE9rables data");
                }
                ;
                if (lesMisResponse instanceof Right) {
                  var graph = readGraphFromFileContents(new Right(lesMisResponse.value0));
                  var forcesArray = [forces8.manyBodyNeg, forces8.collision, forces8.center, forces8.links];
                  var activeForces2 = fromFoldable52(["many body negative", "collision", "center", linksForceName_]);
                  return discard61(modify_18(function(s) {
                    var $36 = {};
                    for (var $37 in s) {
                      if ({}.hasOwnProperty.call(s, $37)) {
                        $36[$37] = s[$37];
                      }
                      ;
                    }
                    ;
                    $36.originalGraph = new Just(graph);
                    return $36;
                  }))(function() {
                    return bind72(get21)(function(state3) {
                      return bind72(liftAff3(execD3v2SimM({
                        simulation: state3.simulation
                      })(bind128(drawLesMisGUPV2(forcesArray)(activeForces2)(graph)("#lesmis-gup-viz"))(function() {
                        return pure66(unit);
                      }))))(function(newState) {
                        return discard61(modify_18(function(s) {
                          var $39 = {};
                          for (var $40 in s) {
                            if ({}.hasOwnProperty.call(s, $40)) {
                              $39[$40] = s[$40];
                            }
                            ;
                          }
                          ;
                          $39.simulation = newState.simulation;
                          return $39;
                        }))(function() {
                          return log9("TourLesMisGUP: Initialized successfully");
                        });
                      });
                    });
                  });
                }
                ;
                throw new Error("Failed pattern match at Component.Tour.TourLesMisGUP (line 76, column 5 - line 91, column 54): " + [lesMisResponse.constructor.name]);
              })())(function() {
                return pure121(unit);
              });
            });
          });
        });
      }
      ;
      if (v instanceof FilterNodes4) {
        return discard61(log9("Filtering nodes to group >= " + show75(v.value0)))(function() {
          return bind72(get21)(function(state3) {
            if (state3.originalGraph instanceof Nothing) {
              return log9("Error: Original graph data not loaded");
            }
            ;
            if (state3.originalGraph instanceof Just) {
              return bind72(liftAff3(execD3v2SimM({
                simulation: state3.simulation
              })(filterByGroupWithOriginal(v.value0)(state3.originalGraph.value0))))(function(newState) {
                return modify_18(function(s) {
                  var $44 = {};
                  for (var $45 in s) {
                    if ({}.hasOwnProperty.call(s, $45)) {
                      $44[$45] = s[$45];
                    }
                    ;
                  }
                  ;
                  $44.simulation = newState.simulation;
                  return $44;
                });
              });
            }
            ;
            throw new Error("Failed pattern match at Component.Tour.TourLesMisGUP (line 98, column 5 - line 103, column 63): " + [state3.originalGraph.constructor.name]);
          });
        });
      }
      ;
      throw new Error("Failed pattern match at Component.Tour.TourLesMisGUP (line 69, column 16 - line 103, column 63): " + [v.constructor.name]);
    };
  };
  var forceLibrary8 = /* @__PURE__ */ (function() {
    return initialize(foldableArray)(functorArray)([forces8.manyBodyNeg, forces8.collision, forces8.center, forces8.links]);
  })();
  var component33 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return {
          simulation: initialSimulationState(forceLibrary8),
          originalGraph: Nothing.value
        };
      },
      render: render37,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction32(dictMonadAff),
        initialize: new Just(Initialize33.value)
      })
    });
  };

  // output/D3.Viz.AnimatedTreeClusterLoop/index.js
  var bind73 = /* @__PURE__ */ bind(bindAff);
  var liftEffect40 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var discard62 = /* @__PURE__ */ discard(discardUnit)(bindAff);
  var animationStep3 = /* @__PURE__ */ animationStep(monadEffD3M)(d3TaglessD3M);
  var draw3 = /* @__PURE__ */ draw(monadEffD3M)(d3TaglessD3M);
  var toggleLayout2 = function(v) {
    if (v instanceof TreeLayout) {
      return ClusterLayout.value;
    }
    ;
    if (v instanceof ClusterLayout) {
      return TreeLayout.value;
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.AnimatedTreeClusterLoop (line 22, column 1 - line 22, column 41): " + [v.constructor.name]);
  };
  var animationLoop = function(vizState) {
    return function(layoutRef) {
      return bind73(liftEffect40(read(layoutRef)))(function(currentLayout) {
        var newLayout = toggleLayout2(currentLayout);
        return discard62(liftEffect40(write(newLayout)(layoutRef)))(function() {
          return bind73(liftEffect40(runD3M(animationStep3(vizState.dataTree)(vizState.linksGroup)(vizState.nodesGroup)(vizState.chartWidth)(vizState.chartHeight)(newLayout))))(function() {
            return discard62(delay(3e3))(function() {
              return animationLoop(vizState)(layoutRef);
            });
          });
        });
      });
    };
  };
  var startAnimatedTreeClusterLoop = function(flareData) {
    return function(containerSelector) {
      return launchAff_(bind73(liftEffect40(runD3M(draw3(flareData)(containerSelector))))(function(vizStateTuple) {
        var vizState = fst(vizStateTuple);
        return bind73(liftEffect40($$new(TreeLayout.value)))(function(layoutRef) {
          return bind73(liftEffect40(runD3M(animationStep3(vizState.dataTree)(vizState.linksGroup)(vizState.nodesGroup)(vizState.chartWidth)(vizState.chartHeight)(TreeLayout.value))))(function() {
            return discard62(delay(3e3))(function() {
              return animationLoop(vizState)(layoutRef);
            });
          });
        });
      }));
    };
  };

  // output/D3.Viz.TreeAPI.LesMisSimple/index.js
  var compare22 = /* @__PURE__ */ compare(ordInt);
  var discard63 = /* @__PURE__ */ discard(discardUnit)(bindD3v2SimM);
  var liftEffect41 = /* @__PURE__ */ liftEffect(monadEffectD3v2SimM);
  var bind74 = /* @__PURE__ */ bind(bindD3v2SimM);
  var select38 = /* @__PURE__ */ select4(selectionMD3v2Selection_D1);
  var initialize5 = /* @__PURE__ */ initialize(foldableArray)(functorArray);
  var fromFoldable53 = /* @__PURE__ */ fromFoldable8(foldableArray)(ordString);
  var init12 = /* @__PURE__ */ init4(simulationMD3v2Selection_);
  var width48 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height48 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox42 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var show76 = /* @__PURE__ */ show(showNumber);
  var id_21 = /* @__PURE__ */ id_(toAttrStringString);
  var class_44 = /* @__PURE__ */ class_2(toAttrStringString);
  var renderTree57 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D1);
  var renderTree119 = /* @__PURE__ */ renderTree57(ordUnit);
  var x114 = /* @__PURE__ */ x1(toAttrNumberFunctionNumbe);
  var y114 = /* @__PURE__ */ y1(toAttrNumberFunctionNumbe);
  var x215 = /* @__PURE__ */ x22(toAttrNumberFunctionNumbe);
  var y215 = /* @__PURE__ */ y22(toAttrNumberFunctionNumbe);
  var strokeWidth35 = /* @__PURE__ */ strokeWidth3(toAttrNumberFunctionNumbe);
  var stroke35 = /* @__PURE__ */ stroke(toAttrStringFunctionStrin);
  var cx36 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy36 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius35 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill46 = /* @__PURE__ */ fill3(toAttrStringString);
  var stroke110 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth110 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var ordNullable7 = /* @__PURE__ */ ordNullable(ordNumber);
  var renderTree217 = /* @__PURE__ */ renderTree57(/* @__PURE__ */ ordRecord()(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordNil)()({
    reflectSymbol: function() {
      return "y";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "x";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "vy";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "vx";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "sy";
    }
  })(ordNullable7))()({
    reflectSymbol: function() {
      return "sx";
    }
  })(ordNullable7))()({
    reflectSymbol: function() {
      return "id";
    }
  })(ordString))()({
    reflectSymbol: function() {
      return "group";
    }
  })(ordInt))()({
    reflectSymbol: function() {
      return "fy";
    }
  })(ordNullable7))()({
    reflectSymbol: function() {
      return "fx";
    }
  })(ordNullable7)));
  var lookup36 = /* @__PURE__ */ lookup2(ordString);
  var on11 = /* @__PURE__ */ on2(selectionMD3v2Selection_D1);
  var addTickFunction8 = /* @__PURE__ */ addTickFunction(simulationMD3v2Selection_);
  var cx111 = /* @__PURE__ */ cx3(toAttrNumberFunctionNumbe);
  var cy111 = /* @__PURE__ */ cy3(toAttrNumberFunctionNumbe);
  var start11 = /* @__PURE__ */ start3(simulationMD3v2Selection_);
  var $$void12 = /* @__PURE__ */ $$void(functorAff);
  var eqIndexedLink7 = {
    eq: function(v) {
      return function(v1) {
        return v.index === v1.index;
      };
    }
  };
  var ordIndexedLink7 = {
    compare: function(v) {
      return function(v1) {
        return compare22(v.index)(v1.index);
      };
    },
    Eq0: function() {
      return eqIndexedLink7;
    }
  };
  var renderTree312 = /* @__PURE__ */ renderTree57(ordIndexedLink7);
  var initialRadius7 = 10;
  var initialAngle6 = /* @__PURE__ */ (function() {
    return pi * (3 - sqrt(5));
  })();
  var setPhyllotaxisPositions6 = function(nodes) {
    var setPosition = function(index5) {
      return function(node) {
        var i2 = toNumber(index5);
        var radius$prime = initialRadius7 * sqrt(0.5 + i2);
        var angle = i2 * initialAngle6;
        var $128 = {};
        for (var $129 in node) {
          if ({}.hasOwnProperty.call(node, $129)) {
            $128[$129] = node[$129];
          }
          ;
        }
        ;
        $128.x = radius$prime * cos(angle);
        $128.y = radius$prime * sin(angle);
        return $128;
      };
    };
    return mapWithIndex2(setPosition)(nodes);
  };
  var drawLesMisSimple = function(model) {
    return function(containerSelector) {
      return function(w) {
        return function(h) {
          return discard63(liftEffect41(log2("=== Drawing LesMis Simple ===")))(function() {
            return bind74(select38(containerSelector))(function(container) {
              var nodesWithPositions = setPhyllotaxisPositions6(model.nodes);
              var manyBodyForce = createForce("many body negative")(new RegularForce(ForceManyBody.value))(allNodes)([strengthVal(-100)]);
              var centerForce = createForce("center")(new RegularForce(ForceCenter.value))(allNodes)([xVal(0), yVal(0), strengthVal(0.1)]);
              var linksForce2 = createLinkForce(allNodes)([]);
              var collisionForce = createForce("collision")(new RegularForce(ForceCollide.value))(allNodes)([radiusVal(6)]);
              var forceLibrary10 = initialize5([manyBodyForce, centerForce, linksForce2, collisionForce]);
              var forcesArray = [manyBodyForce, centerForce, linksForce2, collisionForce];
              var activeForces2 = fromFoldable53(["many body negative", "center", linksForceName_, "collision"]);
              return bind74(init12({
                nodes: nodesWithPositions,
                links: model.links,
                forces: forcesArray,
                activeForces: activeForces2,
                config: {
                  alpha: 1,
                  alphaTarget: 0,
                  alphaMin: 1e-3,
                  alphaDecay: 0.0228,
                  velocityDecay: 0.4
                },
                keyFn: keyIsID_,
                ticks: empty3
              }))(function(v) {
                var indexedLinks = mapWithIndex2(function(i2) {
                  return function(link4) {
                    return {
                      index: i2,
                      link: link4
                    };
                  };
                })(v.links);
                var forceGraphTree = withChild(named2(SVG.value)("svg")([width48(w), height48(h), viewBox42(show76(-w / 2) + (" " + (show76(-h / 2) + (" " + (show76(w) + (" " + show76(h))))))), id_21("lesmis-simple-svg"), class_44("lesmis-simple")]))(withChildren(named2(Group2.value)("zoomGroup")([id_21("zoom-group"), class_44("zoom-group")]))([named2(Group2.value)("linksGroup")([class_44("links")]), named2(Group2.value)("nodesGroup")([class_44("nodes")])]));
                return bind74(renderTree119(container)(forceGraphTree))(function(selections) {
                  return bind74(liftEffect41(reselectD3v2("linksGroup")(selections)))(function(linksGroupSel) {
                    return bind74(liftEffect41(reselectD3v2("nodesGroup")(selections)))(function(nodesGroupSel) {
                      var linksTree = joinData2("linkElements")("line")(indexedLinks)(function(v1) {
                        return elem4(Line2.value)([x114(function(v2) {
                          return v1.link.source.x;
                        }), y114(function(v2) {
                          return v1.link.source.y;
                        }), x215(function(v2) {
                          return v1.link.target.x;
                        }), y215(function(v2) {
                          return v1.link.target.y;
                        }), strokeWidth35(function(v2) {
                          return sqrt(v1.link.value);
                        }), stroke35(function(v2) {
                          return d3SchemeCategory10N_(toNumber(v1.link.target.group));
                        })]);
                      });
                      return bind74(renderTree312(linksGroupSel)(linksTree))(function(linksSelections) {
                        var nodesTree = joinData2("nodeElements")("circle")(v.nodes)(function(v1) {
                          return elem4(Circle2.value)([cx36(v1.x), cy36(v1.y), radius35(5), fill46(d3SchemeCategory10N_(toNumber(v1.group))), stroke110("#fff"), strokeWidth110(2)]);
                        });
                        return bind74(renderTree217(nodesGroupSel)(nodesTree))(function(nodesSelections) {
                          return bind74(liftEffect41(reselectD3v2("svg")(selections)))(function(svgSel) {
                            var nodesSel = (function() {
                              var v1 = lookup36("nodeElements")(nodesSelections);
                              if (v1 instanceof Just) {
                                return v1.value0;
                              }
                              ;
                              if (v1 instanceof Nothing) {
                                return unsafeCrashWith("nodeElements not found");
                              }
                              ;
                              throw new Error("Failed pattern match at D3.Viz.TreeAPI.LesMisSimple (line 181, column 18 - line 183, column 76): " + [v1.constructor.name]);
                            })();
                            var linksSel = (function() {
                              var v1 = lookup36("linkElements")(linksSelections);
                              if (v1 instanceof Just) {
                                return v1.value0;
                              }
                              ;
                              if (v1 instanceof Nothing) {
                                return unsafeCrashWith("linkElements not found");
                              }
                              ;
                              throw new Error("Failed pattern match at D3.Viz.TreeAPI.LesMisSimple (line 186, column 18 - line 188, column 76): " + [v1.constructor.name]);
                            })();
                            return bind74(on11(new Zoom2(defaultZoom(new ScaleExtent2(0.1, 10))(".zoom-group")))(svgSel))(function() {
                              return bind74(on11(new Drag2(simulationDrag("lesmis-simple")))(nodesSel))(function() {
                                return discard63(addTickFunction8("update-nodes")(new Step4(nodesSel, [cx111(function(v1) {
                                  return v1.x;
                                }), cy111(function(v1) {
                                  return v1.y;
                                })])))(function() {
                                  return discard63(addTickFunction8("update-links")(new Step4(linksSel, [x114(function(v1) {
                                    return v1.link.source.x;
                                  }), y114(function(v1) {
                                    return v1.link.source.y;
                                  }), x215(function(v1) {
                                    return v1.link.target.x;
                                  }), y215(function(v1) {
                                    return v1.link.target.y;
                                  })])))(function() {
                                    return discard63(start11)(function() {
                                      return liftEffect41(log2("Les Mis Simple: simulation started"));
                                    });
                                  });
                                });
                              });
                            });
                          });
                        });
                      });
                    });
                  });
                });
              });
            });
          });
        };
      };
    };
  };
  var startLesMisSimple = function(model) {
    return function(containerSelector) {
      return launchAff_((function() {
        var manyBodyForce = createForce("many body negative")(new RegularForce(ForceManyBody.value))(allNodes)([strengthVal(-100)]);
        var centerForce = createForce("center")(new RegularForce(ForceCenter.value))(allNodes)([xVal(0), yVal(0), strengthVal(0.1)]);
        var linksForce2 = createLinkForce(allNodes)([]);
        var collisionForce = createForce("collision")(new RegularForce(ForceCollide.value))(allNodes)([radiusVal(6)]);
        var forceLibrary10 = initialize5([manyBodyForce, centerForce, linksForce2, collisionForce]);
        var initialState4 = {
          simulation: initialSimulationState(forceLibrary10)
        };
        return $$void12(runD3v2SimM(initialState4)(drawLesMisSimple(model)(containerSelector)(900)(600)));
      })());
    };
  };

  // output/D3.Viz.TreeAPI.StaggeredCircles/index.js
  var mapFlipped16 = /* @__PURE__ */ mapFlipped(functorArray);
  var bind129 = /* @__PURE__ */ bind(bindD3v2M);
  var select39 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var width49 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height49 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox43 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var id_22 = /* @__PURE__ */ id_(toAttrStringString);
  var class_45 = /* @__PURE__ */ class_2(toAttrStringString);
  var cx37 = /* @__PURE__ */ cx3(toAttrNumberNumber);
  var cy37 = /* @__PURE__ */ cy3(toAttrNumberNumber);
  var radius36 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var fill47 = /* @__PURE__ */ fill3(toAttrStringString);
  var renderTree58 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(/* @__PURE__ */ ordRecord()(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordNil)()({
    reflectSymbol: function() {
      return "y";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "x";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "index";
    }
  })(ordInt)));
  var lookup37 = /* @__PURE__ */ lookup2(ordString);
  var pure67 = /* @__PURE__ */ pure(applicativeD3v2M);
  var withTransitionStaggered2 = /* @__PURE__ */ withTransitionStaggered(transitionMD3v2Selection_);
  var withTransition3 = /* @__PURE__ */ withTransition(transitionMD3v2Selection_);
  var staggeredCircles = function(selector) {
    var circleData2 = mapFlipped16(range2(0)(10 - 1 | 0))(function(i2) {
      return {
        index: i2,
        x: 50 + toNumber(i2) * 60,
        y: 100
      };
    });
    return function __do3() {
      var animatedRef = $$new(false)();
      var circlesSel = runD3v2M(bind129(select39(selector))(function(container) {
        var tree3 = withChild(named2(SVG.value)("staggered-svg")([width49(650), height49(200), viewBox43("0 0 650 200"), id_22("staggered-svg"), class_45("staggered-circles")]))(joinData2("circles")("circle")(circleData2)(function(d18) {
          return elem4(Circle2.value)([cx37(d18.x), cy37(d18.y), radius36(20), fill47("#4a90d9")]);
        }));
        return bind129(renderTree58(container)(tree3))(function(selections) {
          var circlesSel2 = (function() {
            var v = lookup37("circles")(selections);
            if (v instanceof Just) {
              return v.value0;
            }
            ;
            if (v instanceof Nothing) {
              return unsafeCrashWith("circles selection not found");
            }
            ;
            throw new Error("Failed pattern match at D3.Viz.TreeAPI.StaggeredCircles (line 65, column 22 - line 67, column 83): " + [v.constructor.name]);
          })();
          return pure67(circlesSel2);
        });
      }))();
      var trigger = function __do4() {
        var isAnimated = read(animatedRef)();
        if (isAnimated) {
          return unit;
        }
        ;
        write(true)(animatedRef)();
        return runD3v2M((function() {
          var config = transitionWith({
            duration: 500,
            delay: Nothing.value,
            easing: Nothing.value
          });
          return withTransitionStaggered2(config)(staggerByIndex(100))(circlesSel)([cy37(50), fill47("#e74c3c"), radius36(25)]);
        })())();
      };
      var reset2 = function __do4() {
        write(false)(animatedRef)();
        return runD3v2M((function() {
          var config = transitionWith({
            duration: 300,
            delay: Nothing.value,
            easing: Nothing.value
          });
          return withTransition3(config)(circlesSel)([cy37(100), fill47("#4a90d9"), radius36(20)]);
        })())();
      };
      return {
        trigger,
        reset: reset2
      };
    };
  };

  // output/Component.Tour.TourMotion/index.js
  var pure68 = /* @__PURE__ */ pure(applicativeEffect);
  var discard64 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var bind130 = /* @__PURE__ */ bind(bindHalogenM);
  var modify_19 = /* @__PURE__ */ modify_2(monadStateHalogenM);
  var exGeneralUpdatePattern3 = /* @__PURE__ */ exGeneralUpdatePattern(d3TaglessD3M);
  var forever3 = /* @__PURE__ */ forever(monadRecHalogenM);
  var applySecond4 = /* @__PURE__ */ applySecond(applyEffect);
  var pure122 = /* @__PURE__ */ pure(applicativeHalogenM);
  var get22 = /* @__PURE__ */ get(monadStateHalogenM);
  var Initialize34 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var Finalize3 = /* @__PURE__ */ (function() {
    function Finalize5() {
    }
    ;
    Finalize5.value = new Finalize5();
    return Finalize5;
  })();
  var TriggerColorMixing = /* @__PURE__ */ (function() {
    function TriggerColorMixing2() {
    }
    ;
    TriggerColorMixing2.value = new TriggerColorMixing2();
    return TriggerColorMixing2;
  })();
  var TriggerStaggered = /* @__PURE__ */ (function() {
    function TriggerStaggered2() {
    }
    ;
    TriggerStaggered2.value = new TriggerStaggered2();
    return TriggerStaggered2;
  })();
  var ResetStaggered = /* @__PURE__ */ (function() {
    function ResetStaggered2() {
    }
    ;
    ResetStaggered2.value = new ResetStaggered2();
    return ResetStaggered2;
  })();
  var render38 = function(v) {
    return div2([classes(["tutorial-page"])])([renderHeader2(TourMotion.value), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("5. Movement & Transition")]), p_([text2("This page explores transitions and movement in D3 visualizations, from simple color and position changes to complex physics simulations with the General Update Pattern.")])]), section([classes(["tutorial-section"]), id3("section-1")])([h2([classes(["tutorial-section-title"])])([text2("1. Basic Transitions: Color Mixing")]), p_([text2("Transitions allow smooth animated changes to visual properties. This simple example shows three circles transitioning from green to RGB primary colors (red, green, blue) with 50% opacity. The circles reposition to overlap, demonstrating additive color mixing where overlapping colors create secondary colors: cyan (green + blue), magenta (red + blue), and yellow (red + green).")]), div2([id3("viz"), classes(["viz-container"])])([]), button([classes(["transition-button"]), onClick(function(v1) {
      return TriggerColorMixing.value;
    })])([text2("Transition to RGB")])]), section([classes(["tutorial-section"]), id3("section-2")])([h2([classes(["tutorial-section-title"])])([text2("2. Staggered Animations")]), p_([text2("Transitions can include per-element delays for choreographing complex multi-step animations. This example shows 10 circles with staggered delays\u2014each circle animates 100ms after the previous one, creating a wave effect.")]), p_([text2("The `withTransitionStaggered` function takes a delay function `(datum -> index -> Milliseconds)` that computes a unique delay for each element. The helper `staggerByIndex 100.0` creates delays of 0ms, 100ms, 200ms, etc.")]), div2([id3("staggered-container"), classes(["viz-container"])])([]), div2([classes(["button-row"])])([button([classes(["transition-button"]), onClick(function(v1) {
      return TriggerStaggered.value;
    })])([text2("Animate")]), button([classes(["transition-button", "secondary"]), onClick(function(v1) {
      return ResetStaggered.value;
    })])([text2("Reset")])])]), section([classes(["tutorial-section"]), id3("section-3")])([h2([classes(["tutorial-section-title"])])([text2("3. The General Update Pattern")]), p_([text2("This deceptively simple example shows off an aspect of screen-based data visualization that has no analogue in paper visualizations: the ability to specify how updates to the data should be represented.")]), p_([text2("In this example, some letters of the alphabet are presented and then constantly updated. When a letter enters at first, it falls in from the top and it is green. If it's still present in the next set of letters it stays on the screen, but it turns gray and moves to an alphabetically correct new position. And if it's not present in the new data, it turns red and falls out before disappearing.")]), div2([id3("gup-container"), classes(["viz-container"])])([]), p_([text2("The example automatically cycles through random letter selections every 2 seconds, demonstrating all three parts of the pattern: green letters entering from above, gray letters sliding to new positions, and brown letters exiting below.")])]), section([classes(["tutorial-section"]), id3("section-4")])([h2([classes(["tutorial-section-title"])])([text2("4. Animated Tree Transitions")]), p_([text2("This demonstration shows smooth automatic transitions between Tidy Tree and Dendrogram (Cluster) layouts. The visualization automatically alternates between layouts every 3 seconds. The same 252 nodes from the Flare visualization toolkit smoothly animate to their new positions\u2014no enter/exit, just updates.")]), p_([text2("The transitions are implemented using D3's data join with identity-based keys, ensuring each node maintains its identity across layout changes. Children are sorted by height to eliminate crossovers during animation, creating smooth and comprehensible transitions.")]), div2([id3("animated-tree-container"), classes(["viz-container"])])([]), p_([text2("For a version with manual controls, visit the "), a([href("#" + routeToPath(AnimatedTreeCluster.value))])([text2("full Animated Tree \u2194 Cluster demo")]), text2(".")])]), section([classes(["tutorial-section"]), id3("section-5")])([h2([classes(["tutorial-section-title"])])([text2("5. Force-Directed Graph: Les Mis\xE9rables")]), p_([text2("Force-directed graphs use physics simulation to position nodes and links. Nodes repel each other like charged particles, while links act as springs pulling connected nodes together. The simulation finds an equilibrium that naturally reveals the structure of the network.")]), p_([text2("The graph shows character co-occurrence in Victor Hugo's Les Mis\xE9rables. Try dragging nodes to see the force simulation respond - the simulation applies multiple forces: center (pulls toward middle), charge (nodes repel), collision (prevents overlap), and link (pulls connected nodes together). You can also zoom and pan using the mouse wheel and drag gestures.")]), div2([id3("lesmis-container"), classes(["viz-container"])])([])])])]);
  };
  var getLetters2 = /* @__PURE__ */ (function() {
    var letters = toCharArray("abcdefghijklmnopqrstuvwxyz");
    var coinToss = function(c) {
      return function __do3() {
        var n = random();
        var $35 = n > 0.6;
        if ($35) {
          return new Just(c);
        }
        ;
        return Nothing.value;
      };
    };
    return function __do3() {
      var choices = sequence(traversableArray)(applicativeEffect)(map(functorArray)(coinToss)(letters))();
      return catMaybes(choices);
    };
  })();
  var handleAction33 = function(dictMonadAff) {
    var liftAff3 = liftAff(monadAffHalogenM(dictMonadAff));
    var liftEffect51 = liftEffect(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    return function(v) {
      if (v instanceof Initialize34) {
        return discard64(liftAff3(delay(100)))(function() {
          return bind130(liftEffect51(threeLittleCirclesTransition("#viz")))(function(trigger) {
            return discard64(modify_19(function(v1) {
              var $37 = {};
              for (var $38 in v1) {
                if ({}.hasOwnProperty.call(v1, $38)) {
                  $37[$38] = v1[$38];
                }
                ;
              }
              ;
              $37.colorMixingTrigger = new Just(trigger);
              return $37;
            }))(function() {
              return bind130(liftEffect51(staggeredCircles("#staggered-container")))(function(staggered) {
                return discard64(modify_19(function(v1) {
                  var $40 = {};
                  for (var $41 in v1) {
                    if ({}.hasOwnProperty.call(v1, $41)) {
                      $40[$41] = v1[$41];
                    }
                    ;
                  }
                  ;
                  $40.staggeredTrigger = new Just(staggered);
                  return $40;
                }))(function() {
                  return bind130(liftEffect51(eval_D3M(exGeneralUpdatePattern3("#gup-container"))))(function(update7) {
                    return bind130(fork(forever3(bind130(liftEffect51(getLetters2))(function(letters) {
                      return discard64(liftEffect51(applySecond4(runD3M(update7(letters)))(pure68(unit))))(function() {
                        return liftAff3(delay(2300));
                      });
                    }))))(function(forkId) {
                      return discard64(modify_19(function(v1) {
                        var $43 = {};
                        for (var $44 in v1) {
                          if ({}.hasOwnProperty.call(v1, $44)) {
                            $43[$44] = v1[$44];
                          }
                          ;
                        }
                        ;
                        $43.gupFiber = new Just(forkId);
                        return $43;
                      }))(function() {
                        return bind130(liftAff3(get3(json)("./data/flare-2.json")))(function(flareResult) {
                          return discard64((function() {
                            if (flareResult instanceof Left) {
                              return pure122(unit);
                            }
                            ;
                            if (flareResult instanceof Right) {
                              return liftEffect51(startAnimatedTreeClusterLoop(flareResult.value0.body)("#animated-tree-container"));
                            }
                            ;
                            throw new Error("Failed pattern match at Component.Tour.TourMotion (line 86, column 5 - line 90, column 104): " + [flareResult.constructor.name]);
                          })())(function() {
                            return bind130(liftAff3(get3(string)("./data/miserables.json")))(function(lesMisResult) {
                              var lesMisModel = readGraphFromFileContents(lesMisResult);
                              return discard64(liftEffect51(startLesMisSimple(lesMisModel)("#lesmis-container")))(function() {
                                return pure122(unit);
                              });
                            });
                          });
                        });
                      });
                    });
                  });
                });
              });
            });
          });
        });
      }
      ;
      if (v instanceof Finalize3) {
        return bind130(get22)(function(state3) {
          return discard64((function() {
            if (state3.gupFiber instanceof Nothing) {
              return pure122(unit);
            }
            ;
            if (state3.gupFiber instanceof Just) {
              return kill(state3.gupFiber.value0);
            }
            ;
            throw new Error("Failed pattern match at Component.Tour.TourMotion (line 101, column 5 - line 103, column 35): " + [state3.gupFiber.constructor.name]);
          })())(function() {
            return modify_19(function(v1) {
              var $51 = {};
              for (var $52 in v1) {
                if ({}.hasOwnProperty.call(v1, $52)) {
                  $51[$52] = v1[$52];
                }
                ;
              }
              ;
              $51.gupFiber = Nothing.value;
              return $51;
            });
          });
        });
      }
      ;
      if (v instanceof TriggerColorMixing) {
        return bind130(get22)(function(state3) {
          if (state3.colorMixingTrigger instanceof Nothing) {
            return pure122(unit);
          }
          ;
          if (state3.colorMixingTrigger instanceof Just) {
            return liftEffect51(createTransitionTrigger(state3.colorMixingTrigger.value0));
          }
          ;
          throw new Error("Failed pattern match at Component.Tour.TourMotion (line 108, column 5 - line 110, column 96): " + [state3.colorMixingTrigger.constructor.name]);
        });
      }
      ;
      if (v instanceof TriggerStaggered) {
        return bind130(get22)(function(state3) {
          if (state3.staggeredTrigger instanceof Nothing) {
            return pure122(unit);
          }
          ;
          if (state3.staggeredTrigger instanceof Just) {
            return liftEffect51(state3.staggeredTrigger.value0.trigger);
          }
          ;
          throw new Error("Failed pattern match at Component.Tour.TourMotion (line 114, column 5 - line 116, column 45): " + [state3.staggeredTrigger.constructor.name]);
        });
      }
      ;
      if (v instanceof ResetStaggered) {
        return bind130(get22)(function(state3) {
          if (state3.staggeredTrigger instanceof Nothing) {
            return pure122(unit);
          }
          ;
          if (state3.staggeredTrigger instanceof Just) {
            return liftEffect51(state3.staggeredTrigger.value0.reset);
          }
          ;
          throw new Error("Failed pattern match at Component.Tour.TourMotion (line 120, column 5 - line 122, column 41): " + [state3.staggeredTrigger.constructor.name]);
        });
      }
      ;
      throw new Error("Failed pattern match at Component.Tour.TourMotion (line 63, column 16 - line 122, column 41): " + [v.constructor.name]);
    };
  };
  var component34 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return {
          gupFiber: Nothing.value,
          colorMixingTrigger: Nothing.value,
          staggeredTrigger: Nothing.value
        };
      },
      render: render38,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        handleAction: handleAction33(dictMonadAff),
        initialize: new Just(Initialize34.value),
        finalize: new Just(Finalize3.value)
      })
    });
  };

  // output/D3.Viz.TreeAPI.MultiLineChartExample/foreign.js
  function setTimeout_(effect) {
    return (delay2) => () => {
      return setTimeout(() => effect(), delay2);
    };
  }
  function clearTimeout_(timeoutId) {
    return () => {
      clearTimeout(timeoutId);
    };
  }

  // output/D3.Viz.TreeAPI.MultiLineChartExample/index.js
  var bind75 = /* @__PURE__ */ bind(bindMaybe);
  var pure69 = /* @__PURE__ */ pure(applicativeMaybe);
  var bind131 = /* @__PURE__ */ bind(bindAff);
  var discard65 = /* @__PURE__ */ discard(discardUnit);
  var discard116 = /* @__PURE__ */ discard65(bindAff);
  var liftEffect42 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var pure123 = /* @__PURE__ */ pure(applicativeAff);
  var show77 = /* @__PURE__ */ show(showInt);
  var compare23 = /* @__PURE__ */ compare(ordString);
  var map73 = /* @__PURE__ */ map(functorArray);
  var bind220 = /* @__PURE__ */ bind(bindD3v2M);
  var select40 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var liftEffect118 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var maximum11 = /* @__PURE__ */ maximum(ordNumber)(foldableArray);
  var nub6 = /* @__PURE__ */ nub(ordString);
  var show139 = /* @__PURE__ */ show(showNumber);
  var foldl17 = /* @__PURE__ */ foldl(foldableArray);
  var width50 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height50 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox44 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var class_46 = /* @__PURE__ */ class_2(toAttrStringString);
  var transform18 = /* @__PURE__ */ transform2(toAttrStringString);
  var x44 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y45 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var textAnchor22 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var fontSize15 = /* @__PURE__ */ fontSize2(toAttrNumberNumber);
  var textContent24 = /* @__PURE__ */ textContent(toAttrStringString);
  var d16 = /* @__PURE__ */ d4(toAttrStringString);
  var fill48 = /* @__PURE__ */ fill3(toAttrStringString);
  var stroke36 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth36 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var ordRecord11 = /* @__PURE__ */ ordRecord();
  var ordRecordCons10 = /* @__PURE__ */ ordRecordCons(ordRecordNil)();
  var divisionIsSymbol = {
    reflectSymbol: function() {
      return "division";
    }
  };
  var renderTree59 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(/* @__PURE__ */ ordRecord11(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons10({
    reflectSymbol: function() {
      return "points";
    }
  })(/* @__PURE__ */ ordArray(/* @__PURE__ */ ordRecord11(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons10({
    reflectSymbol: function() {
      return "rate";
    }
  })(ordNumber))()(divisionIsSymbol)(ordString))()({
    reflectSymbol: function() {
      return "date";
    }
  })(ordString)))))()(divisionIsSymbol)(ordString)));
  var compare113 = /* @__PURE__ */ compare(ordNumber);
  var discard212 = /* @__PURE__ */ discard65(bindD3v2M);
  var lookup38 = /* @__PURE__ */ lookup2(ordString);
  var on12 = /* @__PURE__ */ on2(selectionMD3v2Selection_D);
  var pure310 = /* @__PURE__ */ pure(applicativeD3v2M);
  var parseDataPoint = function(line) {
    var v = parseCSVRow(line);
    if (v.length === 3) {
      return bind75(fromString(trim(v[2])))(function(rate) {
        return pure69({
          division: trim(v[0]),
          date: trim(v[1]),
          rate
        });
      });
    }
    ;
    return Nothing.value;
  };
  var loadUnemploymentData = /* @__PURE__ */ (function() {
    return bind131(loadDataFile(MetroUnemploymentCSV.value))(function(result) {
      if (result instanceof Left) {
        return discard116(liftEffect42(log2("Failed to load unemployment data: " + result.value0)))(function() {
          return pure123([]);
        });
      }
      ;
      if (result instanceof Right) {
        var lines = split("\n")(result.value0);
        var dataLines = drop(1)(lines);
        var parsed = mapMaybe(parseDataPoint)(dataLines);
        return discard116(liftEffect42(log2("Loaded " + (show77(length(parsed)) + " unemployment data points"))))(function() {
          return pure123(parsed);
        });
      }
      ;
      throw new Error("Failed pattern match at D3.Viz.TreeAPI.MultiLineChartExample (line 65, column 3 - line 74, column 18): " + [result.constructor.name]);
    });
  })();
  var groupByDivision = function(dataPoints) {
    var toSeries = function(group4) {
      var points = toArray2(group4);
      var first2 = head4(group4);
      return {
        division: first2.division,
        points: sortBy(on(compare23)(function(v) {
          return v.date;
        }))(points)
      };
    };
    var grouped = groupBy(function(a2) {
      return function(b10) {
        return a2.division === b10.division;
      };
    })(sortBy(on(compare23)(function(v) {
      return v.division;
    }))(dataPoints));
    return map73(toSeries)(grouped);
  };
  var drawMultiLineChart = function(selector) {
    return function(unemploymentData) {
      return runD3v2M(bind220(select40(selector))(function(container) {
        return bind220(liftEffect118($$new(Nothing.value)))(function(hideTimeoutRef) {
          var series = groupByDivision(unemploymentData);
          var maxRate = fromMaybe(20)(maximum11(map73(function(v) {
            return v.rate;
          })(unemploymentData)));
          var margin = {
            top: 20,
            right: 20,
            bottom: 50,
            left: 60
          };
          var plotHeight = 600 - margin.top - margin.bottom;
          var yScale = {
            domain: {
              min: 0,
              max: maxRate
            },
            range: {
              min: plotHeight,
              max: 0
            }
          };
          var scaleY3 = function(rate) {
            var rangeSpan = yScale.range.max - yScale.range.min;
            var domainSpan = yScale.domain.max - yScale.domain.min;
            var normalized = (rate - yScale.domain.min) / domainSpan;
            return yScale.range.min + normalized * rangeSpan;
          };
          var plotWidth = 928 - margin.left - margin.right;
          var allDates = nub6(map73(function(v) {
            return v.date;
          })(unemploymentData));
          var dateCount = toNumber(length(allDates));
          var xScale = {
            domain: {
              min: 0,
              max: dateCount - 1
            },
            range: {
              min: 0,
              max: plotWidth
            }
          };
          var scaleX3 = function(date) {
            var rangeSpan = xScale.range.max - xScale.range.min;
            var idx = fromMaybe(0)(findIndex(function(d1) {
              return d1 === date;
            })(allDates));
            var value18 = toNumber(idx);
            var domainSpan = xScale.domain.max - xScale.domain.min;
            var normalized = (value18 - xScale.domain.min) / domainSpan;
            return xScale.range.min + normalized * rangeSpan;
          };
          var linePath = function(points) {
            var v = uncons(points);
            if (v instanceof Nothing) {
              return "";
            }
            ;
            if (v instanceof Just) {
              var moveCmd = "M" + (show139(scaleX3(v.value0.head.date)) + ("," + show139(scaleY3(v.value0.head.rate))));
              var lineSegments = map73(function(p2) {
                return "L" + (show139(scaleX3(p2.date)) + ("," + show139(scaleY3(p2.rate))));
              })(v.value0.tail);
              return moveCmd + foldl17(function(acc) {
                return function(seg) {
                  return acc + seg;
                };
              })("")(lineSegments);
            }
            ;
            throw new Error("Failed pattern match at D3.Viz.TreeAPI.MultiLineChartExample (line 139, column 9 - line 144, column 73): " + [v.constructor.name]);
          };
          var tree3 = withChild(named2(SVG.value)("svg")([width50(928), height50(600), viewBox44("0 0 " + (show139(928) + (" " + show139(600)))), class_46("multi-line-chart")]))(withChildren(named2(Group2.value)("plot-area")([transform18("translate(" + (show139(margin.left) + ("," + (show139(margin.top) + ")"))))]))([withChild(named2(Group2.value)("x-axis")([transform18("translate(0," + (show139(plotHeight) + ")")), class_46("x-axis")]))(renderAxis(axisBottom(xScale))), withChild(named2(Group2.value)("y-axis")([class_46("y-axis")]))(renderAxis(axisLeft(yScale))), elem4(Text3.value)([transform18("rotate(-90)"), x44(-(plotHeight / 2)), y45(-40), textAnchor22("middle"), fontSize15(12), textContent24("Unemployment Rate (%)")]), joinData2("lines")("path")(series)(function(s) {
            return elem4(Path3.value)([d16(linePath(s.points)), fill48("none"), stroke36("#ddd"), strokeWidth36(1.5), class_46("line")]);
          })]));
          return bind220(renderTree59(container)(tree3))(function(selections) {
            var findNearestPoint = function(s) {
              return function(mouseX) {
                var plotX = mouseX - margin.left;
                var sortedPoints = sortBy(on(compare23)(function(v2) {
                  return v2.date;
                }))(s.points);
                var withDistances = map73(function(p2) {
                  return {
                    point: p2,
                    dist: abs(scaleX3(p2.date) - plotX)
                  };
                })(sortedPoints);
                var v = head(sortBy(on(compare113)(function(v1) {
                  return v1.dist;
                }))(withDistances));
                if (v instanceof Just) {
                  return new Just(v.value0.point);
                }
                ;
                if (v instanceof Nothing) {
                  return Nothing.value;
                }
                ;
                throw new Error("Failed pattern match at D3.Viz.TreeAPI.MultiLineChartExample (line 209, column 9 - line 211, column 29): " + [v.constructor.name]);
              };
            };
            return discard212((function() {
              var v = lookup38("lines")(selections);
              if (v instanceof Just) {
                return bind220(on12(onMouseMoveWithInfo(function(v1) {
                  return function __do3() {
                    var maybeTimeout = read(hideTimeoutRef)();
                    (function() {
                      if (maybeTimeout instanceof Just) {
                        clearTimeout_(maybeTimeout.value0)();
                        return write(Nothing.value)(hideTimeoutRef)();
                      }
                      ;
                      if (maybeTimeout instanceof Nothing) {
                        return unit;
                      }
                      ;
                      throw new Error("Failed pattern match at D3.Viz.TreeAPI.MultiLineChartExample (line 223, column 9 - line 227, column 37): " + [maybeTimeout.constructor.name]);
                    })();
                    var v2 = findNearestPoint(v1.datum)(v1.offsetX);
                    if (v2 instanceof Just) {
                      var content3 = "<strong>" + (v1.datum.division + ("</strong><br/>" + (v2.value0.date + (": " + (show139(v2.value0.rate) + "%")))));
                      return showTooltip(content3)(v1.pageX)(v1.pageY)();
                    }
                    ;
                    if (v2 instanceof Nothing) {
                      return unit;
                    }
                    ;
                    throw new Error("Failed pattern match at D3.Viz.TreeAPI.MultiLineChartExample (line 230, column 9 - line 235, column 37): " + [v2.constructor.name]);
                  };
                }))(v.value0))(function() {
                  return bind220(on12(onMouseLeaveWithInfo(function(v1) {
                    return function __do3() {
                      var timeoutId = setTimeout_(hideTooltip)(150)();
                      return write(new Just(timeoutId))(hideTimeoutRef)();
                    };
                  }))(v.value0))(function() {
                    return pure310(unit);
                  });
                });
              }
              ;
              if (v instanceof Nothing) {
                return pure310(unit);
              }
              ;
              throw new Error("Failed pattern match at D3.Viz.TreeAPI.MultiLineChartExample (line 217, column 3 - line 247, column 25): " + [v.constructor.name]);
            })())(function() {
              return liftEffect118(function __do3() {
                log2("=== Multi-Line Chart ===")();
                log2("")();
                log2("Metro areas: " + show77(length(series)))();
                log2("Data points: " + show77(length(unemploymentData)))();
                return log2("")();
              });
            });
          });
        });
      }));
    };
  };
  var multiLineChart = function(selector) {
    return launchAff_(bind131(loadUnemploymentData)(function(unemploymentData) {
      return liftEffect42(drawMultiLineChart(selector)(unemploymentData));
    }));
  };

  // output/D3.Viz.TreeAPI.RadialStackedBarExample/index.js
  var sum5 = /* @__PURE__ */ sum(foldableArray)(semiringNumber);
  var map74 = /* @__PURE__ */ map(functorArray);
  var compare24 = /* @__PURE__ */ compare(ordString);
  var maximum13 = /* @__PURE__ */ maximum(ordNumber)(foldableArray);
  var bind76 = /* @__PURE__ */ bind(bindAff);
  var discard66 = /* @__PURE__ */ discard(discardUnit);
  var discard117 = /* @__PURE__ */ discard66(bindAff);
  var liftEffect43 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var pure70 = /* @__PURE__ */ pure(applicativeAff);
  var show78 = /* @__PURE__ */ show(showInt);
  var show140 = /* @__PURE__ */ show(showNumber);
  var bind132 = /* @__PURE__ */ bind(bindD3v2M);
  var select41 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var radius37 = /* @__PURE__ */ radius3(toAttrNumberNumber);
  var stroke37 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeOpacity6 = /* @__PURE__ */ strokeOpacity(toAttrNumberNumber);
  var fill49 = /* @__PURE__ */ fill3(toAttrStringString);
  var class_47 = /* @__PURE__ */ class_2(toAttrStringString);
  var y46 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var dy3 = /* @__PURE__ */ dy(toAttrNumberNumber);
  var textContent25 = /* @__PURE__ */ textContent(toAttrStringString);
  var strokeWidth37 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var transform19 = /* @__PURE__ */ transform2(toAttrStringString);
  var width51 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height51 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var x45 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var textAnchor23 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var fontSize16 = /* @__PURE__ */ fontSize2(toAttrNumberNumber);
  var d17 = /* @__PURE__ */ d4(toAttrStringString);
  var viewBox45 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var append122 = /* @__PURE__ */ append(semigroupArray);
  var renderTree60 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(ordUnit);
  var liftEffect119 = /* @__PURE__ */ liftEffect(monadEffectD3v2M);
  var prepareRadialData = function(dataPoints) {
    var toStateData = function(maxTotal2) {
      return function(innerR) {
        return function(radiusRange2) {
          return function(stateIndex) {
            return function(group4) {
              var points = toArray2(group4);
              var segments = foldl2(function(acc) {
                return function(item) {
                  var thickness = item.population / maxTotal2 * radiusRange2;
                  var prevRadius = (function() {
                    var v = last(acc.result);
                    if (v instanceof Just) {
                      return v.value0.outerRadius;
                    }
                    ;
                    if (v instanceof Nothing) {
                      return innerR;
                    }
                    ;
                    throw new Error("Failed pattern match at D3.Viz.TreeAPI.RadialStackedBarExample (line 158, column 32 - line 160, column 38): " + [v.constructor.name]);
                  })();
                  return {
                    result: snoc(acc.result)({
                      age: item.age,
                      population: item.population,
                      innerRadius: prevRadius,
                      outerRadius: prevRadius + thickness
                    })
                  };
                };
              })({
                result: []
              })(points);
              var total = sum5(map74(function(v) {
                return v.population;
              })(points));
              var first2 = head4(group4);
              return {
                state: first2.state,
                stateIndex,
                ageSegments: segments.result,
                totalPopulation: total
              };
            };
          };
        };
      };
    };
    var radiusRange = 300 - 80;
    var grouped = groupBy(function(a2) {
      return function(b10) {
        return a2.state === b10.state;
      };
    })(sortBy(on(compare24)(function(v) {
      return v.state;
    }))(dataPoints));
    var allTotals = map74(function(g) {
      return sum5(map74(function(v) {
        return v.population;
      })(toArray2(g)));
    })(grouped);
    var maxTotal = fromMaybe(1)(maximum13(allTotals));
    return mapWithIndex2(toStateData(maxTotal)(80)(radiusRange))(grouped);
  };
  var parsePopulationRow2 = function(line) {
    var v = parseCSVRow(line);
    if (v.length === 8) {
      var under5 = fromMaybe(0)(fromString(trim(v[1])));
      var age65plus = fromMaybe(0)(fromString(trim(v[7])));
      var age5to13 = fromMaybe(0)(fromString(trim(v[2])));
      var age45to64 = fromMaybe(0)(fromString(trim(v[6])));
      var age25to44 = fromMaybe(0)(fromString(trim(v[5])));
      var age18to24 = fromMaybe(0)(fromString(trim(v[4])));
      var age14to17 = fromMaybe(0)(fromString(trim(v[3])));
      return [{
        state: trim(v[0]),
        age: "<10",
        population: under5 + age5to13 * 0.5
      }, {
        state: trim(v[0]),
        age: "10-19",
        population: age5to13 * 0.5 + age14to17
      }, {
        state: trim(v[0]),
        age: "20-29",
        population: age18to24 + age25to44 * 0.25
      }, {
        state: trim(v[0]),
        age: "30-39",
        population: age25to44 * 0.5
      }, {
        state: trim(v[0]),
        age: "40-49",
        population: age25to44 * 0.25
      }, {
        state: trim(v[0]),
        age: "50-59",
        population: age45to64 * 0.6
      }, {
        state: trim(v[0]),
        age: "60-69",
        population: age45to64 * 0.4
      }, {
        state: trim(v[0]),
        age: "70-79",
        population: age65plus * 0.6
      }, {
        state: trim(v[0]),
        age: "\u226580",
        population: age65plus * 0.4
      }];
    }
    ;
    return [];
  };
  var loadPopulationData2 = /* @__PURE__ */ (function() {
    return bind76(loadDataFile(USPopulationStateAgeCSV.value))(function(result) {
      if (result instanceof Left) {
        return discard117(liftEffect43(log2("Failed to load population data: " + result.value0)))(function() {
          return pure70([]);
        });
      }
      ;
      if (result instanceof Right) {
        var lines = split("\n")(result.value0);
        var dataLines = drop(1)(lines);
        var parsed = concatMap(parsePopulationRow2)(dataLines);
        return discard117(liftEffect43(log2("Loaded " + (show78(length(parsed)) + " population data points"))))(function() {
          return pure70(parsed);
        });
      }
      ;
      throw new Error("Failed pattern match at D3.Viz.TreeAPI.RadialStackedBarExample (line 84, column 3 - line 93, column 18): " + [result.constructor.name]);
    });
  })();
  var getAgeColorByName = function(age) {
    if (age === "<10") {
      return "#d53e4f";
    }
    ;
    if (age === "10-19") {
      return "#f46d43";
    }
    ;
    if (age === "20-29") {
      return "#fdae61";
    }
    ;
    if (age === "30-39") {
      return "#fee08b";
    }
    ;
    if (age === "40-49") {
      return "#e6f598";
    }
    ;
    if (age === "50-59") {
      return "#abdda4";
    }
    ;
    if (age === "60-69") {
      return "#66c2a5";
    }
    ;
    if (age === "70-79") {
      return "#3288bd";
    }
    ;
    if (age === "\u226580") {
      return "#5e4fa2";
    }
    ;
    return "#999";
  };
  var formatSI = function(n) {
    var $67 = n >= 1e6;
    if ($67) {
      return show140(n / 1e6) + "M";
    }
    ;
    return show140(n);
  };
  var arcPath2 = function(startAngle) {
    return function(endAngle) {
      return function(innerRadius) {
        return function(outerRadius) {
          var outerStartY = outerRadius * sin(startAngle);
          var outerStartX = outerRadius * cos(startAngle);
          var outerEndY = outerRadius * sin(endAngle);
          var outerEndX = outerRadius * cos(endAngle);
          var largeArc = (function() {
            var $68 = endAngle - startAngle > pi;
            if ($68) {
              return 1;
            }
            ;
            return 0;
          })();
          var innerStartY = innerRadius * sin(startAngle);
          var innerStartX = innerRadius * cos(startAngle);
          var innerEndY = innerRadius * sin(endAngle);
          var innerEndX = innerRadius * cos(endAngle);
          return "M" + (show140(outerStartX) + ("," + (show140(outerStartY) + (" A" + (show140(outerRadius) + ("," + (show140(outerRadius) + (" 0 " + (show78(largeArc) + (",1 " + (show140(outerEndX) + ("," + (show140(outerEndY) + (" L" + (show140(innerEndX) + ("," + (show140(innerEndY) + (" A" + (show140(innerRadius) + ("," + (show140(innerRadius) + (" 0 " + (show78(largeArc) + (",0 " + (show140(innerStartX) + ("," + (show140(innerStartY) + " Z")))))))))))))))))))))))))));
        };
      };
    };
  };
  var ageColors = ["#d53e4f", "#f46d43", "#fdae61", "#fee08b", "#e6f598", "#abdda4", "#66c2a5", "#3288bd", "#5e4fa2"];
  var getAgeColor = function(idx) {
    return fromMaybe("#999")(index(ageColors)(idx));
  };
  var drawRadialStackedBar = function(selector) {
    return function(populationData) {
      return runD3v2M(bind132(select41(selector))(function(container) {
        var states = prepareRadialData(populationData);
        var stateCount = toNumber(length(states));
        var radiusRange = 300 - 80;
        var centerY = 700 / 2;
        var centerX = 700 / 2;
        var anglePerState = 2 * pi / stateCount;
        var allTotals = map74(function(v) {
          return v.totalPopulation;
        })(states);
        var maxTotal = fromMaybe(1)(maximum13(allTotals));
        var gridValues = [0.25 * maxTotal, 0.5 * maxTotal, 0.75 * maxTotal, maxTotal];
        var radiusScale = function(v) {
          return 80 + v / maxTotal * radiusRange;
        };
        var makeGridLine = function(value18) {
          var gridRadius = radiusScale(value18);
          return [elem4(Circle2.value)([radius37(gridRadius), stroke37("#000000"), strokeOpacity6(0.5), fill49("none"), class_47("grid-circle")]), elem4(Text3.value)([y46(-gridRadius), dy3(5.6), textContent25(formatSI(value18)), stroke37("#ffffff"), strokeWidth37(5), fill49("none"), class_47("grid-label-bg")]), elem4(Text3.value)([y46(-gridRadius), dy3(5.6), textContent25(formatSI(value18)), fill49("#000000"), class_47("grid-label")])];
        };
        var ageGroups = ["<10", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79", "\u226580"];
        var makeLegendItem = function(idx) {
          return function(age) {
            var ageCount = length(ageGroups);
            var yOffset = (toNumber(ageCount) / 2 - toNumber(idx) - 1) * 20;
            return withChildren(named2(Group2.value)("legend-" + age)([transform19("translate(-40," + (show140(yOffset) + ")")), class_47("legend-item")]))([elem4(Rect2.value)([width51(18), height51(18), fill49(getAgeColorByName(age))]), elem4(Text3.value)([x45(24), y46(9), dy3(5.6), textContent25(age), class_47("legend-label")])]);
          };
        };
        var makeStateLabel = function(stateData) {
          var startAngle = toNumber(stateData.stateIndex) * anglePerState - pi / 2;
          var labelAngle = startAngle + anglePerState / 2;
          var labelX = 320 * cos(labelAngle);
          var labelY = 320 * sin(labelAngle);
          var rotation = labelAngle * 180 / pi + 90;
          return elem4(Text3.value)([x45(labelX), y46(labelY), textAnchor23("middle"), fontSize16(10), transform19("rotate(" + (show140(rotation) + (" " + (show140(labelX) + (" " + (show140(labelY) + ")")))))), textContent25(stateData.state), class_47("state-label")]);
        };
        var makeStateArcs = function(stateData) {
          return mapWithIndex2(function(ageIdx) {
            return function(segment) {
              var startAngle = toNumber(stateData.stateIndex) * anglePerState - pi / 2;
              var endAngle = startAngle + anglePerState;
              return elem4(Path3.value)([d17(arcPath2(startAngle)(endAngle)(segment.innerRadius)(segment.outerRadius)), fill49(getAgeColor(ageIdx)), class_47("age-arc")]);
            };
          })(stateData.ageSegments);
        };
        var tree3 = withChild(named2(SVG.value)("svg")([width51(700), height51(700), viewBox45("0 0 " + (show140(700) + (" " + show140(700)))), class_47("radial-stacked-bar")]))(withChildren(named2(Group2.value)("plot-area")([transform19("translate(" + (show140(centerX) + ("," + (show140(centerY) + ")"))))]))([withChildren(named2(Group2.value)("y-axis")([textAnchor23("middle")]))(append122([elem4(Text3.value)([y46(-(300 + 10)), fontSize16(12), textContent25("Population"), class_47("axis-label")])])(concatMap(makeGridLine)(gridValues))), withChildren(named2(Group2.value)("legend")([]))(mapWithIndex2(makeLegendItem)(ageGroups)), withChildren(named2(Group2.value)("data-arcs")([]))(concatMap(makeStateArcs)(states)), withChildren(named2(Group2.value)("state-labels")([]))(map74(makeStateLabel)(states))]));
        return bind132(renderTree60(container)(tree3))(function() {
          return liftEffect119(function __do3() {
            log2("=== Radial Stacked Bar Chart ===")();
            log2("")();
            log2("States: " + show78(length(states)))();
            log2("All 50 US states + DC in polar coordinates")();
            return log2("")();
          });
        });
      }));
    };
  };
  var radialStackedBar = function(selector) {
    return launchAff_(bind76(loadPopulationData2)(function(populationData) {
      return liftEffect43(drawRadialStackedBar(selector)(populationData));
    }));
  };

  // output/Component.Tour.TourProfessional/index.js
  var discard67 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var pure71 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize35 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var render39 = function(v) {
    return div2([classes(["tutorial-page"])])([renderHeader2(TourProfessional.value), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("2. Typical Charts")]), p_([text2("Real-world examples of common chart types showing state-level US population data and economic indicators. These are the kinds of charts you'd typically create for data analysis and reporting - more complex than the foundations, but without hierarchies, animations, transitions, or physical simulations.")]), p_([text2("Each example demonstrates best practices for scales, axes, legends, and color coding to create clear and informative visualizations.")])]), section([classes(["tutorial-section"]), id3("grouped-bar")])([h2([classes(["tutorial-section-title"])])([text2("1. Grouped Bar Chart")]), p_([text2("US population by state and age group. This grouped bar chart shows population distribution across 6 states (CA, TX, FL, NY, PA, IL) broken down into 9 age groups. Each state has its own cluster of bars, with colors representing different age groups.")]), div2([classes(["tutorial-viz-container"])])([div2([id3("grouped-bar-viz"), classes(["grouped-bar-viz"])])([])]), p_([text2("The chart uses nested band scales: an outer scale positions each state cluster, and an inner scale positions individual bars within each cluster. The population values are scaled linearly to bar heights, with colors from the Spectral color scheme to distinguish age groups.")]), p_([text2("View this example "), a([href("#" + routeToPath(new Example("grouped-bar-chart")))])([text2("with full source code")]), text2(".")])]), section([classes(["tutorial-section"]), id3("multi-line")])([h2([classes(["tutorial-section-title"])])([text2("2. Multi-Line Chart")]), p_([text2("Unemployment rates over time for 42 US metro areas from 2000 to 2013. This chart shows how unemployment fluctuated across the country, clearly illustrating the impact of the 2008 financial crisis and subsequent recovery. With so many overlapping lines, the data would be impossible to read without interaction.")]), div2([classes(["tutorial-viz-container"])])([div2([id3("multi-line-viz"), classes(["multi-line-viz"])])([])]), p_([text2("All lines are drawn in light gray using SVG path elements. The chart uses linear scales for time (x-axis) and unemployment percentage (y-axis), with axis labels for context.")]), p_([strong_([text2("Try hovering over the lines! ")]), text2("This is the key feature: when you hover over any line, it darkens while the others remain light gray, making it easy to trace that individual metro area through the tangle of overlapping data. This demonstrates a fundamental advantage of web-based visualization over print: interactivity makes complex, dense datasets readable. In a static image, these 42 overlapping lines would be nearly impossible to interpret.")])]), section([classes(["tutorial-section"]), id3("radial-stacked")])([h2([classes(["tutorial-section-title"])])([text2("3. Radial Stacked Bar Chart")]), p_([text2('The same US state population data as the grouped bar chart, but visualized in polar coordinates. Each state gets a wedge around the circle, with age groups stacked radially from the center outward. This "sunburst-like" layout efficiently uses space and creates an aesthetically pleasing circular composition.')]), div2([classes(["tutorial-viz-container"])])([div2([id3("radial-stacked-viz"), classes(["radial-stacked-viz"])])([])]), p_([text2("Radial charts work best for cyclical or seasonal data, but we're using the same state population data here to demonstrate how the same dataset can be visualized in multiple ways. The chart uses polar coordinates with an angular scale (\u03B8) dividing the circle by states and a radial scale (r) for population. Arc paths are generated for each segment, with the same Spectral color scheme as the grouped bar chart. State labels are positioned around the perimeter.")])])])]);
  };
  var handleAction34 = function(dictMonadAff) {
    var liftEffect51 = liftEffect(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    return function(v) {
      return discard67(liftEffect51(groupedBarChart("#grouped-bar-viz")))(function() {
        return discard67(liftEffect51(multiLineChart("#multi-line-viz")))(function() {
          return discard67(liftEffect51(radialStackedBar("#radial-stacked-viz")))(function() {
            return pure71(unit);
          });
        });
      });
    };
  };
  var component35 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render39,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction34(dictMonadAff),
        initialize: new Just(Initialize35.value)
      })
    });
  };

  // output/Component.Tour.TourShowcase/index.js
  var pure72 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize36 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var render40 = function(v) {
    return div2([classes(["tutorial-page"])])([renderHeader2(TourShowcase.value), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("Showcase: Flagship Demonstrations")]), p_([text2("This page highlights the most impressive and complete demonstrations of the PS<$>D3 library. These examples combine multiple techniques from the tour to create sophisticated, production-ready visualizations.")]), p_([text2("Each showcase example demonstrates the full power of combining PureScript's type safety with D3's visualization capabilities, showing what's possible when you bring together advanced programming language features and data visualization.")])]), section([classes(["tutorial-section"]), id3("animated-tree-cluster")])([h2([classes(["tutorial-section-title"])])([text2("Animated Tree \u2194 Cluster Transitions")]), p_([text2("This flagship demonstration shows smooth, bidirectional animations between Tree and Cluster layouts. It visualizes 252 nodes from the Flare visualization toolkit, demonstrating:")]), ul_([li_([text2("Smooth transitions using D3's data join with identity-based keys")]), li_([text2("Height-based child sorting to eliminate crossovers during animation")]), li_([text2("Extent-based centering for balanced layout")]), li_([text2("Complex hierarchical data with 252 nodes transitioning smoothly")])]), p_([a([href("#" + routeToPath(AnimatedTreeCluster.value))])([text2("View the Animated Tree \u2194 Cluster demonstration \u2192")])]), p_([text2("This example showcases the TreeAPI's capability to handle complex layout transitions with proper enter/update/exit patterns, ensuring every node maintains its identity across layout changes for smooth, comprehensible animations.")])]), section([classes(["tutorial-section"]), id3("lesmis-gup-tree")])([h2([classes(["tutorial-section-title"])])([text2("Les Mis\xE9rables with General Update Pattern")]), p_([text2("A proof-of-concept combining the General Update Pattern (GUP) with Tree API and dynamic layouts. This demonstration shows character relationships from Victor Hugo's Les Mis\xE9rables with dynamic updates and transitions.")]), p_([a([href("#" + routeToPath(LesMisGUPTree.value))])([text2("View the Les Mis\xE9rables GUP demonstration \u2192")])]), p_([text2("This example demonstrates how the library can combine multiple advanced techniques: hierarchical layouts, force-directed positioning, and the General Update Pattern for smooth enter/update/exit transitions.")])]), section([classes(["tutorial-section"]), id3("module-graph")])([h2([classes(["tutorial-section-title"])])([text2("Module Dependency Graph (Dogfooding)")]), p_([text2('A self-referential visualization showing the module dependencies of the PS<$>D3 library itself. This is "dogfooding" - using our library to visualize its own structure.')]), p_([a([href("#" + routeToPath(ModuleGraph.value))])([text2("View the Module Dependency Graph \u2192")])]), p_([text2("This example shows:")]), ul_([li_([text2("How the library can visualize its own architecture")]), li_([text2("Hierarchical relationships between modules")]), li_([text2("The power of tree layouts for understanding code structure")]), li_([text2("Self-hosting capabilities of the visualization system")])])]), section([classes(["tutorial-section"]), id3("gallery")])([h2([classes(["tutorial-section-title"])])([text2("Full Examples Gallery")]), p_([text2("For a complete collection of all working examples with source code, visit the "), a([href("#" + routeToPath(Gallery.value))])([text2("Examples Gallery")]), text2(". The gallery provides a comprehensive view of all TreeAPI examples, organized by category and difficulty level.")]), p_([text2("Each example in the gallery includes:")]), ul_([li_([text2("Full source code with syntax highlighting")]), li_([text2("Interactive demonstrations")]), li_([text2("Detailed explanations of techniques used")]), li_([text2("Links to relevant API documentation")])])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Coming Soon")]), p_([text2("As more sophisticated examples are implemented in TreeAPI, they will be featured here in the showcase. Future additions may include:")]), ul_([li_([text2("Interactive chord diagrams with relationship filtering")]), li_([text2("Animated Sankey diagrams showing flow changes over time")]), li_([text2("Force-directed graphs with custom physics simulations")]), li_([text2("Multi-view coordinated visualizations")]), li_([text2("Real-time data streaming visualizations")]), li_([text2("Complex interactive dashboards combining multiple visualization types")])]), p_([text2("The goal is to demonstrate that PureScript + D3 can handle any visualization challenge, with better type safety, composability, and maintainability than pure JavaScript solutions.")])])])]);
  };
  var handleAction35 = function(dictMonadAff) {
    return function(v) {
      return pure72(unit);
    };
  };
  var component36 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render40,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction35(dictMonadAff),
        initialize: new Just(Initialize36.value)
      })
    });
  };

  // output/Component.WealthHealth.Types/index.js
  var EastAsiaAndPacific = /* @__PURE__ */ (function() {
    function EastAsiaAndPacific2() {
    }
    ;
    EastAsiaAndPacific2.value = new EastAsiaAndPacific2();
    return EastAsiaAndPacific2;
  })();
  var Europe = /* @__PURE__ */ (function() {
    function Europe2() {
    }
    ;
    Europe2.value = new Europe2();
    return Europe2;
  })();
  var LatinAmericaAndCaribbean = /* @__PURE__ */ (function() {
    function LatinAmericaAndCaribbean2() {
    }
    ;
    LatinAmericaAndCaribbean2.value = new LatinAmericaAndCaribbean2();
    return LatinAmericaAndCaribbean2;
  })();
  var MiddleEastAndNorthAfrica = /* @__PURE__ */ (function() {
    function MiddleEastAndNorthAfrica2() {
    }
    ;
    MiddleEastAndNorthAfrica2.value = new MiddleEastAndNorthAfrica2();
    return MiddleEastAndNorthAfrica2;
  })();
  var SouthAsia = /* @__PURE__ */ (function() {
    function SouthAsia2() {
    }
    ;
    SouthAsia2.value = new SouthAsia2();
    return SouthAsia2;
  })();
  var SubSaharanAfrica = /* @__PURE__ */ (function() {
    function SubSaharanAfrica2() {
    }
    ;
    SubSaharanAfrica2.value = new SubSaharanAfrica2();
    return SubSaharanAfrica2;
  })();
  var NorthAmerica = /* @__PURE__ */ (function() {
    function NorthAmerica2() {
    }
    ;
    NorthAmerica2.value = new NorthAmerica2();
    return NorthAmerica2;
  })();
  var regionName = function(v) {
    if (v instanceof EastAsiaAndPacific) {
      return "East Asia & Pacific";
    }
    ;
    if (v instanceof Europe) {
      return "Europe & Central Asia";
    }
    ;
    if (v instanceof LatinAmericaAndCaribbean) {
      return "Latin America & Caribbean";
    }
    ;
    if (v instanceof MiddleEastAndNorthAfrica) {
      return "Middle East & North Africa";
    }
    ;
    if (v instanceof SouthAsia) {
      return "South Asia";
    }
    ;
    if (v instanceof SubSaharanAfrica) {
      return "Sub-Saharan Africa";
    }
    ;
    if (v instanceof NorthAmerica) {
      return "North America";
    }
    ;
    throw new Error("Failed pattern match at Component.WealthHealth.Types (line 27, column 14 - line 34, column 34): " + [v.constructor.name]);
  };
  var regionColor = function(v) {
    if (v instanceof EastAsiaAndPacific) {
      return "#e41a1c";
    }
    ;
    if (v instanceof Europe) {
      return "#377eb8";
    }
    ;
    if (v instanceof LatinAmericaAndCaribbean) {
      return "#4daf4a";
    }
    ;
    if (v instanceof MiddleEastAndNorthAfrica) {
      return "#984ea3";
    }
    ;
    if (v instanceof SouthAsia) {
      return "#ff7f00";
    }
    ;
    if (v instanceof SubSaharanAfrica) {
      return "#ffff33";
    }
    ;
    if (v instanceof NorthAmerica) {
      return "#a65628";
    }
    ;
    throw new Error("Failed pattern match at Component.WealthHealth.Types (line 38, column 15 - line 45, column 28): " + [v.constructor.name]);
  };

  // output/Component.WealthHealth.Actions/index.js
  var Initialize37 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var DataLoaded = /* @__PURE__ */ (function() {
    function DataLoaded2(value0) {
      this.value0 = value0;
    }
    ;
    DataLoaded2.create = function(value0) {
      return new DataLoaded2(value0);
    };
    return DataLoaded2;
  })();
  var DataLoadFailed = /* @__PURE__ */ (function() {
    function DataLoadFailed2(value0) {
      this.value0 = value0;
    }
    ;
    DataLoadFailed2.create = function(value0) {
      return new DataLoadFailed2(value0);
    };
    return DataLoadFailed2;
  })();
  var SetYear = /* @__PURE__ */ (function() {
    function SetYear2(value0) {
      this.value0 = value0;
    }
    ;
    SetYear2.create = function(value0) {
      return new SetYear2(value0);
    };
    return SetYear2;
  })();
  var TogglePlay = /* @__PURE__ */ (function() {
    function TogglePlay2() {
    }
    ;
    TogglePlay2.value = new TogglePlay2();
    return TogglePlay2;
  })();
  var Tick = /* @__PURE__ */ (function() {
    function Tick2() {
    }
    ;
    Tick2.value = new Tick2();
    return Tick2;
  })();
  var HoverNation = /* @__PURE__ */ (function() {
    function HoverNation2(value0) {
      this.value0 = value0;
    }
    ;
    HoverNation2.create = function(value0) {
      return new HoverNation2(value0);
    };
    return HoverNation2;
  })();
  var ToggleNationSelection = /* @__PURE__ */ (function() {
    function ToggleNationSelection2(value0) {
      this.value0 = value0;
    }
    ;
    ToggleNationSelection2.create = function(value0) {
      return new ToggleNationSelection2(value0);
    };
    return ToggleNationSelection2;
  })();
  var SetAnimationSpeed = /* @__PURE__ */ (function() {
    function SetAnimationSpeed2(value0) {
      this.value0 = value0;
    }
    ;
    SetAnimationSpeed2.create = function(value0) {
      return new SetAnimationSpeed2(value0);
    };
    return SetAnimationSpeed2;
  })();
  var ToggleLabels = /* @__PURE__ */ (function() {
    function ToggleLabels2() {
    }
    ;
    ToggleLabels2.value = new ToggleLabels2();
    return ToggleLabels2;
  })();
  var Render = /* @__PURE__ */ (function() {
    function Render2() {
    }
    ;
    Render2.value = new Render2();
    return Render2;
  })();

  // output/Component.WealthHealth.Data/foreign.js
  function parseNationsJSON(jsonString) {
    try {
      return JSON.parse(jsonString);
    } catch (e) {
      console.error("Failed to parse nations JSON:", e);
      return [];
    }
  }

  // output/Component.WealthHealth.Data/index.js
  var bind77 = /* @__PURE__ */ bind(bindMaybe);
  var pure73 = /* @__PURE__ */ pure(applicativeMaybe);
  var bind133 = /* @__PURE__ */ bind(bindArray);
  var pure124 = /* @__PURE__ */ pure(applicativeArray);
  var min10 = /* @__PURE__ */ min(ordInt);
  var maximum14 = /* @__PURE__ */ maximum(ordInt)(foldableArray);
  var minimum6 = /* @__PURE__ */ minimum(ordInt)(foldableArray);
  var div5 = /* @__PURE__ */ div(euclideanRingInt);
  var comparing3 = /* @__PURE__ */ comparing(ordNumber);
  var map75 = /* @__PURE__ */ map(functorArray);
  var pure212 = /* @__PURE__ */ pure(applicativeAff);
  var parseRegionString = function(v) {
    if (v === "East Asia & Pacific") {
      return new Just(EastAsiaAndPacific.value);
    }
    ;
    if (v === "Europe & Central Asia") {
      return new Just(Europe.value);
    }
    ;
    if (v === "America") {
      return new Just(LatinAmericaAndCaribbean.value);
    }
    ;
    if (v === "Middle East & North Africa") {
      return new Just(MiddleEastAndNorthAfrica.value);
    }
    ;
    if (v === "South Asia") {
      return new Just(SouthAsia.value);
    }
    ;
    if (v === "Sub-Saharan Africa") {
      return new Just(SubSaharanAfrica.value);
    }
    ;
    return Nothing.value;
  };
  var parseNationData = function(raw) {
    return bind77(parseRegionString(raw.region))(function(region) {
      return pure73({
        name: raw.name,
        region,
        income: raw.income,
        population: raw.population,
        lifeExpectancy: raw.lifeExpectancy
      });
    });
  };
  var nationsDataUrl = "data/nations.json";
  var calculateYearRange = function(nations) {
    var allYears = bind133(nations)(function(nation) {
      return bind133(nation.income)(function(yearValue) {
        var v = index(yearValue)(0);
        if (v instanceof Just) {
          return pure124(floor2(v.value0));
        }
        ;
        if (v instanceof Nothing) {
          return [];
        }
        ;
        throw new Error("Failed pattern match at Component.WealthHealth.Data (line 125, column 7 - line 127, column 22): " + [v.constructor.name]);
      });
    });
    var maxYear = min10(2005)(fromMaybe(2009)(maximum14(allYears)));
    var minYear = fromMaybe(1800)(minimum6(allYears));
    return {
      min: minYear,
      max: maxYear
    };
  };
  var bisectLeft = function(target7) {
    return function(arr) {
      var go2 = function($copy_low) {
        return function($copy_high) {
          var $tco_var_low = $copy_low;
          var $tco_done = false;
          var $tco_result;
          function $tco_loop(low2, high2) {
            if (low2 >= high2) {
              $tco_done = true;
              return low2;
            }
            ;
            if (otherwise) {
              var mid = div5(low2 + high2 | 0)(2);
              var v = bind77(index(arr)(mid))(function(v1) {
                return index(v1)(0);
              });
              if (v instanceof Just && v.value0 < target7) {
                $tco_var_low = mid + 1 | 0;
                $copy_high = high2;
                return;
              }
              ;
              $tco_var_low = low2;
              $copy_high = mid;
              return;
            }
            ;
            throw new Error("Failed pattern match at Component.WealthHealth.Data (line 157, column 5 - line 163, column 28): " + [low2.constructor.name, high2.constructor.name]);
          }
          ;
          while (!$tco_done) {
            $tco_result = $tco_loop($tco_var_low, $copy_high);
          }
          ;
          return $tco_result;
        };
      };
      return go2(0)(length(arr));
    };
  };
  var interpolateValue = function(targetYear) {
    return function(dataPoints) {
      var v = sortBy(comparing3(function(arr) {
        return fromMaybe(0)(index(arr)(0));
      }))(dataPoints);
      if (v.length === 0) {
        return Nothing.value;
      }
      ;
      var yearNum = toNumber(targetYear);
      var i2 = bisectLeft(yearNum)(v);
      return bind77(index(v)(i2))(function(a2) {
        return bind77(index(a2)(0))(function(aYear) {
          return bind77(index(a2)(1))(function(aValue) {
            var $39 = i2 > 0;
            if ($39) {
              return bind77(index(v)(i2 - 1 | 0))(function(b10) {
                return bind77(index(b10)(0))(function(bYear) {
                  return bind77(index(b10)(1))(function(bValue) {
                    var t = (yearNum - aYear) / (bYear - aYear);
                    return pure73(aValue * (1 - t) + bValue * t);
                  });
                });
              });
            }
            ;
            return pure73(aValue);
          });
        });
      });
    };
  };
  var fillMissingYears = function(yearRange) {
    return function(dataPoints) {
      var $$null5 = function(arr) {
        var v = head(arr);
        if (v instanceof Nothing) {
          return true;
        }
        ;
        if (v instanceof Just) {
          return false;
        }
        ;
        throw new Error("Failed pattern match at Component.WealthHealth.Data (line 81, column 16 - line 83, column 22): " + [v.constructor.name]);
      };
      var $42 = $$null5(dataPoints);
      if ($42) {
        return Nothing.value;
      }
      ;
      var fillYear = function(year) {
        var v = interpolateValue(floor2(year))(dataPoints);
        if (v instanceof Just) {
          return [year, v.value0];
        }
        ;
        if (v instanceof Nothing) {
          return [year, 0];
        }
        ;
        throw new Error("Failed pattern match at Component.WealthHealth.Data (line 75, column 23 - line 77, column 31): " + [v.constructor.name]);
      };
      var allYears = map75(toNumber)(range2(yearRange.min)(yearRange.max));
      return new Just(map75(fillYear)(allYears));
    };
  };
  var fillNationData = function(yearRange) {
    return function(nation) {
      return bind77(fillMissingYears(yearRange)(nation.income))(function(filledIncome) {
        return bind77(fillMissingYears(yearRange)(nation.population))(function(filledPopulation) {
          return bind77(fillMissingYears(yearRange)(nation.lifeExpectancy))(function(filledLifeExpectancy) {
            return pure73({
              name: nation.name,
              region: nation.region,
              income: filledIncome,
              population: filledPopulation,
              lifeExpectancy: filledLifeExpectancy
            });
          });
        });
      });
    };
  };
  var loadNationsData = /* @__PURE__ */ bind(bindAff)(/* @__PURE__ */ get3(string)(nationsDataUrl))(function(result) {
    return pure212((function() {
      if (result instanceof Left) {
        return new Left("Failed to load nations data: " + printError(result.value0));
      }
      ;
      if (result instanceof Right) {
        var rawNations = parseNationsJSON(result.value0.body);
        var nations = catMaybes(map75(parseNationData)(rawNations));
        var yearRange = calculateYearRange(nations);
        var filledNations = catMaybes(map75(fillNationData(yearRange))(nations));
        return new Right({
          nations: filledNations,
          yearRange
        });
      }
      ;
      throw new Error("Failed pattern match at Component.WealthHealth.Data (line 104, column 8 - line 115, column 50): " + [result.constructor.name]);
    })());
  });
  var getNationAtYear = function(year) {
    return function(nation) {
      return bind77(interpolateValue(year)(nation.income))(function(income) {
        return bind77(interpolateValue(year)(nation.population))(function(population) {
          return bind77(interpolateValue(year)(nation.lifeExpectancy))(function(lifeExpectancy) {
            return pure73({
              name: nation.name,
              region: nation.region,
              year,
              income,
              population,
              lifeExpectancy
            });
          });
        });
      });
    };
  };
  var getAllNationsAtYear = function(year) {
    return function(model) {
      return catMaybes(map75(getNationAtYear(year))(model.nations));
    };
  };

  // output/Component.WealthHealth.State/index.js
  var AlwaysShow = /* @__PURE__ */ (function() {
    function AlwaysShow2() {
    }
    ;
    AlwaysShow2.value = new AlwaysShow2();
    return AlwaysShow2;
  })();
  var OnHoverOnly = /* @__PURE__ */ (function() {
    function OnHoverOnly2() {
    }
    ;
    OnHoverOnly2.value = new OnHoverOnly2();
    return OnHoverOnly2;
  })();
  var initialState2 = function(v) {
    return {
      model: Nothing.value,
      currentYear: 1800,
      playing: false,
      hoveredNation: Nothing.value,
      selectedNations: empty8,
      animationSpeed: 5,
      animationSubscriptionId: Nothing.value,
      labelMode: OnHoverOnly.value,
      vizUpdateFn: Nothing.value
    };
  };

  // output/Component.WealthHealth.HTML/index.js
  var map76 = /* @__PURE__ */ map(functorMaybe);
  var show79 = /* @__PURE__ */ show(showInt);
  var type_20 = /* @__PURE__ */ type_3(isPropInputType);
  var value15 = /* @__PURE__ */ value3(isPropString);
  var show141 = /* @__PURE__ */ show(showNumber);
  var renderLegendItem = function(region) {
    return div2([classes(["wealth-health-legend__item"])])([span2([classes(["wealth-health-legend__color"]), style("background-color: " + regionColor(region))])([]), span2([classes(["wealth-health-legend__label"])])([text2(regionName(region))])]);
  };
  var renderControlPanel = function(state3) {
    var toNum = function(s) {
      return fromString(s);
    };
    var toInt = function(s) {
      return map76(floor2)(toNum(s));
    };
    return div2([classes(["wealth-health-controls"])])([div2([classes(["wealth-health-year-display"])])([text2(show79(state3.currentYear))]), div2([classes(["wealth-health-scrubber"])])([label_([text2("Year")]), input([type_20(InputRange.value), min4(toNumber(fromMaybe(1800)(map76(function(v) {
      return v.yearRange.min;
    })(state3.model)))), max4(toNumber(fromMaybe(2009)(map76(function(v) {
      return v.yearRange.max;
    })(state3.model)))), value15(show79(state3.currentYear)), step3(new Step(1)), onValueInput(function(val) {
      return new SetYear(fromMaybe(state3.currentYear)(toInt(val)));
    }), classes(["wealth-health-scrubber__slider"])])]), div2([classes(["wealth-health-playback"])])([button([classes(["wealth-health-playback__button"]), onClick(function(v) {
      return TogglePlay.value;
    })])([text2((function() {
      if (state3.playing) {
        return "Pause";
      }
      ;
      return "Play";
    })())])]), div2([classes(["wealth-health-speed"])])([label_([text2("Speed")]), input([type_20(InputRange.value), min4(1), max4(10), value15(show141(state3.animationSpeed)), step3(new Step(0.5)), onValueInput(function(val) {
      return new SetAnimationSpeed(fromMaybe(5)(toNum(val)));
    }), classes(["wealth-health-speed__slider"])]), span2([classes(["wealth-health-speed__value"])])([text2(show141(state3.animationSpeed) + " years/sec")])]), div2([classes(["wealth-health-labels"])])([label_([text2("Show labels:")]), button([classes(["wealth-health-labels__toggle"]), onClick(function(v) {
      return ToggleLabels.value;
    })])([text2((function() {
      if (state3.labelMode instanceof AlwaysShow) {
        return "Always";
      }
      ;
      if (state3.labelMode instanceof OnHoverOnly) {
        return "Only on hover";
      }
      ;
      throw new Error("Failed pattern match at Component.WealthHealth.HTML (line 79, column 25 - line 81, column 47): " + [state3.labelMode.constructor.name]);
    })())])])]);
  };
  var formatPopulation = function(n) {
    var millions = n / 1e6;
    return show79(floor2(millions)) + "M";
  };
  var formatNumber = function(n) {
    return show79(floor2(n));
  };
  var allRegions = /* @__PURE__ */ (function() {
    return [EastAsiaAndPacific.value, Europe.value, LatinAmericaAndCaribbean.value, MiddleEastAndNorthAfrica.value, SouthAsia.value, SubSaharanAfrica.value, NorthAmerica.value];
  })();
  var renderLegend = /* @__PURE__ */ div2([/* @__PURE__ */ classes(["wealth-health-legend"])])([/* @__PURE__ */ h3_([/* @__PURE__ */ text2("Regions")]), /* @__PURE__ */ div2([/* @__PURE__ */ classes(["wealth-health-legend__items"])])(/* @__PURE__ */ map(functorArray)(renderLegendItem)(allRegions))]);

  // output/D3.Viz.TreeAPI.WealthHealthDraw/index.js
  var x115 = /* @__PURE__ */ x1(toAttrNumberNumber);
  var x216 = /* @__PURE__ */ x22(toAttrNumberNumber);
  var y115 = /* @__PURE__ */ y1(toAttrNumberNumber);
  var y216 = /* @__PURE__ */ y22(toAttrNumberNumber);
  var stroke38 = /* @__PURE__ */ stroke(toAttrStringString);
  var strokeWidth38 = /* @__PURE__ */ strokeWidth3(toAttrNumberNumber);
  var x46 = /* @__PURE__ */ x3(toAttrNumberNumber);
  var y47 = /* @__PURE__ */ y3(toAttrNumberNumber);
  var textAnchor24 = /* @__PURE__ */ textAnchor(toAttrStringString);
  var fontSize17 = /* @__PURE__ */ fontSize2(toAttrNumberNumber);
  var fill50 = /* @__PURE__ */ fill3(toAttrStringString);
  var textContent26 = /* @__PURE__ */ textContent(toAttrStringString);
  var show80 = /* @__PURE__ */ show(showInt);
  var max13 = /* @__PURE__ */ max(ordNumber);
  var bind78 = /* @__PURE__ */ bind(bindD3v2M);
  var select42 = /* @__PURE__ */ select4(selectionMD3v2Selection_D);
  var width52 = /* @__PURE__ */ width8(toAttrNumberNumber);
  var height52 = /* @__PURE__ */ height8(toAttrNumberNumber);
  var viewBox46 = /* @__PURE__ */ viewBox2(toAttrStringString);
  var show142 = /* @__PURE__ */ show(showNumber);
  var class_48 = /* @__PURE__ */ class_2(toAttrStringString);
  var strokeOpacity7 = /* @__PURE__ */ strokeOpacity(toAttrNumberNumber);
  var append123 = /* @__PURE__ */ append(semigroupArray);
  var map77 = /* @__PURE__ */ map(functorArray);
  var renderTree61 = /* @__PURE__ */ renderTree(selectionMD3v2Selection_D)(/* @__PURE__ */ ordRecord()(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordNil)()({
    reflectSymbol: function() {
      return "regionColor";
    }
  })(ordString))()({
    reflectSymbol: function() {
      return "region";
    }
  })(ordString))()({
    reflectSymbol: function() {
      return "population";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "name";
    }
  })(ordString))()({
    reflectSymbol: function() {
      return "lifeExpectancy";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "income";
    }
  })(ordNumber)));
  var pure74 = /* @__PURE__ */ pure(applicativeD3v2M);
  var joinDataWithKey5 = /* @__PURE__ */ joinDataWithKey(selectionMD3v2Selection_D)(foldableArray)(ordString);
  var cx38 = /* @__PURE__ */ cx3(toAttrNumberFunctionNumbe);
  var cy38 = /* @__PURE__ */ cy3(toAttrNumberFunctionNumbe);
  var radius38 = /* @__PURE__ */ radius3(toAttrNumberFunctionNumbe);
  var fill112 = /* @__PURE__ */ fill3(toAttrStringFunctionStrin);
  var fillOpacity11 = /* @__PURE__ */ fillOpacity(toAttrNumberNumber);
  var append29 = /* @__PURE__ */ append10(selectionMD3v2Selection_D);
  var setAttrs5 = /* @__PURE__ */ setAttrs(selectionMD3v2Selection_D);
  var discard68 = /* @__PURE__ */ discard(discardUnit)(bindD3v2M);
  var remove8 = /* @__PURE__ */ remove3(selectionMD3v2Selection_D);
  var merge5 = /* @__PURE__ */ merge(selectionMD3v2Selection_D);
  var on13 = /* @__PURE__ */ on2(selectionMD3v2Selection_D);
  var yTicks = [20, 30, 40, 50, 60, 70, 80];
  var xTicks = [200, 500, 1e3, 2e3, 5e3, 1e4, 2e4, 5e4, 1e5];
  var scaleY2 = function(config) {
    return function(lifeExpectancy) {
      var rangeHeight = config.height - config.marginTop - config.marginBottom;
      var normalized = (lifeExpectancy - 14) / (86 - 14);
      return config.height - config.marginBottom - normalized * rangeHeight;
    };
  };
  var yAxisTick = function(config) {
    return function(tickValue) {
      return withChildren(named2(Group2.value)("y-tick")([]))([elem4(Line2.value)([x115(config.marginLeft - 6), x216(config.marginLeft), y115(scaleY2(config)(tickValue)), y216(scaleY2(config)(tickValue)), stroke38("#333"), strokeWidth38(1)]), elem4(Text3.value)([x46(config.marginLeft - 10), y47(scaleY2(config)(tickValue) + 3), textAnchor24("end"), fontSize17(10), fill50("#333"), textContent26(show80(floor2(tickValue)))])]);
    };
  };
  var scaleX2 = function(config) {
    return function(income) {
      var rangeWidth = config.width - config.marginLeft - config.marginRight;
      var logIncome = (function() {
        var $86 = income > 0;
        if ($86) {
          return log(income);
        }
        ;
        return 5.298317;
      })();
      var normalized = (logIncome - 5.298317) / (11.512925 - 5.298317);
      return config.marginLeft + normalized * rangeWidth;
    };
  };
  var verticalGridLine = function(config) {
    return function(tickValue) {
      return elem4(Line2.value)([x115(0.5 + scaleX2(config)(tickValue)), x216(0.5 + scaleX2(config)(tickValue)), y115(config.marginTop), y216(config.height - config.marginBottom)]);
    };
  };
  var scaleRadius = function(population) {
    var normalized = population / 5e9;
    var scaled = sqrt(normalized) * 80;
    return max13(3)(scaled);
  };
  var horizontalGridLine = function(config) {
    return function(tickValue) {
      return elem4(Line2.value)([y115(0.5 + scaleY2(config)(tickValue)), y216(0.5 + scaleY2(config)(tickValue)), x115(config.marginLeft), x216(config.width - config.marginRight)]);
    };
  };
  var formatPopulation2 = function(n) {
    if (n >= 1e9) {
      return show80(floor2(n / 1e9)) + "B";
    }
    ;
    if (n >= 1e6) {
      return show80(floor2(n / 1e6)) + "M";
    }
    ;
    if (n >= 1e3) {
      return show80(floor2(n / 1e3)) + "K";
    }
    ;
    if (otherwise) {
      return show80(floor2(n));
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.TreeAPI.WealthHealthDraw (line 300, column 1 - line 300, column 37): " + [n.constructor.name]);
  };
  var formatIncome = function(value18) {
    if (value18 >= 1e3) {
      return "$" + (show80(floor2(value18 / 1e3)) + "k");
    }
    ;
    if (otherwise) {
      return "$" + show80(floor2(value18));
    }
    ;
    throw new Error("Failed pattern match at D3.Viz.TreeAPI.WealthHealthDraw (line 85, column 1 - line 85, column 33): " + [value18.constructor.name]);
  };
  var xAxisTick = function(config) {
    return function(tickValue) {
      return withChildren(named2(Group2.value)("x-tick")([]))([elem4(Line2.value)([x115(scaleX2(config)(tickValue)), x216(scaleX2(config)(tickValue)), y115(config.height - config.marginBottom), y216(config.height - config.marginBottom + 6), stroke38("#333"), strokeWidth38(1)]), elem4(Text3.value)([x46(scaleX2(config)(tickValue)), y47(config.height - config.marginBottom + 15), textAnchor24("middle"), fontSize17(10), fill50("#333"), textContent26(formatIncome(tickValue))])]);
    };
  };
  var defaultConfig = {
    width: 960,
    height: 560,
    marginTop: 20,
    marginRight: 20,
    marginBottom: 35,
    marginLeft: 40
  };
  var initWealthHealth = function(selector) {
    return runD3v2M(bind78(select42(selector))(function(container) {
      var staticTree = withChildren(named2(SVG.value)("svg")([width52(defaultConfig.width), height52(defaultConfig.height), viewBox46("0 0 " + (show142(defaultConfig.width) + (" " + show142(defaultConfig.height)))), class_48("wealth-health-viz")]))([withChildren(named2(Group2.value)("grid")([stroke38("currentColor"), strokeOpacity7(0.1)]))(append123(map77(verticalGridLine(defaultConfig))(xTicks))(map77(horizontalGridLine(defaultConfig))(yTicks))), withChildren(named2(Group2.value)("x-axis")([]))([elem4(Line2.value)([x115(defaultConfig.marginLeft), y115(defaultConfig.height - defaultConfig.marginBottom), x216(defaultConfig.width - defaultConfig.marginRight), y216(defaultConfig.height - defaultConfig.marginBottom), stroke38("#333"), strokeWidth38(1.5)])]), withChildren(named2(Group2.value)("x-ticks")([]))(map77(xAxisTick(defaultConfig))(xTicks)), elem4(Text3.value)([x46(defaultConfig.width / 2), y47(defaultConfig.height - 5), textAnchor24("middle"), fontSize17(14), fill50("#333"), textContent26("Income per Person (GDP/capita, PPP$ inflation-adjusted)")]), withChildren(named2(Group2.value)("y-axis")([]))([elem4(Line2.value)([x115(defaultConfig.marginLeft), y115(defaultConfig.marginTop), x216(defaultConfig.marginLeft), y216(defaultConfig.height - defaultConfig.marginBottom), stroke38("#333"), strokeWidth38(1.5)])]), withChildren(named2(Group2.value)("y-ticks")([]))(map77(yAxisTick(defaultConfig))(yTicks)), elem4(Text3.value)([x46(15), y47(defaultConfig.height / 2), textAnchor24("middle"), fontSize17(14), fill50("#333"), textContent26("Life Expectancy (years)")]), withChildren(named2(Group2.value)("nations-container")([class_48("nations")]))([])]);
      return bind78(renderTree61(container)(staticTree))(function() {
        return pure74(function(nations) {
          return runD3v2M(bind78(select42("#wealth-health-viz .nations"))(function(nationsContainer) {
            return bind78(joinDataWithKey5(nations)(function(v) {
              return v.name;
            })("circle")(nationsContainer))(function(v) {
              var circleAttrs = [cx38(function(n) {
                return scaleX2(defaultConfig)(n.income);
              }), cy38(function(n) {
                return scaleY2(defaultConfig)(n.lifeExpectancy);
              }), radius38(function(n) {
                return scaleRadius(n.population);
              }), fill112(function(v1) {
                return v1.regionColor;
              }), fillOpacity11(0.7), stroke38("#333"), strokeWidth38(0.5), class_48("nation-circle")];
              return bind78(append29(Circle2.value)(circleAttrs)(v.value0.enter))(function(enterCircles) {
                return bind78(setAttrs5(circleAttrs)(v.value0.update))(function() {
                  return discard68(remove8(v.value0.exit))(function() {
                    return bind78(merge5(enterCircles)(v.value0.update))(function(merged) {
                      return bind78(on13(onMouseEnterWithInfo(function(v1) {
                        var content3 = "<strong>" + (v1.datum.name + ("</strong><br/>" + ("Region: " + (v1.datum.region + ("<br/>" + ("Income: $" + (show80(floor2(v1.datum.income)) + ("<br/>" + ("Life Expectancy: " + (show80(floor2(v1.datum.lifeExpectancy)) + (" years<br/>" + ("Population: " + formatPopulation2(v1.datum.population)))))))))))));
                        return showTooltip(content3)(v1.clientX)(v1.clientY);
                      }))(merged))(function() {
                        return bind78(on13(onMouseLeaveWithInfo(function(v1) {
                          return hideTooltip;
                        }))(merged))(function() {
                          return pure74(unit);
                        });
                      });
                    });
                  });
                });
              });
            });
          }));
        });
      });
    }));
  };

  // output/Component.WealthHealth.WealthHealth/index.js
  var bind79 = /* @__PURE__ */ bind(bindHalogenM);
  var discard69 = /* @__PURE__ */ discard(discardUnit);
  var discard118 = /* @__PURE__ */ discard69(bindHalogenM);
  var pure75 = /* @__PURE__ */ pure(applicativeHalogenM);
  var modify_20 = /* @__PURE__ */ modify_2(monadStateHalogenM);
  var get23 = /* @__PURE__ */ get(monadStateHalogenM);
  var when6 = /* @__PURE__ */ when(applicativeHalogenM);
  var $$void13 = /* @__PURE__ */ $$void(functorHalogenM);
  var forever4 = /* @__PURE__ */ forever(monadRecAff);
  var discard213 = /* @__PURE__ */ discard69(bindAff);
  var liftEffect44 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var member7 = /* @__PURE__ */ member2(ordString);
  var $$delete6 = /* @__PURE__ */ $$delete4(ordString);
  var insert11 = /* @__PURE__ */ insert4(ordString);
  var map78 = /* @__PURE__ */ map(functorArray);
  var bind134 = /* @__PURE__ */ bind(bindMaybe);
  var nationPointToDrawData = function(np) {
    return {
      name: np.name,
      income: np.income,
      population: np.population,
      lifeExpectancy: np.lifeExpectancy,
      regionColor: regionColor(np.region),
      region: regionName(np.region)
    };
  };
  var handleAction36 = function(dictMonadAff) {
    var liftAff3 = liftAff(monadAffHalogenM(dictMonadAff));
    var MonadEffect0 = dictMonadAff.MonadEffect0();
    var liftEffect121 = liftEffect(monadEffectHalogenM(MonadEffect0));
    return function(dictMonadEffect) {
      return function(v) {
        if (v instanceof Initialize37) {
          return bind79(liftAff3(loadNationsData))(function(result) {
            if (result instanceof Left) {
              return discard118(liftEffect121(log2("Error loading data: " + result.value0)))(function() {
                return pure75(unit);
              });
            }
            ;
            if (result instanceof Right) {
              return handleAction36(dictMonadAff)(MonadEffect0)(new DataLoaded(result.value0));
            }
            ;
            throw new Error("Failed pattern match at Component.WealthHealth.WealthHealth (line 157, column 5 - line 162, column 40): " + [result.constructor.name]);
          });
        }
        ;
        if (v instanceof DataLoaded) {
          return discard118(modify_20(function(v1) {
            var $55 = {};
            for (var $56 in v1) {
              if ({}.hasOwnProperty.call(v1, $56)) {
                $55[$56] = v1[$56];
              }
              ;
            }
            ;
            $55.model = new Just(v.value0);
            return $55;
          }))(function() {
            return discard118(modify_20(function(v1) {
              var $58 = {};
              for (var $59 in v1) {
                if ({}.hasOwnProperty.call(v1, $59)) {
                  $58[$59] = v1[$59];
                }
                ;
              }
              ;
              $58.currentYear = v.value0.yearRange.min;
              return $58;
            }))(function() {
              return discard118(liftAff3(delay(100)))(function() {
                return bind79(liftEffect121(initWealthHealth("#wealth-health-viz")))(function(updateFn) {
                  return discard118(modify_20(function(v1) {
                    var $61 = {};
                    for (var $62 in v1) {
                      if ({}.hasOwnProperty.call(v1, $62)) {
                        $61[$62] = v1[$62];
                      }
                      ;
                    }
                    ;
                    $61.vizUpdateFn = new Just(updateFn);
                    return $61;
                  }))(function() {
                    return handleAction36(dictMonadAff)(MonadEffect0)(Render.value);
                  });
                });
              });
            });
          });
        }
        ;
        if (v instanceof DataLoadFailed) {
          return discard118(liftEffect121(log2("Data load failed: " + v.value0)))(function() {
            return pure75(unit);
          });
        }
        ;
        if (v instanceof SetYear) {
          return discard118(modify_20(function(v1) {
            var $66 = {};
            for (var $67 in v1) {
              if ({}.hasOwnProperty.call(v1, $67)) {
                $66[$67] = v1[$67];
              }
              ;
            }
            ;
            $66.currentYear = v.value0;
            return $66;
          }))(function() {
            return handleAction36(dictMonadAff)(MonadEffect0)(Render.value);
          });
        }
        ;
        if (v instanceof TogglePlay) {
          return bind79(get23)(function(state3) {
            var newPlaying = !state3.playing;
            return discard118(modify_20(function(v1) {
              var $70 = {};
              for (var $71 in v1) {
                if ({}.hasOwnProperty.call(v1, $71)) {
                  $70[$71] = v1[$71];
                }
                ;
              }
              ;
              $70.playing = newPlaying;
              return $70;
            }))(function() {
              return discard118(when6(newPlaying)((function() {
                var intervalMs = 1e3 / state3.animationSpeed;
                return bind79(liftEffect121(create))(function(v1) {
                  return bind79(subscribe2(v1.emitter))(function(subscriptionId) {
                    return discard118(modify_20(function(v2) {
                      var $74 = {};
                      for (var $75 in v2) {
                        if ({}.hasOwnProperty.call(v2, $75)) {
                          $74[$75] = v2[$75];
                        }
                        ;
                      }
                      ;
                      $74.animationSubscriptionId = new Just(subscriptionId);
                      return $74;
                    }))(function() {
                      return $$void13(liftAff3(forkAff(forever4(discard213(delay(intervalMs))(function() {
                        return liftEffect44(notify(v1.listener)(Tick.value));
                      })))));
                    });
                  });
                });
              })()))(function() {
                return when6(!newPlaying)(bind79(get23)(function(state$prime) {
                  if (state$prime.animationSubscriptionId instanceof Nothing) {
                    return pure75(unit);
                  }
                  ;
                  if (state$prime.animationSubscriptionId instanceof Just) {
                    return discard118(unsubscribe2(state$prime.animationSubscriptionId.value0))(function() {
                      return modify_20(function(v1) {
                        var $80 = {};
                        for (var $81 in v1) {
                          if ({}.hasOwnProperty.call(v1, $81)) {
                            $80[$81] = v1[$81];
                          }
                          ;
                        }
                        ;
                        $80.animationSubscriptionId = Nothing.value;
                        return $80;
                      });
                    });
                  }
                  ;
                  throw new Error("Failed pattern match at Component.WealthHealth.WealthHealth (line 203, column 7 - line 207, column 60): " + [state$prime.animationSubscriptionId.constructor.name]);
                }));
              });
            });
          });
        }
        ;
        if (v instanceof Tick) {
          return bind79(get23)(function(state3) {
            if (state3.model instanceof Nothing) {
              return pure75(unit);
            }
            ;
            if (state3.model instanceof Just) {
              var nextYear = state3.currentYear + 1 | 0;
              return discard118((function() {
                var $85 = nextYear > state3.model.value0.yearRange.max;
                if ($85) {
                  return modify_20(function(v1) {
                    var $86 = {};
                    for (var $87 in v1) {
                      if ({}.hasOwnProperty.call(v1, $87)) {
                        $86[$87] = v1[$87];
                      }
                      ;
                    }
                    ;
                    $86.currentYear = state3.model.value0.yearRange.min;
                    return $86;
                  });
                }
                ;
                return modify_20(function(v1) {
                  var $89 = {};
                  for (var $90 in v1) {
                    if ({}.hasOwnProperty.call(v1, $90)) {
                      $89[$90] = v1[$90];
                    }
                    ;
                  }
                  ;
                  $89.currentYear = nextYear;
                  return $89;
                });
              })())(function() {
                return handleAction36(dictMonadAff)(MonadEffect0)(Render.value);
              });
            }
            ;
            throw new Error("Failed pattern match at Component.WealthHealth.WealthHealth (line 211, column 5 - line 220, column 28): " + [state3.model.constructor.name]);
          });
        }
        ;
        if (v instanceof HoverNation) {
          return modify_20(function(v1) {
            var $93 = {};
            for (var $94 in v1) {
              if ({}.hasOwnProperty.call(v1, $94)) {
                $93[$94] = v1[$94];
              }
              ;
            }
            ;
            $93.hoveredNation = v.value0;
            return $93;
          });
        }
        ;
        if (v instanceof ToggleNationSelection) {
          return modify_20(function(s) {
            var newSelected = (function() {
              var $97 = member7(v.value0)(s.selectedNations);
              if ($97) {
                return $$delete6(v.value0)(s.selectedNations);
              }
              ;
              return insert11(v.value0)(s.selectedNations);
            })();
            var $98 = {};
            for (var $99 in s) {
              if ({}.hasOwnProperty.call(s, $99)) {
                $98[$99] = s[$99];
              }
              ;
            }
            ;
            $98.selectedNations = newSelected;
            return $98;
          });
        }
        ;
        if (v instanceof SetAnimationSpeed) {
          return modify_20(function(v1) {
            var $102 = {};
            for (var $103 in v1) {
              if ({}.hasOwnProperty.call(v1, $103)) {
                $102[$103] = v1[$103];
              }
              ;
            }
            ;
            $102.animationSpeed = v.value0;
            return $102;
          });
        }
        ;
        if (v instanceof ToggleLabels) {
          return discard118(modify_20(function(s) {
            var $107 = {};
            for (var $108 in s) {
              if ({}.hasOwnProperty.call(s, $108)) {
                $107[$108] = s[$108];
              }
              ;
            }
            ;
            $107.labelMode = (function() {
              if (s.labelMode instanceof AlwaysShow) {
                return OnHoverOnly.value;
              }
              ;
              if (s.labelMode instanceof OnHoverOnly) {
                return AlwaysShow.value;
              }
              ;
              throw new Error("Failed pattern match at Component.WealthHealth.WealthHealth (line 240, column 23 - line 242, column 38): " + [s.labelMode.constructor.name]);
            })();
            return $107;
          }))(function() {
            return handleAction36(dictMonadAff)(MonadEffect0)(Render.value);
          });
        }
        ;
        if (v instanceof Render) {
          return bind79(get23)(function(state3) {
            if (state3.model instanceof Just && state3.vizUpdateFn instanceof Just) {
              var nations = getAllNationsAtYear(state3.currentYear)(state3.model.value0);
              var drawData = map78(nationPointToDrawData)(nations);
              return liftEffect121(state3.vizUpdateFn.value0(drawData));
            }
            ;
            return pure75(unit);
          });
        }
        ;
        throw new Error("Failed pattern match at Component.WealthHealth.WealthHealth (line 153, column 16 - line 253, column 24): " + [v.constructor.name]);
      };
    };
  };
  var getNationData = function(nationName) {
    return function(year) {
      return function(model) {
        return bind134(find2(function(n) {
          return n.name === nationName;
        })(model.nations))(function(nationRawData) {
          return getNationAtYear(year)(nationRawData);
        });
      };
    };
  };
  var renderTooltip = function(state3) {
    if (state3.hoveredNation instanceof Nothing) {
      return text2("");
    }
    ;
    if (state3.hoveredNation instanceof Just) {
      if (state3.model instanceof Nothing) {
        return text2("");
      }
      ;
      if (state3.model instanceof Just) {
        var v = getNationData(state3.hoveredNation.value0)(state3.currentYear)(state3.model.value0);
        if (v instanceof Nothing) {
          return text2("");
        }
        ;
        if (v instanceof Just) {
          return div2([classes(["wealth-health-tooltip-halogen"])])([h4_([text2(v.value0.name)]), div_([text2("Region: " + regionName(v.value0.region))]), div_([text2("Income: $" + formatNumber(v.value0.income))]), div_([text2("Population: " + formatPopulation(v.value0.population))]), div_([text2("Life Expectancy: " + (formatNumber(v.value0.lifeExpectancy) + " years"))])]);
        }
        ;
        throw new Error("Failed pattern match at Component.WealthHealth.WealthHealth (line 122, column 11 - line 132, column 18): " + [v.constructor.name]);
      }
      ;
      throw new Error("Failed pattern match at Component.WealthHealth.WealthHealth (line 119, column 7 - line 132, column 18): " + [state3.model.constructor.name]);
    }
    ;
    throw new Error("Failed pattern match at Component.WealthHealth.WealthHealth (line 116, column 3 - line 132, column 18): " + [state3.hoveredNation.constructor.name]);
  };
  var render41 = function(state3) {
    return div2([classes(["wealth-health-page"])])([header([classes(["wealth-health-header"])])([h1_([text2("The Wealth & Health of Nations")]), p_([text2("An animated exploration of income, life expectancy, and population across 180 nations from 1800 to 2009")])]), div2([classes(["wealth-health-content"])])([aside([classes(["wealth-health-sidebar"])])([renderControlPanel(state3), renderLegend]), main([classes(["wealth-health-visualization"])])([(function() {
      if (state3.model instanceof Nothing) {
        return div2([classes(["wealth-health-loading"])])([text2("Loading data...")]);
      }
      ;
      if (state3.model instanceof Just) {
        return div2([classes(["wealth-health-viz-wrapper"])])([div2([id3("wealth-health-viz"), classes(["wealth-health-viz-container", (function() {
          if (state3.labelMode instanceof AlwaysShow) {
            return "labels-always-show";
          }
          ;
          if (state3.labelMode instanceof OnHoverOnly) {
            return "";
          }
          ;
          throw new Error("Failed pattern match at Component.WealthHealth.WealthHealth (line 74, column 46 - line 76, column 50): " + [state3.labelMode.constructor.name]);
        })()])])([]), renderTooltip(state3)]);
      }
      ;
      throw new Error("Failed pattern match at Component.WealthHealth.WealthHealth (line 62, column 15 - line 81, column 22): " + [state3.model.constructor.name]);
    })()])]), footer([classes(["wealth-health-credits"])])([div2([classes(["wealth-health-credits__tribute"])])([text2("In memory of "), a([href("https://youtu.be/usdJgEwMinM"), target2("_blank"), classes(["wealth-health-credits__link"])])([text2("Hans Rosling")]), text2(" (1948-2017), whose famous TED talk inspired this visualization.")]), div2([classes(["wealth-health-credits__adaptation"])])([text2("D3 adaptation by "), a([href("https://observablehq.com/@mbostock/the-wealth-health-of-nations"), target2("_blank"), classes(["wealth-health-credits__link"])])([text2("Mike Bostock")]), text2(". PureScript implementation demonstrates the PS<$>D3 library.")])])]);
  };
  var component37 = function(dictMonadAff) {
    var handleAction1 = handleAction36(dictMonadAff)(dictMonadAff.MonadEffect0());
    return function(dictMonadEffect) {
      return mkComponent({
        initialState: initialState2,
        render: render41,
        "eval": mkEval({
          handleQuery: defaultEval.handleQuery,
          receive: defaultEval.receive,
          finalize: defaultEval.finalize,
          handleAction: handleAction1,
          initialize: new Just(Initialize37.value)
        })
      });
    };
  };

  // output/Halogen.HTML/index.js
  var componentSlot2 = /* @__PURE__ */ componentSlot();
  var slot_ = function() {
    return function(dictIsSymbol) {
      var componentSlot1 = componentSlot2(dictIsSymbol);
      return function(dictOrd) {
        var componentSlot22 = componentSlot1(dictOrd);
        return function(label5) {
          return function(p2) {
            return function(component55) {
              return function(input3) {
                return widget(new ComponentSlot(componentSlot22(label5)(p2)(component55)(input3)($$const(Nothing.value))));
              };
            };
          };
        };
      };
    };
  };

  // output/Component.Tour.TourWealthHealth/index.js
  var discard70 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var pure76 = /* @__PURE__ */ pure(applicativeHalogenM);
  var slot_2 = /* @__PURE__ */ slot_()({
    reflectSymbol: function() {
      return "wealthHealth";
    }
  })(ordUnit);
  var Initialize38 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var handleAction37 = function(dictMonadAff) {
    var liftAff3 = liftAff(monadAffHalogenM(dictMonadAff));
    return function(v) {
      return discard70(liftAff3(delay(100)))(function() {
        return pure76(unit);
      });
    };
  };
  var _wealthHealth = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var render42 = function(dictMonadAff) {
    var component110 = component37(dictMonadAff)(dictMonadAff.MonadEffect0());
    return function(v) {
      return div2([classes(["showcase-page", "wealth-health-showcase"])])([render5({
        logoSize: Normal.value,
        quadrant: NoQuadrant.value,
        prevNext: Nothing.value,
        pageTitle: new Just("Wealth & Health of Nations")
      }), slot_2(_wealthHealth)(unit)(component110)(unit)]);
    };
  };
  var component38 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render42(dictMonadAff),
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction37(dictMonadAff),
        initialize: new Just(Initialize38.value)
      })
    });
  };

  // output/Component.TreeAPI/foreign.js
  var clearViz = () => {
    const viz = document.getElementById("viz");
    if (viz) {
      viz.innerHTML = "";
    }
  };

  // output/Component.TreeAPI/index.js
  var discard71 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var modify_21 = /* @__PURE__ */ modify_2(monadStateHalogenM);
  var $$void14 = /* @__PURE__ */ $$void(functorEffect);
  var ThreeCircles = /* @__PURE__ */ (function() {
    function ThreeCircles2() {
    }
    ;
    ThreeCircles2.value = new ThreeCircles2();
    return ThreeCircles2;
  })();
  var ThreeCirclesTransition = /* @__PURE__ */ (function() {
    function ThreeCirclesTransition2() {
    }
    ;
    ThreeCirclesTransition2.value = new ThreeCirclesTransition2();
    return ThreeCirclesTransition2;
  })();
  var SimpleTree = /* @__PURE__ */ (function() {
    function SimpleTree2() {
    }
    ;
    SimpleTree2.value = new SimpleTree2();
    return SimpleTree2;
  })();
  var NestedElements = /* @__PURE__ */ (function() {
    function NestedElements2() {
    }
    ;
    NestedElements2.value = new NestedElements2();
    return NestedElements2;
  })();
  var BarChart = /* @__PURE__ */ (function() {
    function BarChart2() {
    }
    ;
    BarChart2.value = new BarChart2();
    return BarChart2;
  })();
  var ScatterPlot = /* @__PURE__ */ (function() {
    function ScatterPlot2() {
    }
    ;
    ScatterPlot2.value = new ScatterPlot2();
    return ScatterPlot2;
  })();
  var LineChart = /* @__PURE__ */ (function() {
    function LineChart2() {
    }
    ;
    LineChart2.value = new LineChart2();
    return LineChart2;
  })();
  var GroupedBarChart = /* @__PURE__ */ (function() {
    function GroupedBarChart2() {
    }
    ;
    GroupedBarChart2.value = new GroupedBarChart2();
    return GroupedBarChart2;
  })();
  var SimpleHierarchy = /* @__PURE__ */ (function() {
    function SimpleHierarchy2() {
    }
    ;
    SimpleHierarchy2.value = new SimpleHierarchy2();
    return SimpleHierarchy2;
  })();
  var ThreeDimensions = /* @__PURE__ */ (function() {
    function ThreeDimensions2() {
    }
    ;
    ThreeDimensions2.value = new ThreeDimensions2();
    return ThreeDimensions2;
  })();
  var LesMisForce = /* @__PURE__ */ (function() {
    function LesMisForce2() {
    }
    ;
    LesMisForce2.value = new LesMisForce2();
    return LesMisForce2;
  })();
  var Initialize39 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var SelectExample2 = /* @__PURE__ */ (function() {
    function SelectExample3(value0) {
      this.value0 = value0;
    }
    ;
    SelectExample3.create = function(value0) {
      return new SelectExample3(value0);
    };
    return SelectExample3;
  })();
  var handleAction38 = function(dictMonadAff) {
    var liftEffect51 = liftEffect(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    return function(v) {
      if (v instanceof Initialize39) {
        return handleAction38(dictMonadAff)(new SelectExample2(ThreeCircles.value));
      }
      ;
      if (v instanceof SelectExample2) {
        return discard71(modify_21(function(v1) {
          var $21 = {};
          for (var $22 in v1) {
            if ({}.hasOwnProperty.call(v1, $22)) {
              $21[$22] = v1[$22];
            }
            ;
          }
          ;
          $21.currentExample = v.value0;
          return $21;
        }))(function() {
          return discard71(liftEffect51(clearViz))(function() {
            if (v.value0 instanceof ThreeCircles) {
              return liftEffect51(threeLittleCircles);
            }
            ;
            if (v.value0 instanceof ThreeCirclesTransition) {
              return liftEffect51($$void14(threeLittleCirclesTransition("#viz")));
            }
            ;
            if (v.value0 instanceof SimpleTree) {
              return liftEffect51(testSimpleTree);
            }
            ;
            if (v.value0 instanceof NestedElements) {
              return liftEffect51(testNestedElements);
            }
            ;
            if (v.value0 instanceof BarChart) {
              return liftEffect51(barChart);
            }
            ;
            if (v.value0 instanceof ScatterPlot) {
              return liftEffect51(scatterPlot);
            }
            ;
            if (v.value0 instanceof LineChart) {
              return liftEffect51(lineChart);
            }
            ;
            if (v.value0 instanceof GroupedBarChart) {
              return liftEffect51(groupedBarChart("#viz"));
            }
            ;
            if (v.value0 instanceof SimpleHierarchy) {
              return liftEffect51(treeViz("#viz"));
            }
            ;
            if (v.value0 instanceof ThreeDimensions) {
              return liftEffect51(threeLittleDimensions);
            }
            ;
            if (v.value0 instanceof LesMisForce) {
              return liftEffect51(testLesMisTree);
            }
            ;
            throw new Error("Failed pattern match at Component.TreeAPI (line 371, column 5 - line 382, column 65): " + [v.value0.constructor.name]);
          });
        });
      }
      ;
      throw new Error("Failed pattern match at Component.TreeAPI (line 359, column 16 - line 382, column 65): " + [v.constructor.name]);
    };
  };
  var exampleTitle = function(v) {
    if (v instanceof ThreeCircles) {
      return "Three Little Circles (Data Join)";
    }
    ;
    if (v instanceof ThreeCirclesTransition) {
      return "Three Little Circles (Transition)";
    }
    ;
    if (v instanceof SimpleTree) {
      return "Simple Tree (Basic Structure)";
    }
    ;
    if (v instanceof NestedElements) {
      return "Nested Elements (Multi-Level)";
    }
    ;
    if (v instanceof BarChart) {
      return "Bar Chart";
    }
    ;
    if (v instanceof ScatterPlot) {
      return "Scatter Plot";
    }
    ;
    if (v instanceof LineChart) {
      return "Line Chart";
    }
    ;
    if (v instanceof GroupedBarChart) {
      return "Grouped Bar Chart (Nested Joins)";
    }
    ;
    if (v instanceof SimpleHierarchy) {
      return "Tree Layout (Hierarchy)";
    }
    ;
    if (v instanceof ThreeDimensions) {
      return "Three Little Dimensions (Nested Joins)";
    }
    ;
    if (v instanceof LesMisForce) {
      return "Les Mis\xE9rables (Force Simulation)";
    }
    ;
    throw new Error("Failed pattern match at Component.TreeAPI (line 137, column 1 - line 137, column 34): " + [v.constructor.name]);
  };
  var exampleCode = function(v) {
    if (v instanceof ThreeCircles) {
      return '\ntree = named SVG "svg" [...] `withChild`\n  (joinData "circles" "circle" circleData $ \\d ->\n    elem Circle\n      [ cx d.x\n      , cy d.y\n      , radius d.r\n      , fill d.color\n      ])\n\nselections <- renderTree container tree\n';
    }
    ;
    if (v instanceof ThreeCirclesTransition) {
      return '\n-- Initial render: green circles in horizontal line\ninitialTree = named SVG "svg" [...] `withChild`\n  (joinData "circles" "circle" [0, 1, 2] $ \\\\d ->\n    elem Circle [fill "green", cx (d * 100 + 100), ...])\n\nselections <- renderTree container initialTree\n\n-- Extract circles selection\ncirclesSel <- liftEffect $ reselectD3v2 "circles" selections\n\n-- Transition to RGB colors with overlapping positions\nlet transitionConfig = transitionWith\n      { duration: Milliseconds 1500.0\n      , delay: Just (Milliseconds 100.0)\n      , easing: Just ElasticOut\n      }\n\nwithTransition transitionConfig circlesSel\n  [ fill colorFn\n  , cx cxFn\n  , cy cyFn\n  , radius 30.0\n  , fillOpacity 0.5\n  ]\n';
    }
    ;
    if (v instanceof SimpleTree) {
      return '\ntree = named SVG "svg" [...] `withChild`\n  (named Group "container" [...] `withChildren`\n    [ named Circle "circle" [...]\n    , named Text "text" [...]\n    ])\n\nselections <- renderTree container tree\n-- Access: Map.lookup "circle" selections\n';
    }
    ;
    if (v instanceof NestedElements) {
      return '\ntree = named SVG "svg" [...] `withChild`\n  (named Group "mainGroup" [...] `withChildren`\n    [ named Group "node1" [...] `withChildren`\n        [ named Circle "circle1" [...]\n        , named Text "label1" [...]\n        ]\n    , named Group "node2" [...] `withChildren`\n        [ named Circle "circle2" [...]\n        , named Text "label2" [...]\n        ]\n    ])\n\nselections <- renderTree container tree\n';
    }
    ;
    if (v instanceof BarChart) {
      return '\ntree = named SVG "svg" [...] `withChild`\n  (named Group "chartGroup" [...] `withChild`\n    (joinData "bars" "rect" dataPoints $ \\\\point ->\n      T.elem Rect\n        [ x (xScale point.x)\n        , y (yScale point.y)\n        , width barWidth\n        , height barHeight\n        , fill "#4a90e2"\n        ]))\n\nselections <- renderTree container tree\n';
    }
    ;
    if (v instanceof ScatterPlot) {
      return '\ntree = named SVG "svg" [...] `withChild`\n  (named Group "chartGroup" [...] `withChild`\n    (joinData "points" "circle" dataPoints $ \\\\point ->\n      T.elem Circle\n        [ cx (xScale point.x)\n        , cy (yScale point.y)\n        , radius 6.0\n        , fill "#e74c3c"\n        ]))\n\nselections <- renderTree container tree\n';
    }
    ;
    if (v instanceof LineChart) {
      return '\ntree = named SVG "svg" [...] `withChild`\n  (named Group "chartGroup" [...] `withChild`\n    (named Path "line"\n      [ d pathData\n      , fill "none"\n      , stroke "#2ecc71"\n      , strokeWidth 2.0\n      ]))\n\nselections <- renderTree container tree\n';
    }
    ;
    if (v instanceof GroupedBarChart) {
      return '\n-- Group data by state\nlet stateGroups = groupByState data\n    ages = getAges data\n\n-- Nested join: states \u2192 bars within each state\nbarsTree = nestedJoin "stateGroups" "g" stateGroups (_.bars) $ \\\\bar ->\n  let\n    stateIdx = findIndex (\\\\g -> g.state == bar.state) stateGroups\n    ageIdx = findIndex (\\\\a -> a == bar.age) ages\n    xPos = stateIdx * groupWidth + ageIdx * barWidth\n    yPos = yScale bar.population\n    barHeight = iHeight - yPos\n  in\n    T.elem Rect\n      [ x xPos\n      , y yPos\n      , width barWidth\n      , height barHeight\n      , fill (colorForAge bar.age)\n      ]\n\nselections <- renderTree chartGroup barsTree\n';
    }
    ;
    if (v instanceof SimpleHierarchy) {
      return '\n-- Apply layout algorithm\nlet positioned = tree config hierarchyData\nlet nodes = Array.fromFoldable positioned\nlet links = makeLinks positioned\n\ntree = named SVG "svg" [...] `withChildren`\n  [ named Group "linksGroup" [...] `withChild`\n      (joinData "links" "path" links $ \\\\link ->\n        T.elem Path [d (linkPath link), ...])\n  , named Group "nodesGroup" [...] `withChild`\n      (joinData "nodes" "g" nodes $ \\\\node ->\n        T.named Group ("node-" <> node.name) [...]\n          `withChildren`\n            [ T.elem Circle [cx node.x, cy node.y, ...]\n            , T.elem Text [textContent node.name, ...]\n            ])\n  ]\n';
    }
    ;
    if (v instanceof ThreeDimensions) {
      return '\n-- Nested data: [[1,2,3],[4,5,6],[7,8,9]]\ntree = named Table "table" [...] `withChild`\n  (nestedJoin "rows" "tr" matrixData identity $ \\\\cellValue ->\n    T.elem Td [textContent (show cellValue)])\n\n-- nestedJoin handles type decomposition:\n-- - Outer type: Array Int (a row)\n-- - Decomposer: identity (extracts row data)\n-- - Inner type: Int (a cell value)\n-- - Creates: table rows \u2192 table cells\n\n-- Power: Works with ANY decomposition!\n-- - Array of Records with nested Arrays\n-- - Lists of Maps of Sets\n-- - Custom ADT decompositions\n';
    }
    ;
    if (v instanceof LesMisForce) {
      return '\n-- Initialize simulation with forces\n{ nodes, links } <- init\n  { nodes: nodesWithPositions\n  , links: model.links\n  , forces: [manyBody, center, forceLinks]\n  , ...\n  }\n\n-- Declarative tree structure\nlet forceGraphTree =\n      named SVG "svg" [...] `withChild`\n        (named Group "zoomGroup" [...] `withChildren`\n          [ named Group "linksGroup" [...] `withChild`\n              (joinData "linkElements" "line" links linkTemplate)\n          , named Group "nodesGroup" [...] `withChild`\n              (joinData "nodeElements" "circle" nodes nodeTemplate)\n          ])\n\n-- Render structure\nselections <- renderTree container forceGraphTree\n\n-- Extract selections and add behaviors\non (Zoom ...) svgSel\non (Drag $ simulationDrag ...) nodesSel\n\n-- Add tick functions for position updates\naddTickFunction "nodes" $ Step nodesSel\n  [cx (\\\\d -> d.x), cy (\\\\d -> d.y)]\naddTickFunction "links" $ Step linksSel\n  [x1 (\\\\l -> l.source.x), y1 (\\\\l -> l.source.y), ...]\n\nstart\n';
    }
    ;
    throw new Error("Failed pattern match at Component.TreeAPI (line 150, column 1 - line 150, column 33): " + [v.constructor.name]);
  };
  var eqExample = {
    eq: function(x47) {
      return function(y48) {
        if (x47 instanceof ThreeCircles && y48 instanceof ThreeCircles) {
          return true;
        }
        ;
        if (x47 instanceof ThreeCirclesTransition && y48 instanceof ThreeCirclesTransition) {
          return true;
        }
        ;
        if (x47 instanceof SimpleTree && y48 instanceof SimpleTree) {
          return true;
        }
        ;
        if (x47 instanceof NestedElements && y48 instanceof NestedElements) {
          return true;
        }
        ;
        if (x47 instanceof BarChart && y48 instanceof BarChart) {
          return true;
        }
        ;
        if (x47 instanceof ScatterPlot && y48 instanceof ScatterPlot) {
          return true;
        }
        ;
        if (x47 instanceof LineChart && y48 instanceof LineChart) {
          return true;
        }
        ;
        if (x47 instanceof GroupedBarChart && y48 instanceof GroupedBarChart) {
          return true;
        }
        ;
        if (x47 instanceof SimpleHierarchy && y48 instanceof SimpleHierarchy) {
          return true;
        }
        ;
        if (x47 instanceof ThreeDimensions && y48 instanceof ThreeDimensions) {
          return true;
        }
        ;
        if (x47 instanceof LesMisForce && y48 instanceof LesMisForce) {
          return true;
        }
        ;
        return false;
      };
    }
  };
  var eq16 = /* @__PURE__ */ eq(eqExample);
  var exampleButton = function(state3) {
    return function(ex) {
      return function(label5) {
        return function(description) {
          return button([class_((function() {
            var $30 = eq16(state3.currentExample)(ex);
            if ($30) {
              return "selected";
            }
            ;
            return "";
          })()), onClick(function(v) {
            return new SelectExample2(ex);
          })])([div2([class_("label")])([text2(label5)]), div2([class_("description")])([text2(description)])]);
        };
      };
    };
  };
  var render43 = function(state3) {
    return div2([class_("tree-api-examples")])([h1_([text2("Declarative Tree API Examples")]), div2([class_("description")])([p_([text2("This page demonstrates the new declarative tree API for PSD3v2. "), text2("Instead of imperative "), code_([text2("appendChild")]), text2(" chains, you define the entire DOM structure as a tree, "), text2("then render it in one step.")]), p_([strong_([text2("Key features:")])]), ul_([li_([text2("Tree structure is immediately visible")]), li_([text2("Data joins with template functions")]), li_([text2("Named selections via Map lookup")]), li_([text2("Type-safe, polymorphic attributes")])])]), div2([class_("example-selector")])([h2_([text2("Basic Examples:")]), div2([class_("buttons")])([exampleButton(state3)(ThreeCircles.value)("Three Little Circles")("Data join basics"), exampleButton(state3)(ThreeCirclesTransition.value)("Circles Transition")("Animated transitions"), exampleButton(state3)(SimpleTree.value)("Simple Tree")("Basic nesting"), exampleButton(state3)(NestedElements.value)("Nested Elements")("Multi-level (Group \u2192 Circle + Text)"), exampleButton(state3)(ThreeDimensions.value)("Three Little Dimensions")("Nested data joins (2D array \u2192 table)")]), h2_([text2("Chart Examples:")]), div2([class_("buttons")])([exampleButton(state3)(BarChart.value)("Bar Chart")("Data-driven bars with scaling"), exampleButton(state3)(ScatterPlot.value)("Scatter Plot")("Points positioned by data"), exampleButton(state3)(LineChart.value)("Line Chart")("Path element from data"), exampleButton(state3)(GroupedBarChart.value)("Grouped Bar Chart")("Nested joins with multiple series")]), h2_([text2("Hierarchy & Simulation Examples:")]), div2([class_("buttons")])([exampleButton(state3)(SimpleHierarchy.value)("Tree Layout")("Hierarchical node-link diagram"), exampleButton(state3)(LesMisForce.value)("Les Mis\xE9rables")("Force-directed graph with simulation")])]), div2([class_("visualization-container")])([h2_([text2(exampleTitle(state3.currentExample))]), div2([id3("viz"), class_("viz-area")])([]), div2([class_("code-example")])([h3_([text2("Code:")]), pre_([code_([text2(exampleCode(state3.currentExample))])])])])]);
  };
  var component39 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return {
          currentExample: ThreeCircles.value
        };
      },
      render: render43,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction38(dictMonadAff),
        initialize: new Just(Initialize39.value)
      })
    });
  };

  // output/Component.Understanding.UnderstandingAttributes/index.js
  var triggerMermaidRendering2 = /* @__PURE__ */ triggerMermaidRendering(monadEffectEffect);
  var Initialize40 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var renderNavCard = function(title4) {
    return function(href5) {
      return function(description) {
        return a([href(href5), classes(["section-nav-card"])])([h3_([text2(title4)]), p_([text2(description)])]);
      };
    };
  };
  var handleAction39 = function(dictMonadAff) {
    var liftEffect51 = liftEffect(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    return function(v) {
      return liftEffect51(triggerMermaidRendering2);
    };
  };
  var contravariantDiagram = '\ngraph LR\n    subgraph "Contravariant Pattern"\n        Attr["Attribute datum"]\n        CMap["cmap f attr"]\n        AttrNew["Attribute newDatum"]\n    end\n\n    Attr --> CMap\n    CMap --> AttrNew\n\n    note["f :: newDatum -> datum<br/>Transforms data BEFORE attribute sees it"]\n\n    style Attr fill:#e8dcc6,stroke:#8b7355,stroke-width:2px\n    style CMap fill:#d4d8e8,stroke:#555b8b,stroke-width:2px\n    style AttrNew fill:#c4e8d3,stroke:#558b73,stroke-width:2px\n';
  var attributeTypeDiagram = '\ngraph TD\n    subgraph "Attribute Values"\n        Static["Static Value<br/><code>cx 100.0</code>"]\n        Datum["Datum Function<br/><code>cx (\\\\d -> d.x)</code>"]\n        DatumIdx["Datum+Index<br/><code>cx (\\\\d i -> d.x + i*10)</code>"]\n    end\n\n    subgraph "Type Resolution"\n        IsAttr[IsAttribute typeclass]\n        Resolve[Resolved at compile time]\n    end\n\n    Static --> IsAttr\n    Datum --> IsAttr\n    DatumIdx --> IsAttr\n    IsAttr --> Resolve\n\n    style Static fill:#f5e6d3,stroke:#8b7355,stroke-width:2px\n    style Datum fill:#e8dcc6,stroke:#8b7355,stroke-width:2px\n    style DatumIdx fill:#d4c4b0,stroke:#8b7355,stroke-width:2px\n';
  var render44 = function(v) {
    return div2([classes(["tutorial-page"])])([render5({
      logoSize: Large.value,
      quadrant: QuadUnderstanding.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("Type-Safe Attribute System")]), p_([text2("A key innovation of D3 is the natural way to go from static to data-driven attributes. PSD3v2 preserves this flexibility while adding compile-time type safety through typeclasses and phantom types.")]), div2([classes(["section-nav-cards"])])([renderNavCard("Attribute Variants")("#attribute-variants")("Static, datum, and indexed"), renderNavCard("Contravariant Pattern")("#contravariant")("Transform data before attributes"), renderNavCard("Type Safety")("#type-safety")("Compile-time guarantees"), renderNavCard("Common Attributes")("#common-attributes")("SVG and HTML attributes")])]), section([classes(["tutorial-section"]), id3("attribute-variants")])([h2([classes(["tutorial-section-title"])])([text2("Attribute Variants")]), p_([text2("Attributes in PSD3v2 can take three forms, all with the same clean syntax:")]), div2([classes(["diagram-container"])])([mermaidDiagram(attributeTypeDiagram)(new Just("attribute-type-diagram"))]), table([classes(["tutorial-table"])])([thead_([tr_([th_([text2("Form")]), th_([text2("Example")]), th_([text2("Use Case")])])]), tbody_([tr_([td_([strong_([text2("Static")])]), td_([code_([text2("radius 10.0")])]), td_([text2("Same value for all elements")])]), tr_([td_([strong_([text2("Datum Function")])]), td_([code_([text2("cx (\\d -> d.x)")])]), td_([text2("Value depends on bound data")])]), tr_([td_([strong_([text2("Datum + Index")])]), td_([code_([text2("x (\\d i -> 50.0 + i * 100.0)")])]), td_([text2("Value depends on data and position")])])])]), p([classes(["code-highlight"])])([text2("Key: "), text2("The "), code_([text2("IsAttribute")]), text2(" typeclass resolves all three forms at compile time.")])]), section([classes(["tutorial-section"]), id3("contravariant")])([h2([classes(["tutorial-section-title"])])([text2("The Contravariant Pattern")]), p_([text2("Attributes form a "), em_([text2("Contravariant Functor")]), text2(". This means you can transform the input data type before the attribute sees it.")]), div2([classes(["diagram-container"])])([mermaidDiagram(contravariantDiagram)(new Just("contravariant-diagram"))]), p_([text2("Why contravariant? Regular functors transform "), em_([text2("outputs")]), text2(". Attributes transform "), em_([text2("inputs")]), text2(" (the datum they receive).")]), p([classes(["code-highlight"])])([text2("Example: "), code_([text2("cmap _.name (textContent identity)")]), text2(" extracts the name field before setting text content.")])]), section([classes(["tutorial-section"]), id3("type-safety")])([h2([classes(["tutorial-section-title"])])([text2("Type Safety Guarantees")]), p_([text2("The attribute system provides several compile-time guarantees:")]), ul_([li_([strong_([text2("Datum type matching")]), text2(" - Attributes must match the selection's datum type")]), li_([strong_([text2("Attribute value types")]), text2(" - "), code_([text2("radius")]), text2(" requires Number, "), code_([text2("fill")]), text2(" requires String")]), li_([strong_([text2("No missing attributes")]), text2(" - Arrays of attributes are explicit and type-checked")])]), p_([text2("Common compile-time errors:")]), ul_([li_([code_([text2('radius "10"')]), text2(" - Type error: expected Number, got String")]), li_([code_([text2("cx (\\d -> d.x)")]), text2(" on wrong datum type - Type error: field 'x' not found")])]), p([classes(["code-highlight"])])([text2("Philosophy: "), text2("Runtime errors in D3 become compile-time errors in PSD3v2.")])]), section([classes(["tutorial-section"]), id3("common-attributes")])([h2([classes(["tutorial-section-title"])])([text2("Common Attributes")]), p_([text2("PSD3v2 provides typed wrappers for all common SVG and HTML attributes:")]), h3_([text2("Positioning")]), p_([code_([text2("cx, cy, x, y, x1, y1, x2, y2")]), text2(" - coordinate positions")]), h3_([text2("Dimensions")]), p_([code_([text2("width, height, radius, rx, ry")]), text2(" - size attributes")]), h3_([text2("Styling")]), p_([code_([text2("fill, stroke, strokeWidth, fillOpacity, strokeOpacity")]), text2(" - colors and strokes")]), h3_([text2("Text")]), p_([code_([text2("textContent, textAnchor, fontSize, fontWeight")]), text2(" - text styling")]), h3_([text2("Transforms")]), p_([code_([text2("transform, translate, rotate, scale")]), text2(" - geometric transforms")]), h3_([text2("General")]), p_([code_([text2("class_, id_, d (for paths), viewBox")]), text2(" - common utilities")])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Summary")]), p_([text2("PSD3v2's attribute system:")]), ul_([li_([text2("Three forms: static, datum function, datum+index")]), li_([text2("Resolved at compile time via IsAttribute typeclass")]), li_([text2("Contravariant functor for data transformation")]), li_([text2("Type-safe: datum types, value types, completeness")]), li_([text2("Comprehensive coverage of SVG and HTML attributes")])])])])]);
  };
  var component40 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render44,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction39(dictMonadAff),
        initialize: new Just(Initialize40.value)
      })
    });
  };

  // output/Component.Understanding.UnderstandingGrammar/index.js
  var triggerMermaidRendering3 = /* @__PURE__ */ triggerMermaidRendering(monadEffectEffect);
  var Initialize41 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var treeAPIDiagram = '\ngraph TD\n    subgraph "TreeAPI - Declarative Structure"\n        A[renderTree] --> B[Tree datum]\n        B --> C[Node]\n        B --> D[Join]\n        B --> E[SceneJoin]\n        C --> F[name, elemType, attrs, children]\n        D --> G[template: datum -> Tree]\n        E --> H[enter/update/exit behaviors]\n    end\n\n    style A fill:#f5e6d3,stroke:#8b7355,stroke-width:2px\n    style B fill:#e8dcc6,stroke:#8b7355,stroke-width:2px\n    style C fill:#d4c4b0,stroke:#8b7355,stroke-width:2px\n    style D fill:#c4e8d3,stroke:#558b73,stroke-width:2px\n    style E fill:#d4d8e8,stroke:#555b8b,stroke-width:2px\n';
  var staticVizDiagram = '\ngraph TD\n    subgraph "Static Visualization"\n        A[select container] --> B[appendChild SVG]\n        B --> C[appendData Circle]\n        C --> D[setAttrs]\n    end\n\n    style A fill:#f5e6d3,stroke:#8b7355,stroke-width:2px\n    style B fill:#e8dcc6,stroke:#8b7355,stroke-width:2px\n    style C fill:#e8dcc6,stroke:#8b7355,stroke-width:2px\n    style D fill:#d4c4b0,stroke:#8b7355,stroke-width:2px\n';
  var selectionStateDiagram = "\nstateDiagram-v2\n    [*] --> SEmpty: select\n    SEmpty --> SBoundOwns: appendData/renderData\n    SEmpty --> JoinResult: joinData\n\n    JoinResult --> SPending: .enter\n    JoinResult --> SBoundOwns: .update\n    JoinResult --> SExiting: .exit\n\n    SPending --> SBoundOwns: append\n    SBoundOwns --> SBoundOwns: setAttrs\n    SBoundOwns --> SBoundInherits: appendChildInheriting\n    SExiting --> [*]: remove\n\n    note right of SEmpty: No data bound yet\n    note right of SPending: Data waiting for elements\n    note right of SBoundOwns: Elements with data\n    note right of SExiting: Elements to remove\n";
  var renderNavCard2 = function(title4) {
    return function(href5) {
      return function(description) {
        return a([href(href5), classes(["section-nav-card"])])([h3_([text2(title4)]), p_([text2(description)])]);
      };
    };
  };
  var handleAction40 = function(dictMonadAff) {
    var liftEffect51 = liftEffect(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    return function(v) {
      return liftEffect51(triggerMermaidRendering3);
    };
  };
  var gupFlowDiagram = '\ngraph TD\n    subgraph "General Update Pattern"\n        A[openSelection/selectAll] --> B[joinData]\n        B --> C{JoinResult}\n        C --> D[enter: append]\n        C --> E[update: setAttrs]\n        C --> F[exit: remove]\n        D --> G[merge]\n        E --> G\n    end\n\n    style A fill:#f5e6d3,stroke:#8b7355,stroke-width:2px\n    style B fill:#e8dcc6,stroke:#8b7355,stroke-width:2px\n    style C fill:#d4c4b0,stroke:#8b7355,stroke-width:2px\n    style D fill:#c4e8d3,stroke:#558b73,stroke-width:2px\n    style E fill:#d4d8e8,stroke:#555b8b,stroke-width:2px\n    style F fill:#e8d4d4,stroke:#8b5555,stroke-width:2px\n';
  var render45 = function(v) {
    return div2([classes(["tutorial-page"])])([render5({
      logoSize: Large.value,
      quadrant: QuadUnderstanding.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("The Grammar of D3")]), p_([text2("D3 can be understood as an embedded Domain Specific Language for data visualization. While the full API has a large surface area, the essential grammar is remarkably small. PSD3v2 captures this grammar in a type-safe, composable way.")]), div2([classes(["section-nav-cards"])])([renderNavCard2("Core Primitives")("#core-primitives")("The four essential operations"), renderNavCard2("Selection States")("#selection-states")("Phantom types for safety"), renderNavCard2("Static vs GUP")("#static-vs-gup")("One-time vs updating"), renderNavCard2("TreeAPI")("#tree-api")("Declarative alternative")])]), section([classes(["tutorial-section"]), id3("core-primitives")])([h2([classes(["tutorial-section-title"])])([text2("Core Primitives")]), p_([text2("The grammar of D3 visualizations consists of four essential primitives. Everything else is built from these:")]), table([classes(["tutorial-table"])])([thead_([tr_([th_([text2("Primitive")]), th_([text2("Function")]), th_([text2("PSD3v2 API")])])]), tbody_([tr_([td_([em_([text2("select")])]), td_([text2("Find an entry point in the DOM")]), td_([code_([text2("select")]), text2(", "), code_([text2("selectAll")])])]), tr_([td_([em_([text2("append")])]), td_([text2("Add a DOM element to a selection")]), td_([code_([text2("appendChild")]), text2(", "), code_([text2("append")])])]), tr_([td_([em_([text2("join")])]), td_([text2("For each datum "), strong_([text2("d")]), text2(", create an element "), strong_([text2("e")])]), td_([code_([text2("appendData")]), text2(", "), code_([text2("joinData")]), text2(", "), code_([text2("renderData")])])]), tr_([td_([em_([text2("attr")])]), td_([text2("Apply attributes to current elements")]), td_([code_([text2("setAttrs")]), text2(" (array of Attribute)")])])])]), p([classes(["code-highlight"])])([text2("Key insight: "), text2("Attributes can be static values or functions of the datum, enabling Data Driven Documents.")])]), section([classes(["tutorial-section"]), id3("selection-states")])([h2([classes(["tutorial-section-title"])])([text2("Selection States (Phantom Types)")]), p_([text2("PSD3v2 uses phantom types to track what operations are legal on a selection. This catches errors at compile time that D3 would only catch at runtime:")]), div2([classes(["diagram-container"])])([mermaidDiagram(selectionStateDiagram)(new Just("selection-state-diagram"))]), table([classes(["tutorial-table"])])([thead_([tr_([th_([text2("State")]), th_([text2("Meaning")]), th_([text2("Legal Operations")])])]), tbody_([tr_([td_([code_([text2("SEmpty")])]), td_([text2("Selection has elements but no data")]), td_([text2("appendChild, appendData, joinData")])]), tr_([td_([code_([text2("SPending")])]), td_([text2("Data waiting for elements (enter)")]), td_([text2("append")])]), tr_([td_([code_([text2("SBoundOwns")])]), td_([text2("Elements with bound data")]), td_([text2("setAttrs, appendChildInheriting, merge")])]), tr_([td_([code_([text2("SExiting")])]), td_([text2("Elements to be removed (exit)")]), td_([text2("setAttrsExit, remove")])])])]), p([classes(["code-highlight"])])([text2("Type safety: "), text2("Trying to call "), code_([text2("setAttrs")]), text2(" on an "), code_([text2("SEmpty")]), text2(" selection is a compile error, not a runtime bug.")])]), section([classes(["tutorial-section"]), id3("static-vs-gup")])([h2([classes(["tutorial-section-title"])])([text2("Static Visualizations vs General Update Pattern")]), p_([text2("There are two fundamental patterns for D3 visualizations:")]), h3_([text2("Static: One-time render")]), div2([classes(["diagram-container"])])([mermaidDiagram(staticVizDiagram)(new Just("static-viz-diagram"))]), p_([text2("Use "), code_([text2("appendData")]), text2(" for simple visualizations that render once with fixed data. This is perfect for charts, static hierarchies, and basic data displays.")]), h3_([text2("GUP: Dynamic updates")]), div2([classes(["diagram-container"])])([mermaidDiagram(gupFlowDiagram)(new Just("gup-flow-diagram"))]), p_([text2("Use "), code_([text2("joinData")]), text2(" when data changes over time. The join splits data into three disjoint sets:")]), ul_([li_([strong_([text2("Enter")]), text2(" - new data items that need elements created")]), li_([strong_([text2("Update")]), text2(" - existing elements that should be updated")]), li_([strong_([text2("Exit")]), text2(" - old elements that should be removed")])]), p([classes(["code-highlight"])])([text2("GUP enables: "), text2("Animated transitions, live data feeds, user interactions, and smooth state changes.")])]), section([classes(["tutorial-section"]), id3("tree-api")])([h2([classes(["tutorial-section-title"])])([text2("TreeAPI: Declarative Alternative")]), p_([text2("For static visualizations, the TreeAPI provides a more declarative, succinct syntax. Instead of imperative method chaining, you declare the desired tree structure:")]), div2([classes(["diagram-container"])])([mermaidDiagram(treeAPIDiagram)(new Just("tree-api-diagram"))]), p_([text2("TreeAPI variants handle different use cases:")]), ul_([li_([code_([text2("Node")]), text2(" - static elements with children")]), li_([code_([text2("Join")]), text2(" - data-driven element creation (N elements from N data)")]), li_([code_([text2("NestedJoin")]), text2(" - nested data with type decomposition")]), li_([code_([text2("SceneJoin")]), text2(" - declarative GUP with enter/update/exit behaviors")])]), p([classes(["code-highlight"])])([text2("Note: "), text2("TreeAPI excels at static visualizations. For complex interactive visualizations with simulations, the underlying Selection API provides more control.")])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Summary")]), p_([text2("The D3 grammar in PSD3v2:")]), ul_([li_([text2("Four primitives: select, append, join, attr")]), li_([text2("Phantom types enforce correct operation ordering")]), li_([text2("Static visualizations use appendData or TreeAPI")]), li_([text2("Dynamic visualizations use joinData with GUP")]), li_([text2("TreeAPI provides declarative syntax for tree structures")])])])])]);
  };
  var component41 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render45,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction40(dictMonadAff),
        initialize: new Just(Initialize41.value)
      })
    });
  };

  // output/Component.Understanding.UnderstandingScenes/index.js
  var triggerMermaidRendering4 = /* @__PURE__ */ triggerMermaidRendering(monadEffectEffect);
  var Initialize42 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var transitionMatrixDiagram = '\ngraph LR\n    subgraph "State Transition Matrix"\n        S1["Scene A"]\n        S2["Scene B"]\n        S3["Scene C"]\n    end\n\n    S1 -->|"transition AB"| S2\n    S2 -->|"transition BC"| S3\n    S3 -->|"transition CA"| S1\n\n    note["Each transition defines:<br/>- Data changes<br/>- Element changes<br/>- Animation timing"]\n\n    style S1 fill:#c4e8d3,stroke:#558b73,stroke-width:2px\n    style S2 fill:#d4d8e8,stroke:#555b8b,stroke-width:2px\n    style S3 fill:#f5e6d3,stroke:#8b7355,stroke-width:2px\n';
  var sceneStructureDiagram = '\ngraph TD\n    subgraph "Scene Data Structure"\n        Scene["Scene"]\n        Data["Visualization Data"]\n        Config["Configuration"]\n        Behaviors["Enter/Update/Exit"]\n    end\n\n    Scene --> Data\n    Scene --> Config\n    Scene --> Behaviors\n\n    Behaviors --> Enter["Enter Behavior<br/><i>initialAttrs, transition</i>"]\n    Behaviors --> Update["Update Behavior<br/><i>attrs, transition</i>"]\n    Behaviors --> Exit["Exit Behavior<br/><i>attrs, transition</i>"]\n\n    style Scene fill:#d4d8e8,stroke:#555b8b,stroke-width:2px\n    style Data fill:#f5e6d3,stroke:#8b7355,stroke-width:2px\n    style Config fill:#f5e6d3,stroke:#8b7355,stroke-width:2px\n    style Enter fill:#c4e8d3,stroke:#558b73,stroke-width:2px\n    style Update fill:#d4d8e8,stroke:#555b8b,stroke-width:2px\n    style Exit fill:#f8d7da,stroke:#721c24,stroke-width:2px\n';
  var renderNavCard3 = function(title4) {
    return function(href5) {
      return function(description) {
        return a([href(href5), classes(["section-nav-card"])])([h3_([text2(title4)]), p_([text2(description)])]);
      };
    };
  };
  var handleAction41 = function(dictMonadAff) {
    var liftEffect51 = liftEffect(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    return function(v) {
      return liftEffect51(triggerMermaidRendering4);
    };
  };
  var declarativeVsDiagram = '\ngraph TB\n    subgraph "Imperative (D3)"\n        Imp1["Check current state"]\n        Imp2["Calculate diff"]\n        Imp3["Apply changes"]\n        Imp4["Manage transitions"]\n        Imp5["Handle cleanup"]\n    end\n\n    subgraph "Declarative (PSD3v2)"\n        Dec1["Declare desired state"]\n        Dec2["Framework handles rest"]\n    end\n\n    Imp1 --> Imp2\n    Imp2 --> Imp3\n    Imp3 --> Imp4\n    Imp4 --> Imp5\n\n    Dec1 --> Dec2\n\n    style Imp1 fill:#f8d7da,stroke:#721c24,stroke-width:1px\n    style Dec1 fill:#d4edda,stroke:#155724,stroke-width:1px\n    style Dec2 fill:#d4edda,stroke:#155724,stroke-width:1px\n';
  var complexityDiagram = '\ngraph TB\n    subgraph "Interactive Visualization Complexity"\n        User["User Actions"]\n        State["Application State"]\n        Sim["Simulation Physics"]\n        Trans["Transitions"]\n        DOM["DOM Updates"]\n    end\n\n    User --> State\n    State --> Sim\n    Sim --> Trans\n    Trans --> DOM\n    State --> DOM\n\n    style User fill:#f5e6d3,stroke:#8b7355,stroke-width:2px\n    style State fill:#d4d8e8,stroke:#555b8b,stroke-width:2px\n    style Sim fill:#c4e8d3,stroke:#558b73,stroke-width:2px\n    style Trans fill:#e8d3f5,stroke:#735b8b,stroke-width:2px\n    style DOM fill:#f5e6d3,stroke:#8b7355,stroke-width:2px\n';
  var render46 = function(v) {
    return div2([classes(["tutorial-page"])])([render5({
      logoSize: Large.value,
      quadrant: QuadUnderstanding.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("Scene Structures & Transitions")]), p_([text2("Complex interactive visualizations like force-directed graphs involve managing multiple concerns: user input, simulation physics, state transitions, and DOM updates. PSD3v2's Scene structures make this complexity declarative.")]), div2([classes(["section-nav-cards"])])([renderNavCard3("The Challenge")("#challenge")("Why interactive viz is hard"), renderNavCard3("Scene Structures")("#scene-structures")("Declarative state management"), renderNavCard3("Transitions")("#transitions")("Smooth state changes"), renderNavCard3("Code Explorer")("#code-explorer")("Flagship example")])]), section([classes(["tutorial-section"]), id3("challenge")])([h2([classes(["tutorial-section-title"])])([text2("The Challenge of Interactive Visualizations")]), p_([text2("Interactive, updating visualizations with simulations are among the most complex frontend code to write correctly. They involve:")]), div2([classes(["diagram-container"])])([mermaidDiagram(complexityDiagram)(new Just("complexity-diagram"))]), ul_([li_([strong_([text2("User actions")]), text2(" - clicks, drags, hovers that trigger state changes")]), li_([strong_([text2("State management")]), text2(" - tracking what's visible, selected, filtered")]), li_([strong_([text2("Simulation physics")]), text2(" - continuous force calculations and position updates")]), li_([strong_([text2("Transitions")]), text2(" - smooth animations between states")]), li_([strong_([text2("DOM synchronization")]), text2(" - keeping the view in sync with the model")])]), p([classes(["code-highlight"])])([text2("Problem: "), text2("Imperative D3 code becomes tangled, hard to reason about, and prone to subtle bugs.")])]), section([classes(["tutorial-section"]), id3("scene-structures")])([h2([classes(["tutorial-section-title"])])([text2("Scene Structures")]), p_([text2("A Scene bundles together all the data needed to render a visualization state:")]), div2([classes(["diagram-container"])])([mermaidDiagram(sceneStructureDiagram)(new Just("scene-structure-diagram"))]), p_([text2("Each scene contains:")]), ul_([li_([strong_([text2("Data")]), text2(" - the nodes, links, or other data to visualize")]), li_([strong_([text2("Configuration")]), text2(" - layout parameters, force strengths, etc.")]), li_([strong_([text2("Behaviors")]), text2(" - how elements enter, update, and exit")])]), p_([text2("When the scene changes, PSD3v2 automatically:")]), ul_([li_([text2("Calculates the diff between old and new data")]), li_([text2("Creates enter selections for new data")]), li_([text2("Updates existing elements")]), li_([text2("Removes exiting elements with transitions")])])]), section([classes(["tutorial-section"]), id3("transitions")])([h2([classes(["tutorial-section-title"])])([text2("Transition Matrix")]), p_([text2("Complex applications have multiple scenes (states) with transitions between them:")]), div2([classes(["diagram-container"])])([mermaidDiagram(transitionMatrixDiagram)(new Just("transition-matrix-diagram"))]), p_([text2("Each transition defines:")]), ul_([li_([strong_([text2("TransitionConfig")]), text2(" - duration, easing, delay")]), li_([strong_([text2("Initial attributes")]), text2(" - starting state for entering elements")]), li_([strong_([text2("Target attributes")]), text2(" - ending state to animate toward")])]), p_([text2("This declarative approach makes complex multi-state visualizations much easier to reason about:")]), div2([classes(["diagram-container"])])([mermaidDiagram(declarativeVsDiagram)(new Just("declarative-vs-diagram"))])]), section([classes(["tutorial-section"]), id3("code-explorer")])([h2([classes(["tutorial-section-title"])])([text2("Flagship Example: Code Explorer")]), p_([text2("The Code Explorer demonstrates Scene structures in action. It's an interactive force-directed graph of PureScript module dependencies with:")]), ul_([li_([strong_([text2("Multiple scenes")]), text2(" - different views of the module graph")]), li_([strong_([text2("Smooth transitions")]), text2(" - animated changes between states")]), li_([strong_([text2("User interactions")]), text2(" - click, drag, zoom, expand/collapse")]), li_([strong_([text2("Force simulation")]), text2(" - physics-based layout")])]), p_([text2("Despite this complexity, the core update logic is declarative - you specify the target scene and PSD3v2 handles the rest.")]), p([classes(["code-highlight"])])([text2("Key insight: "), text2('Think in terms of "what state do I want?" not "what updates do I need to apply?"')])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Summary")]), p_([text2("Scene structures enable:")]), ul_([li_([text2("Declarative state management for complex visualizations")]), li_([text2("Automatic diff calculation and DOM updates")]), li_([text2("Transition matrix for multi-state applications")]), li_([text2("Clean separation of data, configuration, and behavior")]), li_([text2("Easier reasoning about complex interactive visualizations")])])])])]);
  };
  var component42 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render46,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction41(dictMonadAff),
        initialize: new Just(Initialize42.value)
      })
    });
  };

  // output/Component.Understanding.UnderstandingSelections/index.js
  var triggerMermaidRendering5 = /* @__PURE__ */ triggerMermaidRendering(monadEffectEffect);
  var Initialize43 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var typeSafetyDiagram = '\ngraph LR\n    subgraph "Compile-Time Errors"\n        Bad1["setAttrs on SEmpty"]\n        Bad2["append on SBoundOwns"]\n        Bad3["remove on SPending"]\n    end\n\n    Bad1 --> Error[Type Error!]\n    Bad2 --> Error\n    Bad3 --> Error\n\n    style Bad1 fill:#f8d7da,stroke:#721c24,stroke-width:2px\n    style Bad2 fill:#f8d7da,stroke:#721c24,stroke-width:2px\n    style Bad3 fill:#f8d7da,stroke:#721c24,stroke-width:2px\n    style Error fill:#dc3545,stroke:#721c24,stroke-width:2px,color:#fff\n';
  var stateMachineDiagram = "\nstateDiagram-v2\n    [*] --> SEmpty: select/selectAll\n    SEmpty --> SBoundOwns: appendData\n    SEmpty --> JoinResult: joinData\n\n    state JoinResult {\n        [*] --> fork\n        fork --> SPending: .enter\n        fork --> SBoundOwns: .update\n        fork --> SExiting: .exit\n    }\n\n    SPending --> SBoundOwns: append\n    SBoundOwns --> SBoundOwns: setAttrs\n    SBoundOwns --> SBoundInherits: appendChildInheriting\n    SBoundOwns --> SBoundOwns: merge\n    SExiting --> [*]: remove\n";
  var renderNavCard4 = function(title4) {
    return function(href5) {
      return function(description) {
        return a([href(href5), classes(["section-nav-card"])])([h3_([text2(title4)]), p_([text2(description)])]);
      };
    };
  };
  var indexedMonadDiagram = '\ngraph TB\n    subgraph "Indexed Monad Pattern"\n        M1["m (sel s1 elem datum)<br/><i>Operation in state s1</i>"]\n        M2["m (sel s2 elem datum)<br/><i>Returns new state s2</i>"]\n        Bind[ibind]\n    end\n\n    M1 --> Bind\n    Bind --> M2\n\n    note["State transitions encoded in types<br/>Compiler enforces valid sequences"]\n\n    style M1 fill:#f5e6d3,stroke:#8b7355,stroke-width:2px\n    style Bind fill:#d4d8e8,stroke:#555b8b,stroke-width:2px\n    style M2 fill:#c4e8d3,stroke:#558b73,stroke-width:2px\n';
  var render47 = function(v) {
    return div2([classes(["tutorial-page"])])([render5({
      logoSize: Large.value,
      quadrant: QuadUnderstanding.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("Selection Phantom Types")]), p_([text2("PSD3v2 uses phantom types to encode the state machine of D3 selections. This is similar to the Indexed Monad pattern - operations are only allowed when the selection is in the correct state, and this is enforced at compile time.")]), div2([classes(["section-nav-cards"])])([renderNavCard4("Selection States")("#selection-states")("Five phantom type states"), renderNavCard4("State Machine")("#state-machine")("Valid state transitions"), renderNavCard4("Indexed Monad")("#indexed-monad")("Why this pattern works"), renderNavCard4("Type Safety")("#type-safety")("Errors at compile time")])]), section([classes(["tutorial-section"]), id3("selection-states")])([h2([classes(["tutorial-section-title"])])([text2("The Five Selection States")]), p_([text2("A selection in PSD3v2 carries a phantom type parameter indicating its current state:")]), table([classes(["tutorial-table"])])([thead_([tr_([th_([text2("State")]), th_([text2("Meaning")]), th_([text2("Valid Operations")])])]), tbody_([tr_([td_([code_([text2("SEmpty")])]), td_([text2("Has parent elements, no data bound")]), td_([text2("appendChild, appendData, joinData")])]), tr_([td_([code_([text2("SPending")])]), td_([text2("Has data, needs elements (enter)")]), td_([text2("append")])]), tr_([td_([code_([text2("SBoundOwns")])]), td_([text2("Elements with bound data")]), td_([text2("setAttrs, appendChildInheriting, merge")])]), tr_([td_([code_([text2("SBoundInherits")])]), td_([text2("Child elements inheriting parent data")]), td_([text2("setAttrs")])]), tr_([td_([code_([text2("SExiting")])]), td_([text2("Elements to be removed (exit)")]), td_([text2("setAttrsExit, remove")])])])]), p([classes(["code-highlight"])])([text2("Note: "), text2("These types are 'phantom' - they exist only at compile time and carry no runtime data.")])]), section([classes(["tutorial-section"]), id3("state-machine")])([h2([classes(["tutorial-section-title"])])([text2("The Selection State Machine")]), p_([text2("Operations transition selections between states. The type system ensures only valid transitions are allowed:")]), div2([classes(["diagram-container"])])([mermaidDiagram(stateMachineDiagram)(new Just("state-machine-diagram"))]), p_([text2("Key transitions:")]), ul_([li_([code_([text2("select")]), text2(" \u2192 SEmpty (entry point)")]), li_([code_([text2("joinData")]), text2(" \u2192 JoinResult with enter/update/exit")]), li_([code_([text2("append")]), text2(" \u2192 SPending to SBoundOwns (creates elements)")]), li_([code_([text2("remove")]), text2(" \u2192 SExiting to done (deletes elements)")])])]), section([classes(["tutorial-section"]), id3("indexed-monad")])([h2([classes(["tutorial-section-title"])])([text2("The Indexed Monad Pattern")]), p_([text2("This design is inspired by Indexed Monads (also called Parameterized Monads). Unlike regular monads where bind has type:")]), p([classes(["code-highlight"])])([code_([text2("bind :: m a -> (a -> m b) -> m b")])]), p_([text2("Indexed monads carry additional type parameters for pre/post state:")]), p([classes(["code-highlight"])])([code_([text2("ibind :: m i j a -> (a -> m j k b) -> m i k b")])]), div2([classes(["diagram-container"])])([mermaidDiagram(indexedMonadDiagram)(new Just("indexed-monad-diagram"))]), p_([text2("In PSD3v2, each selection operation is typed with its input and output states:")]), ul_([li_([code_([text2("select :: m (sel SEmpty ...)")])]), li_([code_([text2("append :: sel SPending ... -> m (sel SBoundOwns ...)")])])]), p_([text2("Sequencing operations chains their states - the output of one becomes input to the next.")])]), section([classes(["tutorial-section"]), id3("type-safety")])([h2([classes(["tutorial-section-title"])])([text2("Type Safety in Practice")]), p_([text2("Invalid operations are compile-time errors, not runtime bugs:")]), div2([classes(["diagram-container"])])([mermaidDiagram(typeSafetyDiagram)(new Just("type-safety-diagram"))]), p_([text2("Examples of errors caught at compile time:")]), ul_([li_([code_([text2("setAttrs attrs emptySel")]), text2(" - Can't set attrs on SEmpty")]), li_([code_([text2("append Circle boundSel")]), text2(" - Can't append to SBoundOwns")]), li_([code_([text2("remove pendingSel")]), text2(" - Can't remove SPending (has no elements)")])]), p_([text2("Compare to D3.js where these errors would fail silently or cause confusing runtime behavior.")]), p([classes(["code-highlight"])])([text2("Benefit: "), text2("The compiler guides you through the correct sequence of operations.")])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Summary")]), p_([text2("Selection phantom types provide:")]), ul_([li_([text2("Five states: SEmpty, SPending, SBoundOwns, SBoundInherits, SExiting")]), li_([text2("State machine enforced by types")]), li_([text2("Indexed Monad pattern for state transitions")]), li_([text2("Invalid operation sequences caught at compile time")]), li_([text2("No more silent failures or undefined behavior")])])])])]);
  };
  var handleAction42 = function(dictMonadAff) {
    var liftEffect51 = liftEffect(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    return function(v) {
      return liftEffect51(triggerMermaidRendering5);
    };
  };
  var component43 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render47,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction42(dictMonadAff),
        initialize: new Just(Initialize43.value)
      })
    });
  };

  // output/Component.Understanding.UnderstandingTreeAPI/index.js
  var triggerMermaidRendering6 = /* @__PURE__ */ triggerMermaidRendering(monadEffectEffect);
  var Initialize44 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var treeStructureDiagram = '\ngraph TD\n    subgraph "Tree datum"\n        Node["Node<br/><i>Static element</i>"]\n        Join["Join<br/><i>Data-driven N elements</i>"]\n        NestedJoin["NestedJoin<br/><i>Type decomposition</i>"]\n        SceneJoin["SceneJoin<br/><i>GUP behaviors</i>"]\n    end\n\n    Node --> Children["children: Array Tree"]\n    Join --> Template["template: datum -> Tree"]\n    NestedJoin --> Decompose["decompose + template"]\n    SceneJoin --> Behaviors["enter/update/exit"]\n\n    style Node fill:#f5e6d3,stroke:#8b7355,stroke-width:2px\n    style Join fill:#e8dcc6,stroke:#8b7355,stroke-width:2px\n    style NestedJoin fill:#d4c4b0,stroke:#8b7355,stroke-width:2px\n    style SceneJoin fill:#c4e8d3,stroke:#558b73,stroke-width:2px\n';
  var renderNavCard5 = function(title4) {
    return function(href5) {
      return function(description) {
        return a([href(href5), classes(["section-nav-card"])])([h3_([text2(title4)]), p_([text2(description)])]);
      };
    };
  };
  var layerCakeDiagram = '\ngraph TB\n    subgraph "High-Level APIs"\n        TreeAPI["TreeAPI<br/><i>Declarative tree structures</i>"]\n        SimAPI["Simulation API<br/><i>Force-directed layouts</i>"]\n    end\n\n    subgraph "Core Layer"\n        SelectionM["SelectionM<br/><i>Type-safe selections</i>"]\n    end\n\n    subgraph "Interpreters"\n        D3v2["D3v2 Interpreter<br/><i>DOM manipulation</i>"]\n        Mermaid["Mermaid Interpreter<br/><i>Diagram generation</i>"]\n        String["String Interpreter<br/><i>Debug output</i>"]\n    end\n\n    TreeAPI --> SelectionM\n    SimAPI --> SelectionM\n    SelectionM --> D3v2\n    SelectionM --> Mermaid\n    SelectionM --> String\n\n    style TreeAPI fill:#c4e8d3,stroke:#558b73,stroke-width:2px\n    style SimAPI fill:#c4e8d3,stroke:#558b73,stroke-width:2px\n    style SelectionM fill:#d4d8e8,stroke:#555b8b,stroke-width:2px\n    style D3v2 fill:#f5e6d3,stroke:#8b7355,stroke-width:2px\n    style Mermaid fill:#f5e6d3,stroke:#8b7355,stroke-width:2px\n    style String fill:#f5e6d3,stroke:#8b7355,stroke-width:2px\n';
  var handleAction43 = function(dictMonadAff) {
    var liftEffect51 = liftEffect(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    return function(v) {
      return liftEffect51(triggerMermaidRendering6);
    };
  };
  var comparisonDiagram = '\ngraph LR\n    subgraph "Imperative Style"\n        Imp1["select"]\n        Imp2["appendChild"]\n        Imp3["appendChild"]\n        Imp4["joinData"]\n        Imp5["append"]\n        Imp6["setAttrs"]\n    end\n\n    subgraph "Declarative Style"\n        Dec1["renderTree"]\n        Dec2["Tree structure"]\n    end\n\n    Imp1 --> Imp2\n    Imp2 --> Imp3\n    Imp3 --> Imp4\n    Imp4 --> Imp5\n    Imp5 --> Imp6\n\n    Dec1 --> Dec2\n\n    style Imp1 fill:#f8d7da,stroke:#721c24,stroke-width:1px\n    style Dec1 fill:#d4edda,stroke:#155724,stroke-width:1px\n    style Dec2 fill:#d4edda,stroke:#155724,stroke-width:1px\n';
  var render48 = function(v) {
    return div2([classes(["tutorial-page"])])([render5({
      logoSize: Large.value,
      quadrant: QuadUnderstanding.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), main_([section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("TreeAPI: Declarative Visualization")]), p_([text2("TreeAPI provides a declarative way to build visualization structures. Instead of imperative method chains, you declare the tree structure you want and PSD3v2 renders it. This makes static visualizations extremely succinct while maintaining full type safety.")]), div2([classes(["section-nav-cards"])])([renderNavCard5("Architecture")("#architecture")("API layer cake"), renderNavCard5("Tree Variants")("#tree-variants")("Node, Join, SceneJoin"), renderNavCard5("Static vs GUP")("#static-vs-gup")("When to use what"), renderNavCard5("Limitations")("#limitations")("When to use Selection API")])]), section([classes(["tutorial-section"]), id3("architecture")])([h2([classes(["tutorial-section-title"])])([text2("Architecture: The Layer Cake")]), p_([text2("PSD3v2 is organized in layers. TreeAPI and Simulation API are high-level, declarative APIs that sit on top of the core SelectionM layer:")]), div2([classes(["diagram-container"])])([mermaidDiagram(layerCakeDiagram)(new Just("layer-cake-diagram"))]), p_([text2("Key points:")]), ul_([li_([strong_([text2("TreeAPI")]), text2(" - Declarative tree structures for static visualizations")]), li_([strong_([text2("Simulation API")]), text2(" - Force-directed layouts with physics")]), li_([strong_([text2("SelectionM")]), text2(" - Core selection operations with phantom types")]), li_([strong_([text2("Interpreters")]), text2(" - Multiple backends via Finally Tagless")])])]), section([classes(["tutorial-section"]), id3("tree-variants")])([h2([classes(["tutorial-section-title"])])([text2("Tree Variants")]), p_([text2("TreeAPI provides different tree node types for different use cases:")]), div2([classes(["diagram-container"])])([mermaidDiagram(treeStructureDiagram)(new Just("tree-structure-diagram"))]), table([classes(["tutorial-table"])])([thead_([tr_([th_([text2("Variant")]), th_([text2("Use Case")]), th_([text2("Smart Constructor")])])]), tbody_([tr_([td_([code_([text2("Node")])]), td_([text2("Static elements with children")]), td_([code_([text2("named, elem")])])]), tr_([td_([code_([text2("Join")])]), td_([text2("N elements from N data items")]), td_([code_([text2("joinData")])])]), tr_([td_([code_([text2("NestedJoin")])]), td_([text2("Nested data with type decomposition")]), td_([code_([text2("nestedJoin")])])]), tr_([td_([code_([text2("SceneJoin")])]), td_([text2("GUP with enter/update/exit behaviors")]), td_([code_([text2("sceneJoin, sceneNestedJoin")])])])])]), p([classes(["code-highlight"])])([text2("Composition: "), code_([text2("withChild")]), text2(" and "), code_([text2("withChildren")]), text2(" build up tree structures.")])]), section([classes(["tutorial-section"]), id3("static-vs-gup")])([h2([classes(["tutorial-section-title"])])([text2("Static vs General Update Pattern")]), p_([text2("TreeAPI shines for static visualizations with its succinct, declarative syntax:")]), div2([classes(["diagram-container"])])([mermaidDiagram(comparisonDiagram)(new Just("comparison-diagram"))]), p_([text2("For updating visualizations, use "), code_([text2("SceneJoin")]), text2(" which declaratively specifies enter/update/exit behaviors:")]), ul_([li_([strong_([text2("Enter")]), text2(" - Initial attributes and optional transition for new elements")]), li_([strong_([text2("Update")]), text2(" - Attributes and transition for existing elements")]), li_([strong_([text2("Exit")]), text2(" - Attributes and transition before removal")])]), p([classes(["code-highlight"])])([text2("SceneNestedJoin: "), text2("Combines type decomposition with GUP - the most powerful variant.")])]), section([classes(["tutorial-section"]), id3("limitations")])([h2([classes(["tutorial-section-title"])])([text2("When to Use the Selection API")]), p_([text2("TreeAPI is excellent for many use cases, but the underlying Selection API provides more control for:")]), ul_([li_([strong_([text2("Complex interactions")]), text2(" - Fine-grained control over event handlers")]), li_([strong_([text2("Dynamic structures")]), text2(" - Tree shape that changes based on data")]), li_([strong_([text2("Custom transitions")]), text2(" - Coordinated animations across elements")]), li_([strong_([text2("Force simulations")]), text2(" - Physics-based layouts with tick functions")])]), p_([text2("The good news: both APIs work with the same SelectionM foundation, so you can mix them as needed. Use TreeAPI for structure, Selection API for behavior.")]), p([classes(["code-highlight"])])([text2("Tip: "), text2("Start with TreeAPI. Drop to Selection API when you need more control.")])]), section([classes(["tutorial-section"])])([h2([classes(["tutorial-section-title"])])([text2("Summary")]), p_([text2("TreeAPI provides:")]), ul_([li_([text2("Declarative tree structures instead of imperative chains")]), li_([text2("Four variants: Node, Join, NestedJoin, SceneJoin")]), li_([text2("Succinct static visualizations")]), li_([text2("SceneJoin for declarative GUP with transitions")]), li_([text2("Compatible with underlying Selection API")])])])])]);
  };
  var component44 = function(dictMonadAff) {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render48,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction43(dictMonadAff),
        initialize: new Just(Initialize44.value)
      })
    });
  };

  // output/Halogen.Aff.Util/index.js
  var bind80 = /* @__PURE__ */ bind(bindAff);
  var liftEffect45 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var bindFlipped5 = /* @__PURE__ */ bindFlipped(bindEffect);
  var composeKleisliFlipped4 = /* @__PURE__ */ composeKleisliFlipped(bindEffect);
  var pure77 = /* @__PURE__ */ pure(applicativeAff);
  var bindFlipped1 = /* @__PURE__ */ bindFlipped(bindMaybe);
  var pure125 = /* @__PURE__ */ pure(applicativeEffect);
  var map80 = /* @__PURE__ */ map(functorEffect);
  var discard72 = /* @__PURE__ */ discard(discardUnit);
  var throwError2 = /* @__PURE__ */ throwError(monadThrowAff);
  var selectElement = function(query2) {
    return bind80(liftEffect45(bindFlipped5(composeKleisliFlipped4((function() {
      var $16 = querySelector(query2);
      return function($17) {
        return $16(toParentNode2($17));
      };
    })())(document2))(windowImpl)))(function(mel) {
      return pure77(bindFlipped1(fromElement)(mel));
    });
  };
  var runHalogenAff = /* @__PURE__ */ runAff_(/* @__PURE__ */ either(throwException)(/* @__PURE__ */ $$const(/* @__PURE__ */ pure125(unit))));
  var awaitLoad = /* @__PURE__ */ makeAff(function(callback) {
    return function __do3() {
      var rs = bindFlipped5(readyState)(bindFlipped5(document2)(windowImpl))();
      if (rs instanceof Loading) {
        var et = map80(toEventTarget)(windowImpl)();
        var listener = eventListener(function(v) {
          return callback(new Right(unit));
        })();
        addEventListener2(domcontentloaded)(listener)(false)(et)();
        return effectCanceler(removeEventListener2(domcontentloaded)(listener)(false)(et));
      }
      ;
      callback(new Right(unit))();
      return nonCanceler;
    };
  });
  var awaitBody = /* @__PURE__ */ discard72(bindAff)(awaitLoad)(function() {
    return bind80(selectElement("body"))(function(body2) {
      return maybe(throwError2(error("Could not find body")))(pure77)(body2);
    });
  });

  // output/Control.Monad.Fork.Class/index.js
  var monadForkAff = {
    suspend: suspendAff,
    fork: forkAff,
    join: joinFiber,
    Monad0: function() {
      return monadAff;
    },
    Functor1: function() {
      return functorFiber;
    }
  };
  var fork2 = function(dict) {
    return dict.fork;
  };

  // output/Halogen.Aff.Driver.State/index.js
  var unRenderStateX = unsafeCoerce2;
  var unDriverStateX = unsafeCoerce2;
  var renderStateX_ = function(dictApplicative) {
    var traverse_10 = traverse_(dictApplicative)(foldableMaybe);
    return function(f) {
      return unDriverStateX(function(st) {
        return traverse_10(f)(st.rendering);
      });
    };
  };
  var mkRenderStateX = unsafeCoerce2;
  var renderStateX = function(dictFunctor) {
    return function(f) {
      return unDriverStateX(function(st) {
        return mkRenderStateX(f(st.rendering));
      });
    };
  };
  var mkDriverStateXRef = unsafeCoerce2;
  var mapDriverState = function(f) {
    return function(v) {
      return f(v);
    };
  };
  var initDriverState = function(component55) {
    return function(input3) {
      return function(handler3) {
        return function(lchs) {
          return function __do3() {
            var selfRef = $$new({})();
            var childrenIn = $$new(empty4)();
            var childrenOut = $$new(empty4)();
            var handlerRef = $$new(handler3)();
            var pendingQueries = $$new(new Just(Nil.value))();
            var pendingOuts = $$new(new Just(Nil.value))();
            var pendingHandlers = $$new(Nothing.value)();
            var fresh2 = $$new(1)();
            var subscriptions = $$new(new Just(empty3))();
            var forks = $$new(empty3)();
            var ds = {
              component: component55,
              state: component55.initialState(input3),
              refs: empty3,
              children: empty4,
              childrenIn,
              childrenOut,
              selfRef,
              handlerRef,
              pendingQueries,
              pendingOuts,
              pendingHandlers,
              rendering: Nothing.value,
              fresh: fresh2,
              subscriptions,
              forks,
              lifecycleHandlers: lchs
            };
            write(ds)(selfRef)();
            return mkDriverStateXRef(selfRef);
          };
        };
      };
    };
  };

  // output/Halogen.Aff.Driver.Eval/index.js
  var traverse_7 = /* @__PURE__ */ traverse_(applicativeEffect)(foldableMaybe);
  var bindFlipped6 = /* @__PURE__ */ bindFlipped(bindMaybe);
  var lookup39 = /* @__PURE__ */ lookup2(ordSubscriptionId);
  var bind135 = /* @__PURE__ */ bind(bindAff);
  var liftEffect46 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var discard73 = /* @__PURE__ */ discard(discardUnit);
  var discard119 = /* @__PURE__ */ discard73(bindAff);
  var traverse_13 = /* @__PURE__ */ traverse_(applicativeAff);
  var traverse_22 = /* @__PURE__ */ traverse_13(foldableList);
  var fork3 = /* @__PURE__ */ fork2(monadForkAff);
  var parSequence_2 = /* @__PURE__ */ parSequence_(parallelAff)(applicativeParAff)(foldableList);
  var pure78 = /* @__PURE__ */ pure(applicativeAff);
  var map81 = /* @__PURE__ */ map(functorCoyoneda);
  var parallel3 = /* @__PURE__ */ parallel(parallelAff);
  var map121 = /* @__PURE__ */ map(functorAff);
  var sequential2 = /* @__PURE__ */ sequential(parallelAff);
  var map210 = /* @__PURE__ */ map(functorMaybe);
  var insert13 = /* @__PURE__ */ insert(ordSubscriptionId);
  var retractFreeAp2 = /* @__PURE__ */ retractFreeAp(applicativeParAff);
  var $$delete7 = /* @__PURE__ */ $$delete3(ordForkId);
  var unlessM2 = /* @__PURE__ */ unlessM(monadEffect);
  var insert14 = /* @__PURE__ */ insert(ordForkId);
  var traverse_32 = /* @__PURE__ */ traverse_13(foldableMaybe);
  var lookup111 = /* @__PURE__ */ lookup2(ordForkId);
  var lookup210 = /* @__PURE__ */ lookup2(ordString);
  var foldFree2 = /* @__PURE__ */ foldFree(monadRecAff);
  var alter3 = /* @__PURE__ */ alter(ordString);
  var unsubscribe3 = function(sid) {
    return function(ref2) {
      return function __do3() {
        var v = read(ref2)();
        var subs = read(v.subscriptions)();
        return traverse_7(unsubscribe)(bindFlipped6(lookup39(sid))(subs))();
      };
    };
  };
  var queueOrRun = function(ref2) {
    return function(au) {
      return bind135(liftEffect46(read(ref2)))(function(v) {
        if (v instanceof Nothing) {
          return au;
        }
        ;
        if (v instanceof Just) {
          return liftEffect46(write(new Just(new Cons(au, v.value0)))(ref2));
        }
        ;
        throw new Error("Failed pattern match at Halogen.Aff.Driver.Eval (line 188, column 33 - line 190, column 57): " + [v.constructor.name]);
      });
    };
  };
  var handleLifecycle = function(lchs) {
    return function(f) {
      return discard119(liftEffect46(write({
        initializers: Nil.value,
        finalizers: Nil.value
      })(lchs)))(function() {
        return bind135(liftEffect46(f))(function(result) {
          return bind135(liftEffect46(read(lchs)))(function(v) {
            return discard119(traverse_22(fork3)(v.finalizers))(function() {
              return discard119(parSequence_2(v.initializers))(function() {
                return pure78(result);
              });
            });
          });
        });
      });
    };
  };
  var handleAff = /* @__PURE__ */ runAff_(/* @__PURE__ */ either(throwException)(/* @__PURE__ */ $$const(/* @__PURE__ */ pure(applicativeEffect)(unit))));
  var fresh = function(f) {
    return function(ref2) {
      return bind135(liftEffect46(read(ref2)))(function(v) {
        return liftEffect46(modify$prime(function(i2) {
          return {
            state: i2 + 1 | 0,
            value: f(i2)
          };
        })(v.fresh));
      });
    };
  };
  var evalQ = function(render61) {
    return function(ref2) {
      return function(q2) {
        return bind135(liftEffect46(read(ref2)))(function(v) {
          return evalM(render61)(ref2)(v["component"]["eval"](new Query(map81(Just.create)(liftCoyoneda(q2)), $$const(Nothing.value))));
        });
      };
    };
  };
  var evalM = function(render61) {
    return function(initRef) {
      return function(v) {
        var evalChildQuery = function(ref2) {
          return function(cqb) {
            return bind135(liftEffect46(read(ref2)))(function(v1) {
              return unChildQueryBox(function(v2) {
                var evalChild = function(v3) {
                  return parallel3(bind135(liftEffect46(read(v3)))(function(dsx) {
                    return unDriverStateX(function(ds) {
                      return evalQ(render61)(ds.selfRef)(v2.value1);
                    })(dsx);
                  }));
                };
                return map121(v2.value2)(sequential2(v2.value0(applicativeParAff)(evalChild)(v1.children)));
              })(cqb);
            });
          };
        };
        var go2 = function(ref2) {
          return function(v1) {
            if (v1 instanceof State) {
              return bind135(liftEffect46(read(ref2)))(function(v2) {
                var v3 = v1.value0(v2.state);
                if (unsafeRefEq(v2.state)(v3.value1)) {
                  return pure78(v3.value0);
                }
                ;
                if (otherwise) {
                  return discard119(liftEffect46(write({
                    component: v2.component,
                    refs: v2.refs,
                    children: v2.children,
                    childrenIn: v2.childrenIn,
                    childrenOut: v2.childrenOut,
                    selfRef: v2.selfRef,
                    handlerRef: v2.handlerRef,
                    pendingQueries: v2.pendingQueries,
                    pendingOuts: v2.pendingOuts,
                    pendingHandlers: v2.pendingHandlers,
                    rendering: v2.rendering,
                    fresh: v2.fresh,
                    subscriptions: v2.subscriptions,
                    forks: v2.forks,
                    lifecycleHandlers: v2.lifecycleHandlers,
                    state: v3.value1
                  })(ref2)))(function() {
                    return discard119(handleLifecycle(v2.lifecycleHandlers)(render61(v2.lifecycleHandlers)(ref2)))(function() {
                      return pure78(v3.value0);
                    });
                  });
                }
                ;
                throw new Error("Failed pattern match at Halogen.Aff.Driver.Eval (line 86, column 7 - line 92, column 21): " + [v3.constructor.name]);
              });
            }
            ;
            if (v1 instanceof Subscribe) {
              return bind135(fresh(SubscriptionId)(ref2))(function(sid) {
                return bind135(liftEffect46(subscribe(v1.value0(sid))(function(act) {
                  return handleAff(evalF(render61)(ref2)(new Action(act)));
                })))(function(finalize) {
                  return bind135(liftEffect46(read(ref2)))(function(v2) {
                    return discard119(liftEffect46(modify_(map210(insert13(sid)(finalize)))(v2.subscriptions)))(function() {
                      return pure78(v1.value1(sid));
                    });
                  });
                });
              });
            }
            ;
            if (v1 instanceof Unsubscribe) {
              return discard119(liftEffect46(unsubscribe3(v1.value0)(ref2)))(function() {
                return pure78(v1.value1);
              });
            }
            ;
            if (v1 instanceof Lift2) {
              return v1.value0;
            }
            ;
            if (v1 instanceof ChildQuery2) {
              return evalChildQuery(ref2)(v1.value0);
            }
            ;
            if (v1 instanceof Raise2) {
              return bind135(liftEffect46(read(ref2)))(function(v2) {
                return bind135(liftEffect46(read(v2.handlerRef)))(function(handler3) {
                  return discard119(queueOrRun(v2.pendingOuts)(handler3(v1.value0)))(function() {
                    return pure78(v1.value1);
                  });
                });
              });
            }
            ;
            if (v1 instanceof Par) {
              return sequential2(retractFreeAp2(hoistFreeAp((function() {
                var $119 = evalM(render61)(ref2);
                return function($120) {
                  return parallel3($119($120));
                };
              })())(v1.value0)));
            }
            ;
            if (v1 instanceof Fork) {
              return bind135(fresh(ForkId)(ref2))(function(fid) {
                return bind135(liftEffect46(read(ref2)))(function(v2) {
                  return bind135(liftEffect46($$new(false)))(function(doneRef) {
                    return bind135(fork3($$finally(liftEffect46(function __do3() {
                      modify_($$delete7(fid))(v2.forks)();
                      return write(true)(doneRef)();
                    }))(evalM(render61)(ref2)(v1.value0))))(function(fiber) {
                      return discard119(liftEffect46(unlessM2(read(doneRef))(modify_(insert14(fid)(fiber))(v2.forks))))(function() {
                        return pure78(v1.value1(fid));
                      });
                    });
                  });
                });
              });
            }
            ;
            if (v1 instanceof Join) {
              return bind135(liftEffect46(read(ref2)))(function(v2) {
                return bind135(liftEffect46(read(v2.forks)))(function(forkMap) {
                  return discard119(traverse_32(joinFiber)(lookup111(v1.value0)(forkMap)))(function() {
                    return pure78(v1.value1);
                  });
                });
              });
            }
            ;
            if (v1 instanceof Kill) {
              return bind135(liftEffect46(read(ref2)))(function(v2) {
                return bind135(liftEffect46(read(v2.forks)))(function(forkMap) {
                  return discard119(traverse_32(killFiber(error("Cancelled")))(lookup111(v1.value0)(forkMap)))(function() {
                    return pure78(v1.value1);
                  });
                });
              });
            }
            ;
            if (v1 instanceof GetRef) {
              return bind135(liftEffect46(read(ref2)))(function(v2) {
                return pure78(v1.value1(lookup210(v1.value0)(v2.refs)));
              });
            }
            ;
            throw new Error("Failed pattern match at Halogen.Aff.Driver.Eval (line 83, column 12 - line 139, column 33): " + [v1.constructor.name]);
          };
        };
        return foldFree2(go2(initRef))(v);
      };
    };
  };
  var evalF = function(render61) {
    return function(ref2) {
      return function(v) {
        if (v instanceof RefUpdate) {
          return liftEffect46(flip(modify_)(ref2)(mapDriverState(function(st) {
            return {
              component: st.component,
              state: st.state,
              children: st.children,
              childrenIn: st.childrenIn,
              childrenOut: st.childrenOut,
              selfRef: st.selfRef,
              handlerRef: st.handlerRef,
              pendingQueries: st.pendingQueries,
              pendingOuts: st.pendingOuts,
              pendingHandlers: st.pendingHandlers,
              rendering: st.rendering,
              fresh: st.fresh,
              subscriptions: st.subscriptions,
              forks: st.forks,
              lifecycleHandlers: st.lifecycleHandlers,
              refs: alter3($$const(v.value1))(v.value0)(st.refs)
            };
          })));
        }
        ;
        if (v instanceof Action) {
          return bind135(liftEffect46(read(ref2)))(function(v1) {
            return evalM(render61)(ref2)(v1["component"]["eval"](new Action2(v.value0, unit)));
          });
        }
        ;
        throw new Error("Failed pattern match at Halogen.Aff.Driver.Eval (line 52, column 20 - line 58, column 62): " + [v.constructor.name]);
      };
    };
  };

  // output/Halogen.Aff.Driver/index.js
  var bind81 = /* @__PURE__ */ bind(bindEffect);
  var discard74 = /* @__PURE__ */ discard(discardUnit);
  var for_4 = /* @__PURE__ */ for_(applicativeEffect)(foldableMaybe);
  var traverse_8 = /* @__PURE__ */ traverse_(applicativeAff)(foldableList);
  var fork4 = /* @__PURE__ */ fork2(monadForkAff);
  var bindFlipped7 = /* @__PURE__ */ bindFlipped(bindEffect);
  var traverse_14 = /* @__PURE__ */ traverse_(applicativeEffect);
  var traverse_23 = /* @__PURE__ */ traverse_14(foldableMaybe);
  var traverse_33 = /* @__PURE__ */ traverse_14(foldableMap);
  var discard214 = /* @__PURE__ */ discard74(bindAff);
  var parSequence_3 = /* @__PURE__ */ parSequence_(parallelAff)(applicativeParAff)(foldableList);
  var liftEffect47 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var pure79 = /* @__PURE__ */ pure(applicativeEffect);
  var map82 = /* @__PURE__ */ map(functorEffect);
  var pure126 = /* @__PURE__ */ pure(applicativeAff);
  var when7 = /* @__PURE__ */ when(applicativeEffect);
  var renderStateX2 = /* @__PURE__ */ renderStateX(functorEffect);
  var $$void15 = /* @__PURE__ */ $$void(functorAff);
  var foreachSlot2 = /* @__PURE__ */ foreachSlot(applicativeEffect);
  var renderStateX_2 = /* @__PURE__ */ renderStateX_(applicativeEffect);
  var tailRecM3 = /* @__PURE__ */ tailRecM(monadRecEffect);
  var voidLeft3 = /* @__PURE__ */ voidLeft(functorEffect);
  var bind136 = /* @__PURE__ */ bind(bindAff);
  var liftEffect120 = /* @__PURE__ */ liftEffect(monadEffectEffect);
  var newLifecycleHandlers = /* @__PURE__ */ (function() {
    return $$new({
      initializers: Nil.value,
      finalizers: Nil.value
    });
  })();
  var handlePending = function(ref2) {
    return function __do3() {
      var queue = read(ref2)();
      write(Nothing.value)(ref2)();
      return for_4(queue)((function() {
        var $59 = traverse_8(fork4);
        return function($60) {
          return handleAff($59(reverse2($60)));
        };
      })())();
    };
  };
  var cleanupSubscriptionsAndForks = function(v) {
    return function __do3() {
      bindFlipped7(traverse_23(traverse_33(unsubscribe)))(read(v.subscriptions))();
      write(Nothing.value)(v.subscriptions)();
      bindFlipped7(traverse_33((function() {
        var $61 = killFiber(error("finalized"));
        return function($62) {
          return handleAff($61($62));
        };
      })()))(read(v.forks))();
      return write(empty3)(v.forks)();
    };
  };
  var runUI = function(renderSpec2) {
    return function(component55) {
      return function(i2) {
        var squashChildInitializers = function(lchs) {
          return function(preInits) {
            return unDriverStateX(function(st) {
              var parentInitializer = evalM(render61)(st.selfRef)(st["component"]["eval"](new Initialize(unit)));
              return modify_(function(handlers) {
                return {
                  initializers: new Cons(discard214(parSequence_3(reverse2(handlers.initializers)))(function() {
                    return discard214(parentInitializer)(function() {
                      return liftEffect47(function __do3() {
                        handlePending(st.pendingQueries)();
                        return handlePending(st.pendingOuts)();
                      });
                    });
                  }), preInits),
                  finalizers: handlers.finalizers
                };
              })(lchs);
            });
          };
        };
        var runComponent = function(lchs) {
          return function(handler3) {
            return function(j) {
              return unComponent(function(c) {
                return function __do3() {
                  var lchs$prime = newLifecycleHandlers();
                  var $$var2 = initDriverState(c)(j)(handler3)(lchs$prime)();
                  var pre2 = read(lchs)();
                  write({
                    initializers: Nil.value,
                    finalizers: pre2.finalizers
                  })(lchs)();
                  bindFlipped7(unDriverStateX((function() {
                    var $63 = render61(lchs);
                    return function($64) {
                      return $63((function(v) {
                        return v.selfRef;
                      })($64));
                    };
                  })()))(read($$var2))();
                  bindFlipped7(squashChildInitializers(lchs)(pre2.initializers))(read($$var2))();
                  return $$var2;
                };
              });
            };
          };
        };
        var renderChild = function(lchs) {
          return function(handler3) {
            return function(childrenInRef) {
              return function(childrenOutRef) {
                return unComponentSlot(function(slot) {
                  return function __do3() {
                    var childrenIn = map82(slot.pop)(read(childrenInRef))();
                    var $$var2 = (function() {
                      if (childrenIn instanceof Just) {
                        write(childrenIn.value0.value1)(childrenInRef)();
                        var dsx = read(childrenIn.value0.value0)();
                        unDriverStateX(function(st) {
                          return function __do4() {
                            flip(write)(st.handlerRef)((function() {
                              var $65 = maybe(pure126(unit))(handler3);
                              return function($66) {
                                return $65(slot.output($66));
                              };
                            })())();
                            return handleAff(evalM(render61)(st.selfRef)(st["component"]["eval"](new Receive(slot.input, unit))))();
                          };
                        })(dsx)();
                        return childrenIn.value0.value0;
                      }
                      ;
                      if (childrenIn instanceof Nothing) {
                        return runComponent(lchs)((function() {
                          var $67 = maybe(pure126(unit))(handler3);
                          return function($68) {
                            return $67(slot.output($68));
                          };
                        })())(slot.input)(slot.component)();
                      }
                      ;
                      throw new Error("Failed pattern match at Halogen.Aff.Driver (line 213, column 14 - line 222, column 98): " + [childrenIn.constructor.name]);
                    })();
                    var isDuplicate = map82(function($69) {
                      return isJust(slot.get($69));
                    })(read(childrenOutRef))();
                    when7(isDuplicate)(warn("Halogen: Duplicate slot address was detected during rendering, unexpected results may occur"))();
                    modify_(slot.set($$var2))(childrenOutRef)();
                    return bind81(read($$var2))(renderStateX2(function(v) {
                      if (v instanceof Nothing) {
                        return $$throw("Halogen internal error: child was not initialized in renderChild");
                      }
                      ;
                      if (v instanceof Just) {
                        return pure79(renderSpec2.renderChild(v.value0));
                      }
                      ;
                      throw new Error("Failed pattern match at Halogen.Aff.Driver (line 227, column 37 - line 229, column 50): " + [v.constructor.name]);
                    }))();
                  };
                });
              };
            };
          };
        };
        var render61 = function(lchs) {
          return function($$var2) {
            return function __do3() {
              var v = read($$var2)();
              var shouldProcessHandlers = map82(isNothing)(read(v.pendingHandlers))();
              when7(shouldProcessHandlers)(write(new Just(Nil.value))(v.pendingHandlers))();
              write(empty4)(v.childrenOut)();
              write(v.children)(v.childrenIn)();
              var handler3 = (function() {
                var $70 = queueOrRun(v.pendingHandlers);
                var $71 = evalF(render61)(v.selfRef);
                return function($72) {
                  return $70($$void15($71($72)));
                };
              })();
              var childHandler = (function() {
                var $73 = queueOrRun(v.pendingQueries);
                return function($74) {
                  return $73(handler3(Action.create($74)));
                };
              })();
              var rendering = renderSpec2.render(function($75) {
                return handleAff(handler3($75));
              })(renderChild(lchs)(childHandler)(v.childrenIn)(v.childrenOut))(v.component.render(v.state))(v.rendering)();
              var children3 = read(v.childrenOut)();
              var childrenIn = read(v.childrenIn)();
              foreachSlot2(childrenIn)(function(v1) {
                return function __do4() {
                  var childDS = read(v1)();
                  renderStateX_2(renderSpec2.removeChild)(childDS)();
                  return finalize(lchs)(childDS)();
                };
              })();
              flip(modify_)(v.selfRef)(mapDriverState(function(ds$prime) {
                return {
                  component: ds$prime.component,
                  state: ds$prime.state,
                  refs: ds$prime.refs,
                  childrenIn: ds$prime.childrenIn,
                  childrenOut: ds$prime.childrenOut,
                  selfRef: ds$prime.selfRef,
                  handlerRef: ds$prime.handlerRef,
                  pendingQueries: ds$prime.pendingQueries,
                  pendingOuts: ds$prime.pendingOuts,
                  pendingHandlers: ds$prime.pendingHandlers,
                  fresh: ds$prime.fresh,
                  subscriptions: ds$prime.subscriptions,
                  forks: ds$prime.forks,
                  lifecycleHandlers: ds$prime.lifecycleHandlers,
                  rendering: new Just(rendering),
                  children: children3
                };
              }))();
              return when7(shouldProcessHandlers)(flip(tailRecM3)(unit)(function(v1) {
                return function __do4() {
                  var handlers = read(v.pendingHandlers)();
                  write(new Just(Nil.value))(v.pendingHandlers)();
                  traverse_23((function() {
                    var $76 = traverse_8(fork4);
                    return function($77) {
                      return handleAff($76(reverse2($77)));
                    };
                  })())(handlers)();
                  var mmore = read(v.pendingHandlers)();
                  var $52 = maybe(false)($$null3)(mmore);
                  if ($52) {
                    return voidLeft3(write(Nothing.value)(v.pendingHandlers))(new Done(unit))();
                  }
                  ;
                  return new Loop(unit);
                };
              }))();
            };
          };
        };
        var finalize = function(lchs) {
          return unDriverStateX(function(st) {
            return function __do3() {
              cleanupSubscriptionsAndForks(st)();
              var f = evalM(render61)(st.selfRef)(st["component"]["eval"](new Finalize(unit)));
              modify_(function(handlers) {
                return {
                  initializers: handlers.initializers,
                  finalizers: new Cons(f, handlers.finalizers)
                };
              })(lchs)();
              return foreachSlot2(st.children)(function(v) {
                return function __do4() {
                  var dsx = read(v)();
                  return finalize(lchs)(dsx)();
                };
              })();
            };
          });
        };
        var evalDriver = function(disposed) {
          return function(ref2) {
            return function(q2) {
              return bind136(liftEffect47(read(disposed)))(function(v) {
                if (v) {
                  return pure126(Nothing.value);
                }
                ;
                return evalQ(render61)(ref2)(q2);
              });
            };
          };
        };
        var dispose = function(disposed) {
          return function(lchs) {
            return function(dsx) {
              return handleLifecycle(lchs)(function __do3() {
                var v = read(disposed)();
                if (v) {
                  return unit;
                }
                ;
                write(true)(disposed)();
                finalize(lchs)(dsx)();
                return unDriverStateX(function(v1) {
                  return function __do4() {
                    var v2 = liftEffect120(read(v1.selfRef))();
                    return for_4(v2.rendering)(renderSpec2.dispose)();
                  };
                })(dsx)();
              });
            };
          };
        };
        return bind136(liftEffect47(newLifecycleHandlers))(function(lchs) {
          return bind136(liftEffect47($$new(false)))(function(disposed) {
            return handleLifecycle(lchs)(function __do3() {
              var sio = create();
              var dsx = bindFlipped7(read)(runComponent(lchs)((function() {
                var $78 = notify(sio.listener);
                return function($79) {
                  return liftEffect47($78($79));
                };
              })())(i2)(component55))();
              return unDriverStateX(function(st) {
                return pure79({
                  query: evalDriver(disposed)(st.selfRef),
                  messages: sio.emitter,
                  dispose: dispose(disposed)(lchs)(dsx)
                });
              })(dsx)();
            });
          });
        });
      };
    };
  };

  // output/Halogen.VDom.Driver/index.js
  var $runtime_lazy10 = function(name16, moduleName, init13) {
    var state3 = 0;
    var val;
    return function(lineNumber) {
      if (state3 === 2) return val;
      if (state3 === 1) throw new ReferenceError(name16 + " was needed before it finished initializing (module " + moduleName + ", line " + lineNumber + ")", moduleName, lineNumber);
      state3 = 1;
      val = init13();
      state3 = 2;
      return val;
    };
  };
  var $$void16 = /* @__PURE__ */ $$void(functorEffect);
  var pure80 = /* @__PURE__ */ pure(applicativeEffect);
  var traverse_9 = /* @__PURE__ */ traverse_(applicativeEffect)(foldableMaybe);
  var unwrap9 = /* @__PURE__ */ unwrap();
  var when8 = /* @__PURE__ */ when(applicativeEffect);
  var not3 = /* @__PURE__ */ not(/* @__PURE__ */ heytingAlgebraFunction(/* @__PURE__ */ heytingAlgebraFunction(heytingAlgebraBoolean)));
  var identity17 = /* @__PURE__ */ identity(categoryFn);
  var bind137 = /* @__PURE__ */ bind(bindAff);
  var liftEffect48 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var map83 = /* @__PURE__ */ map(functorEffect);
  var bindFlipped8 = /* @__PURE__ */ bindFlipped(bindEffect);
  var substInParent = function(v) {
    return function(v1) {
      return function(v2) {
        if (v1 instanceof Just && v2 instanceof Just) {
          return $$void16(insertBefore(v)(v1.value0)(v2.value0));
        }
        ;
        if (v1 instanceof Nothing && v2 instanceof Just) {
          return $$void16(appendChild2(v)(v2.value0));
        }
        ;
        return pure80(unit);
      };
    };
  };
  var removeChild3 = function(v) {
    return function __do3() {
      var npn = parentNode2(v.node)();
      return traverse_9(function(pn) {
        return removeChild2(v.node)(pn);
      })(npn)();
    };
  };
  var mkSpec = function(handler3) {
    return function(renderChildRef) {
      return function(document3) {
        var getNode = unRenderStateX(function(v) {
          return v.node;
        });
        var done = function(st) {
          if (st instanceof Just) {
            return halt(st.value0);
          }
          ;
          return unit;
        };
        var buildWidget2 = function(spec) {
          var buildThunk2 = buildThunk(unwrap9)(spec);
          var $lazy_patch = $runtime_lazy10("patch", "Halogen.VDom.Driver", function() {
            return function(st, slot) {
              if (st instanceof Just) {
                if (slot instanceof ComponentSlot) {
                  halt(st.value0);
                  return $lazy_renderComponentSlot(100)(slot.value0);
                }
                ;
                if (slot instanceof ThunkSlot) {
                  var step$prime = step(st.value0, slot.value0);
                  return mkStep(new Step2(extract2(step$prime), new Just(step$prime), $lazy_patch(103), done));
                }
                ;
                throw new Error("Failed pattern match at Halogen.VDom.Driver (line 97, column 22 - line 103, column 79): " + [slot.constructor.name]);
              }
              ;
              return $lazy_render(104)(slot);
            };
          });
          var $lazy_render = $runtime_lazy10("render", "Halogen.VDom.Driver", function() {
            return function(slot) {
              if (slot instanceof ComponentSlot) {
                return $lazy_renderComponentSlot(86)(slot.value0);
              }
              ;
              if (slot instanceof ThunkSlot) {
                var step4 = buildThunk2(slot.value0);
                return mkStep(new Step2(extract2(step4), new Just(step4), $lazy_patch(89), done));
              }
              ;
              throw new Error("Failed pattern match at Halogen.VDom.Driver (line 84, column 7 - line 89, column 75): " + [slot.constructor.name]);
            };
          });
          var $lazy_renderComponentSlot = $runtime_lazy10("renderComponentSlot", "Halogen.VDom.Driver", function() {
            return function(cs) {
              var renderChild = read(renderChildRef)();
              var rsx = renderChild(cs)();
              var node = getNode(rsx);
              return mkStep(new Step2(node, Nothing.value, $lazy_patch(117), done));
            };
          });
          var patch2 = $lazy_patch(91);
          var render61 = $lazy_render(82);
          var renderComponentSlot = $lazy_renderComponentSlot(109);
          return render61;
        };
        var buildAttributes = buildProp(handler3);
        return {
          buildWidget: buildWidget2,
          buildAttributes,
          document: document3
        };
      };
    };
  };
  var renderSpec = function(document3) {
    return function(container) {
      var render61 = function(handler3) {
        return function(child) {
          return function(v) {
            return function(v1) {
              if (v1 instanceof Nothing) {
                return function __do3() {
                  var renderChildRef = $$new(child)();
                  var spec = mkSpec(handler3)(renderChildRef)(document3);
                  var machine = buildVDom(spec)(v);
                  var node = extract2(machine);
                  $$void16(appendChild2(node)(toNode2(container)))();
                  return {
                    machine,
                    node,
                    renderChildRef
                  };
                };
              }
              ;
              if (v1 instanceof Just) {
                return function __do3() {
                  write(child)(v1.value0.renderChildRef)();
                  var parent2 = parentNode2(v1.value0.node)();
                  var nextSib = nextSibling(v1.value0.node)();
                  var machine$prime = step(v1.value0.machine, v);
                  var newNode = extract2(machine$prime);
                  when8(not3(unsafeRefEq)(v1.value0.node)(newNode))(substInParent(newNode)(nextSib)(parent2))();
                  return {
                    machine: machine$prime,
                    node: newNode,
                    renderChildRef: v1.value0.renderChildRef
                  };
                };
              }
              ;
              throw new Error("Failed pattern match at Halogen.VDom.Driver (line 157, column 5 - line 173, column 80): " + [v1.constructor.name]);
            };
          };
        };
      };
      return {
        render: render61,
        renderChild: identity17,
        removeChild: removeChild3,
        dispose: removeChild3
      };
    };
  };
  var runUI2 = function(component55) {
    return function(i2) {
      return function(element3) {
        return bind137(liftEffect48(map83(toDocument)(bindFlipped8(document2)(windowImpl))))(function(document3) {
          return runUI(renderSpec(document3)(element3))(component55)(i2);
        });
      };
    };
  };

  // output/PSD3.Shared.Footer/index.js
  var render49 = /* @__PURE__ */ (function() {
    return footer([classes(["site-footer"])])([hr([classes(["site-footer__rule"])]), div2([classes(["site-footer__content"])])([a([href("#" + routeToPath(Acknowledgements.value)), classes(["site-footer__link"])])([text2("Acknowledgements")])])]);
  })();

  // output/PSD3.Acknowledgements/index.js
  var pure81 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize45 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var render50 = function(v) {
    return div2([classes(["acknowledgements-page"])])([div2([classes(["acknowledgements-content"])])([h1([classes(["acknowledgements-title"])])([text2("Acknowledgements")]), section([classes(["acknowledgements-section"])])([h2_([text2("D3.js and Data Visualization")]), p_([text2("This project would not exist without "), a([href("https://d3js.org/")])([text2("D3.js")]), text2(", created by "), a([href("https://bost.ocks.org/mike/")])([text2("Mike Bostock")]), text2(". D3 revolutionized web-based data visualization and established patterns that have become fundamental to the field. Many of the examples in PS<$>D3 are adapted from Mike's extensive collection of examples and tutorials.")]), p_([text2("Thanks so much to Mike for creating D3, for his clear documentation and examples, and for making the library open source. His work on Observable and continued contributions to visualization continue to inspire.")])]), section([classes(["acknowledgements-section"])])([h2_([text2("Observable Examples (ISC License)")]), p_([text2("Several chart examples in PS<$>D3 are based on visualizations from "), a([href("https://observablehq.com/")])([text2("Observable")]), text2(", licensed under the ISC License. These include:")]), ul_([li_([a([href("https://observablehq.com/@d3/grouped-bar-chart/2")])([text2("Grouped Bar Chart")]), text2(" (Copyright 2018\u20132020 Observable, Inc.)")]), li_([a([href("https://observablehq.com/@d3/multi-line-chart/2")])([text2("Multi-Line Chart")]), text2(" (Copyright 2018\u20132023 Observable, Inc.)")]), li_([a([href("https://observablehq.com/@d3/radial-stacked-bar-chart/2")])([text2("Radial Stacked Bar Chart")]), text2(" (Copyright 2019\u20132023 Observable, Inc., created by Mike Bostock)")])]), p_([text2("These examples have been reimplemented in PureScript to demonstrate the PS<$>D3 library's capabilities while faithfully reproducing the original visualizations' dimensions, scales, and styling.")])]), section([classes(["acknowledgements-section"])])([h2_([text2("Data Visualization Pioneers")]), p_([a([href("https://www.edwardtufte.com/")])([text2("Edward Tufte")]), text2("'s work on information design and visual communication established many of the principles we follow today. His books remain essential reading for anyone interested in effective data presentation.")]), p_([a([href("https://www.gapminder.org/about/hans-rosling/")])([text2("Hans Rosling")]), text2("'s passionate advocacy for data literacy and his innovative animated visualizations (particularly the Gapminder World visualization) showed how data can tell compelling stories. The Wealth & Health example in this project is inspired by his work.")])]), section([classes(["acknowledgements-section"])])([h2_([text2("PureScript and Functional Programming")]), p_([a([href("http://functorial.com/")])([text2("Phil Freeman")]), text2(", for his presentation and example of finally tagless encodings in PureScript which provided the spark for this library's architecture.")]), p_([text2("Ian Ross, for his solution to the polymorphic attribute architecture with typeclasses, so neat.")]), p_([text2("The PureScript Core Team members, past, present and future and the wider PureScript community for building this incredibly nice language and ecosystem. I'd particularly like to single out Mike Solomon, Jordan Martinez, Thomas Honeyman, Fabrizio Ferrai who listened to me drone on about this on conference calls.")])]), section([classes(["acknowledgements-section"])])([h2_([text2("About This Project")]), p_([text2("PS<$>D3 is an experimental exploration of what data visualization APIs might look like in a strongly-typed functional programming language. It aims to preserve D3's flexibility while adding type safety and composability.")]), p_([text2("This project is open source and available on GitHub. Contributions, feedback, and suggestions are always welcome.")])])]), render49]);
  };
  var handleAction44 = function(v) {
    return pure81(unit);
  };
  var component45 = /* @__PURE__ */ (function() {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render50,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction44,
        initialize: new Just(Initialize45.value)
      })
    });
  })();

  // output/D3.Viz.Spago.Draw/index.js
  var ordRecord17 = /* @__PURE__ */ ordRecord();
  var ordRecordCons11 = /* @__PURE__ */ ordRecordCons(ordRecordNil)();
  var ordRecordCons17 = /* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons11({
    reflectSymbol: function() {
      return "y";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "x";
    }
  })(ordNumber);
  var ordNullable8 = /* @__PURE__ */ ordNullable(/* @__PURE__ */ ordRecord17(ordRecordCons17));
  var ordArray3 = /* @__PURE__ */ ordArray(ordInt);
  var ordNullable12 = /* @__PURE__ */ ordNullable(ordNumber);
  var ordRecord18 = /* @__PURE__ */ ordRecord17(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(ordRecordCons17)()({
    reflectSymbol: function() {
      return "vy";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "vx";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "treeXY";
    }
  })(ordNullable8))()({
    reflectSymbol: function() {
      return "treeDepth";
    }
  })(/* @__PURE__ */ ordNullable(ordInt)))()({
    reflectSymbol: function() {
      return "showChildren";
    }
  })(ordBoolean))()({
    reflectSymbol: function() {
      return "r";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "nodetype";
    }
  })(ordNodeType))()({
    reflectSymbol: function() {
      return "name";
    }
  })(ordString))()({
    reflectSymbol: function() {
      return "loc";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "links";
    }
  })(/* @__PURE__ */ ordRecord17(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons(/* @__PURE__ */ ordRecordCons11({
    reflectSymbol: function() {
      return "treeChildren";
    }
  })(ordArray3))()({
    reflectSymbol: function() {
      return "targets";
    }
  })(ordArray3))()({
    reflectSymbol: function() {
      return "sources";
    }
  })(ordArray3))()({
    reflectSymbol: function() {
      return "outPackage";
    }
  })(ordArray3))()({
    reflectSymbol: function() {
      return "inPackage";
    }
  })(ordArray3))()({
    reflectSymbol: function() {
      return "contains";
    }
  })(ordArray3))))()({
    reflectSymbol: function() {
      return "inSim";
    }
  })(ordBoolean))()({
    reflectSymbol: function() {
      return "id";
    }
  })(ordInt))()({
    reflectSymbol: function() {
      return "gridXY";
    }
  })(ordNullable8))()({
    reflectSymbol: function() {
      return "fy";
    }
  })(ordNullable12))()({
    reflectSymbol: function() {
      return "fx";
    }
  })(ordNullable12))()({
    reflectSymbol: function() {
      return "focusY";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "focusX";
    }
  })(ordNumber))()({
    reflectSymbol: function() {
      return "containsMany";
    }
  })(ordBoolean))()({
    reflectSymbol: function() {
      return "containerName";
    }
  })(ordString))()({
    reflectSymbol: function() {
      return "containerID";
    }
  })(ordInt))()({
    reflectSymbol: function() {
      return "connected";
    }
  })(ordBoolean))()({
    reflectSymbol: function() {
      return "cluster";
    }
  })(ordInt));
  var class_49 = /* @__PURE__ */ class_2(toAttrStringString);
  var updateSimulation = function(dictBind) {
    return function(dictMonadEffect) {
      var genericUpdateSimulation3 = genericUpdateSimulation(dictMonadEffect);
      var spagoRenderCallbacks2 = spagoRenderCallbacks(dictMonadEffect.Monad0());
      return function(dictSelectionM) {
        var genericUpdateSimulation1 = genericUpdateSimulation3(dictSelectionM);
        var spagoRenderCallbacks1 = spagoRenderCallbacks2(dictSelectionM);
        return function(dictSimulationM2) {
          var genericUpdateSimulation22 = genericUpdateSimulation1(dictSimulationM2)(ordRecord18)(ordInt)(eqInt)(showInt)(ordIndex_);
          return function(selections) {
            return function(dataConfig) {
              return function(attrs) {
                return genericUpdateSimulation22({
                  nodes: selections.nodes,
                  links: selections.links
                })(Group2.value)(Path3.value)({
                  allNodes: dataConfig.allNodes,
                  allLinks: dataConfig.allLinks,
                  nodeFilter: dataConfig.nodeFilter,
                  linkFilter: dataConfig.linkFilter,
                  nodeInitializers: dataConfig.nodeInitializers,
                  activeForces: new Just(dataConfig.activeForces),
                  config: Nothing.value
                })(function(n) {
                  return n.id;
                })(keyIsID_)(attrs)(spagoRenderCallbacks1);
              };
            };
          };
        };
      };
    };
  };
  var initialize6 = function(dictBind) {
    var bind87 = bind(dictBind);
    return function(dictMonadEffect) {
      var liftEffect51 = liftEffect(dictMonadEffect);
      var pure91 = pure(dictMonadEffect.Monad0().Applicative0());
      return function(dictSimulationM2) {
        return function(dictSelectionM) {
          var select44 = select4(dictSelectionM);
          var appendChild5 = appendChild(dictSelectionM);
          var on14 = on2(dictSelectionM);
          return bind87(liftEffect51(getWindowWidthHeight))(function(v) {
            return bind87(select44("div.svg-container"))(function(root3) {
              return bind87(appendChild5(SVG.value)(svgAttrs(v.value0)(v.value1))(root3))(function(svg2) {
                return bind87(appendChild5(Group2.value)([])(svg2))(function(inner) {
                  return bind87(on14(new Drag2(defaultDrag))(inner))(function() {
                    return bind87(on14(new Zoom2(defaultZoom(new ScaleExtent2(0.1, 4))("g")))(svg2))(function() {
                      return bind87(appendChild5(Group2.value)([class_49("links")])(inner))(function(linksGroup) {
                        return bind87(appendChild5(Group2.value)([class_49("nodes")])(inner))(function(nodesGroup) {
                          return pure91({
                            nodes: nodesGroup,
                            links: linksGroup
                          });
                        });
                      });
                    });
                  });
                });
              });
            });
          });
        };
      };
    };
  };

  // output/PSD3.Data.Tree/index.js
  var Radial = /* @__PURE__ */ (function() {
    function Radial2() {
    }
    ;
    Radial2.value = new Radial2();
    return Radial2;
  })();
  var Horizontal = /* @__PURE__ */ (function() {
    function Horizontal2() {
    }
    ;
    Horizontal2.value = new Horizontal2();
    return Horizontal2;
  })();
  var Vertical = /* @__PURE__ */ (function() {
    function Vertical2() {
    }
    ;
    Vertical2.value = new Vertical2();
    return Vertical2;
  })();
  var eqTreeLayout = {
    eq: function(x47) {
      return function(y48) {
        if (x47 instanceof Radial && y48 instanceof Radial) {
          return true;
        }
        ;
        if (x47 instanceof Horizontal && y48 instanceof Horizontal) {
          return true;
        }
        ;
        if (x47 instanceof Vertical && y48 instanceof Vertical) {
          return true;
        }
        ;
        return false;
      };
    }
  };
  var ordTreeLayout = {
    compare: function(x47) {
      return function(y48) {
        if (x47 instanceof Radial && y48 instanceof Radial) {
          return EQ.value;
        }
        ;
        if (x47 instanceof Radial) {
          return LT.value;
        }
        ;
        if (y48 instanceof Radial) {
          return GT.value;
        }
        ;
        if (x47 instanceof Horizontal && y48 instanceof Horizontal) {
          return EQ.value;
        }
        ;
        if (x47 instanceof Horizontal) {
          return LT.value;
        }
        ;
        if (y48 instanceof Horizontal) {
          return GT.value;
        }
        ;
        if (x47 instanceof Vertical && y48 instanceof Vertical) {
          return EQ.value;
        }
        ;
        throw new Error("Failed pattern match at PSD3.Data.Tree (line 0, column 0 - line 0, column 0): " + [x47.constructor.name, y48.constructor.name]);
      };
    },
    Eq0: function() {
      return eqTreeLayout;
    }
  };

  // output/PSD3.CodeExplorer.Actions/index.js
  var eq17 = /* @__PURE__ */ eq(eqTreeLayout);
  var compare25 = /* @__PURE__ */ compare(ordTreeLayout);
  var NodeClick = /* @__PURE__ */ (function() {
    function NodeClick2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    NodeClick2.create = function(value0) {
      return function(value1) {
        return new NodeClick2(value0, value1);
      };
    };
    return NodeClick2;
  })();
  var TopLevelCSS = /* @__PURE__ */ (function() {
    function TopLevelCSS2(value0) {
      this.value0 = value0;
    }
    ;
    TopLevelCSS2.create = function(value0) {
      return new TopLevelCSS2(value0);
    };
    return TopLevelCSS2;
  })();
  var GraphStyle = /* @__PURE__ */ (function() {
    function GraphStyle2(value0) {
      this.value0 = value0;
    }
    ;
    GraphStyle2.create = function(value0) {
      return new GraphStyle2(value0);
    };
    return GraphStyle2;
  })();
  var EmptyScene = /* @__PURE__ */ (function() {
    function EmptyScene2() {
    }
    ;
    EmptyScene2.value = new EmptyScene2();
    return EmptyScene2;
  })();
  var PackageGrid = /* @__PURE__ */ (function() {
    function PackageGrid2() {
    }
    ;
    PackageGrid2.value = new PackageGrid2();
    return PackageGrid2;
  })();
  var PackageGraph2 = /* @__PURE__ */ (function() {
    function PackageGraph3() {
    }
    ;
    PackageGraph3.value = new PackageGraph3();
    return PackageGraph3;
  })();
  var ModuleTree = /* @__PURE__ */ (function() {
    function ModuleTree2(value0) {
      this.value0 = value0;
    }
    ;
    ModuleTree2.create = function(value0) {
      return new ModuleTree2(value0);
    };
    return ModuleTree2;
  })();
  var LayerSwarm = /* @__PURE__ */ (function() {
    function LayerSwarm2() {
    }
    ;
    LayerSwarm2.value = new LayerSwarm2();
    return LayerSwarm2;
  })();
  var LinkShowFilter = /* @__PURE__ */ (function() {
    function LinkShowFilter2(value0) {
      this.value0 = value0;
    }
    ;
    LinkShowFilter2.create = function(value0) {
      return new LinkShowFilter2(value0);
    };
    return LinkShowFilter2;
  })();
  var LinkForceFilter = /* @__PURE__ */ (function() {
    function LinkForceFilter2(value0) {
      this.value0 = value0;
    }
    ;
    LinkForceFilter2.create = function(value0) {
      return new LinkForceFilter2(value0);
    };
    return LinkForceFilter2;
  })();
  var NodeFilter = /* @__PURE__ */ (function() {
    function NodeFilter2(value0) {
      this.value0 = value0;
    }
    ;
    NodeFilter2.create = function(value0) {
      return new NodeFilter2(value0);
    };
    return NodeFilter2;
  })();
  var Initialize46 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var Finalize4 = /* @__PURE__ */ (function() {
    function Finalize5() {
    }
    ;
    Finalize5.value = new Finalize5();
    return Finalize5;
  })();
  var Scene = /* @__PURE__ */ (function() {
    function Scene2(value0) {
      this.value0 = value0;
    }
    ;
    Scene2.create = function(value0) {
      return new Scene2(value0);
    };
    return Scene2;
  })();
  var ToggleForce = /* @__PURE__ */ (function() {
    function ToggleForce2(value0) {
      this.value0 = value0;
    }
    ;
    ToggleForce2.create = function(value0) {
      return new ToggleForce2(value0);
    };
    return ToggleForce2;
  })();
  var Filter = /* @__PURE__ */ (function() {
    function Filter2(value0) {
      this.value0 = value0;
    }
    ;
    Filter2.create = function(value0) {
      return new Filter2(value0);
    };
    return Filter2;
  })();
  var ChangeStyling = /* @__PURE__ */ (function() {
    function ChangeStyling2(value0) {
      this.value0 = value0;
    }
    ;
    ChangeStyling2.create = function(value0) {
      return new ChangeStyling2(value0);
    };
    return ChangeStyling2;
  })();
  var ChangeSimConfig = /* @__PURE__ */ (function() {
    function ChangeSimConfig2(value0) {
      this.value0 = value0;
    }
    ;
    ChangeSimConfig2.create = function(value0) {
      return new ChangeSimConfig2(value0);
    };
    return ChangeSimConfig2;
  })();
  var ChangeColorBy = /* @__PURE__ */ (function() {
    function ChangeColorBy2(value0) {
      this.value0 = value0;
    }
    ;
    ChangeColorBy2.create = function(value0) {
      return new ChangeColorBy2(value0);
    };
    return ChangeColorBy2;
  })();
  var StopSim = /* @__PURE__ */ (function() {
    function StopSim2() {
    }
    ;
    StopSim2.value = new StopSim2();
    return StopSim2;
  })();
  var StartSim = /* @__PURE__ */ (function() {
    function StartSim2() {
    }
    ;
    StartSim2.value = new StartSim2();
    return StartSim2;
  })();
  var EventFromVizualization = /* @__PURE__ */ (function() {
    function EventFromVizualization2(value0) {
      this.value0 = value0;
    }
    ;
    EventFromVizualization2.create = function(value0) {
      return new EventFromVizualization2(value0);
    };
    return EventFromVizualization2;
  })();
  var ToggleChildrenOfNode = /* @__PURE__ */ (function() {
    function ToggleChildrenOfNode2(value0) {
      this.value0 = value0;
    }
    ;
    ToggleChildrenOfNode2.create = function(value0) {
      return new ToggleChildrenOfNode2(value0);
    };
    return ToggleChildrenOfNode2;
  })();
  var SpotlightNode = /* @__PURE__ */ (function() {
    function SpotlightNode2(value0) {
      this.value0 = value0;
    }
    ;
    SpotlightNode2.create = function(value0) {
      return new SpotlightNode2(value0);
    };
    return SpotlightNode2;
  })();
  var UnToggleChildrenOfNode = /* @__PURE__ */ (function() {
    function UnToggleChildrenOfNode2(value0) {
      this.value0 = value0;
    }
    ;
    UnToggleChildrenOfNode2.create = function(value0) {
      return new UnToggleChildrenOfNode2(value0);
    };
    return UnToggleChildrenOfNode2;
  })();
  var TagHalogen = /* @__PURE__ */ (function() {
    function TagHalogen2() {
    }
    ;
    TagHalogen2.value = new TagHalogen2();
    return TagHalogen2;
  })();
  var ClearTags = /* @__PURE__ */ (function() {
    function ClearTags2() {
    }
    ;
    ClearTags2.value = new ClearTags2();
    return ClearTags2;
  })();
  var DismissWelcome = /* @__PURE__ */ (function() {
    function DismissWelcome2() {
    }
    ;
    DismissWelcome2.value = new DismissWelcome2();
    return DismissWelcome2;
  })();
  var StartReplay = /* @__PURE__ */ (function() {
    function StartReplay2() {
    }
    ;
    StartReplay2.value = new StartReplay2();
    return StartReplay2;
  })();
  var StopReplay = /* @__PURE__ */ (function() {
    function StopReplay2() {
    }
    ;
    StopReplay2.value = new StopReplay2();
    return StopReplay2;
  })();
  var ResetReplay = /* @__PURE__ */ (function() {
    function ResetReplay2() {
    }
    ;
    ResetReplay2.value = new ResetReplay2();
    return ResetReplay2;
  })();
  var ReplayTick = /* @__PURE__ */ (function() {
    function ReplayTick2() {
    }
    ;
    ReplayTick2.value = new ReplayTick2();
    return ReplayTick2;
  })();
  var SetRevelationStep = /* @__PURE__ */ (function() {
    function SetRevelationStep2(value0) {
      this.value0 = value0;
    }
    ;
    SetRevelationStep2.create = function(value0) {
      return new SetRevelationStep2(value0);
    };
    return SetRevelationStep2;
  })();
  var eqScene2 = {
    eq: function(x47) {
      return function(y48) {
        if (x47 instanceof EmptyScene && y48 instanceof EmptyScene) {
          return true;
        }
        ;
        if (x47 instanceof PackageGrid && y48 instanceof PackageGrid) {
          return true;
        }
        ;
        if (x47 instanceof PackageGraph2 && y48 instanceof PackageGraph2) {
          return true;
        }
        ;
        if (x47 instanceof ModuleTree && y48 instanceof ModuleTree) {
          return eq17(x47.value0)(y48.value0);
        }
        ;
        if (x47 instanceof LayerSwarm && y48 instanceof LayerSwarm) {
          return true;
        }
        ;
        return false;
      };
    }
  };
  var ordScene = {
    compare: function(x47) {
      return function(y48) {
        if (x47 instanceof EmptyScene && y48 instanceof EmptyScene) {
          return EQ.value;
        }
        ;
        if (x47 instanceof EmptyScene) {
          return LT.value;
        }
        ;
        if (y48 instanceof EmptyScene) {
          return GT.value;
        }
        ;
        if (x47 instanceof PackageGrid && y48 instanceof PackageGrid) {
          return EQ.value;
        }
        ;
        if (x47 instanceof PackageGrid) {
          return LT.value;
        }
        ;
        if (y48 instanceof PackageGrid) {
          return GT.value;
        }
        ;
        if (x47 instanceof PackageGraph2 && y48 instanceof PackageGraph2) {
          return EQ.value;
        }
        ;
        if (x47 instanceof PackageGraph2) {
          return LT.value;
        }
        ;
        if (y48 instanceof PackageGraph2) {
          return GT.value;
        }
        ;
        if (x47 instanceof ModuleTree && y48 instanceof ModuleTree) {
          return compare25(x47.value0)(y48.value0);
        }
        ;
        if (x47 instanceof ModuleTree) {
          return LT.value;
        }
        ;
        if (y48 instanceof ModuleTree) {
          return GT.value;
        }
        ;
        if (x47 instanceof LayerSwarm && y48 instanceof LayerSwarm) {
          return EQ.value;
        }
        ;
        throw new Error("Failed pattern match at PSD3.CodeExplorer.Actions (line 0, column 0 - line 0, column 0): " + [x47.constructor.name, y48.constructor.name]);
      };
    },
    Eq0: function() {
      return eqScene2;
    }
  };

  // output/PSD3.CodeExplorer.Forces/index.js
  var map84 = /* @__PURE__ */ map(functorMaybe);
  var treePointY = function(d18) {
    return fromMaybe(d18.y)(map84(function(v) {
      return v.y;
    })(toMaybe(d18.treeXY)));
  };
  var treePointX = function(d18) {
    return fromMaybe(d18.x)(map84(function(v) {
      return v.x;
    })(toMaybe(d18.treeXY)));
  };
  var isUnusedModule = function(d18) {
    if (d18.nodetype instanceof IsPackage) {
      return false;
    }
    ;
    if (d18.nodetype instanceof IsModule) {
      return !d18.connected;
    }
    ;
    throw new Error("Failed pattern match at PSD3.CodeExplorer.Forces (line 41, column 20 - line 43, column 34): " + [d18.nodetype.constructor.name]);
  };
  var isTreeParent = function(d18) {
    if (d18.links.treeChildren.length === 0) {
      return false;
    }
    ;
    return true;
  };
  var gridPointY = function(d18) {
    return fromMaybe(d18.y)(map84(function(v) {
      return v.y;
    })(toMaybe(d18.gridXY)));
  };
  var gridPointX = function(d18) {
    return fromMaybe(d18.x)(map84(function(v) {
      return v.x;
    })(toMaybe(d18.gridXY)));
  };
  var collideRadiusBig = function(d18) {
    return d18.r + 10;
  };
  var collideRadius = function(d18) {
    var $31 = d18.id === d18.containerID;
    if ($31) {
      return 10;
    }
    ;
    return d18.r;
  };
  var forceLibrary9 = /* @__PURE__ */ (function() {
    var usedModulesOnly = new Just(new ForceFilter("used modules only", function($32) {
      return isUsedModule($32);
    }));
    var unusedModulesOnly = new Just(new ForceFilter("unused modules only", function($33) {
      return isUnusedModule($33);
    }));
    var treeExceptLeaves = new Just(new ForceFilter("tree parent nodes only", function($34) {
      return isTreeParent($34);
    }));
    var packagesOnly = new Just(new ForceFilter("all packages", function($35) {
      return isPackage($35);
    }));
    var modulesOnly = new Just(new ForceFilter("all modules", function($36) {
      return isModule($36);
    }));
    return initialize(foldableArray)(functorArray)([createForce("center")(new RegularForce(ForceCenter.value))(allNodes)([strengthVal(0.5), xVal(0), yVal(0)]), createForce("x")(new RegularForce(ForceX.value))(allNodes)([strengthVal(0.05), xVal(0)]), createForce("y")(new RegularForce(ForceY.value))(allNodes)([strengthVal(0.07), yVal(0)]), createForce("collide1")(new RegularForce(ForceCollide.value))(allNodes)([strengthVal(1), radiusFn(function(d18) {
      return function(v) {
        return collideRadius(d18);
      };
    })]), createForce("collide2")(new RegularForce(ForceCollide.value))(allNodes)([strengthVal(0.7), radiusFn(function(d18) {
      return function(v) {
        return collideRadiusBig(d18);
      };
    })]), createForce("charge1")(new RegularForce(ForceManyBody.value))(allNodes)([strengthVal(-50), thetaVal(0.9), distanceMinVal(1), distanceMaxVal(infinity)]), createForce("charge2")(new RegularForce(ForceManyBody.value))(allNodes)([strengthVal(-100), thetaVal(0.9), distanceMinVal(1), distanceMaxVal(400)]), createForce("chargetree")(new RegularForce(ForceManyBody.value))(treeExceptLeaves)([strengthVal(-100), thetaVal(0.9), distanceMinVal(1), distanceMaxVal(400)]), createForce("clusterx_M")(new RegularForce(ForceX.value))(modulesOnly)([strengthVal(0.2), xFn(function(d18) {
      return function(v) {
        return gridPointX(d18);
      };
    })]), createForce("clustery_M")(new RegularForce(ForceY.value))(modulesOnly)([strengthVal(0.2), yFn(function(d18) {
      return function(v) {
        return gridPointY(d18);
      };
    })]), createForce("clusterx_P")(new RegularForce(ForceX.value))(packagesOnly)([strengthVal(0.8), xFn(function(d18) {
      return function(v) {
        return gridPointX(d18);
      };
    })]), createForce("clustery_P")(new RegularForce(ForceY.value))(packagesOnly)([strengthVal(0.8), yFn(function(d18) {
      return function(v) {
        return gridPointY(d18);
      };
    })]), createForce("htreeNodesX")(new RegularForce(ForceX.value))(new Just(new ForceFilter("tree only", function($37) {
      return $37.connected;
    })))([strengthVal(0.4), xFn(function(d18) {
      return function(v) {
        return treePointY(d18);
      };
    })]), createForce("htreeNodesY")(new RegularForce(ForceY.value))(new Just(new ForceFilter("tree only", function($38) {
      return $38.connected;
    })))([strengthVal(0.4), yFn(function(d18) {
      return function(v) {
        return treePointX(d18);
      };
    })]), createForce("vtreeNodesX")(new RegularForce(ForceX.value))(new Just(new ForceFilter("tree only", function($39) {
      return $39.connected;
    })))([strengthVal(0.4), xFn(function(d18) {
      return function(v) {
        return treePointX(d18);
      };
    })]), createForce("vtreeNodesY")(new RegularForce(ForceY.value))(new Just(new ForceFilter("tree only", function($40) {
      return $40.connected;
    })))([strengthVal(0.4), yFn(function(d18) {
      return function(v) {
        return treePointY(d18);
      };
    })]), createForce("packageOrbit")(new RegularForce(ForceRadial.value))(packagesOnly)([strengthVal(0.7), xVal(0), yVal(0), radiusVal(1200)]), createForce("unusedOrbit")(new RegularForce(ForceRadial.value))(unusedModulesOnly)([strengthVal(0.8), xVal(0), yVal(0), radiusVal(900)]), createForce("moduleOrbit")(new RegularForce(ForceRadial.value))(usedModulesOnly)([strengthVal(0.8), xVal(0), yVal(0), radiusVal(600)]), createLinkForce(Nothing.value)([strengthVal(0.5), distanceVal(0), numKey(function($41) {
      return toNumber((function(v) {
        return v.id;
      })($41));
    })])]);
  })();

  // output/PSD3.Properties/index.js
  var lmap2 = /* @__PURE__ */ lmap(bifunctorTuple);
  var append124 = /* @__PURE__ */ append(semigroupArray);
  var rmap3 = /* @__PURE__ */ rmap(bifunctorTuple);
  var elem7 = /* @__PURE__ */ elem2(eqString);
  var not4 = /* @__PURE__ */ not(/* @__PURE__ */ heytingAlgebraFunction(heytingAlgebraBoolean));
  var pure82 = /* @__PURE__ */ pure(applicativeArray);
  var map85 = /* @__PURE__ */ map(functorArray);
  var startsWith3 = function(str0) {
    return function(str1) {
      return str0 === take3(length3(str0))(str1);
    };
  };
  var extract3 = /* @__PURE__ */ (function() {
    var f = function(v) {
      return function(v1) {
        if (v1 instanceof Property && v1.value0 === "className") {
          return lmap2(function(v2) {
            return append124(v2)(split(" ")(v1.value1));
          })(v);
        }
        ;
        return rmap3(function(v2) {
          return append124(v2)([v1]);
        })(v);
      };
    };
    return foldl2(f)(new Tuple([], []));
  })();
  var classifySide = function(str2) {
    if (startsWith3("t-")(str2)) {
      return "top";
    }
    ;
    if (startsWith3("r-")(str2)) {
      return "right";
    }
    ;
    if (startsWith3("b-")(str2)) {
      return "bottom";
    }
    ;
    if (startsWith3("l-")(str2)) {
      return "left";
    }
    ;
    if (startsWith3("x-")(str2)) {
      return "horizontal";
    }
    ;
    if (startsWith3("y-")(str2)) {
      return "vertical";
    }
    ;
    if (startsWith3("-")(str2)) {
      return "all";
    }
    ;
    if (otherwise) {
      return "";
    }
    ;
    throw new Error("Failed pattern match at PSD3.Properties (line 103, column 1 - line 105, column 12): " + [str2.constructor.name]);
  };
  var append$prime = function(v) {
    return function(v1) {
      if (v1 === "") {
        return v;
      }
      ;
      return v + ("-" + v1);
    };
  };
  var classifyOverflow = function(str2) {
    if (startsWith3("x-")(str2)) {
      return append$prime("horizontal")(classifyOverflow(drop3(2)(str2)));
    }
    ;
    if (startsWith3("y-")(str2)) {
      return append$prime("vertical")(classifyOverflow(drop3(2)(str2)));
    }
    ;
    if (elem7(str2)(["auto", "hidden", "visible", "scroll"])) {
      return "";
    }
    ;
    if (otherwise) {
      return str2;
    }
    ;
    throw new Error("Failed pattern match at PSD3.Properties (line 116, column 1 - line 118, column 12): " + [str2.constructor.name]);
  };
  var classify = function(str2) {
    if (startsWith3("p")(str2) && not4($$null2)(classifySide(drop3(1)(str2)))) {
      return append$prime("padding")(classifySide(drop3(1)(str2)));
    }
    ;
    if (startsWith3("m")(str2) && not4($$null2)(classifySide(drop3(1)(str2)))) {
      return append$prime("margin")(classifySide(drop3(1)(str2)));
    }
    ;
    if (startsWith3("-m")(str2) && not4($$null2)(classifySide(drop3(2)(str2)))) {
      return append$prime("margin")(classifySide(drop3(2)(str2)));
    }
    ;
    if (startsWith3("min-")(str2)) {
      return append$prime("min")(classify(drop3(4)(str2)));
    }
    ;
    if (startsWith3("max-")(str2)) {
      return append$prime("max")(classify(drop3(4)(str2)));
    }
    ;
    if (startsWith3("w-")(str2)) {
      return "width";
    }
    ;
    if (startsWith3("h-")(str2)) {
      return "height";
    }
    ;
    if (startsWith3("overflow-")(str2) && classifyOverflow(drop3(9)(str2)) !== drop3(9)(str2)) {
      return append$prime("overflow")(classifyOverflow(drop3(9)(str2)));
    }
    ;
    if (otherwise) {
      return str2;
    }
    ;
    throw new Error("Failed pattern match at PSD3.Properties (line 85, column 1 - line 87, column 12): " + [str2.constructor.name]);
  };
  var appendIProps = function(ip) {
    return function(ip$prime) {
      var v = extract3(ip);
      var v1 = extract3(ip$prime);
      var classNames = pure82(classes(map85(ClassName)(nubByEq(function(c) {
        return function(c$prime) {
          return classify(c) === classify(c$prime);
        };
      })(append124(v1.value0)(v.value0)))));
      return append124(v.value1)(append124(v1.value1)(classNames));
    };
  };

  // output/PSD3.Button/index.js
  var map86 = /* @__PURE__ */ map(functorArray);
  var append30 = /* @__PURE__ */ append(semigroupArray);
  var rightClasses = /* @__PURE__ */ map86(ClassName)(["rounded-r"]);
  var leftClasses = /* @__PURE__ */ map86(ClassName)(["mr-px", "rounded-l"]);
  var centerClasses = /* @__PURE__ */ map86(ClassName)(["mr-px"]);
  var buttonSharedClasses = /* @__PURE__ */ map86(ClassName)(["no-outline", "px-4", "py-2", "!active:border-b", "active:border-t", "disabled:opacity-50", "disabled:cursor-default", "!disabled:cursor-pointer"]);
  var buttonPrimaryClasses = /* @__PURE__ */ map86(ClassName)(["bg-blue-88", "border-blue-88", "hover:!disabled:bg-blue-82", "focus:bg-blue-82", "text-white"]);
  var buttonMainClasses = /* @__PURE__ */ append30(buttonSharedClasses)(/* @__PURE__ */ map86(ClassName)(["rounded"]));
  var buttonGroupClasses = /* @__PURE__ */ map86(ClassName)(["flex", "items-center"]);
  var buttonGroupBuilder = function(classes2) {
    return function(iprops) {
      return button(appendIProps([classes(append30(buttonSharedClasses)(classes2))])(iprops));
    };
  };
  var buttonPrimaryCenter = /* @__PURE__ */ buttonGroupBuilder(/* @__PURE__ */ append30(buttonPrimaryClasses)(centerClasses));
  var buttonPrimaryLeft = /* @__PURE__ */ buttonGroupBuilder(/* @__PURE__ */ append30(buttonPrimaryClasses)(leftClasses));
  var buttonPrimaryRight = /* @__PURE__ */ buttonGroupBuilder(/* @__PURE__ */ append30(buttonPrimaryClasses)(rightClasses));
  var buttonGroup = function(iprops) {
    return div2(appendIProps([classes(buttonGroupClasses)])(iprops));
  };
  var buttonGroup_ = /* @__PURE__ */ buttonGroup([]);
  var buttonClasses = /* @__PURE__ */ map86(ClassName)(["bg-grey-50-a20", "border-grey-50-a20", "hover:!disabled:bg-grey-50-a30", "focus:bg-grey-50-a30", "text-black-20"]);
  var buttonLeft = /* @__PURE__ */ buttonGroupBuilder(/* @__PURE__ */ append30(buttonClasses)(leftClasses));
  var buttonRight = /* @__PURE__ */ buttonGroupBuilder(/* @__PURE__ */ append30(buttonClasses)(rightClasses));
  var buttonCenter = /* @__PURE__ */ buttonGroupBuilder(/* @__PURE__ */ append30(buttonClasses)(centerClasses));
  var buttonBuilder = function(classes2) {
    return function(iprops) {
      return button(appendIProps([classes(append30(buttonMainClasses)(classes2))])(iprops));
    };
  };
  var button3 = /* @__PURE__ */ buttonBuilder(buttonClasses);

  // output/PSD3.Component.SimulationState/index.js
  var $$delete8 = /* @__PURE__ */ $$delete4(ordString);
  var member8 = /* @__PURE__ */ member2(ordString);
  var insert15 = /* @__PURE__ */ insert4(ordString);
  var updateScene3 = function(f) {
    return function(state3) {
      return {
        simulation: state3.simulation,
        model: state3.model,
        staging: state3.staging,
        currentScene: state3.currentScene,
        transitionMatrix: state3.transitionMatrix,
        eventListener: state3.eventListener,
        transitionListener: state3.transitionListener,
        tags: state3.tags,
        showWelcome: state3.showWelcome,
        revelationStep: state3.revelationStep,
        maxTreeDepth: state3.maxTreeDepth,
        scene: f(state3.scene)
      };
    };
  };
  var toggleForce2 = function(label5) {
    return updateScene3(function(s) {
      return {
        chooseNodes: s.chooseNodes,
        linksShown: s.linksShown,
        linksActive: s.linksActive,
        cssClass: s.cssClass,
        attributes: s.attributes,
        nodeInitializerFunctions: s.nodeInitializerFunctions,
        transitionConfig: s.transitionConfig,
        activeForces: (function() {
          var $101 = member8(label5)(s.activeForces);
          if ($101) {
            return $$delete8(label5)(s.activeForces);
          }
          ;
          return insert15(label5)(s.activeForces);
        })()
      };
    });
  };
  var tagNodes = function(dictOrd) {
    var alter4 = alter(dictOrd);
    return function(getId) {
      return function(label5) {
        return function(predicate) {
          return function(nodes) {
            return function(state3) {
              var addTag = function(v) {
                return function(v1) {
                  if (v1 instanceof Nothing) {
                    return new Just(singleton10(v));
                  }
                  ;
                  if (v1 instanceof Just) {
                    return new Just(insert15(v)(v1.value0));
                  }
                  ;
                  throw new Error("Failed pattern match at PSD3.Component.SimulationState (line 429, column 5 - line 429, column 65): " + [v.constructor.name, v1.constructor.name]);
                };
              };
              var newTags = foldl2(function(acc) {
                return function(node) {
                  var $105 = predicate(node);
                  if ($105) {
                    return alter4(addTag(label5))(getId(node))(acc);
                  }
                  ;
                  return acc;
                };
              })(state3.tags)(nodes);
              return {
                simulation: state3.simulation,
                model: state3.model,
                staging: state3.staging,
                scene: state3.scene,
                currentScene: state3.currentScene,
                transitionMatrix: state3.transitionMatrix,
                eventListener: state3.eventListener,
                transitionListener: state3.transitionListener,
                showWelcome: state3.showWelcome,
                revelationStep: state3.revelationStep,
                maxTreeDepth: state3.maxTreeDepth,
                tags: newTags
              };
            };
          };
        };
      };
    };
  };
  var setSceneAttributes = function(attrs) {
    return updateScene3(function(s) {
      return {
        chooseNodes: s.chooseNodes,
        linksShown: s.linksShown,
        linksActive: s.linksActive,
        activeForces: s.activeForces,
        cssClass: s.cssClass,
        nodeInitializerFunctions: s.nodeInitializerFunctions,
        transitionConfig: s.transitionConfig,
        attributes: attrs
      };
    });
  };
  var setLinksShown = function(fn) {
    return updateScene3(function(s) {
      return {
        chooseNodes: s.chooseNodes,
        linksActive: s.linksActive,
        activeForces: s.activeForces,
        cssClass: s.cssClass,
        attributes: s.attributes,
        nodeInitializerFunctions: s.nodeInitializerFunctions,
        transitionConfig: s.transitionConfig,
        linksShown: fn
      };
    });
  };
  var setLinksActive = function(fn) {
    return updateScene3(function(s) {
      return {
        chooseNodes: s.chooseNodes,
        linksShown: s.linksShown,
        activeForces: s.activeForces,
        cssClass: s.cssClass,
        attributes: s.attributes,
        nodeInitializerFunctions: s.nodeInitializerFunctions,
        transitionConfig: s.transitionConfig,
        linksActive: fn
      };
    });
  };
  var setCssClass = function(css) {
    return updateScene3(function(s) {
      return {
        chooseNodes: s.chooseNodes,
        linksShown: s.linksShown,
        linksActive: s.linksActive,
        activeForces: s.activeForces,
        attributes: s.attributes,
        nodeInitializerFunctions: s.nodeInitializerFunctions,
        transitionConfig: s.transitionConfig,
        cssClass: css
      };
    });
  };
  var setChooseNodes = function(fn) {
    return updateScene3(function(s) {
      return {
        linksShown: s.linksShown,
        linksActive: s.linksActive,
        activeForces: s.activeForces,
        cssClass: s.cssClass,
        attributes: s.attributes,
        nodeInitializerFunctions: s.nodeInitializerFunctions,
        transitionConfig: s.transitionConfig,
        chooseNodes: fn
      };
    });
  };
  var getStagingNodes = function(state3) {
    return state3.staging.rawdata.nodes;
  };
  var getStagingLinks = function(state3) {
    return state3.staging.rawdata.links;
  };
  var clearAllTags = function(state3) {
    return {
      simulation: state3.simulation,
      model: state3.model,
      staging: state3.staging,
      scene: state3.scene,
      currentScene: state3.currentScene,
      transitionMatrix: state3.transitionMatrix,
      eventListener: state3.eventListener,
      transitionListener: state3.transitionListener,
      showWelcome: state3.showWelcome,
      revelationStep: state3.revelationStep,
      maxTreeDepth: state3.maxTreeDepth,
      tags: empty3
    };
  };
  var applySceneWithTransition = function(dictOrd) {
    var lookup40 = lookup2(ordTuple(dictOrd)(dictOrd));
    return function(targetScene) {
      return function(baseConfig) {
        return function(state3) {
          var transitionSpec = lookup40(new Tuple(state3.currentScene, targetScene))(state3.transitionMatrix);
          var config = {
            activeForces: baseConfig.activeForces,
            attributes: baseConfig.attributes,
            chooseNodes: baseConfig.chooseNodes,
            cssClass: baseConfig.cssClass,
            linksActive: baseConfig.linksActive,
            linksShown: baseConfig.linksShown,
            nodeInitializerFunctions: baseConfig.nodeInitializerFunctions,
            transitionConfig: transitionSpec
          };
          return {
            simulation: state3.simulation,
            model: state3.model,
            staging: state3.staging,
            currentScene: state3.currentScene,
            transitionMatrix: state3.transitionMatrix,
            eventListener: state3.eventListener,
            transitionListener: state3.transitionListener,
            tags: state3.tags,
            showWelcome: state3.showWelcome,
            revelationStep: state3.revelationStep,
            maxTreeDepth: state3.maxTreeDepth,
            scene: config
          };
        };
      };
    };
  };
  var applySceneConfig = function(config) {
    return function(state3) {
      return {
        simulation: state3.simulation,
        model: state3.model,
        staging: state3.staging,
        currentScene: state3.currentScene,
        transitionMatrix: state3.transitionMatrix,
        eventListener: state3.eventListener,
        transitionListener: state3.transitionListener,
        tags: state3.tags,
        showWelcome: state3.showWelcome,
        revelationStep: state3.revelationStep,
        maxTreeDepth: state3.maxTreeDepth,
        scene: config
      };
    };
  };

  // output/PSD3.CodeExplorer.State/index.js
  var tagNodes1 = /* @__PURE__ */ tagNodes(ordInt);
  var fromFoldable54 = /* @__PURE__ */ fromFoldable8(foldableSet)(ordString);
  var _handle4 = /* @__PURE__ */ _handle(strongForget);
  var updateScene4 = updateScene3;
  var toggleForce3 = toggleForce2;
  var tagNodes2 = function(label5) {
    return function(predicate) {
      return function(nodes) {
        return function(state3) {
          return tagNodes1(function(v) {
            return v.id;
          })(label5)(predicate)(nodes)(state3);
        };
      };
    };
  };
  var setSceneAttributes2 = setSceneAttributes;
  var setLinksShown2 = setLinksShown;
  var setLinksActive2 = setLinksActive;
  var setCssClass2 = setCssClass;
  var setChooseNodes2 = setChooseNodes;
  var initialScene = function(forceLibrary10) {
    return {
      chooseNodes: isPackage,
      linksShown: $$const(false),
      linksActive: $$const(false),
      activeForces: fromFoldable54(keys3(forceLibrary10)),
      cssClass: "",
      attributes: clusterSceneAttributes,
      nodeInitializerFunctions: [],
      transitionConfig: Nothing.value
    };
  };
  var getStagingNodes2 = getStagingNodes;
  var getStagingLinks2 = getStagingLinks;
  var getSimulationVariables = function(state3) {
    var handle = view(_handle4)(state3);
    return readSimulationVariables_(handle);
  };
  var getSelections = function(state3) {
    if (state3.staging.selections.nodes instanceof Just && state3.staging.selections.links instanceof Just) {
      return {
        nodes: state3.staging.selections.nodes.value0,
        links: state3.staging.selections.links.value0
      };
    }
    ;
    return unsafeCrashWith("getSelections called before Initialize action! Selections must be initialized first.");
  };
  var getModelNodes = function(state3) {
    if (state3.model instanceof Just) {
      return state3.model.value0.nodes;
    }
    ;
    if (state3.model instanceof Nothing) {
      return [];
    }
    ;
    throw new Error("Failed pattern match at PSD3.CodeExplorer.State (line 205, column 23 - line 207, column 16): " + [state3.model.constructor.name]);
  };
  var getModelLinks = function(state3) {
    if (state3.model instanceof Just) {
      return state3.model.value0.links;
    }
    ;
    if (state3.model instanceof Nothing) {
      return [];
    }
    ;
    throw new Error("Failed pattern match at PSD3.CodeExplorer.State (line 210, column 23 - line 212, column 16): " + [state3.model.constructor.name]);
  };
  var clearAllTags2 = clearAllTags;
  var applySceneWithTransition2 = /* @__PURE__ */ applySceneWithTransition(ordScene);
  var applySceneConfig2 = applySceneConfig;

  // output/PSD3.CodeExplorer.WelcomeOverlay/index.js
  var render51 = function(dismissAction) {
    return div2([classes(["welcome-overlay"])])([div2([classes(["welcome-overlay__backdrop"]), onClick($$const(dismissAction))])([]), div2([classes(["welcome-overlay__content"])])([div2([classes(["welcome-overlay__header"])])([h2([classes(["welcome-overlay__title"])])([text2("Welcome to Code Explorer")]), button([classes(["welcome-overlay__close"]), onClick($$const(dismissAction))])([text2("\xD7")])]), div2([classes(["welcome-overlay__body"])])([p([classes(["welcome-overlay__intro"])])([text2("Explore the PureScript package dependency graph with interactive force-directed layouts.")]), div2([classes(["welcome-overlay__section"])])([h3_([text2("\u{1F3AE} Interactive Controls")]), p_([text2("Try zooming, clicking, and dragging nodes!")]), ul_([li_([text2("Zoom: Scroll wheel or pinch to zoom in/out")]), li_([text2("Pan: Click and drag the background")]), li_([text2("Move nodes: Click and drag individual nodes")])])]), div2([classes(["welcome-overlay__section"])])([h3_([text2("\u25C0 Left Panel: Scene Selection")]), p_([text2("Control what visualization you see:")]), ul_([li_([text2("Package Grid: Cluster view of packages")]), li_([text2("Package Graph: Force-directed package relationships")]), li_([text2("Module Trees: Hierarchical module layouts (horizontal, vertical, radial)")]), li_([text2("Layer Swarm: Modules organized by dependency layers")])])]), div2([classes(["welcome-overlay__section"])])([h3_([text2("\u25B6 Right Panel: Force Controls")]), p_([text2("Activate and deactivate physics forces that govern the layout:")]), ul_([li_([text2("Click force names to toggle them on/off")]), li_([text2("Adjust parameters with sliders")]), li_([text2("Watch the simulation respond in real-time")])])])]), div2([classes(["welcome-overlay__footer"])])([button([classes(["button", "button--primary"]), onClick($$const(dismissAction))])([text2("Got it, let's explore!")])])])]);
  };

  // output/PSD3.Format/index.js
  var map87 = /* @__PURE__ */ map(functorArray);
  var subHeadingClasses = /* @__PURE__ */ map87(ClassName)(["text-xl", "font-medium", "leading-loose", "flex", "items-center", "mb-6"]);
  var subHeading = function(iprops) {
    return function(html2) {
      return h2(appendIProps([classes(subHeadingClasses)])(iprops))(html2);
    };
  };
  var subHeading_ = /* @__PURE__ */ subHeading([]);
  var contentHeadingClasses = /* @__PURE__ */ map87(ClassName)(["mb-6", "text-lg", "font-normal", "leading-loose", "flex", "items-center"]);
  var contentHeading = function(iprops) {
    return h3(appendIProps([classes(contentHeadingClasses)])(iprops));
  };
  var contentHeading_ = /* @__PURE__ */ contentHeading([]);
  var captionClasses = /* @__PURE__ */ map87(ClassName)(["block", "font-light", "mb-6", "text-grey-70", "text-sm", "tracking-wide", "uppercase"]);
  var caption2 = function(iprops) {
    return h4(appendIProps([classes(captionClasses)])(iprops));
  };
  var caption_2 = /* @__PURE__ */ caption2([]);

  // output/PSD3.Shared.ZoomSticker/index.js
  var render52 = /* @__PURE__ */ div2([/* @__PURE__ */ classes(["zoom-sticker"])])([/* @__PURE__ */ span2([/* @__PURE__ */ classes(["zoom-sticker__icon"])])([/* @__PURE__ */ text2("\u{1F50D}")]), /* @__PURE__ */ span2([/* @__PURE__ */ classes(["zoom-sticker__text"])])([/* @__PURE__ */ text2("Try zooming!")])]);

  // output/PSD3.CodeExplorer.HTML/index.js
  var type_21 = /* @__PURE__ */ type_3(isPropInputType);
  var value16 = /* @__PURE__ */ value3(isPropString);
  var show81 = /* @__PURE__ */ show(showNumber);
  var member9 = /* @__PURE__ */ member2(ordString);
  var map88 = /* @__PURE__ */ map(functorArray);
  var toUnfoldable9 = /* @__PURE__ */ toUnfoldable3(unfoldableArray);
  var _forceLibrary3 = /* @__PURE__ */ _forceLibrary(strongForget);
  var show143 = /* @__PURE__ */ show(showInt);
  var max14 = /* @__PURE__ */ max(ordInt);
  var min11 = /* @__PURE__ */ min(ordInt);
  var slider = function(config) {
    var toScale = function(s) {
      return toNumber(fromMaybe(0)(fromString2(s))) / 100;
    };
    return [onValueInput(function($24) {
      return ChangeSimConfig.create(config["var"](toScale($24)));
    }), type_21(InputRange.value), id3(config.id), class_("range-slider scaling-slider"), min4(config.min), max4(config.max), step3(new Step(config.step)), value16(show81(config.value))];
  };
  var renderTableForces = function(state3) {
    var renderForceItem = function(v) {
      var isActive = member9(v.name)(state3.scene.activeForces);
      return div2([classes(["force-item", (function() {
        if (isActive) {
          return "force-active";
        }
        ;
        return "force-inactive";
      })()]), onClick($$const(new ToggleForce(v.name)))])([div2([classes(["force-name"])])([text2(v.name)]), div2([classes(["force-type"])])([text2(showType(v.type))]), div2([classes(["force-filter"])])([text2(showForceFilter(v.filter))])]);
    };
    var forceData = map88(snd)(toUnfoldable9(view(_forceLibrary3)(state3)));
    return div_([h3_([text2("Forces")]), div2([classes(["force-grid"])])(map88(renderForceItem)(forceData))]);
  };
  var renderSimState = function(state3) {
    return div2([classes(["spago-sim-state"])])([caption_2([text2("Simulation state")]), p_([text2("CSS Class: " + state3.scene.cssClass)]), p_([text2("Links: " + show143(length(getStagingLinks2(state3))))]), p_([text2("Nodes: " + show143(length(getStagingNodes2(state3))))])]);
  };
  var isProjectModule = function(node) {
    if (node.nodetype instanceof IsModule) {
      return take3(4)(node.nodetype.value0) === "src/";
    }
    ;
    if (node.nodetype instanceof IsPackage) {
      return true;
    }
    ;
    throw new Error("Failed pattern match at PSD3.CodeExplorer.HTML (line 41, column 24 - line 43, column 22): " + [node.nodetype.constructor.name]);
  };
  var renderSimControls = function(state3) {
    var params = getSimulationVariables(state3);
    return div2([classes(["spago-sim-controls"])])([subHeading_([text2("Scene Selection")]), div2([classes(["control-group"])])([buttonGroup_([buttonPrimaryLeft([onClick($$const(new Scene(PackageGrid.value)))])([text2("Package Grid")]), buttonPrimaryRight([onClick($$const(new Scene(PackageGraph2.value)))])([text2("Package Graph")])])]), div2([classes(["control-group"])])([buttonGroup_([buttonPrimaryLeft([onClick($$const(new Scene(new ModuleTree(Horizontal.value))))])([text2("Horiz. Tree")]), buttonPrimaryCenter([onClick($$const(new Scene(new ModuleTree(Vertical.value))))])([text2("Vert. Tree")]), buttonPrimaryRight([onClick($$const(new Scene(new ModuleTree(Radial.value))))])([text2("Radial Tree")])])]), div2([classes(["control-group"])])([buttonGroup_([buttonPrimaryLeft([onClick($$const(new Scene(LayerSwarm.value)))])([text2("Layer Swarm")])])]), subHeading_([text2("Tree Revelation")]), div2([classes(["control-group"])])([input([type_21(InputRange.value), id3("revelation-slider"), class_("range-slider revelation-slider"), min4(0), max4(toNumber(state3.maxTreeDepth + 1 | 0)), step3(new Step(1)), value16(show143(state3.revelationStep)), disabled2(true)]), caption_2([text2("Depth: " + (show143(state3.revelationStep) + (" / " + show143(state3.maxTreeDepth))))]), buttonGroup_([buttonPrimaryLeft([onClick($$const(new SetRevelationStep(max14(0)(state3.revelationStep - 1 | 0))))])([text2("\u2190 Back")]), buttonPrimaryRight([onClick($$const(new SetRevelationStep(min11(state3.maxTreeDepth + 1 | 0)(state3.revelationStep + 1 | 0))))])([text2("Forward \u2192")])])]), subHeading_([text2("Tagging (Demo)")]), div2([classes(["control-group"])])([buttonGroup_([buttonPrimaryLeft([onClick($$const(TagHalogen.value))])([text2("Tag Halogen")]), buttonPrimaryRight([onClick($$const(ClearTags.value))])([text2("Clear Tags")])])]), subHeading_([text2("Simulation Control")]), div2([classes(["control-group"])])([input(slider({
      "var": Alpha.create,
      id: "alpha-slider",
      min: 0,
      max: 100,
      step: 10,
      value: params.alpha * 100
    })), caption_2([text2("Alpha: " + show81(params.alpha))]), input(slider({
      "var": AlphaTarget.create,
      id: "alphatarget-slider",
      min: 0,
      max: 100,
      step: 10,
      value: params.alphaTarget * 100
    })), caption_2([text2("AlphaTarget: " + show81(params.alphaTarget))])]), div2([classes(["control-group"])])([buttonGroup_([buttonPrimaryLeft([onClick($$const(StopSim.value))])([text2("Stop")]), buttonPrimaryCenter([onClick($$const(new ChangeSimConfig(new AlphaTarget(0.3))))])([text2("Heat")]), buttonPrimaryCenter([onClick($$const(new ChangeSimConfig(new AlphaTarget(0))))])([text2("Cool")]), buttonPrimaryRight([onClick($$const(StartSim.value))])([text2("Start")])])]), subHeading_([text2("Filters")]), div2([classes(["control-group"])])([contentHeading_([text2("Node visibility")]), buttonGroup_([buttonLeft([onClick($$const(new Filter(new NodeFilter(isPackage))))])([text2("Packages")]), buttonCenter([onClick($$const(new Filter(new NodeFilter($$const(true)))))])([text2("All")]), buttonRight([onClick($$const(new Filter(new NodeFilter(isUsedModule))))])([text2("Modules")])])]), div2([classes(["control-group"])])([button3([onClick($$const(new Filter(new NodeFilter(isProjectModule))))])([text2("Only project files")])]), div2([classes(["control-group"])])([contentHeading_([text2("Link Visibility")]), buttonGroup_([buttonLeft([onClick($$const(new Filter(new LinkShowFilter(isM2M_Tree_Link))))])([text2("Tree")]), buttonCenter([onClick($$const(new Filter(new LinkShowFilter(isM2M_Graph_Link))))])([text2("Graph")]), buttonCenter([onClick($$const(new Filter(new LinkShowFilter(isM2P_Link))))])([text2("M2P")]), buttonCenter([onClick($$const(new Filter(new LinkShowFilter(isP2P_Link))))])([text2("P2P")]), buttonRight([onClick($$const(new Filter(new LinkShowFilter($$const(false)))))])([text2("None")])])]), subHeading_([text2("Styling")]), div2([classes(["control-group"])])([buttonGroup_([buttonLeft([onClick($$const(new ChangeStyling(new GraphStyle(clusterSceneAttributes))))])([text2("Cluster")]), buttonCenter([onClick($$const(new ChangeStyling(new GraphStyle(graphSceneAttributes))))])([text2("Graph")]), buttonRight([onClick($$const(new ChangeStyling(new GraphStyle(treeSceneAttributes))))])([text2("Tree")])])]), subHeading_([text2("Color By")]), div2([classes(["control-group"])])([buttonGroup_([buttonLeft([onClick($$const(new ChangeColorBy(ColorByGroup.value)))])([text2("Package")]), buttonCenter([onClick($$const(new ChangeColorBy(ColorByDepth.value)))])([text2("Depth")]), buttonRight([onClick($$const(new ChangeColorBy(ColorBySize.value)))])([text2("Size")])])]), div2([classes(["control-group"])])([contentHeading_([text2("Git Metrics")]), buttonGroup_([buttonLeft([onClick($$const(new ChangeColorBy(ColorByCommits.value)))])([text2("Commits")]), buttonCenter([onClick($$const(new ChangeColorBy(ColorByRecency.value)))])([text2("Recency")]), buttonRight([onClick($$const(new ChangeColorBy(ColorByAge.value)))])([text2("Age")])])]), div2([classes(["control-group"])])([buttonGroup_([buttonLeft([onClick($$const(new ChangeColorBy(ColorByAuthors.value)))])([text2("Authors")]), buttonRight([onClick($$const(new ChangeColorBy(ColorByChurn.value)))])([text2("Churn")])])]), subHeading_([text2("Git Replay")]), div2([classes(["control-group"])])([buttonGroup_([buttonLeft([onClick($$const(StartReplay.value))])([text2("Play")]), buttonCenter([onClick($$const(StopReplay.value))])([text2("Stop")]), buttonRight([onClick($$const(ResetReplay.value))])([text2("Reset")])])])]);
  };
  var render53 = function(state3) {
    return div2([classes(["fullscreen-container", "spago-fullscreen", "page-with-watermark"])])([renderHeader2(CodeExplorer.value), div2([classes(["floating-panel", "floating-panel--top-left", "floating-panel--small", "spago-controls-panel", "editorial"])])([h2([classes(["floating-panel__title", "spago-controls__title"])])([text2("Controls")]), renderSimControls(state3), renderSimState(state3)]), div2([classes(["floating-panel", "floating-panel--top-right", "floating-panel--large", "spago-forces-panel", "editorial"])])([renderTableForces(state3)]), div2([classes(["svg-container", "fullscreen-viz", "spago-viz-container", state3.scene.cssClass])])([render52]), (function() {
      if (state3.showWelcome) {
        return render51(DismissWelcome.value);
      }
      ;
      return text2("");
    })()]);
  };

  // output/PSD3.CodeExplorer.Scenes/index.js
  var fromFoldable55 = /* @__PURE__ */ fromFoldable8(foldableArray)(ordString);
  var verticalTreeScene = /* @__PURE__ */ (function() {
    return {
      chooseNodes: isUsedModule,
      linksShown: isM2M_Tree_Link,
      linksActive: $$const(false),
      cssClass: "tree vertical",
      attributes: treeSceneAttributes,
      activeForces: fromFoldable55(["vtreeNodesX", "vtreeNodesY", "charge1", "collide2", linksForceName_]),
      nodeInitializerFunctions: [unpinAllNodes, treeNodesToTreeXY_V],
      transitionConfig: new Just(smoothTransition)
    };
  })();
  var treeRevelationScene = function(step4) {
    return function(maxDepth) {
      if (step4 === 0) {
        return {
          chooseNodes: allNodes2,
          linksShown: $$const(false),
          linksActive: $$const(false),
          cssClass: "revelation step-0",
          attributes: clusterSceneAttributes,
          activeForces: fromFoldable55(["clusterx_M", "clustery_M", "collide2"]),
          nodeInitializerFunctions: [unpinAllNodes, pinnedPackagesToPhyllotaxis, moduleNodesToContainerXY],
          transitionConfig: new Just(smoothTransition)
        };
      }
      ;
      if (step4 > maxDepth) {
        return {
          chooseNodes: allNodes2,
          linksShown: isM2M_Tree_Link,
          linksActive: $$const(true),
          cssClass: "revelation final",
          attributes: clusterSceneAttributes,
          activeForces: fromFoldable55(["center", "collide2", "charge2", linksForceName_]),
          nodeInitializerFunctions: [unpinAllNodes, packageNodesToGridXY, moduleNodesToContainerXY, treeNodesToTreeXY_R],
          transitionConfig: new Just(smoothTransition)
        };
      }
      ;
      if (otherwise) {
        return {
          chooseNodes: allNodes2,
          linksShown: isM2M_Tree_Link,
          linksActive: $$const(false),
          cssClass: "revelation",
          attributes: clusterSceneAttributes,
          activeForces: empty8,
          nodeInitializerFunctions: [nodesToRevelationXY(step4)],
          transitionConfig: Nothing.value
        };
      }
      ;
      throw new Error("Failed pattern match at PSD3.CodeExplorer.Scenes (line 126, column 1 - line 126, column 49): " + [step4.constructor.name, maxDepth.constructor.name]);
    };
  };
  var radialTreeScene = /* @__PURE__ */ (function() {
    return {
      chooseNodes: isUsedModule,
      linksShown: isM2M_Tree_Link,
      linksActive: $$const(true),
      cssClass: "tree radial",
      attributes: treeSceneAttributes,
      activeForces: fromFoldable55(["center", "collide2", "chargetree", "charge2", linksForceName_]),
      nodeInitializerFunctions: [unpinAllNodes, treeNodesToTreeXY_R, fixNamedNodeTo("PSD3.Main")({
        x: 0,
        y: 0
      })],
      transitionConfig: new Just(smoothTransition)
    };
  })();
  var packageGridScene = /* @__PURE__ */ (function() {
    return {
      chooseNodes: allNodes2,
      linksShown: isM2P_Link,
      linksActive: $$const(true),
      cssClass: "cluster",
      attributes: clusterSceneAttributes,
      activeForces: fromFoldable55(["clusterx_P", "clustery_P", "clusterx_M", "clustery_M", "collide2", linksForceName_]),
      nodeInitializerFunctions: [unpinAllNodes, packageNodesToGridXY, moduleNodesToContainerXY],
      transitionConfig: new Just(smoothTransition)
    };
  })();
  var packageGraphScene = /* @__PURE__ */ (function() {
    return {
      chooseNodes: isPackage,
      linksShown: isP2P_Link,
      linksActive: $$const(true),
      cssClass: "graph",
      attributes: graphSceneAttributes,
      activeForces: fromFoldable55(["center", "collide2", "charge2", "packageOrbit", linksForceName_]),
      nodeInitializerFunctions: [unpinAllNodes, packagesNodesToPhyllotaxis, fixNamedNodeTo("my-project")({
        x: 0,
        y: 0
      })],
      transitionConfig: Nothing.value
    };
  })();
  var layerSwarmScene = /* @__PURE__ */ (function() {
    return {
      chooseNodes: isUsedModule,
      linksShown: isM2M_Tree_Link,
      linksActive: $$const(true),
      cssClass: "tree",
      attributes: treeSceneAttributes,
      activeForces: fromFoldable55(["htreeNodesX", "collide1", "y", linksForceName_]),
      nodeInitializerFunctions: [treeNodesToSwarmStart],
      transitionConfig: Nothing.value
    };
  })();
  var horizontalTreeScene = /* @__PURE__ */ (function() {
    return {
      chooseNodes: isUsedModule,
      linksShown: isM2M_Tree_Link,
      linksActive: $$const(false),
      cssClass: "tree horizontal",
      attributes: treeSceneAttributes,
      activeForces: fromFoldable55(["htreeNodesX", "htreeNodesY", "charge1", "collide2", linksForceName_]),
      nodeInitializerFunctions: [unpinAllNodes, treeNodesToTreeXY_H],
      transitionConfig: new Just(smoothTransition)
    };
  })();

  // output/PSD3v2.Simulation.SceneTransition/foreign.js
  function applyUpdateBehavior(selection2, behaviorType, transition2, targetById) {
    switch (behaviorType) {
      case "TransitionMove":
        selection2.transition(transition2).attr("transform", function(d18) {
          const target7 = targetById.get(d18.id);
          if (target7 && target7.fx !== null && target7.fx !== void 0 && target7.fy !== null && target7.fy !== void 0) {
            return `translate(${target7.fx},${target7.fy})`;
          } else if (target7) {
            return `translate(${target7.x || 0},${target7.y || 0})`;
          }
          return `translate(${d18.x || 0},${d18.y || 0})`;
        });
        break;
      case "InstantMove":
        selection2.attr("transform", function(d18) {
          const target7 = targetById.get(d18.id);
          if (target7 && target7.fx !== null && target7.fx !== void 0 && target7.fy !== null && target7.fy !== void 0) {
            return `translate(${target7.fx},${target7.fy})`;
          } else if (target7) {
            return `translate(${target7.x || 0},${target7.y || 0})`;
          }
          return `translate(${d18.x || 0},${d18.y || 0})`;
        });
        break;
      default:
        console.warn(`Unknown update behavior: ${behaviorType}`);
    }
  }
  var executeSceneTransition_Impl = (spec) => (nodeSelector) => (linkSelector) => (targetNodes) => (onComplete) => () => {
    const nodeSelection2 = d3.selectAll(nodeSelector);
    const linkSelection = d3.selectAll(linkSelector);
    if (nodeSelection2.empty()) {
      onComplete();
      return;
    }
    const t = d3.transition().duration(spec.duration);
    const targetById = new Map(targetNodes.map((n) => [n.id, n]));
    applyUpdateBehavior(nodeSelection2, spec.updateNodes, t, targetById);
    linkSelection.transition(t).attr("d", function(d18) {
      const source2 = targetById.get(d18.source.id);
      const target7 = targetById.get(d18.target.id);
      const x116 = source2 ? source2.fx !== null && source2.fx !== void 0 ? source2.fx : source2.x : d18.source.x;
      const y116 = source2 ? source2.fy !== null && source2.fy !== void 0 ? source2.fy : source2.y : d18.source.y;
      const x217 = target7 ? target7.fx !== null && target7.fx !== void 0 ? target7.fx : target7.x : d18.target.x;
      const y217 = target7 ? target7.fy !== null && target7.fy !== void 0 ? target7.fy : target7.y : d18.target.y;
      return `M${x116},${y116}L${x217},${y217}`;
    });
    let completed = false;
    const lastNodeIndex = nodeSelection2.size() - 1;
    nodeSelection2.transition(t).on("end", function(d18, i2) {
      if (!completed && i2 === lastNodeIndex) {
        completed = true;
        nodeSelection2.each(function(d19) {
          const target7 = targetById.get(d19.id);
          if (target7) {
            d19.x = target7.x || 0;
            d19.y = target7.y || 0;
            if (spec.pinAfterTransition) {
              if (target7.fx !== null && target7.fx !== void 0) {
                d19.fx = target7.fx;
              } else {
                d19.fx = d19.x;
              }
              if (target7.fy !== null && target7.fy !== void 0) {
                d19.fy = target7.fy;
              } else {
                d19.fy = d19.y;
              }
            } else {
              if (target7.fx !== null && target7.fx !== void 0) {
                d19.fx = target7.fx;
              }
              if (target7.fy !== null && target7.fy !== void 0) {
                d19.fy = target7.fy;
              }
            }
          }
        });
        onComplete();
      }
    });
  };

  // output/PSD3v2.Simulation.SceneTransition/index.js
  var encodeTransitionSpec = function(spec) {
    return {
      duration: spec.duration,
      enterNodes: encodeEnterBehavior(spec.enterNodes),
      exitNodes: encodeExitBehavior(spec.exitNodes),
      updateNodes: encodeUpdateBehavior(spec.updateNodes),
      pinAfterTransition: spec.pinAfterTransition
    };
  };
  var executeSceneTransition_ = function(spec) {
    return executeSceneTransition_Impl(encodeTransitionSpec(spec));
  };

  // output/PSD3v2.Simulation.RunSimulation/index.js
  var discard75 = /* @__PURE__ */ discard(discardUnit);
  var foldl18 = /* @__PURE__ */ foldl(foldableArray);
  var runSimulation = function(dictMonadAff) {
    var discard215 = discard75(dictMonadAff.MonadEffect0().Monad0().Bind1());
    var liftAff3 = liftAff(dictMonadAff);
    return function(dictSimulationM2) {
      var SimulationM1 = dictSimulationM2.SimulationM1();
      var stop5 = stop(SimulationM1);
      var start13 = start3(SimulationM1);
      return function(_selections) {
        return function(scene) {
          return function(allNodes3) {
            return function(allLinks) {
              return function(updateSimFn) {
                return discard215(stop5)(function() {
                  var targetNodes = foldl18(function(nodes) {
                    return function(fn) {
                      return fn(nodes);
                    };
                  })(allNodes3)(scene.nodeInitializerFunctions);
                  return discard215(updateSimFn({
                    allNodes: allNodes3,
                    allLinks,
                    scene
                  }))(function() {
                    if (scene.transitionConfig instanceof Nothing) {
                      return start13;
                    }
                    ;
                    if (scene.transitionConfig instanceof Just) {
                      return discard215(liftAff3(makeAff(function(callback) {
                        return function __do3() {
                          executeSceneTransition_(scene.transitionConfig.value0)("g.nodes > g")("g.links > path")(targetNodes)(callback(new Right(unit)))();
                          return nonCanceler;
                        };
                      })))(function() {
                        return start13;
                      });
                    }
                    ;
                    throw new Error("Failed pattern match at PSD3v2.Simulation.RunSimulation (line 91, column 3 - line 109, column 12): " + [scene.transitionConfig.constructor.name]);
                  });
                });
              };
            };
          };
        };
      };
    };
  };
  var runSimulationFromState = function(dictMonadAff) {
    var bind87 = bind(dictMonadAff.MonadEffect0().Monad0().Bind1());
    var runSimulation1 = runSimulation(dictMonadAff);
    return function(dictSimulationM2) {
      var runSimulation22 = runSimulation1(dictSimulationM2);
      return function(dictMonadState) {
        var get26 = get(dictMonadState);
        return function(getSelections2) {
          return function(getScene) {
            return function(getNodes) {
              return function(getLinks) {
                return function(enhanceAttrs) {
                  return function(updateSimFn) {
                    return bind87(get26)(function(state3) {
                      var selections = getSelections2(state3);
                      var scene = getScene(state3);
                      var enhancedAttrs = enhanceAttrs(scene.attributes)(state3);
                      var allModelNodes = getNodes(state3);
                      var allModelLinks = getLinks(state3);
                      return runSimulation22(selections)(scene)(allModelNodes)(allModelLinks)(function(v) {
                        return updateSimFn(selections)({
                          allNodes: v.allNodes,
                          allLinks: v.allLinks,
                          nodeFilter: v.scene.chooseNodes,
                          linkFilter: new Just(v.scene.linksShown),
                          nodeInitializers: v.scene.nodeInitializerFunctions,
                          activeForces: v.scene.activeForces,
                          linksWithForce: v.scene.linksActive
                        })(enhancedAttrs);
                      });
                    });
                  };
                };
              };
            };
          };
        };
      };
    };
  };

  // output/PSD3.CodeExplorer/index.js
  var runSimulationFromState2 = /* @__PURE__ */ runSimulationFromState(monadAffD3v2SimM)(simulationM2D3v2Selection)(monadStateRecordD3v2SimM);
  var updateSimulation2 = /* @__PURE__ */ updateSimulation(bindD3v2SimM)(monadEffectD3v2SimM)(selectionMD3v2Selection_D1)(simulationM2D3v2Selection);
  var bind82 = /* @__PURE__ */ bind(bindHalogenM);
  var discard76 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var modify_22 = /* @__PURE__ */ modify_2(monadStateHalogenM);
  var maximum15 = /* @__PURE__ */ maximum(ordInt)(foldableArray);
  var get24 = /* @__PURE__ */ get(monadStateHalogenM);
  var initialize7 = /* @__PURE__ */ initialize6(bindD3v2SimM)(monadEffectD3v2SimM)(simulationM2D3v2Selection)(selectionMD3v2Selection_D1);
  var $$void17 = /* @__PURE__ */ $$void(functorHalogenM);
  var pure83 = /* @__PURE__ */ pure(applicativeHalogenM);
  var stop4 = /* @__PURE__ */ stop(simulationMD3v2Selection_);
  var start12 = /* @__PURE__ */ start3(simulationMD3v2Selection_);
  var runSimulation2 = function(dictMonadAff) {
    var bind139 = bind(dictMonadAff.MonadEffect0().Monad0().Bind1());
    var liftAff3 = liftAff(dictMonadAff);
    return function(dictMonadState) {
      return bind139(get(dictMonadState))(function(state3) {
        return liftAff3(evalD3v2SimM(state3)(runSimulationFromState2(getSelections)(function(v) {
          return v.scene;
        })(getModelNodes)(getModelLinks)(function(attrs) {
          return function(st) {
            return {
              circles: attrs.circles,
              labels: attrs.labels,
              tagMap: new Just(st.tags),
              nodeClick: (function() {
                if (st.eventListener instanceof Just) {
                  return new Just(function(node) {
                    return notify(st.eventListener.value0)(new EventFromVizualization(new NodeClick(node.nodetype, node.id)));
                  });
                }
                ;
                if (st.eventListener instanceof Nothing) {
                  return Nothing.value;
                }
                ;
                throw new Error("Failed pattern match at PSD3.CodeExplorer (line 457, column 23 - line 460, column 31): " + [st.eventListener.constructor.name]);
              })()
            };
          };
        })(updateSimulation2)));
      });
    };
  };
  var handleAction45 = function(dictMonadAff) {
    var monadAffHalogenM2 = monadAffHalogenM(dictMonadAff);
    var liftAff3 = liftAff(monadAffHalogenM2);
    var liftEffect51 = liftEffect(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    var runSimulation1 = runSimulation2(monadAffHalogenM2)(monadStateHalogenM);
    return function(v) {
      if (v instanceof Initialize46) {
        return bind82(liftAff3(readModelData))(function(v1) {
          return discard76(modify_22(function(v2) {
            var $71 = {};
            for (var $72 in v2) {
              if ({}.hasOwnProperty.call(v2, $72)) {
                $71[$72] = v2[$72];
              }
              ;
            }
            ;
            $71.model = v1;
            return $71;
          }))(function() {
            var maxDepth = (function() {
              if (v1 instanceof Nothing) {
                return 0;
              }
              ;
              if (v1 instanceof Just) {
                var depths = mapMaybe(function(n) {
                  return toMaybe(n.treeDepth);
                })(v1.value0.nodes);
                return fromMaybe(0)(maximum15(depths));
              }
              ;
              throw new Error("Failed pattern match at PSD3.CodeExplorer (line 169, column 20 - line 173, column 44): " + [v1.constructor.name]);
            })();
            return discard76(modify_22(function(v2) {
              var $76 = {};
              for (var $77 in v2) {
                if ({}.hasOwnProperty.call(v2, $77)) {
                  $76[$77] = v2[$77];
                }
                ;
              }
              ;
              $76.maxTreeDepth = maxDepth;
              return $76;
            }))(function() {
              return discard76(liftEffect51(loadGitMetrics_))(function() {
                return discard76(liftEffect51(loadTimeline_))(function() {
                  return bind82(get24)(function(state3) {
                    return bind82(liftAff3(evalD3v2SimM(state3)(initialize7)))(function(openSelections) {
                      return discard76(modify_22(function(s) {
                        var $82 = {};
                        for (var $83 in s) {
                          if ({}.hasOwnProperty.call(s, $83)) {
                            $82[$83] = s[$83];
                          }
                          ;
                        }
                        ;
                        $82.staging = (function() {
                          var $79 = {};
                          for (var $80 in s.staging) {
                            if ({}.hasOwnProperty.call(s.staging, $80)) {
                              $79[$80] = s["staging"][$80];
                            }
                            ;
                          }
                          ;
                          $79.selections = {
                            nodes: new Just(openSelections.nodes),
                            links: new Just(openSelections.links)
                          };
                          return $79;
                        })();
                        return $82;
                      }))(function() {
                        return bind82(liftEffect51(create))(function(v2) {
                          return discard76($$void17(subscribe2(v2.emitter)))(function() {
                            return discard76(modify_22(function(v3) {
                              var $86 = {};
                              for (var $87 in v3) {
                                if ({}.hasOwnProperty.call(v3, $87)) {
                                  $86[$87] = v3[$87];
                                }
                                ;
                              }
                              ;
                              $86.eventListener = new Just(v2.listener);
                              return $86;
                            }))(function() {
                              return bind82(liftEffect51(create))(function(v3) {
                                return discard76($$void17(subscribe2(v3.emitter)))(function() {
                                  return discard76(modify_22(function(v4) {
                                    var $90 = {};
                                    for (var $91 in v4) {
                                      if ({}.hasOwnProperty.call(v4, $91)) {
                                        $90[$91] = v4[$91];
                                      }
                                      ;
                                    }
                                    ;
                                    $90.transitionListener = new Just(v3.listener);
                                    return $90;
                                  }))(function() {
                                    return bind82(get24)(function(state$prime) {
                                      var sceneConfig = treeRevelationScene(0)(state$prime.maxTreeDepth);
                                      return discard76(modify_22(applySceneConfig2(sceneConfig)))(function() {
                                        return runSimulation1;
                                      });
                                    });
                                  });
                                });
                              });
                            });
                          });
                        });
                      });
                    });
                  });
                });
              });
            });
          });
        });
      }
      ;
      if (v instanceof Finalize4) {
        return pure83(unit);
      }
      ;
      if (v instanceof EventFromVizualization) {
        if (v.value0.value0 instanceof IsPackage) {
          return handleAction45(dictMonadAff)(new ToggleChildrenOfNode(v.value0.value1));
        }
        ;
        if (v.value0.value0 instanceof IsModule) {
          return handleAction45(dictMonadAff)(new SpotlightNode(v.value0.value1));
        }
        ;
        throw new Error("Failed pattern match at PSD3.CodeExplorer (line 215, column 5 - line 217, column 68): " + [v.value0.constructor.name]);
      }
      ;
      if (v instanceof ToggleChildrenOfNode) {
        return discard76(modify_22(setChooseNodes2(isPackageOrVisibleModule(v.value0))))(function() {
          return runSimulation1;
        });
      }
      ;
      if (v instanceof UnToggleChildrenOfNode) {
        return discard76(modify_22(setChooseNodes2(isPackage)))(function() {
          return runSimulation1;
        });
      }
      ;
      if (v instanceof SpotlightNode) {
        return bind82(get24)(function(state3) {
          return liftAff3(evalD3v2SimM(state3)(stop4));
        });
      }
      ;
      if (v instanceof Scene && v.value0 instanceof EmptyScene) {
        return pure83(unit);
      }
      ;
      if (v instanceof Scene && v.value0 instanceof PackageGrid) {
        return discard76(modify_22(applySceneWithTransition2(PackageGrid.value)(packageGridScene)))(function() {
          return discard76(runSimulation1)(function() {
            return modify_22(function(v1) {
              var $109 = {};
              for (var $110 in v1) {
                if ({}.hasOwnProperty.call(v1, $110)) {
                  $109[$110] = v1[$110];
                }
                ;
              }
              ;
              $109.currentScene = PackageGrid.value;
              return $109;
            });
          });
        });
      }
      ;
      if (v instanceof Scene && v.value0 instanceof PackageGraph2) {
        return discard76(modify_22(applySceneWithTransition2(PackageGraph2.value)(packageGraphScene)))(function() {
          return discard76(runSimulation1)(function() {
            return modify_22(function(v1) {
              var $113 = {};
              for (var $114 in v1) {
                if ({}.hasOwnProperty.call(v1, $114)) {
                  $113[$114] = v1[$114];
                }
                ;
              }
              ;
              $113.currentScene = PackageGraph2.value;
              return $113;
            });
          });
        });
      }
      ;
      if (v instanceof Scene && v.value0 instanceof LayerSwarm) {
        return discard76(modify_22(applySceneWithTransition2(LayerSwarm.value)(layerSwarmScene)))(function() {
          return discard76(runSimulation1)(function() {
            return modify_22(function(v1) {
              var $117 = {};
              for (var $118 in v1) {
                if ({}.hasOwnProperty.call(v1, $118)) {
                  $117[$118] = v1[$118];
                }
                ;
              }
              ;
              $117.currentScene = LayerSwarm.value;
              return $117;
            });
          });
        });
      }
      ;
      if (v instanceof Scene && (v.value0 instanceof ModuleTree && v.value0.value0 instanceof Radial)) {
        return discard76(modify_22(applySceneWithTransition2(new ModuleTree(Radial.value))(radialTreeScene)))(function() {
          return discard76(runSimulation1)(function() {
            return modify_22(function(v1) {
              var $121 = {};
              for (var $122 in v1) {
                if ({}.hasOwnProperty.call(v1, $122)) {
                  $121[$122] = v1[$122];
                }
                ;
              }
              ;
              $121.currentScene = new ModuleTree(Radial.value);
              return $121;
            });
          });
        });
      }
      ;
      if (v instanceof Scene && (v.value0 instanceof ModuleTree && v.value0.value0 instanceof Horizontal)) {
        return discard76(modify_22(applySceneWithTransition2(new ModuleTree(Horizontal.value))(horizontalTreeScene)))(function() {
          return discard76(runSimulation1)(function() {
            return modify_22(function(v1) {
              var $126 = {};
              for (var $127 in v1) {
                if ({}.hasOwnProperty.call(v1, $127)) {
                  $126[$127] = v1[$127];
                }
                ;
              }
              ;
              $126.currentScene = new ModuleTree(Horizontal.value);
              return $126;
            });
          });
        });
      }
      ;
      if (v instanceof Scene && (v.value0 instanceof ModuleTree && v.value0.value0 instanceof Vertical)) {
        return discard76(modify_22(applySceneWithTransition2(new ModuleTree(Vertical.value))(verticalTreeScene)))(function() {
          return discard76(runSimulation1)(function() {
            return modify_22(function(v1) {
              var $131 = {};
              for (var $132 in v1) {
                if ({}.hasOwnProperty.call(v1, $132)) {
                  $131[$132] = v1[$132];
                }
                ;
              }
              ;
              $131.currentScene = new ModuleTree(Vertical.value);
              return $131;
            });
          });
        });
      }
      ;
      if (v instanceof ToggleForce) {
        return discard76(modify_22(toggleForce3(v.value0)))(function() {
          return discard76(modify_22(updateScene4(function(s) {
            return {
              chooseNodes: s.chooseNodes,
              linksShown: s.linksShown,
              linksActive: s.linksActive,
              activeForces: s.activeForces,
              cssClass: s.cssClass,
              attributes: s.attributes,
              nodeInitializerFunctions: s.nodeInitializerFunctions,
              transitionConfig: Nothing.value
            };
          })))(function() {
            return runSimulation1;
          });
        });
      }
      ;
      if (v instanceof Filter && v.value0 instanceof LinkShowFilter) {
        return discard76(modify_22(setLinksShown2(v.value0.value0)))(function() {
          return runSimulation1;
        });
      }
      ;
      if (v instanceof Filter && v.value0 instanceof LinkForceFilter) {
        return discard76(modify_22(setLinksActive2(v.value0.value0)))(function() {
          return runSimulation1;
        });
      }
      ;
      if (v instanceof Filter && v.value0 instanceof NodeFilter) {
        return discard76(modify_22(setChooseNodes2(v.value0.value0)))(function() {
          return runSimulation1;
        });
      }
      ;
      if (v instanceof ChangeStyling && v.value0 instanceof TopLevelCSS) {
        return modify_22(setCssClass2(v.value0.value0));
      }
      ;
      if (v instanceof ChangeStyling && v.value0 instanceof GraphStyle) {
        return discard76(modify_22(setSceneAttributes2(v.value0.value0)))(function() {
          return runSimulation1;
        });
      }
      ;
      if (v instanceof ChangeSimConfig) {
        return pure83(unit);
      }
      ;
      if (v instanceof StartSim) {
        return bind82(get24)(function(state3) {
          return liftAff3(evalD3v2SimM(state3)(start12));
        });
      }
      ;
      if (v instanceof StopSim) {
        return bind82(get24)(function(state3) {
          return liftAff3(evalD3v2SimM(state3)(stop4));
        });
      }
      ;
      if (v instanceof TagHalogen) {
        return bind82(get24)(function(state3) {
          var isHalogenPackage = function(n) {
            if (n.nodetype instanceof IsPackage) {
              return contains("halogen")(toLower(n.name));
            }
            ;
            return false;
          };
          var allNodes3 = getModelNodes(state3);
          return discard76(modify_22(tagNodes2("halogen")(isHalogenPackage)(allNodes3)))(function() {
            return runSimulation1;
          });
        });
      }
      ;
      if (v instanceof ClearTags) {
        return discard76(modify_22(clearAllTags2))(function() {
          return runSimulation1;
        });
      }
      ;
      if (v instanceof DismissWelcome) {
        return modify_22(function(v1) {
          var $150 = {};
          for (var $151 in v1) {
            if ({}.hasOwnProperty.call(v1, $151)) {
              $150[$151] = v1[$151];
            }
            ;
          }
          ;
          $150.showWelcome = false;
          return $150;
        });
      }
      ;
      if (v instanceof ChangeColorBy) {
        return discard76(modify_22(setSceneAttributes2(sceneAttributesWithColorBy(v.value0))))(function() {
          return runSimulation1;
        });
      }
      ;
      if (v instanceof StartReplay) {
        return discard76(modify_22(setSceneAttributes2(sceneAttributesWithColorBy(ColorByReplay.value))))(function() {
          return bind82(liftEffect51(create))(function(v1) {
            return discard76($$void17(subscribe2(v1.emitter)))(function() {
              return discard76(liftEffect51(setUpdateCallback_(notify(v1.listener)(ReplayTick.value))))(function() {
                return discard76(liftEffect51(startReplay_))(function() {
                  return runSimulation1;
                });
              });
            });
          });
        });
      }
      ;
      if (v instanceof StopReplay) {
        return liftEffect51(stopReplay_);
      }
      ;
      if (v instanceof ResetReplay) {
        return discard76(liftEffect51(resetReplay_))(function() {
          return runSimulation1;
        });
      }
      ;
      if (v instanceof ReplayTick) {
        return runSimulation1;
      }
      ;
      if (v instanceof SetRevelationStep) {
        return bind82(get24)(function(state3) {
          return discard76(modify_22(function(v1) {
            var $157 = {};
            for (var $158 in v1) {
              if ({}.hasOwnProperty.call(v1, $158)) {
                $157[$158] = v1[$158];
              }
              ;
            }
            ;
            $157.revelationStep = v.value0;
            return $157;
          }))(function() {
            var sceneConfig = treeRevelationScene(v.value0)(state3.maxTreeDepth);
            return discard76(modify_22(applySceneConfig2(sceneConfig)))(function() {
              return runSimulation1;
            });
          });
        });
      }
      ;
      throw new Error("Failed pattern match at PSD3.CodeExplorer (line 161, column 16 - line 370, column 18): " + [v.constructor.name]);
    };
  };
  var defaultTransitionMatrix = /* @__PURE__ */ (function() {
    return fromFoldable6(ordTuple(ordScene)(ordScene))(foldableArray)([new Tuple(new Tuple(PackageGrid.value, PackageGraph2.value), smoothTransition), new Tuple(new Tuple(PackageGraph2.value, PackageGrid.value), smoothTransition), new Tuple(new Tuple(PackageGrid.value, LayerSwarm.value), smoothTransition), new Tuple(new Tuple(LayerSwarm.value, PackageGrid.value), smoothTransition), new Tuple(new Tuple(PackageGraph2.value, LayerSwarm.value), smoothTransition), new Tuple(new Tuple(LayerSwarm.value, PackageGraph2.value), smoothTransition), new Tuple(new Tuple(PackageGrid.value, new ModuleTree(Radial.value)), smoothTransitionPinned), new Tuple(new Tuple(PackageGrid.value, new ModuleTree(Horizontal.value)), smoothTransitionPinned), new Tuple(new Tuple(PackageGrid.value, new ModuleTree(Vertical.value)), smoothTransitionPinned), new Tuple(new Tuple(PackageGraph2.value, new ModuleTree(Radial.value)), smoothTransitionPinned), new Tuple(new Tuple(PackageGraph2.value, new ModuleTree(Horizontal.value)), smoothTransitionPinned), new Tuple(new Tuple(PackageGraph2.value, new ModuleTree(Vertical.value)), smoothTransitionPinned), new Tuple(new Tuple(LayerSwarm.value, new ModuleTree(Radial.value)), smoothTransitionPinned), new Tuple(new Tuple(LayerSwarm.value, new ModuleTree(Horizontal.value)), smoothTransitionPinned), new Tuple(new Tuple(LayerSwarm.value, new ModuleTree(Vertical.value)), smoothTransitionPinned), new Tuple(new Tuple(new ModuleTree(Radial.value), PackageGrid.value), smoothTransition), new Tuple(new Tuple(new ModuleTree(Radial.value), PackageGraph2.value), smoothTransition), new Tuple(new Tuple(new ModuleTree(Radial.value), LayerSwarm.value), smoothTransition), new Tuple(new Tuple(new ModuleTree(Horizontal.value), PackageGrid.value), smoothTransition), new Tuple(new Tuple(new ModuleTree(Horizontal.value), PackageGraph2.value), smoothTransition), new Tuple(new Tuple(new ModuleTree(Horizontal.value), LayerSwarm.value), smoothTransition), new Tuple(new Tuple(new ModuleTree(Vertical.value), PackageGrid.value), smoothTransition), new Tuple(new Tuple(new ModuleTree(Vertical.value), PackageGraph2.value), smoothTransition), new Tuple(new Tuple(new ModuleTree(Vertical.value), LayerSwarm.value), smoothTransition), new Tuple(new Tuple(new ModuleTree(Radial.value), new ModuleTree(Horizontal.value)), smoothTransitionPinned), new Tuple(new Tuple(new ModuleTree(Radial.value), new ModuleTree(Vertical.value)), smoothTransitionPinned), new Tuple(new Tuple(new ModuleTree(Horizontal.value), new ModuleTree(Radial.value)), smoothTransitionPinned), new Tuple(new Tuple(new ModuleTree(Horizontal.value), new ModuleTree(Vertical.value)), smoothTransitionPinned), new Tuple(new Tuple(new ModuleTree(Vertical.value), new ModuleTree(Radial.value)), smoothTransitionPinned), new Tuple(new Tuple(new ModuleTree(Vertical.value), new ModuleTree(Horizontal.value)), smoothTransitionPinned)]);
  })();
  var component46 = function(dictMonadAff) {
    var initialState4 = {
      model: Nothing.value,
      staging: {
        selections: {
          nodes: Nothing.value,
          links: Nothing.value
        },
        linksWithForce: $$const(true),
        rawdata: {
          nodes: [],
          links: []
        }
      },
      simulation: initialSimulationState(forceLibrary9),
      scene: initialScene(forceLibrary9),
      currentScene: EmptyScene.value,
      transitionMatrix: defaultTransitionMatrix,
      eventListener: Nothing.value,
      transitionListener: Nothing.value,
      tags: empty3,
      showWelcome: true,
      revelationStep: 0,
      maxTreeDepth: 0
    };
    return mkComponent({
      initialState: $$const(initialState4),
      render: render53,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        handleAction: handleAction45(dictMonadAff),
        initialize: new Just(Initialize46.value),
        finalize: new Just(Finalize4.value)
      })
    });
  };

  // output/PSD3.Home/index.js
  var pure84 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize47 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var renderTutorialLink = function(title4) {
    return function(description) {
      return function(path2) {
        return a([href("#" + path2), classes(["home-tutorial-card"])])([h3([classes(["home-tutorial-card-title"])])([text2(title4)]), p([classes(["home-tutorial-card-description"])])([text2(description)])]);
      };
    };
  };
  var renderExampleCategory = function(categoryName) {
    return function(examples) {
      return div2([classes(["home-gallery-category"])])([h3([classes(["home-gallery-category-title"])])([text2(categoryName)]), div2([classes(["home-examples-grid"])])(examples)]);
    };
  };
  var renderExampleCard2 = function(title4) {
    return function(description) {
      return function(thumbnail) {
        return function(route) {
          return a([href("#" + routeToPath(route)), classes(["home-example-card"])])([div2([classes(["home-example-thumbnail"])])([img([src2(thumbnail), alt4(title4), classes(["home-example-thumbnail-img"])])]), div2([classes(["home-example-content"])])([h3([classes(["home-example-title"])])([text2(title4)]), p([classes(["home-example-description"])])([text2(description)])])]);
        };
      };
    };
  };
  var handleAction46 = function(v) {
    return pure84(unit);
  };
  var getBookmarkImage = function(v) {
    if (v === "Getting Started") {
      return "assets/bookmark-images/getting-started.jpeg";
    }
    ;
    if (v === "How-to Guides") {
      return "assets/bookmark-images/howto.jpeg";
    }
    ;
    if (v === "API Reference") {
      return "assets/bookmark-images/reference.jpeg";
    }
    ;
    if (v === "Understanding") {
      return "assets/bookmark-images/understanding.jpeg";
    }
    ;
    return "assets/bookmark-images/howto.jpeg";
  };
  var renderDocBox = function(title4) {
    return function(description) {
      return function(path2) {
        return a([href("#" + path2), classes(["home-doc-box"])])([div2([classes(["home-doc-box__image-container"])])([img([src2(getBookmarkImage(title4)), alt4(""), classes(["home-doc-box__image"])])]), div2([classes(["home-doc-box__content"])])([h3([classes(["home-doc-box-title"])])([text2(title4)]), p([classes(["home-doc-box-description"])])([text2(description)])])]);
      };
    };
  };
  var render54 = function(v) {
    return div2([classes(["home-page"])])([render5({
      logoSize: Large.value,
      quadrant: NoQuadrant.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), section([id3("hero"), classes(["home-hero"])])([div2([classes(["home-hero-content"])])([h1([classes(["home-hero-title"])])([text2("Type-safe, composable, maintainable, interactive data visualisation with PureScript and D3.js")]), div2([classes(["home-hero-image"])])([img([src2("assets/example-thumbnails/code-explorer.png"), alt4("Interactive code explorer"), classes(["home-hero-img"])]), p([classes(["home-hero-caption"])])([text2("Explore the "), a([href("#" + routeToPath(CodeExplorer.value)), classes(["home-hero-link"])])([text2("interactive code explorer")])])])])]), section([id3("docs"), classes(["home-docs"])])([h2([classes(["home-section-title"])])([text2("Documentation")]), div2([classes(["home-docs-grid"])])([renderDocBox("Getting Started")("Installation, setup, and your first visualization")(routeToPath(GettingStarted.value)), renderDocBox("How-to Guides")("Step-by-step instructions for specific visualizations")(routeToPath(HowtoIndex.value)), renderDocBox("API Reference")("Pursuit-style documentation of the library with type signatures")(routeToPath(Reference.value)), renderDocBox("Understanding")("Conceptual overview of the project")(routeToPath(Understanding.value))])]), section([id3("tutorials"), classes(["home-tutorials"])])([h2([classes(["home-section-title"])])([text2("Take the Tour")]), p([classes(["home-section-description"])])([text2("A progressive tour of the library's capabilities, from basic visualizations to advanced techniques:")]), div2([classes(["home-tutorials-grid"])])([renderTutorialLink("1. Foundations")("Three circles, nested data, bar charts - the building blocks of visualization")(routeToPath(TourFoundations.value)), renderTutorialLink("2. Typical Charts")("Grouped bars, multi-line, radial stacked - production-ready visualizations")(routeToPath(TourProfessional.value)), renderTutorialLink("3. Data Flow")("Chord and Sankey diagrams for relationships and flows")(routeToPath(TourFlow.value)), renderTutorialLink("4. Hierarchies")("Trees, dendrograms, treemaps, circle packing - all hierarchy layouts")(routeToPath(TourHierarchies.value)), renderTutorialLink("5. Motion & Transitions")("Animations, General Update Pattern, force-directed graphs")(routeToPath(TourMotion.value)), renderTutorialLink("5b. Wealth & Health")("Animated bubble chart - Hans Rosling's famous visualization")(routeToPath(TourWealthHealth.value)), renderTutorialLink("6. Alternative Interpreters")("Mermaid diagrams, code generation - the power of Finally Tagless")(routeToPath(TourInterpreters.value)), renderTutorialLink("7. FP For The Win")("Maps, Sets, contravariant functors - functional programming superpowers")(routeToPath(TourFPFTW.value)), renderTutorialLink("8. Showcase")("Flagship demonstrations combining multiple techniques")(routeToPath(TourShowcase.value))])]), section([id3("examples"), classes(["home-examples"])])([h2([classes(["home-section-title"])])([text2("Examples Gallery")]), p([classes(["home-section-description"])])([text2("Browse all TreeAPI examples organized by category, from basic data joins to advanced simulations.")]), renderExampleCategory("Basic Examples")([renderExampleCard2("Three Little Circles")("Data join basics - bind data to DOM elements")("assets/example-thumbnails/three-little-circles.png")(new Example("three-little-circles")), renderExampleCard2("Circles Transition")("Animated transitions with easing and delays")("assets/example-thumbnails/three-little-circles.png")(new Example("three-circles-transition")), renderExampleCard2("Simple Tree")("Basic nesting with named selections")("assets/example-thumbnails/simple-tree.png")(new Example("simple-tree")), renderExampleCard2("Nested Elements")("Multi-level nesting (Group \u2192 Circle + Text)")("assets/example-thumbnails/nested-elements.png")(new Example("nested-elements")), renderExampleCard2("Three Little Dimensions")("Nested data joins (2D array \u2192 table)")("assets/example-thumbnails/nested-data.png")(new Example("three-little-dimensions"))]), renderExampleCategory("Chart Examples")([renderExampleCard2("Bar Chart")("Data-driven bars with scaling")("assets/example-thumbnails/simple-bar-chart.png")(new Example("bar-chart")), renderExampleCard2("Scatter Plot")("Points positioned by data coordinates")("assets/example-thumbnails/anscombes-quartet.png")(new Example("scatter-plot")), renderExampleCard2("Line Chart")("Path element generated from data")("assets/example-thumbnails/simple-line-chart.png")(new Example("line-chart")), renderExampleCard2("Grouped Bar Chart")("Nested joins with multiple series")("assets/example-thumbnails/grouped-bar-chart.png")(new Example("grouped-bar-chart"))]), renderExampleCategory("Hierarchies & Simulations")([renderExampleCard2("Tree Layout")("Hierarchical node-link diagram (pure PureScript)")("assets/example-thumbnails/tree-purescript.png")(new Example("simple-hierarchy")), renderExampleCard2("Les Mis\xE9rables Network")("Force-directed graph with simulation")("assets/example-thumbnails/les-miserables.png")(new Example("lesmis-force"))]), renderExampleCategory("Advanced Examples")([renderExampleCard2("Animated Tree \u2194 Cluster")("Smooth transitions between pure PureScript layouts")("assets/example-thumbnails/tree-purescript.png")(AnimatedTreeCluster.value), renderExampleCard2("Les Mis\xE9rables GUP")("Force layout + dynamic layouts with General Update Pattern")("assets/example-thumbnails/les-miserables-gup.png")(LesMisGUPTree.value), renderExampleCard2("Module Graph")("Visualize this codebase's own module dependencies")("assets/example-thumbnails/module-graph.png")(ModuleGraph.value)]), renderExampleCategory("Alternative Interpreters")([renderExampleCard2("Mermaid Tree Visualizer")("Visualize Tree API structure as Mermaid diagrams")("assets/example-thumbnails/mermaid-diagram.png")(MermaidTreeDemo.value)])]), render49]);
  };
  var component47 = /* @__PURE__ */ (function() {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render54,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction46,
        initialize: new Just(Initialize47.value)
      })
    });
  })();

  // output/PSD3.HowTo.HowtoIndex/index.js
  var pure85 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize48 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var renderHowtoCard = function(route) {
    return function(title4) {
      return function(description) {
        return a([classes(["howto-card"]), href("#" + routeToPath(route))])([h3([classes(["howto-card__title"])])([text2(title4)]), p([classes(["howto-card__description"])])([text2(description)])]);
      };
    };
  };
  var render55 = function(v) {
    return div2([classes(["docs-page", "howto-wiki"])])([render5({
      logoSize: Large.value,
      quadrant: QuadHowTo.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), section([classes(["docs-hero"])])([div2([classes(["docs-hero-content"])])([h1([classes(["docs-hero-title"])])([text2("How-to Guides")]), p([classes(["docs-hero-description"])])([text2("Practical guides for accomplishing specific tasks with PureScript D3. Each topic includes bullet points of what will be covered.")])])]), section([classes(["docs-section"])])([h2([classes(["docs-section-title"])])([text2("Core Techniques")]), div2([classes(["howto-card-grid"])])([renderHowtoCard(HowtoTransitions.value)("Creating Animated Transitions")("Smooth, animated transitions between visualization states."), renderHowtoCard(HowtoEvents.value)("Responding to User Events")("Click, hover, drag, and zoom interactions."), renderHowtoCard(HowtoTooltips.value)("Adding Tooltips")("Informative tooltips that appear on hover.")])]), section([classes(["docs-section"])])([h2([classes(["docs-section-title"])])([text2("Data & Scales")]), div2([classes(["howto-card-grid"])])([renderHowtoCard(HowtoLoadingData.value)("Loading External Data")("Fetch and parse JSON/CSV with Affjax."), renderHowtoCard(HowtoAxesScales.value)("Creating Axes and Scales")("Color interpolation and D3 scale/axis FFI.")])]), section([classes(["docs-section"])])([h2([classes(["docs-section-title"])])([text2("Layouts")]), div2([classes(["howto-card-grid"])])([renderHowtoCard(HowtoForceGraphs.value)("Building Force-Directed Graphs")("SimulationM for interactive network visualizations."), renderHowtoCard(HowtoHierarchical.value)("Working with Hierarchical Data")("Tree, cluster, and treemap layouts."), renderHowtoCard(HowtoTreeAPI.value)("Using the TreeAPI")("Declarative trees with multiple interpreters.")])]), section([classes(["docs-section"])])([h2([classes(["docs-section-title"])])([text2("Development")]), div2([classes(["howto-card-grid"])])([renderHowtoCard(HowtoDebugging.value)("Debugging Visualizations")("Console logging, DevTools, Mermaid diagrams."), renderHowtoCard(HowtoPerformance.value)("Performance Optimization")("DOM optimization, tick efficiency, CSS transitions.")])])]);
  };
  var handleAction47 = function(v) {
    return pure85(unit);
  };
  var component48 = /* @__PURE__ */ (function() {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render55,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction47,
        initialize: new Just(Initialize48.value)
      })
    });
  })();

  // output/PSD3.Reference.Reference/index.js
  var pure86 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize49 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var renderApiCard = function(title4) {
    return function(description) {
      return a([classes(["howto-card"]), href("api/index.html"), target2("_blank")])([h3([classes(["howto-card__title"])])([text2(title4)]), p([classes(["howto-card__description"])])([text2(description)])]);
    };
  };
  var render56 = function(v) {
    return div2([classes(["docs-page", "reference-index"])])([render5({
      logoSize: Large.value,
      quadrant: QuadReference.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), section([classes(["docs-hero"])])([div2([classes(["docs-hero-content"])])([h1([classes(["docs-hero-title"])])([text2("API Reference")]), p([classes(["docs-hero-description"])])([text2("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Comprehensive documentation for all PSD3 modules, types, and functions.")])])]), section([classes(["docs-section"])])([h2([classes(["docs-section-title"])])([text2("Browse Documentation")]), div2([classes(["howto-card-grid"])])([renderApiCard("Core Selection API")("Lorem ipsum dolor sit amet, consectetur adipiscing elit. SelectionM monad and phantom type system."), renderApiCard("Simulation & Forces")("Sed do eiusmod tempor incididunt ut labore. Force-directed layouts and physics configuration."), renderApiCard("TreeAPI & Declarative")("Ut enim ad minim veniam, quis nostrud exercitation. Declarative tree structures and interpreters."), renderApiCard("Data Utilities")("Duis aute irure dolor in reprehenderit in voluptate. Hierarchical data, scales, and transformations.")])])]);
  };
  var handleAction48 = function(v) {
    return pure86(unit);
  };
  var component49 = /* @__PURE__ */ (function() {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render56,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction48,
        initialize: new Just(Initialize49.value)
      })
    });
  })();

  // output/PSD3.Tutorial.GettingStarted/index.js
  var triggerMermaidRendering7 = /* @__PURE__ */ triggerMermaidRendering(/* @__PURE__ */ monadEffectHalogenM(monadEffectAff));
  var Initialize50 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var wizardWorkflowDiagram = "\nflowchart TD\n    Start([Start Wizard]) --> Choice{Choose Method}\n\n    Choice -->|Web| WebWizard[Web-based Wizard]\n    Choice -->|CLI| CLIWizard[CLI Wizard]\n\n    WebWizard --> WebOptions{Select Options}\n    WebOptions --> Dataset[Choose Dataset<br/>\u2022 Anscombe's Quartet<br/>\u2022 Scatter Plot<br/>\u2022 Sine Wave]\n    Dataset --> WebPreview[Preview Files]\n    WebPreview --> WebDownload[Download .zip]\n\n    CLIWizard --> CLIRun[Run: node scripts/init-psd3-viz.js]\n    CLIRun --> CLIOptions{Configure}\n    CLIOptions --> VizName[Enter Visualization Name]\n    VizName --> VizType[Select Type<br/>\u2022 Static<br/>\u2022 Interactive]\n    VizType --> DataChoice[Choose Data<br/>\u2022 Example<br/>\u2022 Custom JSON]\n    DataChoice --> CLIGenerate[Generate Files]\n\n    WebDownload --> Extract[Extract Files]\n    CLIGenerate --> Build[Build & Run]\n    Extract --> Build\n    Build --> Success([Visualization Ready!])\n\n    style Start fill:#f5e6d3,stroke:#8b7355,stroke-width:2px\n    style Success fill:#d4c4b0,stroke:#8b7355,stroke-width:2px\n    style WebWizard fill:#e8dcc6,stroke:#8b7355,stroke-width:2px\n    style CLIWizard fill:#e8dcc6,stroke:#8b7355,stroke-width:2px\n";
  var render57 = function(v) {
    return div2([classes(["docs-page"])])([render5({
      logoSize: Large.value,
      quadrant: QuadGettingStarted.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), section([classes(["docs-hero"])])([div2([classes(["docs-hero-content"])])([h1([classes(["docs-hero-title"])])([text2("Getting Started")]), p([classes(["docs-hero-description"])])([text2("To get a feel for writing with this DSL we provide a command-line wizard bundled with the repo, a web-based wizard that you can run right here and you can also find instructions here to write your own visualizations from scratch.")])])]), section([classes(["tutorial-section", "tutorial-intro"])])([h1([classes(["tutorial-title"])])([text2("Getting Started with PS<$>D3")]), p_([text2("Welcome! This guide will help you install PSD3, set up your first project, and create your first data visualization using our scaffold wizard. By the end, you'll have a working visualization that you can view in your browser.")]), div2([classes(["tutorial-callout"])])([h3_([text2("\u{1F680} Try the Interactive Wizard")]), p_([text2("Want to skip the command line? Use our interactive web wizard to generate a complete visualization project right in your browser:")]), p_([a([href("#/wizard"), classes(["tutorial-button tutorial-button--primary"])])([text2("Launch Interactive Wizard \u2192")])])])]), section([classes(["tutorial-section"]), id3("installation")])([h2([classes(["tutorial-section-title"])])([text2("Installation")]), p_([text2("Before we begin, ensure you have the following installed on your system:")]), h3([id3("prerequisites")])([text2("Prerequisites")]), ul_([li_([text2("Node.js (version 18 or higher)")]), li_([text2("npm or yarn package manager")]), li_([text2("PureScript compiler (purs)")]), li_([text2("Spago (PureScript package manager and build tool)")])]), p_([text2("If you don't have PureScript and Spago installed, you can install them globally:")]), pre_([code_([text2("npm install -g purescript spago")])])]), section([classes(["tutorial-section"]), id3("setup")])([h2([classes(["tutorial-section-title"])])([text2("Project Setup")]), p_([text2("Clone the PSD3 repository which includes the visualization wizard:")]), pre_([code_([text2("# Clone the PSD3 repository\ngit clone https://github.com/afcondon/PureScript-Tagless-D3.git\ncd PureScript-Tagless-D3\n\n# Install dependencies\nnpm install\nspago build")])]), p_([text2("The wizard is located in ")]), code_([text2("scripts/init-psd3-viz.js")]), text2(" and will generate all the files you need to get started.")]), section([classes(["tutorial-section"]), id3("wizard")])([h2([classes(["tutorial-section-title"])])([text2("Using the Wizard")]), p_([text2("PSD3 provides two ways to generate a visualization scaffold:")]), div2([classes(["diagram-container"])])([mermaidDiagram(wizardWorkflowDiagram)(new Just("wizard-workflow-diagram"))]), h3_([text2("Option 1: Interactive Web Wizard (Recommended)")]), p_([text2("The easiest way to get started is with our "), a([href("#/wizard")])([text2("interactive web wizard")]), text2(". It provides:")]), ul_([li_([text2("Choose from pre-configured example datasets (Anscombe's Quartet, scatter plots, sine waves, etc.)")]), li_([text2("Educational tips and explanations at each step")]), li_([text2("Preview generated files before downloading")]), li_([text2("Download as a .zip file or copy to clipboard")])]), p_([a([href("#/wizard"), classes(["tutorial-button tutorial-button--primary"])])([text2("Launch Interactive Wizard \u2192")])]), h3_([text2("Option 2: Command-Line Wizard")]), p_([text2("If you prefer working from the command line, use the CLI wizard. Run it from the project root:")]), pre_([code_([text2("node scripts/init-psd3-viz.js")])]), p_([text2("You'll be prompted for:")]), ul_([li_([strong_([text2("Visualization module name")]), text2(" - e.g., "), code_([text2("MyFirstChart")])]), li_([strong_([text2("Data record fields")]), text2(" - e.g., "), code_([text2("x:Number,y:Number,label:String")])]), li_([strong_([text2("Output directory")]), text2(" - default: "), code_([text2("src/viz/YourModuleName")])]), li_([strong_([text2("Generate Main.purs?")]), text2(" - Entry point for standalone viewing (y/n, default: y)")]), li_([strong_([text2("Generate index.html?")]), text2(" - (y/n, default: y)")])]), h3_([text2("Example Session")]), pre_([code_([text2("Visualization module name: ParabolaChart\nData record fields: x:Number,y:Number\nOutput directory: src/viz/ParabolaChart\nGenerate Main.purs? (y/n): y\nGenerate index.html? (y/n): y\n\n\u2713 Created src/viz/ParabolaChart/Unsafe.purs\n\u2713 Created src/viz/ParabolaChart/Model.purs\n\u2713 Created src/viz/ParabolaChart/Draw.purs\n\u2713 Created src/viz/ParabolaChart/Main.purs\n\u2713 Created src/viz/ParabolaChart/index.html\n\u2713 Created src/viz/ParabolaChart/README.md")])]), h3_([text2("Build and View")]), p_([text2("Now build and bundle your visualization:")]), pre_([code_([text2("# Compile the PureScript\nspago build\n\n# Bundle for the browser\nspago bundle --module Main --outfile src/viz/ParabolaChart/bundle.js\n\n# Open in browser\nopen src/viz/ParabolaChart/index.html")])])]), section([classes(["tutorial-section"]), id3("understanding")])([h2([classes(["tutorial-section-title"])])([text2("Understanding the Generated Code")]), p_([text2("The wizard generates several files following PSD3 best practices:")]), ul_([li_([strong_([text2("Unsafe.purs")]), text2(" - Contains type coercion functions that bridge PureScript's type system with D3's untyped JavaScript data")]), li_([strong_([text2("Model.purs")]), text2(" - Defines your data type and provides a placeholder for example data")]), li_([strong_([text2("Draw.purs")]), text2(" - Contains the visualization code with the "), code_([text2("datum_")]), text2(" accessor pattern")]), li_([strong_([text2("index.html")]), text2(" - Pre-configured HTML with D3.js loaded from CDN and the correct "), code_([text2("#chart")]), text2(" div")]), li_([strong_([text2("README.md")]), text2(" - Quick reference specific to your visualization")])]), h3([id3("datum-pattern")])([text2("The Datum_ Pattern")]), p_([text2("D3.js works with untyped JavaScript data, but PureScript is strongly typed. The "), code_([text2("datum_")]), text2(" accessor pattern solves this by isolating type coercion in the "), code_([text2("Unsafe.purs")]), text2(" module while providing typed accessors everywhere else.")]), p_([text2("In your "), code_([text2("Draw.purs")]), text2(", you'll use type-annotated lambdas to work with your data:")]), pre_([code_([text2('-- Use data in attributes\nA.cx (\\\\(d :: Datum_) _ -> datum_.x d)\n\n-- Use both data and index\nA.fill (\\\\(d :: Datum_) (i :: Index_) ->\n  if datum_.index i > 5 then "red" else "blue")\n\n-- Scale by data value\nA.radius (\\\\(d :: Datum_) _ -> datum_.y d * 2.0)')])]), p_([text2("The type annotations "), code_([text2("(d :: Datum_)")]), text2(" and "), code_([text2("(i :: Index_)")]), text2(" are required to help PureScript's type checker find the correct "), code_([text2("ToAttr")]), text2(" instance.")])]), render49]);
  };
  var handleAction49 = function(v) {
    return triggerMermaidRendering7;
  };
  var component50 = /* @__PURE__ */ (function() {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render57,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction49,
        initialize: new Just(Initialize50.value)
      })
    });
  })();

  // output/PSD3.Understanding/index.js
  var pure87 = /* @__PURE__ */ pure(applicativeHalogenM);
  var Initialize51 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var renderCard3 = function(route) {
    return function(title4) {
      return function(description) {
        return a([classes(["howto-card"]), href("#" + routeToPath(route))])([h3([classes(["howto-card__title"])])([text2(title4)]), p([classes(["howto-card__description"])])([text2(description)])]);
      };
    };
  };
  var render58 = function(v) {
    return div2([classes(["docs-page", "understanding-index"])])([render5({
      logoSize: Large.value,
      quadrant: QuadUnderstanding.value,
      prevNext: Nothing.value,
      pageTitle: Nothing.value
    }), section([classes(["docs-hero"])])([div2([classes(["docs-hero-content"])])([h1([classes(["docs-hero-title"])])([text2("Understanding")]), p([classes(["docs-hero-description"])])([text2("Deep dives into the core concepts and patterns that make PSD3 a type-safe, composable framework for D3 visualizations.")])])]), section([classes(["docs-section"])])([h2([classes(["docs-section-title"])])([text2("Core Concepts")]), div2([classes(["howto-card-grid"])])([renderCard3(UnderstandingGrammar.value)("The Grammar of D3")("Four essential primitives: select, append, join, attr. Everything else builds from these."), renderCard3(UnderstandingAttributes.value)("Type-Safe Attributes")("Static values, datum functions, contravariant pattern. Compile-time type safety."), renderCard3(UnderstandingSelections.value)("Selection Phantom Types")("Five states: SEmpty, SPending, SBoundOwns, SBoundInherits, SExiting. Indexed Monad pattern.")])]), section([classes(["docs-section"])])([h2([classes(["docs-section-title"])])([text2("Architecture")]), div2([classes(["howto-card-grid"])])([renderCard3(UnderstandingTreeAPI.value)("TreeAPI")("Declarative tree structures. Layer cake architecture with TreeAPI and Simulation API on SelectionM."), renderCard3(UnderstandingScenes.value)("Scene Structures & Transitions")("Declarative state management for complex interactive visualizations with transition matrices.")])])]);
  };
  var handleAction50 = function(v) {
    return pure87(unit);
  };
  var component51 = /* @__PURE__ */ (function() {
    return mkComponent({
      initialState: function(v) {
        return unit;
      },
      render: render58,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction50,
        initialize: new Just(Initialize51.value)
      })
    });
  })();

  // output/Data.Char/index.js
  var toCharCode2 = /* @__PURE__ */ fromEnum(boundedEnumChar);
  var fromCharCode3 = /* @__PURE__ */ toEnum(boundedEnumChar);

  // output/PSD3.Wizard.Datasets/index.js
  var Beginner = /* @__PURE__ */ (function() {
    function Beginner2() {
    }
    ;
    Beginner2.value = new Beginner2();
    return Beginner2;
  })();
  var Intermediate = /* @__PURE__ */ (function() {
    function Intermediate2() {
    }
    ;
    Intermediate2.value = new Intermediate2();
    return Intermediate2;
  })();
  var Advanced = /* @__PURE__ */ (function() {
    function Advanced2() {
    }
    ;
    Advanced2.value = new Advanced2();
    return Advanced2;
  })();
  var sineWaveDataset = /* @__PURE__ */ (function() {
    return {
      id: "sinewave",
      name: "Sine Wave",
      description: "Smooth wave pattern - great for line charts and transitions",
      difficulty: Beginner.value,
      fields: [{
        name: "x",
        fieldType: "Number"
      }, {
        name: "y",
        fieldType: "Number"
      }],
      dataPreview: ["{ x: 0.0, y: 100.0 }", "{ x: 5.0, y: 125.0 }", "{ x: 10.0, y: 145.0 }", "..."],
      suggestedViz: "Line chart or area chart",
      educationalNote: "Demonstrates smooth continuous data - perfect for learning line generators and paths."
    };
  })();
  var showDifficulty = {
    show: function(v) {
      if (v instanceof Beginner) {
        return "Beginner";
      }
      ;
      if (v instanceof Intermediate) {
        return "Intermediate";
      }
      ;
      if (v instanceof Advanced) {
        return "Advanced";
      }
      ;
      throw new Error("Failed pattern match at PSD3.Wizard.Datasets (line 32, column 1 - line 35, column 29): " + [v.constructor.name]);
    }
  };
  var scatterDataset = /* @__PURE__ */ (function() {
    return {
      id: "scatter",
      name: "Scatter Plot",
      description: "Random points in 2D space - perfect for your first visualization",
      difficulty: Beginner.value,
      fields: [{
        name: "x",
        fieldType: "Number"
      }, {
        name: "y",
        fieldType: "Number"
      }],
      dataPreview: ["{ x: 10.0, y: 20.0 }", "{ x: 25.0, y: 45.0 }", "{ x: 40.0, y: 30.0 }", "..."],
      suggestedViz: "Scatter plot with circles",
      educationalNote: "Start here! Simple 2D data is the easiest way to learn PSD3's data binding patterns."
    };
  })();
  var multiLineDataset = /* @__PURE__ */ (function() {
    return {
      id: "multiline",
      name: "Unemployment Rates",
      description: "Unemployment rates for 4 cities over time - multi-series data",
      difficulty: Intermediate.value,
      fields: [{
        name: "series",
        fieldType: "String"
      }, {
        name: "date",
        fieldType: "String"
      }, {
        name: "value",
        fieldType: "Number"
      }],
      dataPreview: ['{ series: "San Francisco", date: "2000-01", value: 3.5 }', '{ series: "San Francisco", date: "2002-01", value: 5.2 }', '{ series: "New York", date: "2000-01", value: 5.3 }', "..."],
      suggestedViz: "Multi-line chart with legend",
      educationalNote: "Time-series data with multiple series - demonstrates data grouping by series and line generators."
    };
  })();
  var groupedBarDataset = /* @__PURE__ */ (function() {
    return {
      id: "groupedbar",
      name: "State Demographics",
      description: "Population by state and age group - for grouped/stacked visualizations",
      difficulty: Intermediate.value,
      fields: [{
        name: "state",
        fieldType: "String"
      }, {
        name: "age",
        fieldType: "String"
      }, {
        name: "population",
        fieldType: "Number"
      }],
      dataPreview: ['{ state: "CA", age: "<10", population: 5038433.0 }', '{ state: "CA", age: "10-19", population: 5055706.0 }', '{ state: "TX", age: "<10", population: 4131018.0 }', "..."],
      suggestedViz: "Grouped bar chart or stacked bar chart",
      educationalNote: "Multi-dimensional data with categorical and numerical fields - great for learning data nesting and grouping patterns."
    };
  })();
  var eqDifficulty = {
    eq: function(x47) {
      return function(y48) {
        if (x47 instanceof Beginner && y48 instanceof Beginner) {
          return true;
        }
        ;
        if (x47 instanceof Intermediate && y48 instanceof Intermediate) {
          return true;
        }
        ;
        if (x47 instanceof Advanced && y48 instanceof Advanced) {
          return true;
        }
        ;
        return false;
      };
    }
  };
  var barChartDataset = /* @__PURE__ */ (function() {
    return {
      id: "barchart",
      name: "Monthly Sales",
      description: "12 months of sales data - classic bar chart material",
      difficulty: Beginner.value,
      fields: [{
        name: "x",
        fieldType: "Number"
      }, {
        name: "y",
        fieldType: "Number"
      }],
      dataPreview: ["{ x: 0.0, y: 30.0 }", "{ x: 1.0, y: 45.0 }", "{ x: 2.0, y: 60.0 }", "..."],
      suggestedViz: "Bar chart or column chart",
      educationalNote: "Perfect for learning data joins - each bar represents one data point."
    };
  })();
  var anscombeDataset = /* @__PURE__ */ (function() {
    return {
      id: "anscombe",
      name: "Anscombe's Quartet",
      description: "Four datasets with identical statistics but very different patterns",
      difficulty: Beginner.value,
      fields: [{
        name: "x",
        fieldType: "Number"
      }, {
        name: "y",
        fieldType: "Number"
      }],
      dataPreview: ["-- Dataset 1:", "{ x: 10.0, y: 8.04 }", "{ x: 8.0, y: 6.95 }", "..."],
      suggestedViz: "Four small multiples scatter plots",
      educationalNote: "Famous dataset showing why visualization matters - all four have identical mean, variance, and correlation, but look completely different when plotted!"
    };
  })();
  var allDatasets2 = [scatterDataset, sineWaveDataset, barChartDataset, anscombeDataset, groupedBarDataset, multiLineDataset];

  // output/PSD3.Wizard.FileDownload/foreign.js
  var createZip = function() {
    return new JSZip();
  };
  var addFile = function(zip2) {
    return function(filename) {
      return function(content3) {
        return function() {
          zip2.file(filename, content3);
        };
      };
    };
  };
  var downloadZipImpl = function(zip2) {
    return function(zipFilename) {
      return function(onError, onSuccess) {
        zip2.generateAsync({ type: "blob" }).then(function(blob) {
          const url2 = URL.createObjectURL(blob);
          const link4 = document.createElement("a");
          link4.href = url2;
          link4.download = zipFilename;
          document.body.appendChild(link4);
          link4.click();
          document.body.removeChild(link4);
          setTimeout(function() {
            URL.revokeObjectURL(url2);
          }, 100);
          onSuccess();
        }).catch(function(error4) {
          onError(error4);
        });
        return function(cancelError, onCancelerError, onCancelerSuccess) {
          onCancelerSuccess();
        };
      };
    };
  };
  var copyToClipboard = function(text8) {
    return function() {
      try {
        if (navigator.clipboard && window.isSecureContext) {
          navigator.clipboard.writeText(text8);
          return true;
        } else {
          const textArea = document.createElement("textarea");
          textArea.value = text8;
          textArea.style.position = "fixed";
          textArea.style.left = "-999999px";
          textArea.style.top = "-999999px";
          document.body.appendChild(textArea);
          textArea.focus();
          textArea.select();
          const success = document.execCommand("copy");
          document.body.removeChild(textArea);
          return success;
        }
      } catch (error4) {
        console.error("Failed to copy to clipboard:", error4);
        return false;
      }
    };
  };

  // output/PSD3.Wizard.FileDownload/index.js
  var append31 = /* @__PURE__ */ append(semigroupArray);
  var eq18 = /* @__PURE__ */ eq(/* @__PURE__ */ eqArray(eqString));
  var append125 = /* @__PURE__ */ append(semigroupString);
  var map89 = /* @__PURE__ */ map(functorArray);
  var bind83 = /* @__PURE__ */ bind(bindAff);
  var liftEffect49 = /* @__PURE__ */ liftEffect(monadEffectAff);
  var discard77 = /* @__PURE__ */ discard(discardUnit)(bindAff);
  var for_5 = /* @__PURE__ */ for_(applicativeEffect)(foldableArray);
  var formatFilesForClipboard = function(files2) {
    var replicateArray = function(n) {
      return function(x47) {
        var $14 = n <= 0;
        if ($14) {
          return [];
        }
        ;
        return append31([x47])(replicateArray(n - 1 | 0)(x47));
      };
    };
    var intercalateArray = function(sep) {
      return function(arr) {
        return maybe("")(function(v) {
          var $16 = eq18(v.tail)([]);
          if ($16) {
            return v.head;
          }
          ;
          return v.head + (sep + intercalateArray(sep)(v.tail));
        })(uncons(arr));
      };
    };
    var repeatString = function(str2) {
      return function(n) {
        return foldl2(append125)("")(replicateArray(n)(str2));
      };
    };
    var separator = "\n" + (repeatString("=")(80) + "\n");
    var formatFile = function(file) {
      return "File: " + (file.filename + ("\n" + (repeatString("-")(80) + ("\n" + file.content))));
    };
    var fileTexts = map89(formatFile)(files2);
    return intercalateArray(separator)(fileTexts);
  };
  var downloadAsZip = function(projectName) {
    return function(files2) {
      return bind83(liftEffect49(createZip))(function(zip2) {
        return discard77(liftEffect49(for_5(files2)(function(file) {
          return addFile(zip2)(file.filename)(file.content);
        })))(function() {
          return fromEffectFnAff(downloadZipImpl(zip2)(projectName + ".zip"));
        });
      });
    };
  };
  var copyFilesToClipboard = function(files2) {
    var formatted = formatFilesForClipboard(files2);
    return copyToClipboard(formatted);
  };

  // output/PSD3.Wizard.Templates/index.js
  var map90 = /* @__PURE__ */ map(functorArray);
  var map122 = /* @__PURE__ */ map(functorMaybe);
  var intercalate7 = /* @__PURE__ */ intercalate2(monoidString);
  var generateRecordType = function(fields) {
    var fieldLines = map90(function(f) {
      return f.name + (" :: " + f.fieldType);
    })(fields);
    return joinWith("\n  , ")(fieldLines);
  };
  var generateUnsafe = function(vizName) {
    return function(dataTypeName) {
      return function(fields) {
        var recordType = generateRecordType(fields);
        return "module " + (vizName + (".Unsafe where\n\nimport PSD3.Internal.Types (Datum_, Index_)\nimport Unsafe.Coerce (unsafeCoerce)\n\n-- | Data type for this visualization\ntype " + (dataTypeName + (" =\n  { " + (recordType + ("\n  }\n\n-- | Coerce Datum_ to " + (dataTypeName + ("\n-- This is safe because D3's data join ensures Datum_ contains\n-- the data we originally passed to simpleJoin/updateJoin\ncoerceTo" + (dataTypeName + (" :: Datum_ -> " + (dataTypeName + ("\ncoerceTo" + (dataTypeName + " = unsafeCoerce\n\n-- | Coerce Index_ to Int (always provided by D3)\ncoerceIndex :: Index_ -> Int\ncoerceIndex = unsafeCoerce\n")))))))))))));
      };
    };
  };
  var generateModel = function(vizName) {
    return function(dataTypeName) {
      return function(fields) {
        return function(exampleData) {
          var recordType = generateRecordType(fields);
          return "module " + (vizName + (".Model where\n\n-- | Data type for this visualization\n-- Re-exported from Unsafe for use in type signatures\ntype " + (dataTypeName + (" =\n  { " + (recordType + ("\n  }\n\n-- | Example data for testing\nexampleData :: Array " + (dataTypeName + ("\nexampleData =\n  " + (exampleData + "\n")))))))));
        };
      };
    };
  };
  var generateMain = function(vizName) {
    return function(dataTypeName) {
      return "module Main where\n\nimport Prelude\nimport Effect (Effect)\nimport " + (vizName + (".Draw (run)\nimport " + (vizName + ".Model (exampleData)\n\nmain :: Effect Unit\nmain = run exampleData\n")));
    };
  };
  var generateHTML = function(vizName) {
    return '<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8">\n  <meta name="viewport" content="width=device-width, initial-scale=1.0">\n  <title>' + (vizName + (' - PSD3 Visualization</title>\n  <style>\n    body {\n      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;\n      margin: 0;\n      padding: 20px;\n      background-color: #f5f5f5;\n    }\n    .container {\n      max-width: 1200px;\n      margin: 0 auto;\n      background-color: white;\n      padding: 30px;\n      border-radius: 8px;\n      box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    }\n    h1 {\n      color: #333;\n      margin-top: 0;\n    }\n    #chart {\n      margin: 20px 0;\n      border: 1px solid #e0e0e0;\n      border-radius: 4px;\n      background-color: #fafafa;\n    }\n    svg {\n      display: block;\n    }\n  </style>\n</head>\n<body>\n  <div class="container">\n    <h1>' + (vizName + `</h1>
    <div id="chart"></div>
  </div>

  <!-- D3.js from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"><\/script>

  <!-- Your bundled PureScript code -->
  <!-- After building with 'spago bundle', include your bundle here: -->
  <!-- <script src="./bundle.js"><\/script> -->
</body>
</html>
`)));
  };
  var generateDatumType = function(fields) {
    var typeLines = map90(function(f) {
      return f.name + (" :: Datum_ -> " + f.fieldType);
    })(fields);
    return joinWith("\n  , ")(typeLines);
  };
  var generateREADME = function(vizName) {
    return function(dataTypeName) {
      return function(fields) {
        var firstField = fromMaybe("x")(map122(function(f) {
          return f.name;
        })(head(fields)));
        var fieldList = intercalate7("\n")(map90(function(f) {
          return "- " + (f.name + (": " + f.fieldType));
        })(fields));
        var exampleFields = intercalate7(", ")(map90(function(f) {
          return f.name + ": 0.0";
        })(fields));
        var datumType = generateDatumType(fields);
        return "# " + (vizName + ("\n\nPSD3 visualization scaffold generated by the web wizard.\n\n## Files Generated\n\n- **Unsafe.purs** - Type coercion functions (isolates all unsafeCoerce calls)\n- **Model.purs** - Data type definitions\n- **Draw.purs** - Main visualization code\n- **index.html** - HTML page with D3.js loaded from CDN\n\n## Data Type\n\n```purescript\ntype " + (dataTypeName + (" =\n  { " + (fieldList + ("\n  }\n```\n\n## Quick Start\n\n1. **Add your data** in `Model.purs`:\n   ```purescript\n   exampleData :: Array " + (dataTypeName + ("\n   exampleData =\n     [ { " + (exampleFields + (" }\n     -- Add more data points\n     ]\n   ```\n\n2. **Customize the visualization** in `Draw.purs`\n   - Modify the `draw` function to create your desired chart\n   - Use the `datum_` accessor to work with your data safely\n   - See the commented examples for using data fields in attributes\n\n3. **Build and run**:\n   ```bash\n   # Compile the PureScript\n   spago build\n\n   # Bundle for the browser (if you created Main.purs)\n   spago bundle --module Main --outfile bundle.js\n\n   # Open index.html in your browser\n   open index.html\n   ```\n\n## The datum_ Pattern\n\nThe `datum_` accessor record provides type-safe access to your data:\n\n```purescript\ndatum_ ::\n  { " + (datumType + ("\n  , index :: Index_ -> Int\n  }\n```\n\nUse it in attributes like this:\n```purescript\nA.cx (\\\\(d :: Datum_) _ -> datum_." + (firstField + " d)\n```\n\nThe type annotations `(d :: Datum_)` and `(i :: Index_)` help PureScript's type checker\nfind the correct ToAttr instance.\n\n## Learn More\n\n- [PSD3 Documentation](https://github.com/afcondon/PureScript-Tagless-D3)\n- [Wizard Guide](../../docs/wizard-guide.md)\n")))))))))))));
      };
    };
  };
  var generateAccessors = function(fields) {
    return function(coerceFnName) {
      var accessorLines = map90(function(f) {
        return f.name + (": _." + (f.name + (" <<< " + coerceFnName)));
      })(fields);
      return joinWith("\n  , ")(accessorLines);
    };
  };
  var generateDraw = function(vizName) {
    return function(dataTypeName) {
      return function(fields) {
        return function(coerceFnName) {
          var firstField = fromMaybe("x")(map122(function(f) {
            return f.name;
          })(head(fields)));
          var datumType = generateDatumType(fields);
          var accessors = generateAccessors(fields)(coerceFnName);
          return "module " + (vizName + (".Draw where\n\nimport Prelude\n\nimport PSD3\nimport PSD3.Attributes as A\nimport PSD3.Internal.FFI (keyIsID_)\nimport " + (vizName + (".Unsafe (" + (coerceFnName + (", coerceIndex)\nimport " + (vizName + (".Model (" + (dataTypeName + (")\nimport Data.Int (toNumber)\nimport Effect (Effect)\n\n-- | Accessor record for working with bound data\ndatum_ ::\n  { " + (datumType + ("\n  , index :: Index_ -> Int\n  }\ndatum_ =\n  { " + (accessors + ("\n  , index: coerceIndex\n  }\n\n-- | Main drawing function\ndraw :: forall m. SelectionM D3Selection_ m => Array " + (dataTypeName + (' -> Selector D3Selection_ -> m Unit\ndraw dataPoints selector = do\n  (root :: D3Selection_) <- attach selector\n  svg <- appendTo root Svg\n    [ A.width 800.0\n    , A.height 600.0\n    , A.viewBox 0.0 0.0 800.0 600.0\n    ]\n\n  -- Example: Simple data join\n  -- Replace this with your visualization logic\n  circles <- simpleJoin svg Circle dataPoints keyIsID_\n  setAttributes circles\n    [ A.cx (\\\\(_ :: Datum_) (i :: Index_) -> toNumber (datum_.index i) * 50.0)\n    , A.cy 300.0\n    , A.radius 20.0\n    , A.fill "steelblue"\n    ]\n\n  -- Examples of using your data fields in attributes:\n  -- A.cx (\\\\(d :: Datum_) _ -> datum_.' + (firstField + (' d)  -- Use first data field\n  -- A.fill (\\\\(d :: Datum_) (i :: Index_) -> if datum_.index i > 5 then "red" else "blue")\n  -- A.radius (\\\\(d :: Datum_) _ -> datum_.' + (firstField + (" d * 2.0)  -- Scale by data\n\n  pure unit\n\n-- | Entry point\nrun :: Array " + (dataTypeName + ' -> Effect Unit\nrun dataPoints = eval_D3M $ draw dataPoints "#chart"\n')))))))))))))))))))));
        };
      };
    };
  };

  // output/PSD3.Wizard.Generator/index.js
  var intercalate8 = /* @__PURE__ */ intercalate2(monoidString);
  var map91 = /* @__PURE__ */ map(functorArray);
  var append126 = /* @__PURE__ */ append(semigroupArray);
  var sineWaveData = "[ { x: 0.0, y: 100.0 }\n  , { x: 5.0, y: 125.0 }\n  , { x: 10.0, y: 145.0 }\n  , { x: 15.0, y: 159.0 }\n  , { x: 20.0, y: 165.0 }\n  , { x: 25.0, y: 159.0 }\n  , { x: 30.0, y: 145.0 }\n  , { x: 35.0, y: 125.0 }\n  , { x: 40.0, y: 100.0 }\n  , { x: 45.0, y: 75.0 }\n  , { x: 50.0, y: 55.0 }\n  , { x: 55.0, y: 41.0 }\n  , { x: 60.0, y: 35.0 }\n  , { x: 65.0, y: 41.0 }\n  , { x: 70.0, y: 55.0 }\n  , { x: 75.0, y: 75.0 }\n  , { x: 80.0, y: 100.0 }\n  ]";
  var scatterData2 = "[ { x: 10.0, y: 20.0 }\n  , { x: 25.0, y: 45.0 }\n  , { x: 40.0, y: 30.0 }\n  , { x: 55.0, y: 60.0 }\n  , { x: 70.0, y: 40.0 }\n  , { x: 85.0, y: 70.0 }\n  , { x: 100.0, y: 55.0 }\n  , { x: 115.0, y: 80.0 }\n  , { x: 130.0, y: 65.0 }\n  , { x: 145.0, y: 90.0 }\n  ]";
  var multiLineData = '[ { series: "San Francisco", date: "2000-01", value: 3.5 }\n  , { series: "San Francisco", date: "2002-01", value: 5.2 }\n  , { series: "San Francisco", date: "2004-01", value: 4.8 }\n  , { series: "San Francisco", date: "2006-01", value: 3.9 }\n  , { series: "San Francisco", date: "2008-01", value: 4.2 }\n  , { series: "San Francisco", date: "2010-01", value: 8.4 }\n  , { series: "San Francisco", date: "2012-01", value: 6.8 }\n  , { series: "New York", date: "2000-01", value: 5.3 }\n  , { series: "New York", date: "2002-01", value: 7.2 }\n  , { series: "New York", date: "2004-01", value: 6.1 }\n  , { series: "New York", date: "2006-01", value: 4.9 }\n  , { series: "New York", date: "2008-01", value: 5.3 }\n  , { series: "New York", date: "2010-01", value: 9.2 }\n  , { series: "New York", date: "2012-01", value: 7.8 }\n  , { series: "Austin", date: "2000-01", value: 2.9 }\n  , { series: "Austin", date: "2002-01", value: 4.8 }\n  , { series: "Austin", date: "2004-01", value: 4.2 }\n  , { series: "Austin", date: "2006-01", value: 3.5 }\n  , { series: "Austin", date: "2008-01", value: 3.8 }\n  , { series: "Austin", date: "2010-01", value: 6.5 }\n  , { series: "Austin", date: "2012-01", value: 5.1 }\n  , { series: "Seattle", date: "2000-01", value: 4.1 }\n  , { series: "Seattle", date: "2002-01", value: 6.3 }\n  , { series: "Seattle", date: "2004-01", value: 5.5 }\n  , { series: "Seattle", date: "2006-01", value: 4.2 }\n  , { series: "Seattle", date: "2008-01", value: 4.5 }\n  , { series: "Seattle", date: "2010-01", value: 7.8 }\n  , { series: "Seattle", date: "2012-01", value: 6.2 }\n  ]';
  var groupedBarData = '[ { state: "CA", age: "<10", population: 5038433.0 }\n  , { state: "CA", age: "10-19", population: 5055706.0 }\n  , { state: "CA", age: "20-29", population: 5310481.0 }\n  , { state: "CA", age: "30-39", population: 5354112.0 }\n  , { state: "TX", age: "<10", population: 4131018.0 }\n  , { state: "TX", age: "10-19", population: 3770007.0 }\n  , { state: "TX", age: "20-29", population: 3863019.0 }\n  , { state: "TX", age: "30-39", population: 3696647.0 }\n  , { state: "NY", age: "<10", population: 2275293.0 }\n  , { state: "NY", age: "10-19", population: 2363801.0 }\n  , { state: "NY", age: "20-29", population: 2885845.0 }\n  , { state: "NY", age: "30-39", population: 2754048.0 }\n  ]';
  var fallbackData = function(fields) {
    var generateFieldValue = function(field) {
      if (field.fieldType === "Number") {
        return field.name + ": 0.0";
      }
      ;
      if (field.fieldType === "String") {
        return field.name + (': "' + (field.name + '"'));
      }
      ;
      if (field.fieldType === "Int") {
        return field.name + ": 0";
      }
      ;
      return field.name + ": 0.0";
    };
    var sampleRow = "{ " + (intercalate8(", ")(map91(generateFieldValue)(fields)) + " }");
    var rows4 = intercalate8("\n  , ")([sampleRow, sampleRow, sampleRow]);
    return "[ " + (rows4 + "\n  ]");
  };
  var barChartData = "[ { x: 0.0, y: 30.0 }\n  , { x: 1.0, y: 45.0 }\n  , { x: 2.0, y: 60.0 }\n  , { x: 3.0, y: 55.0 }\n  , { x: 4.0, y: 70.0 }\n  , { x: 5.0, y: 65.0 }\n  , { x: 6.0, y: 80.0 }\n  , { x: 7.0, y: 75.0 }\n  , { x: 8.0, y: 90.0 }\n  , { x: 9.0, y: 85.0 }\n  , { x: 10.0, y: 95.0 }\n  , { x: 11.0, y: 100.0 }\n  ]";
  var anscombeData2 = "[ { x: 10.0, y: 8.04 }\n  , { x: 8.0, y: 6.95 }\n  , { x: 13.0, y: 7.58 }\n  , { x: 9.0, y: 8.81 }\n  , { x: 11.0, y: 8.33 }\n  , { x: 14.0, y: 9.96 }\n  , { x: 6.0, y: 7.24 }\n  , { x: 4.0, y: 4.26 }\n  , { x: 12.0, y: 10.84 }\n  , { x: 7.0, y: 4.82 }\n  , { x: 5.0, y: 5.68 }\n  ]";
  var generateExampleData = function(dataset) {
    if (dataset.id === "scatter") {
      return scatterData2;
    }
    ;
    if (dataset.id === "sinewave") {
      return sineWaveData;
    }
    ;
    if (dataset.id === "barchart") {
      return barChartData;
    }
    ;
    if (dataset.id === "anscombe") {
      return anscombeData2;
    }
    ;
    if (dataset.id === "groupedbar") {
      return groupedBarData;
    }
    ;
    if (dataset.id === "multiline") {
      return multiLineData;
    }
    ;
    return fallbackData(dataset.fields);
  };
  var generateProject = function(config) {
    var exampleData = generateExampleData(config.dataset);
    var dataTypeName = config.vizName + "Data";
    var mainFile = (function() {
      if (config.includeMain) {
        return [{
          filename: "Main.purs",
          content: generateMain(config.vizName)(dataTypeName)
        }];
      }
      ;
      return [];
    })();
    var coerceFnName = "coerceTo" + dataTypeName;
    var baseFiles = [{
      filename: config.vizName + "/Unsafe.purs",
      content: generateUnsafe(config.vizName)(dataTypeName)(config.dataset.fields)
    }, {
      filename: config.vizName + "/Model.purs",
      content: generateModel(config.vizName)(dataTypeName)(config.dataset.fields)(exampleData)
    }, {
      filename: config.vizName + "/Draw.purs",
      content: generateDraw(config.vizName)(dataTypeName)(config.dataset.fields)(coerceFnName)
    }, {
      filename: config.vizName + "/index.html",
      content: generateHTML(config.vizName)
    }, {
      filename: config.vizName + "/README.md",
      content: generateREADME(config.vizName)(dataTypeName)(config.dataset.fields)
    }];
    return append126(baseFiles)(mainFile);
  };

  // output/PSD3.Wizard.Wizard/index.js
  var map92 = /* @__PURE__ */ map(functorArray);
  var eq19 = /* @__PURE__ */ eq(/* @__PURE__ */ eqArray(eqString));
  var show82 = /* @__PURE__ */ show(showDifficulty);
  var eq26 = /* @__PURE__ */ eq(eqDifficulty);
  var eq33 = /* @__PURE__ */ eq(/* @__PURE__ */ eqMaybe(eqDifficulty));
  var bind84 = /* @__PURE__ */ bind(bindMaybe);
  var pure88 = /* @__PURE__ */ pure(applicativeMaybe);
  var type_22 = /* @__PURE__ */ type_3(isPropInputType);
  var value17 = /* @__PURE__ */ value3(isPropString);
  var modify_23 = /* @__PURE__ */ modify_2(monadStateHalogenM);
  var bind138 = /* @__PURE__ */ bind(bindHalogenM);
  var get25 = /* @__PURE__ */ get(monadStateHalogenM);
  var discard78 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var pure127 = /* @__PURE__ */ pure(applicativeHalogenM);
  var when9 = /* @__PURE__ */ when(applicativeHalogenM);
  var ChooseDataset = /* @__PURE__ */ (function() {
    function ChooseDataset2() {
    }
    ;
    ChooseDataset2.value = new ChooseDataset2();
    return ChooseDataset2;
  })();
  var NameModule = /* @__PURE__ */ (function() {
    function NameModule2() {
    }
    ;
    NameModule2.value = new NameModule2();
    return NameModule2;
  })();
  var ReviewFiles = /* @__PURE__ */ (function() {
    function ReviewFiles2() {
    }
    ;
    ReviewFiles2.value = new ReviewFiles2();
    return ReviewFiles2;
  })();
  var Download = /* @__PURE__ */ (function() {
    function Download2() {
    }
    ;
    Download2.value = new Download2();
    return Download2;
  })();
  var SelectDataset = /* @__PURE__ */ (function() {
    function SelectDataset2(value0) {
      this.value0 = value0;
    }
    ;
    SelectDataset2.create = function(value0) {
      return new SelectDataset2(value0);
    };
    return SelectDataset2;
  })();
  var SetVizName = /* @__PURE__ */ (function() {
    function SetVizName2(value0) {
      this.value0 = value0;
    }
    ;
    SetVizName2.create = function(value0) {
      return new SetVizName2(value0);
    };
    return SetVizName2;
  })();
  var ToggleIncludeMain = /* @__PURE__ */ (function() {
    function ToggleIncludeMain2() {
    }
    ;
    ToggleIncludeMain2.value = new ToggleIncludeMain2();
    return ToggleIncludeMain2;
  })();
  var NextStep = /* @__PURE__ */ (function() {
    function NextStep2() {
    }
    ;
    NextStep2.value = new NextStep2();
    return NextStep2;
  })();
  var PreviousStep = /* @__PURE__ */ (function() {
    function PreviousStep2() {
    }
    ;
    PreviousStep2.value = new PreviousStep2();
    return PreviousStep2;
  })();
  var GoToStep = /* @__PURE__ */ (function() {
    function GoToStep2(value0) {
      this.value0 = value0;
    }
    ;
    GoToStep2.create = function(value0) {
      return new GoToStep2(value0);
    };
    return GoToStep2;
  })();
  var GenerateFiles = /* @__PURE__ */ (function() {
    function GenerateFiles2() {
    }
    ;
    GenerateFiles2.value = new GenerateFiles2();
    return GenerateFiles2;
  })();
  var DownloadZip = /* @__PURE__ */ (function() {
    function DownloadZip2() {
    }
    ;
    DownloadZip2.value = new DownloadZip2();
    return DownloadZip2;
  })();
  var CopyToClipboard = /* @__PURE__ */ (function() {
    function CopyToClipboard2() {
    }
    ;
    CopyToClipboard2.value = new CopyToClipboard2();
    return CopyToClipboard2;
  })();
  var SetDifficultyFilter = /* @__PURE__ */ (function() {
    function SetDifficultyFilter2(value0) {
      this.value0 = value0;
    }
    ;
    SetDifficultyFilter2.create = function(value0) {
      return new SetDifficultyFilter2(value0);
    };
    return SetDifficultyFilter2;
  })();
  var renderReviewFiles = function(state3) {
    var renderFile = function(file) {
      return details([classes(["wizard__file"])])([summary_([text2(file.filename)]), pre([classes(["wizard__code"])])([code_([text2(file.content)])])]);
    };
    return div2([classes(["wizard__step-content"])])([h2_([text2("Review Generated Files")]), p_([text2("Preview the files that will be generated for your project.")]), div2([classes(["wizard__file-list"])])(map92(renderFile)(state3.generatedFiles))]);
  };
  var renderHeader3 = function(state3) {
    return header([classes(["wizard__header"])])([h1_([text2("PSD3 Visualization Wizard")]), p([classes(["wizard__subtitle"])])([text2("Create a new PSD3 visualization project in 4 easy steps")])]);
  };
  var renderDownload = function(state3) {
    return div2([classes(["wizard__step-content wizard__step-content--centered"])])([h2_([text2("Download Your Project")]), p_([text2("Your visualization project is ready! Download it as a zip file or copy the code to your clipboard.")]), div2([classes(["wizard__download-options"])])([button([classes(["wizard__btn wizard__btn--primary wizard__btn--large"]), onClick(function(v) {
      return DownloadZip.value;
    })])([text2("\u{1F4E6} Download " + (state3.vizName + ".zip"))]), button([classes(["wizard__btn wizard__btn--secondary wizard__btn--large"]), onClick(function(v) {
      return CopyToClipboard.value;
    })])([text2("\u{1F4CB} Copy to Clipboard")])]), div2([classes(["wizard__next-steps"])])([h3_([text2("Next Steps")]), ol_([li_([text2("Extract the zip file to your project directory")]), li_([text2("Add your dependencies to spago.dhall or package.json")]), li_([text2("Customize the visualization in Draw.purs")]), li_([text2("Build with 'spago build'")]), li_([text2("Open index.html in your browser")])])])]);
  };
  var renderChooseDataset = function(state3) {
    var toLowerCase = (function() {
      var toLower2 = function(c) {
        var $73 = c >= "A" && c <= "Z";
        if ($73) {
          return fromMaybe(c)(fromCharCode3(toCharCode2(c) + 32 | 0));
        }
        ;
        return c;
      };
      var $151 = map92(toLower2);
      return function($152) {
        return fromCharArray($151(toCharArray($152)));
      };
    })();
    var intercalate9 = function(sep) {
      return function(arr) {
        return maybe("")(function(v) {
          var $75 = eq19(v.tail)([]);
          if ($75) {
            return v.head;
          }
          ;
          return v.head + (sep + intercalate9(sep)(v.tail));
        })(uncons(arr));
      };
    };
    var renderDatasetCard = function(dataset) {
      var isSelected = (function() {
        if (state3.selectedDataset instanceof Just) {
          return state3.selectedDataset.value0.id === dataset.id;
        }
        ;
        if (state3.selectedDataset instanceof Nothing) {
          return false;
        }
        ;
        throw new Error("Failed pattern match at PSD3.Wizard.Wizard (line 180, column 22 - line 182, column 27): " + [state3.selectedDataset.constructor.name]);
      })();
      var cardClass = "dataset-card" + (function() {
        if (isSelected) {
          return " dataset-card--selected";
        }
        ;
        return "";
      })();
      return div2([classes([cardClass]), onClick(function(v) {
        return new SelectDataset(dataset);
      })])([div2([classes(["dataset-card__header"])])([h3_([text2(dataset.name)]), span2([classes(["difficulty-badge difficulty-badge--" + toLowerCase(show82(dataset.difficulty))])])([text2(show82(dataset.difficulty))])]), p([classes(["dataset-card__description"])])([text2(dataset.description)]), div2([classes(["dataset-card__info"])])([strong_([text2("Fields: ")]), text2(intercalate9(", ")(map92(function(f) {
        return f.name + (": " + f.fieldType);
      })(dataset.fields)))]), div2([classes(["dataset-card__viz"])])([strong_([text2("Suggested: ")]), text2(dataset.suggestedViz)]), div2([classes(["dataset-card__note"])])([text2(dataset.educationalNote)])]);
    };
    var filteredDatasets = (function() {
      if (state3.filterDifficulty instanceof Nothing) {
        return allDatasets2;
      }
      ;
      if (state3.filterDifficulty instanceof Just) {
        return filter(function(d18) {
          return eq26(d18.difficulty)(state3.filterDifficulty.value0);
        })(allDatasets2);
      }
      ;
      throw new Error("Failed pattern match at PSD3.Wizard.Wizard (line 173, column 24 - line 175, column 79): " + [state3.filterDifficulty.constructor.name]);
    })();
    return div2([classes(["wizard__step-content"])])([h2_([text2("Choose a Dataset")]), p_([text2("Select an example dataset to get started. Each dataset includes sample data and suggestions for visualizations.")]), div2([classes(["wizard__filters"])])([label_([text2("Filter by difficulty:")]), button([classes(["filter-btn" + (function() {
      var $83 = eq33(state3.filterDifficulty)(Nothing.value);
      if ($83) {
        return " filter-btn--active";
      }
      ;
      return "";
    })()]), onClick(function(v) {
      return new SetDifficultyFilter(Nothing.value);
    })])([text2("All")]), button([classes(["filter-btn" + (function() {
      var $84 = eq33(state3.filterDifficulty)(new Just(Beginner.value));
      if ($84) {
        return " filter-btn--active";
      }
      ;
      return "";
    })()]), onClick(function(v) {
      return new SetDifficultyFilter(new Just(Beginner.value));
    })])([text2("Beginner")]), button([classes(["filter-btn" + (function() {
      var $85 = eq33(state3.filterDifficulty)(new Just(Intermediate.value));
      if ($85) {
        return " filter-btn--active";
      }
      ;
      return "";
    })()]), onClick(function(v) {
      return new SetDifficultyFilter(new Just(Intermediate.value));
    })])([text2("Intermediate")])]), div2([classes(["wizard__dataset-grid"])])(map92(renderDatasetCard)(filteredDatasets))]);
  };
  var isValidModuleName = function(name16) {
    var all4 = function(pred) {
      return function(arr) {
        var v = uncons(arr);
        if (v instanceof Nothing) {
          return true;
        }
        ;
        if (v instanceof Just) {
          return pred(v.value0.head) && all4(pred)(v.value0.tail);
        }
        ;
        throw new Error("Failed pattern match at PSD3.Wizard.Wizard (line 458, column 20 - line 460, column 58): " + [v.constructor.name]);
      };
    };
    var isUpperCase = function(c) {
      var code2 = toCharCode2(c);
      return code2 >= 65 && code2 <= 90;
    };
    var isLowerCase = function(c) {
      var code2 = toCharCode2(c);
      return code2 >= 97 && code2 <= 122;
    };
    var isDigitChar = function(c) {
      var code2 = toCharCode2(c);
      return code2 >= 48 && code2 <= 57;
    };
    var isAlphaNum = function(c) {
      return isUpperCase(c) || (isLowerCase(c) || isDigitChar(c));
    };
    var chars = toCharArray(name16);
    if (chars.length === 0) {
      return false;
    }
    ;
    return fromMaybe(false)(bind84(head(chars))(function(first2) {
      return pure88(isUpperCase(first2) && all4(isAlphaNum)(chars));
    }));
  };
  var renderNameModule = function(state3) {
    return div2([classes(["wizard__step-content"])])([h2_([text2("Name Your Visualization")]), p_([text2("Choose a name for your visualization module. It should be a valid PureScript module name (CamelCase, starting with uppercase).")]), div2([classes(["wizard__form-group"])])([label([$$for("viz-name")])([text2("Visualization Name")]), input([type_22(InputText.value), id3("viz-name"), value17(state3.vizName), placeholder2("e.g., MyScatterPlot"), onValueInput(SetVizName.create), classes(["wizard__input"])]), (function() {
      var $91 = isValidModuleName(state3.vizName) || state3.vizName === "";
      if ($91) {
        return div_([]);
      }
      ;
      return div2([classes(["wizard__error"])])([text2("Module name must start with uppercase and contain only letters and numbers")]);
    })()]), div2([classes(["wizard__form-group"])])([label_([input([type_22(InputCheckbox.value), checked2(state3.includeMain), onChecked(function(v) {
      return ToggleIncludeMain.value;
    })]), text2(" Include Main.purs (for bundling with spago)")]), p([classes(["wizard__help-text"])])([text2("Main.purs provides an entry point for bundling your visualization. Check this if you plan to use 'spago bundle'.")])]), (function() {
      var $92 = state3.vizName !== "" && isValidModuleName(state3.vizName);
      if ($92) {
        return div2([classes(["wizard__preview"])])([h3_([text2("Files that will be generated:")]), ul_([li_([text2(state3.vizName + "/Unsafe.purs")]), li_([text2(state3.vizName + "/Model.purs")]), li_([text2(state3.vizName + "/Draw.purs")]), li_([text2(state3.vizName + "/index.html")]), li_([text2(state3.vizName + "/README.md")]), (function() {
          if (state3.includeMain) {
            return li_([text2("Main.purs")]);
          }
          ;
          return text2("");
        })()])]);
      }
      ;
      return div_([]);
    })()]);
  };
  var renderStepContent = function(dictMonadAff) {
    return function(state3) {
      return div2([classes(["wizard__content"])])([(function() {
        if (state3.currentStep instanceof ChooseDataset) {
          return renderChooseDataset(state3);
        }
        ;
        if (state3.currentStep instanceof NameModule) {
          return renderNameModule(state3);
        }
        ;
        if (state3.currentStep instanceof ReviewFiles) {
          return renderReviewFiles(state3);
        }
        ;
        if (state3.currentStep instanceof Download) {
          return renderDownload(state3);
        }
        ;
        throw new Error("Failed pattern match at PSD3.Wizard.Wizard (line 131, column 7 - line 135, column 41): " + [state3.currentStep.constructor.name]);
      })()]);
    };
  };
  var initialState3 = /* @__PURE__ */ (function() {
    return {
      currentStep: ChooseDataset.value,
      selectedDataset: Nothing.value,
      vizName: "",
      includeMain: true,
      generatedFiles: [],
      filterDifficulty: Nothing.value
    };
  })();
  var eqWizardStep = {
    eq: function(x47) {
      return function(y48) {
        if (x47 instanceof ChooseDataset && y48 instanceof ChooseDataset) {
          return true;
        }
        ;
        if (x47 instanceof NameModule && y48 instanceof NameModule) {
          return true;
        }
        ;
        if (x47 instanceof ReviewFiles && y48 instanceof ReviewFiles) {
          return true;
        }
        ;
        if (x47 instanceof Download && y48 instanceof Download) {
          return true;
        }
        ;
        return false;
      };
    }
  };
  var eq42 = /* @__PURE__ */ eq(eqWizardStep);
  var renderNavigation = function(state3) {
    var canProceed = (function() {
      if (state3.currentStep instanceof ChooseDataset) {
        return isJust(state3.selectedDataset);
      }
      ;
      if (state3.currentStep instanceof NameModule) {
        return state3.vizName !== "" && isValidModuleName(state3.vizName);
      }
      ;
      if (state3.currentStep instanceof ReviewFiles) {
        return true;
      }
      ;
      if (state3.currentStep instanceof Download) {
        return true;
      }
      ;
      throw new Error("Failed pattern match at PSD3.Wizard.Wizard (line 363, column 18 - line 367, column 23): " + [state3.currentStep.constructor.name]);
    })();
    return div2([classes(["wizard__navigation"])])([button([classes(["wizard__btn wizard__btn--secondary"]), onClick(function(v) {
      return PreviousStep.value;
    }), disabled2(eq42(state3.currentStep)(ChooseDataset.value))])([text2("\u2190 Previous")]), button([classes(["wizard__btn wizard__btn--primary"]), onClick(function(v) {
      return NextStep.value;
    }), disabled2(!canProceed)])([text2((function() {
      var $98 = eq42(state3.currentStep)(Download.value);
      if ($98) {
        return "Restart";
      }
      ;
      return "Next \u2192";
    })())])]);
  };
  var renderProgressBar = function(state3) {
    var stepIndex = function(v) {
      if (v instanceof ChooseDataset) {
        return 0;
      }
      ;
      if (v instanceof NameModule) {
        return 1;
      }
      ;
      if (v instanceof ReviewFiles) {
        return 2;
      }
      ;
      if (v instanceof Download) {
        return 3;
      }
      ;
      throw new Error("Failed pattern match at PSD3.Wizard.Wizard (line 120, column 5 - line 120, column 35): " + [v.constructor.name]);
    };
    var renderStep = function(step4) {
      return function(num) {
        return function(label5) {
          var isCompleted = stepIndex(state3.currentStep) > stepIndex(step4);
          var isActive = eq42(state3.currentStep)(step4);
          var classes2 = "wizard__step" + ((function() {
            if (isActive) {
              return " wizard__step--active";
            }
            ;
            return "";
          })() + (function() {
            if (isCompleted) {
              return " wizard__step--completed";
            }
            ;
            return "";
          })());
          return div2([classes([classes2]), onClick(function(v) {
            return new GoToStep(step4);
          })])([div2([classes(["wizard__step-number"])])([text2(num)]), div2([classes(["wizard__step-label"])])([text2(label5)])]);
        };
      };
    };
    return div2([classes(["wizard__progress"])])([renderStep(ChooseDataset.value)("1")("Choose Dataset"), renderStep(NameModule.value)("2")("Name Module"), renderStep(ReviewFiles.value)("3")("Review Files"), renderStep(Download.value)("4")("Download")]);
  };
  var render59 = function(dictMonadAff) {
    var renderStepContent1 = renderStepContent(dictMonadAff);
    return function(state3) {
      return div2([classes(["wizard"])])([renderHeader3(state3), renderProgressBar(state3), renderStepContent1(state3), renderNavigation(state3)]);
    };
  };
  var canGoToStep = function(state3) {
    return function(step4) {
      if (step4 instanceof ChooseDataset) {
        return true;
      }
      ;
      if (step4 instanceof NameModule) {
        return isJust(state3.selectedDataset);
      }
      ;
      if (step4 instanceof ReviewFiles) {
        return isJust(state3.selectedDataset) && (state3.vizName !== "" && isValidModuleName(state3.vizName));
      }
      ;
      if (step4 instanceof Download) {
        return isJust(state3.selectedDataset) && (state3.vizName !== "" && isValidModuleName(state3.vizName));
      }
      ;
      throw new Error("Failed pattern match at PSD3.Wizard.Wizard (line 435, column 26 - line 439, column 101): " + [step4.constructor.name]);
    };
  };
  var handleAction51 = function(dictMonadAff) {
    var liftAff3 = liftAff(monadAffHalogenM(dictMonadAff));
    var liftEffect51 = liftEffect(monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    return function(v) {
      if (v instanceof SelectDataset) {
        return modify_23(function(v1) {
          var $104 = {};
          for (var $105 in v1) {
            if ({}.hasOwnProperty.call(v1, $105)) {
              $104[$105] = v1[$105];
            }
            ;
          }
          ;
          $104.selectedDataset = new Just(v.value0);
          return $104;
        });
      }
      ;
      if (v instanceof SetVizName) {
        return modify_23(function(v1) {
          var $108 = {};
          for (var $109 in v1) {
            if ({}.hasOwnProperty.call(v1, $109)) {
              $108[$109] = v1[$109];
            }
            ;
          }
          ;
          $108.vizName = trim(v.value0);
          return $108;
        });
      }
      ;
      if (v instanceof ToggleIncludeMain) {
        return modify_23(function(s) {
          var $112 = {};
          for (var $113 in s) {
            if ({}.hasOwnProperty.call(s, $113)) {
              $112[$113] = s[$113];
            }
            ;
          }
          ;
          $112.includeMain = !s.includeMain;
          return $112;
        });
      }
      ;
      if (v instanceof NextStep) {
        return bind138(get25)(function(state3) {
          if (state3.currentStep instanceof ChooseDataset) {
            return modify_23(function(v1) {
              var $116 = {};
              for (var $117 in v1) {
                if ({}.hasOwnProperty.call(v1, $117)) {
                  $116[$117] = v1[$117];
                }
                ;
              }
              ;
              $116.currentStep = NameModule.value;
              return $116;
            });
          }
          ;
          if (state3.currentStep instanceof NameModule) {
            return discard78(handleAction51(dictMonadAff)(GenerateFiles.value))(function() {
              return modify_23(function(v1) {
                var $119 = {};
                for (var $120 in v1) {
                  if ({}.hasOwnProperty.call(v1, $120)) {
                    $119[$120] = v1[$120];
                  }
                  ;
                }
                ;
                $119.currentStep = ReviewFiles.value;
                return $119;
              });
            });
          }
          ;
          if (state3.currentStep instanceof ReviewFiles) {
            return modify_23(function(v1) {
              var $122 = {};
              for (var $123 in v1) {
                if ({}.hasOwnProperty.call(v1, $123)) {
                  $122[$123] = v1[$123];
                }
                ;
              }
              ;
              $122.currentStep = Download.value;
              return $122;
            });
          }
          ;
          if (state3.currentStep instanceof Download) {
            return modify_23(function(v1) {
              var $125 = {};
              for (var $126 in v1) {
                if ({}.hasOwnProperty.call(v1, $126)) {
                  $125[$126] = v1[$126];
                }
                ;
              }
              ;
              $125.currentStep = ChooseDataset.value;
              return $125;
            });
          }
          ;
          throw new Error("Failed pattern match at PSD3.Wizard.Wizard (line 383, column 5 - line 389, column 62): " + [state3.currentStep.constructor.name]);
        });
      }
      ;
      if (v instanceof PreviousStep) {
        return bind138(get25)(function(state3) {
          if (state3.currentStep instanceof NameModule) {
            return modify_23(function(v1) {
              var $129 = {};
              for (var $130 in v1) {
                if ({}.hasOwnProperty.call(v1, $130)) {
                  $129[$130] = v1[$130];
                }
                ;
              }
              ;
              $129.currentStep = ChooseDataset.value;
              return $129;
            });
          }
          ;
          if (state3.currentStep instanceof ReviewFiles) {
            return modify_23(function(v1) {
              var $132 = {};
              for (var $133 in v1) {
                if ({}.hasOwnProperty.call(v1, $133)) {
                  $132[$133] = v1[$133];
                }
                ;
              }
              ;
              $132.currentStep = NameModule.value;
              return $132;
            });
          }
          ;
          if (state3.currentStep instanceof Download) {
            return modify_23(function(v1) {
              var $135 = {};
              for (var $136 in v1) {
                if ({}.hasOwnProperty.call(v1, $136)) {
                  $135[$136] = v1[$136];
                }
                ;
              }
              ;
              $135.currentStep = ReviewFiles.value;
              return $135;
            });
          }
          ;
          if (state3.currentStep instanceof ChooseDataset) {
            return pure127(unit);
          }
          ;
          throw new Error("Failed pattern match at PSD3.Wizard.Wizard (line 393, column 5 - line 397, column 33): " + [state3.currentStep.constructor.name]);
        });
      }
      ;
      if (v instanceof GoToStep) {
        return bind138(get25)(function(state3) {
          return when9(canGoToStep(state3)(v.value0))(modify_23(function(v1) {
            var $138 = {};
            for (var $139 in v1) {
              if ({}.hasOwnProperty.call(v1, $139)) {
                $138[$139] = v1[$139];
              }
              ;
            }
            ;
            $138.currentStep = v.value0;
            return $138;
          }));
        });
      }
      ;
      if (v instanceof GenerateFiles) {
        return bind138(get25)(function(state3) {
          if (state3.selectedDataset instanceof Just) {
            var config = {
              vizName: state3.vizName,
              dataset: state3.selectedDataset.value0,
              includeMain: state3.includeMain
            };
            var files2 = generateProject(config);
            return modify_23(function(v1) {
              var $143 = {};
              for (var $144 in v1) {
                if ({}.hasOwnProperty.call(v1, $144)) {
                  $143[$144] = v1[$144];
                }
                ;
              }
              ;
              $143.generatedFiles = files2;
              return $143;
            });
          }
          ;
          if (state3.selectedDataset instanceof Nothing) {
            return pure127(unit);
          }
          ;
          throw new Error("Failed pattern match at PSD3.Wizard.Wizard (line 407, column 5 - line 418, column 27): " + [state3.selectedDataset.constructor.name]);
        });
      }
      ;
      if (v instanceof DownloadZip) {
        return bind138(get25)(function(state3) {
          return liftAff3(downloadAsZip(state3.vizName)(state3.generatedFiles));
        });
      }
      ;
      if (v instanceof CopyToClipboard) {
        return bind138(get25)(function(state3) {
          return bind138(liftEffect51(copyFilesToClipboard(state3.generatedFiles)))(function(success) {
            return pure127(unit);
          });
        });
      }
      ;
      if (v instanceof SetDifficultyFilter) {
        return modify_23(function(v1) {
          var $147 = {};
          for (var $148 in v1) {
            if ({}.hasOwnProperty.call(v1, $148)) {
              $147[$148] = v1[$148];
            }
            ;
          }
          ;
          $147.filterDifficulty = v.value0;
          return $147;
        });
      }
      ;
      throw new Error("Failed pattern match at PSD3.Wizard.Wizard (line 371, column 16 - line 431, column 50): " + [v.constructor.name]);
    };
  };
  var component52 = /* @__PURE__ */ (function() {
    return mkComponent({
      initialState: $$const(initialState3),
      render: render59(monadAffAff),
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        initialize: defaultEval.initialize,
        finalize: defaultEval.finalize,
        handleAction: handleAction51(monadAffAff)
      })
    });
  })();

  // output/Routing.Parser/index.js
  var map93 = /* @__PURE__ */ map(functorArray);
  var discard79 = /* @__PURE__ */ discard(discardUnit)(bindMaybe);
  var guard2 = /* @__PURE__ */ guard(alternativeMaybe);
  var apply6 = /* @__PURE__ */ apply(applyMaybe);
  var map123 = /* @__PURE__ */ map(functorMaybe);
  var fromFoldable56 = /* @__PURE__ */ fromFoldable6(ordString)(foldableArray);
  var traverse5 = /* @__PURE__ */ traverse(traversableArray)(applicativeMaybe);
  var fromFoldable119 = /* @__PURE__ */ fromFoldable2(foldableArray);
  var append33 = /* @__PURE__ */ append(semigroupList);
  var map211 = /* @__PURE__ */ map(functorList);
  var fromFoldable210 = /* @__PURE__ */ fromFoldable2(foldableMaybe);
  var parseQueryPart = function(decoder) {
    var part2tuple = function(input3) {
      var keyVal = map93(decoder)(split("=")(input3));
      return discard79(guard2(length(keyVal) <= 2))(function() {
        return apply6(map123(Tuple.create)(head(keyVal)))(index(keyVal)(1));
      });
    };
    var $27 = map123(fromFoldable56);
    var $28 = traverse5(part2tuple);
    var $29 = split("&");
    return function($30) {
      return $27($28($29($30)));
    };
  };
  var parse8 = function(decoder) {
    return function(hash2) {
      var pathParts = function(str2) {
        var parts = fromFoldable119(map93(function($31) {
          return Path4.create(decoder($31));
        })(split("/")(str2)));
        var v2 = unsnoc(parts);
        if (v2 instanceof Just && (v2.value0.last instanceof Path4 && v2.value0.last.value0 === "")) {
          return v2.value0.init;
        }
        ;
        return parts;
      };
      var v = map123(flip(splitAt3)(hash2))(indexOf2("?")(hash2));
      if (v instanceof Just) {
        return append33(pathParts(v.value0.before))(map211(Query2.create)(fromFoldable210(parseQueryPart(decoder)(drop5(1)(v.value0.after)))));
      }
      ;
      if (v instanceof Nothing) {
        return pathParts(hash2);
      }
      ;
      throw new Error("Failed pattern match at Routing.Parser (line 32, column 3 - line 37, column 21): " + [v.constructor.name]);
    };
  };

  // output/Routing/index.js
  var fromJust6 = /* @__PURE__ */ fromJust();
  var matchWith = function(decoder) {
    return function(matcher) {
      var $2 = runMatch(matcher);
      var $3 = parse8(decoder);
      return function($4) {
        return $2($3($4));
      };
    };
  };
  var match = /* @__PURE__ */ matchWith(function($6) {
    return fromJust6($$decodeURIComponent($6));
  });

  // output/Web.HTML.Event.HashChangeEvent.EventTypes/index.js
  var hashchange = "hashchange";

  // output/Routing.Hash/index.js
  var bind85 = /* @__PURE__ */ bind(bindEffect);
  var map94 = /* @__PURE__ */ map(functorEffect);
  var bindFlipped9 = /* @__PURE__ */ bindFlipped(bindEffect);
  var join4 = /* @__PURE__ */ join(bindEffect);
  var apply7 = /* @__PURE__ */ apply(applyEffect);
  var pure89 = /* @__PURE__ */ pure(applicativeEffect);
  var voidRight3 = /* @__PURE__ */ voidRight(functorEffect);
  var setHash2 = function(h) {
    return bind85(bind85(windowImpl)(location))(setHash(h));
  };
  var getHash = /* @__PURE__ */ bind85(/* @__PURE__ */ bind85(windowImpl)(location))(/* @__PURE__ */ (function() {
    var $16 = map94((function() {
      var $18 = fromMaybe("");
      var $19 = stripPrefix("#");
      return function($20) {
        return $18($19($20));
      };
    })());
    return function($17) {
      return $16(hash($17));
    };
  })());
  var foldHashes = function(cb) {
    return function(init13) {
      return function __do3() {
        var ref2 = bindFlipped9($$new)(bindFlipped9(init13)(getHash))();
        var win = map94(toEventTarget)(windowImpl)();
        var listener = eventListener(function(v) {
          return bindFlipped9(flip(write)(ref2))(join4(apply7(map94(cb)(read(ref2)))(getHash)));
        })();
        addEventListener2(hashchange)(listener)(false)(win)();
        return removeEventListener2(hashchange)(listener)(false)(win);
      };
    };
  };
  var matchesWith = function(dictFoldable) {
    var indexl2 = indexl(dictFoldable);
    return function(parser) {
      return function(cb) {
        var go2 = function(a2) {
          var $21 = maybe(pure89(a2))(function(b10) {
            return voidRight3(new Just(b10))(cb(a2)(b10));
          });
          var $22 = indexl2(0);
          return function($23) {
            return $21($22(parser($23)));
          };
        };
        return foldHashes(go2)(go2(Nothing.value));
      };
    };
  };
  var matches2 = /* @__PURE__ */ (function() {
    var $24 = matchesWith(foldableEither);
    return function($25) {
      return $24(match($25));
    };
  })();

  // output/PSD3.Main/index.js
  var bind86 = /* @__PURE__ */ bind(bindHalogenM);
  var liftEffect50 = /* @__PURE__ */ liftEffect(/* @__PURE__ */ monadEffectHalogenM(monadEffectAff));
  var discard80 = /* @__PURE__ */ discard(discardUnit)(bindHalogenM);
  var when10 = /* @__PURE__ */ when(applicativeHalogenM);
  var pure90 = /* @__PURE__ */ pure(applicativeHalogenM);
  var spy4 = /* @__PURE__ */ spy();
  var modify_24 = /* @__PURE__ */ modify_2(monadStateHalogenM);
  var slot_3 = /* @__PURE__ */ slot_();
  var slot_1 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "home";
    }
  })(ordUnit);
  var slot_22 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "gettingStarted";
    }
  })(ordUnit);
  var slot_32 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "wizard";
    }
  })(ordUnit);
  var slot_4 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "howtoIndex";
    }
  })(ordUnit);
  var slot_5 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "howtoTransitions";
    }
  })(ordUnit);
  var component1 = /* @__PURE__ */ component14(monadAffAff);
  var slot_6 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "howtoForceGraphs";
    }
  })(ordUnit);
  var component210 = /* @__PURE__ */ component9(monadAffAff);
  var slot_7 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "howtoHierarchical";
    }
  })(ordUnit);
  var component310 = /* @__PURE__ */ component10(monadAffAff);
  var slot_8 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "howtoEvents";
    }
  })(ordUnit);
  var component410 = /* @__PURE__ */ component8(monadAffAff);
  var slot_9 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "howtoTreeAPI";
    }
  })(ordUnit);
  var component53 = /* @__PURE__ */ component15(monadAffAff);
  var slot_10 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "howtoLoadingData";
    }
  })(ordUnit);
  var component62 = /* @__PURE__ */ component11(monadAffAff);
  var slot_11 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "howtoAxesScales";
    }
  })(ordUnit);
  var component72 = /* @__PURE__ */ component6(monadAffAff);
  var slot_12 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "howtoTooltips";
    }
  })(ordUnit);
  var component82 = /* @__PURE__ */ component13(monadAffAff);
  var slot_13 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "howtoDebugging";
    }
  })(ordUnit);
  var component92 = /* @__PURE__ */ component7(monadAffAff);
  var slot_14 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "howtoPerformance";
    }
  })(ordUnit);
  var component102 = /* @__PURE__ */ component12(monadAffAff);
  var slot_15 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "howtoTreeExplorer";
    }
  })(ordUnit);
  var component112 = /* @__PURE__ */ component16(monadAffAff);
  var slot_16 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "understanding";
    }
  })(ordUnit);
  var slot_17 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "understandingGrammar";
    }
  })(ordUnit);
  var component122 = /* @__PURE__ */ component41(monadAffAff);
  var slot_18 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "understandingAttributes";
    }
  })(ordUnit);
  var component132 = /* @__PURE__ */ component40(monadAffAff);
  var slot_19 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "understandingSelections";
    }
  })(ordUnit);
  var component142 = /* @__PURE__ */ component43(monadAffAff);
  var slot_20 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "understandingTreeAPI";
    }
  })(ordUnit);
  var component152 = /* @__PURE__ */ component44(monadAffAff);
  var slot_21 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "understandingScenes";
    }
  })(ordUnit);
  var component162 = /* @__PURE__ */ component42(monadAffAff);
  var slot_222 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "reference";
    }
  })(ordUnit);
  var slot_23 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "tourIndex";
    }
  })(ordUnit);
  var slot_24 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "tourFoundations";
    }
  })(ordUnit);
  var component172 = /* @__PURE__ */ component28(monadAffAff);
  var slot_25 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "tourProfessional";
    }
  })(ordUnit);
  var component182 = /* @__PURE__ */ component35(monadAffAff);
  var slot_26 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "tourFlow";
    }
  })(ordUnit);
  var component192 = /* @__PURE__ */ component27(monadAffAff);
  var slot_27 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "tourHierarchies";
    }
  })(ordUnit);
  var component202 = /* @__PURE__ */ component30(monadAffAff);
  var slot_28 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "tourMotion";
    }
  })(ordUnit);
  var component212 = /* @__PURE__ */ component34(monadAffAff);
  var slot_29 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "tourWealthHealth";
    }
  })(ordUnit);
  var component222 = /* @__PURE__ */ component38(monadAffAff);
  var slot_30 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "tourInterpreters";
    }
  })(ordUnit);
  var component232 = /* @__PURE__ */ component32(monadAffAff);
  var slot_31 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "tourFPFTW";
    }
  })(ordUnit);
  var component242 = /* @__PURE__ */ component26(monadAffAff);
  var slot_322 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "tourGraphAlgorithms";
    }
  })(ordUnit);
  var component252 = /* @__PURE__ */ component29(monadAffAff);
  var slot_33 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "tourLesMisGUP";
    }
  })(ordUnit);
  var component262 = /* @__PURE__ */ component33(monadAffAff);
  var slot_34 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "tourShowcase";
    }
  })(ordUnit);
  var component272 = /* @__PURE__ */ component36(monadAffAff);
  var slot_35 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "showcase";
    }
  })(ordUnit);
  var slot_36 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "gallery";
    }
  })(ordUnit);
  var slot_37 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "example";
    }
  })(ordUnit);
  var component282 = /* @__PURE__ */ component3(monadAffAff);
  var slot_38 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "treeAPI";
    }
  })(ordUnit);
  var component292 = /* @__PURE__ */ component39(monadAffAff);
  var slot_39 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "animatedTreeCluster";
    }
  })(ordUnit);
  var component302 = /* @__PURE__ */ component(monadAffAff);
  var slot_40 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "generalUpdatePattern";
    }
  })(ordUnit);
  var component312 = /* @__PURE__ */ component5(monadAffAff);
  var slot_41 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "lesMisGUPTree";
    }
  })(ordUnit);
  var component322 = /* @__PURE__ */ component20(monadAffAff);
  var slot_42 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "lesMisGUP";
    }
  })(ordUnit);
  var component332 = /* @__PURE__ */ component17(monadAffAff);
  var slot_43 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "lesMisGUPSimple";
    }
  })(ordUnit);
  var component342 = /* @__PURE__ */ component19(monadAffAff);
  var slot_44 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "lesMisGUPClean";
    }
  })(ordUnit);
  var component352 = /* @__PURE__ */ component18(monadAffAff);
  var slot_45 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "lesMisQueryDemo";
    }
  })(ordUnit);
  var component362 = /* @__PURE__ */ component21(monadAffAff);
  var slot_46 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "moduleGraph";
    }
  })(ordUnit);
  var component372 = /* @__PURE__ */ component23(monadAffAff);
  var slot_47 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "mermaidTreeDemo";
    }
  })(ordUnit);
  var component382 = /* @__PURE__ */ component22(monadAffAff);
  var slot_48 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "sceneJoinDemo";
    }
  })(ordUnit);
  var component392 = /* @__PURE__ */ component24(monadAffAff);
  var slot_49 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "codeExplorer";
    }
  })(ordUnit);
  var component402 = /* @__PURE__ */ component46(monadAffAff);
  var slot_50 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "codeExplorerV2";
    }
  })(ordUnit);
  var component412 = /* @__PURE__ */ component2(monadAffAff);
  var slot_51 = /* @__PURE__ */ slot_3({
    reflectSymbol: function() {
      return "acknowledgements";
    }
  })(ordUnit);
  var Initialize52 = /* @__PURE__ */ (function() {
    function Initialize53() {
    }
    ;
    Initialize53.value = new Initialize53();
    return Initialize53;
  })();
  var Navigate = /* @__PURE__ */ (function() {
    function Navigate2(value0) {
      this.value0 = value0;
    }
    ;
    Navigate2.create = function(value0) {
      return new Navigate2(value0);
    };
    return Navigate2;
  })();
  var RouteChanged = /* @__PURE__ */ (function() {
    function RouteChanged2(value0) {
      this.value0 = value0;
    }
    ;
    RouteChanged2.create = function(value0) {
      return new RouteChanged2(value0);
    };
    return RouteChanged2;
  })();
  var handleAction52 = function(v) {
    if (v instanceof Initialize52) {
      return bind86(liftEffect50(function __do3() {
        var w = windowImpl();
        var loc = location(w)();
        return hash(loc)();
      }))(function(currentHash) {
        return discard80(when10(currentHash === "" || (currentHash === "#" || currentHash === "#/"))(liftEffect50(setHash2(routeToPath(Home.value)))))(function() {
          return bind86(subscribe2(makeEmitter(function(push2) {
            return matches2(routing)(function(v12) {
              return function(newRoute) {
                return push2(new RouteChanged(new Just(newRoute)));
              };
            });
          })))(function() {
            return pure90(unit);
          });
        });
      });
    }
    ;
    if (v instanceof Navigate) {
      return liftEffect50(setHash2(routeToPath(v.value0)));
    }
    ;
    if (v instanceof RouteChanged) {
      var v1 = spy4("RouteChanged")(v.value0);
      if (v.value0 instanceof Just) {
        var v2 = spy4("Updating currentRoute to")(v.value0.value0);
        return modify_24(function(v3) {
          var $221 = {};
          for (var $222 in v3) {
            if ({}.hasOwnProperty.call(v3, $222)) {
              $221[$222] = v3[$222];
            }
            ;
          }
          ;
          $221.currentRoute = v.value0.value0;
          return $221;
        });
      }
      ;
      if (v.value0 instanceof Nothing) {
        return modify_24(function(v22) {
          var $225 = {};
          for (var $226 in v22) {
            if ({}.hasOwnProperty.call(v22, $226)) {
              $225[$226] = v22[$226];
            }
            ;
          }
          ;
          $225.currentRoute = NotFound.value;
          return $225;
        });
      }
      ;
      throw new Error("Failed pattern match at PSD3.Main (line 423, column 5 - line 427, column 57): " + [v.value0.constructor.name]);
    }
    ;
    throw new Error("Failed pattern match at PSD3.Main (line 398, column 16 - line 427, column 57): " + [v.constructor.name]);
  };
  var _wizard = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _understandingTreeAPI = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _understandingSelections = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _understandingScenes = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _understandingGrammar = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _understandingAttributes = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _understanding = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _treeAPI = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _tourWealthHealth = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _tourShowcase = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _tourProfessional = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _tourMotion = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _tourLesMisGUP = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _tourInterpreters = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _tourIndex = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _tourHierarchies = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _tourGraphAlgorithms = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _tourFoundations = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _tourFlow = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _tourFPFTW = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _showcase = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _sceneJoinDemo = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _reference = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _moduleGraph = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _mermaidTreeDemo = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _lesMisQueryDemo = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _lesMisGUPTree = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _lesMisGUPSimple = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _lesMisGUPClean = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _lesMisGUP = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _howtoTreeExplorer = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _howtoTreeAPI = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _howtoTransitions = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _howtoTooltips = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _howtoPerformance = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _howtoLoadingData = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _howtoIndex = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _howtoHierarchical = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _howtoForceGraphs = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _howtoEvents = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _howtoDebugging = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _howtoAxesScales = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _home = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _gettingStarted = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _generalUpdatePattern = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _gallery = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _example = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _codeExplorerV2 = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _codeExplorer = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _animatedTreeCluster = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var _acknowledgements = /* @__PURE__ */ (function() {
    return $$Proxy.value;
  })();
  var renderPage = function(route) {
    var v = spy4("Route is")(route);
    if (v instanceof Home) {
      return slot_1(_home)(unit)(component47)(unit);
    }
    ;
    if (v instanceof GettingStarted) {
      return slot_22(_gettingStarted)(unit)(component50)(unit);
    }
    ;
    if (v instanceof Wizard) {
      return slot_32(_wizard)(unit)(component52)(unit);
    }
    ;
    if (v instanceof HowtoIndex) {
      return slot_4(_howtoIndex)(unit)(component48)(unit);
    }
    ;
    if (v instanceof HowtoTransitions) {
      return slot_5(_howtoTransitions)(unit)(component1)(unit);
    }
    ;
    if (v instanceof HowtoForceGraphs) {
      return slot_6(_howtoForceGraphs)(unit)(component210)(unit);
    }
    ;
    if (v instanceof HowtoHierarchical) {
      return slot_7(_howtoHierarchical)(unit)(component310)(unit);
    }
    ;
    if (v instanceof HowtoEvents) {
      return slot_8(_howtoEvents)(unit)(component410)(unit);
    }
    ;
    if (v instanceof HowtoTreeAPI) {
      return slot_9(_howtoTreeAPI)(unit)(component53)(unit);
    }
    ;
    if (v instanceof HowtoLoadingData) {
      return slot_10(_howtoLoadingData)(unit)(component62)(unit);
    }
    ;
    if (v instanceof HowtoAxesScales) {
      return slot_11(_howtoAxesScales)(unit)(component72)(unit);
    }
    ;
    if (v instanceof HowtoTooltips) {
      return slot_12(_howtoTooltips)(unit)(component82)(unit);
    }
    ;
    if (v instanceof HowtoDebugging) {
      return slot_13(_howtoDebugging)(unit)(component92)(unit);
    }
    ;
    if (v instanceof HowtoPerformance) {
      return slot_14(_howtoPerformance)(unit)(component102)(unit);
    }
    ;
    if (v instanceof HowtoTreeExplorer) {
      return slot_15(_howtoTreeExplorer)(unit)(component112)(unit);
    }
    ;
    if (v instanceof Understanding) {
      return slot_16(_understanding)(unit)(component51)(unit);
    }
    ;
    if (v instanceof UnderstandingGrammar) {
      return slot_17(_understandingGrammar)(unit)(component122)(unit);
    }
    ;
    if (v instanceof UnderstandingAttributes) {
      return slot_18(_understandingAttributes)(unit)(component132)(unit);
    }
    ;
    if (v instanceof UnderstandingSelections) {
      return slot_19(_understandingSelections)(unit)(component142)(unit);
    }
    ;
    if (v instanceof UnderstandingTreeAPI) {
      return slot_20(_understandingTreeAPI)(unit)(component152)(unit);
    }
    ;
    if (v instanceof UnderstandingScenes) {
      return slot_21(_understandingScenes)(unit)(component162)(unit);
    }
    ;
    if (v instanceof Reference) {
      return slot_222(_reference)(unit)(component49)(unit);
    }
    ;
    if (v instanceof ReferenceModule) {
      return slot_222(_reference)(unit)(component49)(unit);
    }
    ;
    if (v instanceof TourIndex) {
      return slot_23(_tourIndex)(unit)(component31)(unit);
    }
    ;
    if (v instanceof TourFoundations) {
      return slot_24(_tourFoundations)(unit)(component172)(unit);
    }
    ;
    if (v instanceof TourProfessional) {
      return slot_25(_tourProfessional)(unit)(component182)(unit);
    }
    ;
    if (v instanceof TourFlow) {
      return slot_26(_tourFlow)(unit)(component192)(unit);
    }
    ;
    if (v instanceof TourHierarchies) {
      return slot_27(_tourHierarchies)(unit)(component202)(unit);
    }
    ;
    if (v instanceof TourMotion) {
      return slot_28(_tourMotion)(unit)(component212)(unit);
    }
    ;
    if (v instanceof TourWealthHealth) {
      return slot_29(_tourWealthHealth)(unit)(component222)(unit);
    }
    ;
    if (v instanceof TourInterpreters) {
      return slot_30(_tourInterpreters)(unit)(component232)(unit);
    }
    ;
    if (v instanceof TourFPFTW) {
      return slot_31(_tourFPFTW)(unit)(component242)(unit);
    }
    ;
    if (v instanceof TourGraphAlgorithms) {
      return slot_322(_tourGraphAlgorithms)(unit)(component252)(unit);
    }
    ;
    if (v instanceof TourLesMisGUP) {
      return slot_33(_tourLesMisGUP)(unit)(component262)(unit);
    }
    ;
    if (v instanceof TourShowcase) {
      return slot_34(_tourShowcase)(unit)(component272)(unit);
    }
    ;
    if (v instanceof Showcase) {
      return slot_35(_showcase)(unit)(component25)(unit);
    }
    ;
    if (v instanceof Gallery) {
      return slot_36(_gallery)(unit)(component4)(unit);
    }
    ;
    if (v instanceof Example) {
      return slot_37(_example)(unit)(component282)(v.value0);
    }
    ;
    if (v instanceof TreeAPI) {
      return slot_38(_treeAPI)(unit)(component292)(unit);
    }
    ;
    if (v instanceof AnimatedTreeCluster) {
      return slot_39(_animatedTreeCluster)(unit)(component302)(unit);
    }
    ;
    if (v instanceof GeneralUpdatePattern) {
      return slot_40(_generalUpdatePattern)(unit)(component312)(unit);
    }
    ;
    if (v instanceof LesMisGUPTree) {
      return slot_41(_lesMisGUPTree)(unit)(component322)(unit);
    }
    ;
    if (v instanceof LesMisGUP) {
      return slot_42(_lesMisGUP)(unit)(component332)(unit);
    }
    ;
    if (v instanceof LesMisGUPSimple) {
      return slot_43(_lesMisGUPSimple)(unit)(component342)(unit);
    }
    ;
    if (v instanceof LesMisGUPClean) {
      return slot_44(_lesMisGUPClean)(unit)(component352)(unit);
    }
    ;
    if (v instanceof LesMisQueryDemo) {
      return slot_45(_lesMisQueryDemo)(unit)(component362)(unit);
    }
    ;
    if (v instanceof ModuleGraph) {
      return slot_46(_moduleGraph)(unit)(component372)(unit);
    }
    ;
    if (v instanceof MermaidTreeDemo) {
      return slot_47(_mermaidTreeDemo)(unit)(component382)(unit);
    }
    ;
    if (v instanceof SceneJoinDemo) {
      return slot_48(_sceneJoinDemo)(unit)(component392)(unit);
    }
    ;
    if (v instanceof CodeExplorer) {
      return slot_49(_codeExplorer)(unit)(component402)(unit);
    }
    ;
    if (v instanceof CodeExplorerV2) {
      return slot_50(_codeExplorerV2)(unit)(component412)(unit);
    }
    ;
    if (v instanceof Acknowledgements) {
      return slot_51(_acknowledgements)(unit)(component45)(unit);
    }
    ;
    if (v instanceof NotFound) {
      return div2([classes(["not-found"])])([h1_([text2("404 - Page Not Found")]), p_([text2("The page you're looking for doesn't exist.")]), a([href("#" + routeToPath(Home.value))])([text2("Go to Home")])]);
    }
    ;
    throw new Error("Failed pattern match at PSD3.Main (line 224, column 20 - line 395, column 8): " + [v.constructor.name]);
  };
  var render60 = function(state3) {
    return div2([classes(["app"])])([main([classes(["app__main"])])([renderPage(state3.currentRoute)])]);
  };
  var component54 = /* @__PURE__ */ (function() {
    return mkComponent({
      initialState: function(v) {
        return {
          currentRoute: Home.value
        };
      },
      render: render60,
      "eval": mkEval({
        handleQuery: defaultEval.handleQuery,
        receive: defaultEval.receive,
        finalize: defaultEval.finalize,
        handleAction: handleAction52,
        initialize: new Just(Initialize52.value)
      })
    });
  })();
  var main2 = /* @__PURE__ */ runHalogenAff(/* @__PURE__ */ bind(bindAff)(awaitBody)(function(body2) {
    return runUI2(component54)(unit)(body2);
  }));

  // <stdin>
  main2();
})();
